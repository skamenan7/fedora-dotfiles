"use strict";var Qre=Object.create;var KE=Object.defineProperty;var iB=Object.getOwnPropertyDescriptor;var Xre=Object.getOwnPropertyNames;var Zre=Object.getPrototypeOf,ene=Object.prototype.hasOwnProperty;var ge=(r,e)=>()=>(r&&(e=r(r=0)),e);var re=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Vv=(r,e)=>{for(var t in e)KE(r,t,{get:e[t],enumerable:!0})},oB=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Xre(e))!ene.call(r,i)&&i!==t&&KE(r,i,{get:()=>e[i],enumerable:!(n=iB(e,i))||n.enumerable});return r};var oe=(r,e,t)=>(t=r!=null?Qre(Zre(r)):{},oB(e||!r||!r.__esModule?KE(t,"default",{value:r,enumerable:!0}):t,r)),pL=r=>oB(KE({},"__esModule",{value:!0}),r),U=(r,e,t,n)=>{for(var i=n>1?void 0:n?iB(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&KE(e,t,i),i},x=(r,e)=>(t,n)=>e(t,n,r);var process,p=ge(()=>{"use strict";process={platform:"web",cwd:()=>"",env:{NODE_ENV:"production"}}});var aB=re(()=>{p();var sB;(function(r){(function(e){var t=typeof this=="object"?this:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=i(r);typeof t.Reflect=="undefined"?t.Reflect=r:n=i(t.Reflect,n),e(n);function i(o,s){return function(a,l){typeof o[a]!="function"&&Object.defineProperty(o,a,{configurable:!0,writable:!0,value:l}),s&&s(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",i=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",o=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!s&&!a,u={create:s?function(){return we(Object.create(null))}:a?function(){return we({__proto__:null})}:function(){return we({})},has:l?function(G,X){return t.call(G,X)}:function(G,X){return X in G},get:l?function(G,X){return t.call(G,X)?G[X]:void 0}:function(G,X){return G[X]}},c=Object.getPrototypeOf(Function),d=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",f=!d&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:me(),m=!d&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Fe(),g=!d&&typeof WeakMap=="function"?WeakMap:Q(),b=new g;function v(G,X,ue,_e){if($(ue)){if(!$e(G))throw new TypeError;if(!Bt(X))throw new TypeError;return h(G,X)}else{if(!$e(G))throw new TypeError;if(!ye(X))throw new TypeError;if(!ye(_e)&&!$(_e)&&!de(_e))throw new TypeError;return de(_e)&&(_e=void 0),ue=Le(ue),y(G,X,ue,_e)}}e("decorate",v);function k(G,X){function ue(_e,xe){if(!ye(_e))throw new TypeError;if(!$(xe)&&!A(xe))throw new TypeError;ie(G,X,_e,xe)}return ue}e("metadata",k);function R(G,X,ue,_e){if(!ye(ue))throw new TypeError;return $(_e)||(_e=Le(_e)),ie(G,X,ue,_e)}e("defineMetadata",R);function P(G,X,ue){if(!ye(X))throw new TypeError;return $(ue)||(ue=Le(ue)),T(G,X,ue)}e("hasMetadata",P);function D(G,X,ue){if(!ye(X))throw new TypeError;return $(ue)||(ue=Le(ue)),H(G,X,ue)}e("hasOwnMetadata",D);function K(G,X,ue){if(!ye(X))throw new TypeError;return $(ue)||(ue=Le(ue)),Y(G,X,ue)}e("getMetadata",K);function L(G,X,ue){if(!ye(X))throw new TypeError;return $(ue)||(ue=Le(ue)),Z(G,X,ue)}e("getOwnMetadata",L);function B(G,X){if(!ye(G))throw new TypeError;return $(X)||(X=Le(X)),ce(G,X)}e("getMetadataKeys",B);function N(G,X){if(!ye(G))throw new TypeError;return $(X)||(X=Le(X)),be(G,X)}e("getOwnMetadataKeys",N);function O(G,X,ue){if(!ye(X))throw new TypeError;$(ue)||(ue=Le(ue));var _e=w(X,ue,!1);if($(_e)||!_e.delete(G))return!1;if(_e.size>0)return!0;var xe=b.get(X);return xe.delete(ue),xe.size>0||b.delete(X),!0}e("deleteMetadata",O);function h(G,X){for(var ue=G.length-1;ue>=0;--ue){var _e=G[ue],xe=_e(X);if(!$(xe)&&!de(xe)){if(!Bt(xe))throw new TypeError;X=xe}}return X}function y(G,X,ue,_e){for(var xe=G.length-1;xe>=0;--xe){var ee=G[xe],se=ee(X,ue,_e);if(!$(se)&&!de(se)){if(!ye(se))throw new TypeError;_e=se}}return _e}function w(G,X,ue){var _e=b.get(G);if($(_e)){if(!ue)return;_e=new f,b.set(G,_e)}var xe=_e.get(X);if($(xe)){if(!ue)return;xe=new f,_e.set(X,xe)}return xe}function T(G,X,ue){var _e=H(G,X,ue);if(_e)return!0;var xe=j(X);return de(xe)?!1:T(G,xe,ue)}function H(G,X,ue){var _e=w(X,ue,!1);return $(_e)?!1:Se(_e.has(G))}function Y(G,X,ue){var _e=H(G,X,ue);if(_e)return Z(G,X,ue);var xe=j(X);if(!de(xe))return Y(G,xe,ue)}function Z(G,X,ue){var _e=w(X,ue,!1);if(!$(_e))return _e.get(G)}function ie(G,X,ue,_e){var xe=w(ue,_e,!0);xe.set(G,X)}function ce(G,X){var ue=be(G,X),_e=j(G);if(_e===null)return ue;var xe=ce(_e,X);if(xe.length<=0)return ue;if(ue.length<=0)return xe;for(var ee=new m,se=[],ae=0,Ie=ue;ae<Ie.length;ae++){var Pe=Ie[ae],Ne=ee.has(Pe);Ne||(ee.add(Pe),se.push(Pe))}for(var vt=0,Yt=xe;vt<Yt.length;vt++){var Pe=Yt[vt],Ne=ee.has(Pe);Ne||(ee.add(Pe),se.push(Pe))}return se}function be(G,X){var ue=[],_e=w(G,X,!1);if($(_e))return ue;for(var xe=_e.keys(),ee=I(xe),se=0;;){var ae=_(ee);if(!ae)return ue.length=se,ue;var Ie=S(ae);try{ue[se]=Ie}catch(Pe){try{F(ee)}finally{throw Pe}}se++}}function q(G){if(G===null)return 1;switch(typeof G){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return G===null?1:6;default:return 6}}function $(G){return G===void 0}function de(G){return G===null}function pe(G){return typeof G=="symbol"}function ye(G){return typeof G=="object"?G!==null:typeof G=="function"}function z(G,X){switch(q(G)){case 0:return G;case 1:return G;case 2:return G;case 3:return G;case 4:return G;case 5:return G}var ue=X===3?"string":X===5?"number":"default",_e=M(G,i);if(_e!==void 0){var xe=_e.call(G,ue);if(ye(xe))throw new TypeError;return xe}return fe(G,ue==="default"?"number":ue)}function fe(G,X){if(X==="string"){var ue=G.toString;if(Ge(ue)){var _e=ue.call(G);if(!ye(_e))return _e}var xe=G.valueOf;if(Ge(xe)){var _e=xe.call(G);if(!ye(_e))return _e}}else{var xe=G.valueOf;if(Ge(xe)){var _e=xe.call(G);if(!ye(_e))return _e}var ee=G.toString;if(Ge(ee)){var _e=ee.call(G);if(!ye(_e))return _e}}throw new TypeError}function Se(G){return!!G}function Te(G){return""+G}function Le(G){var X=z(G,3);return pe(X)?X:Te(X)}function $e(G){return Array.isArray?Array.isArray(G):G instanceof Object?G instanceof Array:Object.prototype.toString.call(G)==="[object Array]"}function Ge(G){return typeof G=="function"}function Bt(G){return typeof G=="function"}function A(G){switch(q(G)){case 3:return!0;case 4:return!0;default:return!1}}function M(G,X){var ue=G[X];if(ue!=null){if(!Ge(ue))throw new TypeError;return ue}}function I(G){var X=M(G,o);if(!Ge(X))throw new TypeError;var ue=X.call(G);if(!ye(ue))throw new TypeError;return ue}function S(G){return G.value}function _(G){var X=G.next();return X.done?!1:X}function F(G){var X=G.return;X&&X.call(G)}function j(G){var X=Object.getPrototypeOf(G);if(typeof G!="function"||G===c||X!==c)return X;var ue=G.prototype,_e=ue&&Object.getPrototypeOf(ue);if(_e==null||_e===Object.prototype)return X;var xe=_e.constructor;return typeof xe!="function"||xe===G?X:xe}function me(){var G={},X=[],ue=function(){function se(ae,Ie,Pe){this._index=0,this._keys=ae,this._values=Ie,this._selector=Pe}return se.prototype["@@iterator"]=function(){return this},se.prototype[o]=function(){return this},se.prototype.next=function(){var ae=this._index;if(ae>=0&&ae<this._keys.length){var Ie=this._selector(this._keys[ae],this._values[ae]);return ae+1>=this._keys.length?(this._index=-1,this._keys=X,this._values=X):this._index++,{value:Ie,done:!1}}return{value:void 0,done:!0}},se.prototype.throw=function(ae){throw this._index>=0&&(this._index=-1,this._keys=X,this._values=X),ae},se.prototype.return=function(ae){return this._index>=0&&(this._index=-1,this._keys=X,this._values=X),{value:ae,done:!0}},se}();return function(){function se(){this._keys=[],this._values=[],this._cacheKey=G,this._cacheIndex=-2}return Object.defineProperty(se.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),se.prototype.has=function(ae){return this._find(ae,!1)>=0},se.prototype.get=function(ae){var Ie=this._find(ae,!1);return Ie>=0?this._values[Ie]:void 0},se.prototype.set=function(ae,Ie){var Pe=this._find(ae,!0);return this._values[Pe]=Ie,this},se.prototype.delete=function(ae){var Ie=this._find(ae,!1);if(Ie>=0){for(var Pe=this._keys.length,Ne=Ie+1;Ne<Pe;Ne++)this._keys[Ne-1]=this._keys[Ne],this._values[Ne-1]=this._values[Ne];return this._keys.length--,this._values.length--,ae===this._cacheKey&&(this._cacheKey=G,this._cacheIndex=-2),!0}return!1},se.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=G,this._cacheIndex=-2},se.prototype.keys=function(){return new ue(this._keys,this._values,_e)},se.prototype.values=function(){return new ue(this._keys,this._values,xe)},se.prototype.entries=function(){return new ue(this._keys,this._values,ee)},se.prototype["@@iterator"]=function(){return this.entries()},se.prototype[o]=function(){return this.entries()},se.prototype._find=function(ae,Ie){return this._cacheKey!==ae&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=ae)),this._cacheIndex<0&&Ie&&(this._cacheIndex=this._keys.length,this._keys.push(ae),this._values.push(void 0)),this._cacheIndex},se}();function _e(se,ae){return se}function xe(se,ae){return ae}function ee(se,ae){return[se,ae]}}function Fe(){return function(){function G(){this._map=new f}return Object.defineProperty(G.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),G.prototype.has=function(X){return this._map.has(X)},G.prototype.add=function(X){return this._map.set(X,X),this},G.prototype.delete=function(X){return this._map.delete(X)},G.prototype.clear=function(){this._map.clear()},G.prototype.keys=function(){return this._map.keys()},G.prototype.values=function(){return this._map.values()},G.prototype.entries=function(){return this._map.entries()},G.prototype["@@iterator"]=function(){return this.keys()},G.prototype[o]=function(){return this.keys()},G}()}function Q(){var G=16,X=u.create(),ue=_e();return function(){function Ie(){this._key=_e()}return Ie.prototype.has=function(Pe){var Ne=xe(Pe,!1);return Ne!==void 0?u.has(Ne,this._key):!1},Ie.prototype.get=function(Pe){var Ne=xe(Pe,!1);return Ne!==void 0?u.get(Ne,this._key):void 0},Ie.prototype.set=function(Pe,Ne){var vt=xe(Pe,!0);return vt[this._key]=Ne,this},Ie.prototype.delete=function(Pe){var Ne=xe(Pe,!1);return Ne!==void 0?delete Ne[this._key]:!1},Ie.prototype.clear=function(){this._key=_e()},Ie}();function _e(){var Ie;do Ie="@@WeakMap@@"+ae();while(u.has(X,Ie));return X[Ie]=!0,Ie}function xe(Ie,Pe){if(!t.call(Ie,ue)){if(!Pe)return;Object.defineProperty(Ie,ue,{value:u.create()})}return Ie[ue]}function ee(Ie,Pe){for(var Ne=0;Ne<Pe;++Ne)Ie[Ne]=Math.random()*255|0;return Ie}function se(Ie){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(Ie)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(Ie)):ee(new Uint8Array(Ie),Ie):ee(new Array(Ie),Ie)}function ae(){var Ie=se(G);Ie[6]=Ie[6]&79|64,Ie[8]=Ie[8]&191|128;for(var Pe="",Ne=0;Ne<G;++Ne){var vt=Ie[Ne];(Ne===4||Ne===6||Ne===8)&&(Pe+="-"),vt<16&&(Pe+="0"),Pe+=vt.toString(16).toLowerCase()}return Pe}}function we(G){return G.__=void 0,delete G.__,G}})})(sB||(sB={}))});var lB={};Vv(lB,{isPreRelesVersionOfJupyterExtension:()=>tne});var tne,cB=ge(()=>{"use strict";p();tne=!1});var Mn=re(er=>{"use strict";p();Object.defineProperty(er,"__esModule",{value:!0});er.NON_CUSTOM_TAG_KEYS=er.PRE_DESTROY=er.POST_CONSTRUCT=er.DESIGN_PARAM_TYPES=er.PARAM_TYPES=er.TAGGED_PROP=er.TAGGED=er.MULTI_INJECT_TAG=er.INJECT_TAG=er.OPTIONAL_TAG=er.UNMANAGED_TAG=er.NAME_TAG=er.NAMED_TAG=void 0;er.NAMED_TAG="named";er.NAME_TAG="name";er.UNMANAGED_TAG="unmanaged";er.OPTIONAL_TAG="optional";er.INJECT_TAG="inject";er.MULTI_INJECT_TAG="multi_inject";er.TAGGED="inversify:tagged";er.TAGGED_PROP="inversify:tagged_props";er.PARAM_TYPES="inversify:paramtypes";er.DESIGN_PARAM_TYPES="design:paramtypes";er.POST_CONSTRUCT="post_construct";er.PRE_DESTROY="pre_destroy";function Pne(){return[er.INJECT_TAG,er.MULTI_INJECT_TAG,er.NAME_TAG,er.UNMANAGED_TAG,er.NAMED_TAG,er.OPTIONAL_TAG]}er.NON_CUSTOM_TAG_KEYS=Pne()});var Wa=re(xp=>{"use strict";p();Object.defineProperty(xp,"__esModule",{value:!0});xp.TargetTypeEnum=xp.BindingTypeEnum=xp.BindingScopeEnum=void 0;var Dne={Request:"Request",Singleton:"Singleton",Transient:"Transient"};xp.BindingScopeEnum=Dne;var Tne={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};xp.BindingTypeEnum=Tne;var kne={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};xp.TargetTypeEnum=kne});var Pp=re(LD=>{"use strict";p();Object.defineProperty(LD,"__esModule",{value:!0});LD.id=void 0;var Nne=0;function Rne(){return Nne++}LD.id=Rne});var rH=re(KD=>{"use strict";p();Object.defineProperty(KD,"__esModule",{value:!0});KD.Binding=void 0;var tH=Wa(),Ane=Pp(),Mne=function(){function r(e,t){this.id=(0,Ane.id)(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=tH.BindingTypeEnum.Invalid,this.constraint=function(n){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return r.prototype.clone=function(){var e=new r(this.serviceIdentifier,this.scope);return e.activated=e.scope===tH.BindingScopeEnum.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},r}();KD.Binding=Mne});var Ui=re(je=>{"use strict";p();Object.defineProperty(je,"__esModule",{value:!0});je.STACK_OVERFLOW=je.CIRCULAR_DEPENDENCY_IN_FACTORY=je.ON_DEACTIVATION_ERROR=je.PRE_DESTROY_ERROR=je.POST_CONSTRUCT_ERROR=je.ASYNC_UNBIND_REQUIRED=je.MULTIPLE_POST_CONSTRUCT_METHODS=je.MULTIPLE_PRE_DESTROY_METHODS=je.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=je.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=je.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=je.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=je.ARGUMENTS_LENGTH_MISMATCH=je.INVALID_DECORATOR_OPERATION=je.INVALID_TO_SELF_VALUE=je.LAZY_IN_SYNC=je.INVALID_FUNCTION_BINDING=je.INVALID_MIDDLEWARE_RETURN=je.NO_MORE_SNAPSHOTS_AVAILABLE=je.INVALID_BINDING_TYPE=je.NOT_IMPLEMENTED=je.CIRCULAR_DEPENDENCY=je.UNDEFINED_INJECT_ANNOTATION=je.MISSING_INJECT_ANNOTATION=je.MISSING_INJECTABLE_ANNOTATION=je.NOT_REGISTERED=je.CANNOT_UNBIND=je.AMBIGUOUS_MATCH=je.KEY_NOT_FOUND=je.NULL_ARGUMENT=je.DUPLICATED_METADATA=je.DUPLICATED_INJECTABLE_DECORATOR=void 0;je.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.";je.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:";je.NULL_ARGUMENT="NULL argument";je.KEY_NOT_FOUND="Key Not Found";je.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:";je.CANNOT_UNBIND="Could not unbind serviceIdentifier:";je.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";je.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:";je.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var One=function(r){return"@inject called with undefined this could mean that the class "+r+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};je.UNDEFINED_INJECT_ANNOTATION=One;je.CIRCULAR_DEPENDENCY="Circular dependency found:";je.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.";je.INVALID_BINDING_TYPE="Invalid binding type:";je.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.";je.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!";je.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";var Lne=function(r){return"You are attempting to construct '"+r+`' in a synchronous way
 but it has asynchronous dependencies.`};je.LAZY_IN_SYNC=Lne;je.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier";je.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var Kne=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return"The number of constructor arguments in the derived class "+(r[0]+" must be >= than the number of constructor arguments of its base class.")};je.ARGUMENTS_LENGTH_MISMATCH=Kne;je.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.";je.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').";je.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean";je.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean";je.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class";je.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";je.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";var Fne=function(r,e){return"@postConstruct error in class "+r+": "+e};je.POST_CONSTRUCT_ERROR=Fne;var Une=function(r,e){return"@preDestroy error in class "+r+": "+e};je.PRE_DESTROY_ERROR=Une;var Wne=function(r,e){return"onDeactivation() error in class "+r+": "+e};je.ON_DEACTIVATION_ERROR=Wne;var Vne=function(r,e){return"It looks like there is a circular dependency in one of the '"+r+"' bindings. Please investigate bindings with"+("service identifier '"+e+"'.")};je.CIRCULAR_DEPENDENCY_IN_FACTORY=Vne;je.STACK_OVERFLOW="Maximum call stack size exceeded"});var RL=re(lc=>{"use strict";p();var jne=lc&&lc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Bne=lc&&lc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Hne=lc&&lc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&jne(e,r,t);return Bne(e,r),e};Object.defineProperty(lc,"__esModule",{value:!0});lc.MetadataReader=void 0;var NL=Hne(Mn()),qne=function(){function r(){}return r.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(NL.PARAM_TYPES,e),n=Reflect.getMetadata(NL.TAGGED,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},r.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(NL.TAGGED_PROP,e)||[];return t},r}();lc.MetadataReader=qne});var nH=re(FD=>{"use strict";p();Object.defineProperty(FD,"__esModule",{value:!0});FD.BindingCount=void 0;var Jne={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};FD.BindingCount=Jne});var AL=re(Zs=>{"use strict";p();var Gne=Zs&&Zs.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yne=Zs&&Zs.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$ne=Zs&&Zs.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Gne(e,r,t);return Yne(e,r),e};Object.defineProperty(Zs,"__esModule",{value:!0});Zs.tryAndThrowErrorIfStackOverflow=Zs.isStackOverflowExeption=void 0;var zne=$ne(Ui());function iH(r){return r instanceof RangeError||r.message===zne.STACK_OVERFLOW}Zs.isStackOverflowExeption=iH;var Qne=function(r,e){try{return r()}catch(t){throw iH(t)&&(t=e()),t}};Zs.tryAndThrowErrorIfStackOverflow=Qne});var ty=re(On=>{"use strict";p();var Xne=On&&On.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Zne=On&&On.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),eie=On&&On.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Xne(e,r,t);return Zne(e,r),e};Object.defineProperty(On,"__esModule",{value:!0});On.getSymbolDescription=On.circularDependencyToException=On.listMetadataForTarget=On.listRegisteredBindingsForServiceIdentifier=On.getServiceIdentifierAsString=On.getFunctionName=void 0;var tie=eie(Ui());function oH(r){if(typeof r=="function"){var e=r;return e.name}else{if(typeof r=="symbol")return r.toString();var e=r;return e}}On.getServiceIdentifierAsString=oH;function rie(r,e,t){var n="",i=t(r,e);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(o){var s="Object";o.implementationType!==null&&(s=lH(o.implementationType)),n=n+`
 `+s,o.constraint.metaData&&(n=n+" - "+o.constraint.metaData)})),n}On.listRegisteredBindingsForServiceIdentifier=rie;function sH(r,e){return r.parentRequest===null?!1:r.parentRequest.serviceIdentifier===e?!0:sH(r.parentRequest,e)}function nie(r){function e(n,i){i===void 0&&(i=[]);var o=oH(n.serviceIdentifier);return i.push(o),n.parentRequest!==null?e(n.parentRequest,i):i}var t=e(r);return t.reverse().join(" --> ")}function aH(r){r.childRequests.forEach(function(e){if(sH(e,e.serviceIdentifier)){var t=nie(e);throw new Error(tie.CIRCULAR_DEPENDENCY+" "+t)}else aH(e)})}On.circularDependencyToException=aH;function iie(r,e){if(e.isTagged()||e.isNamed()){var t="",n=e.getNamedTag(),i=e.getCustomTags();return n!==null&&(t+=n.toString()+`
`),i!==null&&i.forEach(function(o){t+=o.toString()+`
`})," "+r+`
 `+r+" - "+t}else return" "+r}On.listMetadataForTarget=iie;function lH(r){if(r.name)return r.name;var e=r.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+e}On.getFunctionName=lH;function oie(r){return r.toString().slice(7,-1)}On.getSymbolDescription=oie});var cH=re(UD=>{"use strict";p();Object.defineProperty(UD,"__esModule",{value:!0});UD.Context=void 0;var sie=Pp(),aie=function(){function r(e){this.id=(0,sie.id)(),this.container=e}return r.prototype.addPlan=function(e){this.plan=e},r.prototype.setCurrentRequest=function(e){this.currentRequest=e},r}();UD.Context=aie});var Va=re(cc=>{"use strict";p();var lie=cc&&cc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),cie=cc&&cc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),uie=cc&&cc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&lie(e,r,t);return cie(e,r),e};Object.defineProperty(cc,"__esModule",{value:!0});cc.Metadata=void 0;var die=uie(Mn()),pie=function(){function r(e,t){this.key=e,this.value=t}return r.prototype.toString=function(){return this.key===die.NAMED_TAG?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},r}();cc.Metadata=pie});var uH=re(WD=>{"use strict";p();Object.defineProperty(WD,"__esModule",{value:!0});WD.Plan=void 0;var fie=function(){function r(e,t){this.parentContext=e,this.rootRequest=t}return r}();WD.Plan=fie});var ML=re(VD=>{"use strict";p();Object.defineProperty(VD,"__esModule",{value:!0});VD.LazyServiceIdentifer=void 0;var mie=function(){function r(e){this._cb=e}return r.prototype.unwrap=function(){return this._cb()},r}();VD.LazyServiceIdentifer=mie});var dH=re(jD=>{"use strict";p();Object.defineProperty(jD,"__esModule",{value:!0});jD.QueryableString=void 0;var hie=function(){function r(e){this.str=e}return r.prototype.startsWith=function(e){return this.str.indexOf(e)===0},r.prototype.endsWith=function(e){var t="",n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},r.prototype.contains=function(e){return this.str.indexOf(e)!==-1},r.prototype.equals=function(e){return this.str===e},r.prototype.value=function(){return this.str},r}();jD.QueryableString=hie});var OL=re(uc=>{"use strict";p();var gie=uc&&uc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),vie=uc&&uc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),yie=uc&&uc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&gie(e,r,t);return vie(e,r),e};Object.defineProperty(uc,"__esModule",{value:!0});uc.Target=void 0;var Lu=yie(Mn()),bie=Pp(),Iie=ty(),pH=Va(),Sie=dH(),_ie=function(){function r(e,t,n,i){this.id=(0,bie.id)(),this.type=e,this.serviceIdentifier=n;var o=typeof t=="symbol"?(0,Iie.getSymbolDescription)(t):t;this.name=new Sie.QueryableString(o||""),this.identifier=t,this.metadata=new Array;var s=null;typeof i=="string"?s=new pH.Metadata(Lu.NAMED_TAG,i):i instanceof pH.Metadata&&(s=i),s!==null&&this.metadata.push(s)}return r.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){var i=n[t];if(i.key===e)return!0}return!1},r.prototype.isArray=function(){return this.hasTag(Lu.MULTI_INJECT_TAG)},r.prototype.matchesArray=function(e){return this.matchesTag(Lu.MULTI_INJECT_TAG)(e)},r.prototype.isNamed=function(){return this.hasTag(Lu.NAMED_TAG)},r.prototype.isTagged=function(){return this.metadata.some(function(e){return Lu.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})})},r.prototype.isOptional=function(){return this.matchesTag(Lu.OPTIONAL_TAG)(!0)},r.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===Lu.NAMED_TAG})[0]:null},r.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return Lu.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})}):null},r.prototype.matchesNamedTag=function(e){return this.matchesTag(Lu.NAMED_TAG)(e)},r.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,o=t.metadata;i<o.length;i++){var s=o[i];if(s.key===e&&s.value===n)return!0}return!1}},r}();uc.Target=_ie});var IH=re(Wi=>{"use strict";p();var Eie=Wi&&Wi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Cie=Wi&&Wi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),fH=Wi&&Wi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Eie(e,r,t);return Cie(e,r),e},BD=Wi&&Wi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(Wi,"__esModule",{value:!0});Wi.getFunctionName=Wi.getBaseClassDependencyCount=Wi.getDependencies=void 0;var wie=ML(),LL=fH(Ui()),mH=Wa(),ZE=fH(Mn()),KL=ty();Object.defineProperty(Wi,"getFunctionName",{enumerable:!0,get:function(){return KL.getFunctionName}});var hH=OL();function xie(r,e){var t=(0,KL.getFunctionName)(e);return gH(r,t,e,!1)}Wi.getDependencies=xie;function gH(r,e,t,n){var i=r.getConstructorMetadata(t),o=i.compilerGeneratedMetadata;if(o===void 0){var s=LL.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(s)}var a=i.userGeneratedMetadata,l=Object.keys(a),u=t.length===0&&l.length>0,c=l.length>t.length,d=u||c?l.length:t.length,f=Die(n,e,o,a,d),m=vH(r,t,e),g=BD(BD([],f,!0),m,!0);return g}function Pie(r,e,t,n,i){var o=i[r.toString()]||[],s=bH(o),a=s.unmanaged!==!0,l=n[r],u=s.inject||s.multiInject;if(l=u||l,l instanceof wie.LazyServiceIdentifer&&(l=l.unwrap()),a){var c=l===Object,d=l===Function,f=l===void 0,m=c||d||f;if(!e&&m){var g=LL.MISSING_INJECT_ANNOTATION+" argument "+r+" in class "+t+".";throw new Error(g)}var b=new hH.Target(mH.TargetTypeEnum.ConstructorArgument,s.targetName,l);return b.metadata=o,b}return null}function Die(r,e,t,n,i){for(var o=[],s=0;s<i;s++){var a=s,l=Pie(a,r,e,t,n);l!==null&&o.push(l)}return o}function Tie(r,e,t,n){var i=r||e;if(i===void 0){var o=LL.MISSING_INJECTABLE_ANNOTATION+" for property "+String(t)+" in class "+n+".";throw new Error(o)}return i}function vH(r,e,t){for(var n=r.getPropertiesMetadata(e),i=[],o=Object.getOwnPropertySymbols(n),s=Object.keys(n),a=s.concat(o),l=0,u=a;l<u.length;l++){var c=u[l],d=n[c],f=bH(d),m=f.targetName||c,g=Tie(f.inject,f.multiInject,c,t),b=new hH.Target(mH.TargetTypeEnum.ClassProperty,m,g);b.metadata=d,i.push(b)}var v=Object.getPrototypeOf(e.prototype).constructor;if(v!==Object){var k=vH(r,v,t);i=BD(BD([],i,!0),k,!0)}return i}function yH(r,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var n=(0,KL.getFunctionName)(t),i=gH(r,n,t,!0),o=i.map(function(l){return l.metadata.filter(function(u){return u.key===ZE.UNMANAGED_TAG})}),s=[].concat.apply([],o).length,a=i.length-s;return a>0?a:yH(r,t)}else return 0}Wi.getBaseClassDependencyCount=yH;function bH(r){var e={};return r.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[ZE.INJECT_TAG],multiInject:e[ZE.MULTI_INJECT_TAG],targetName:e[ZE.NAME_TAG],unmanaged:e[ZE.UNMANAGED_TAG]}}});var SH=re(HD=>{"use strict";p();Object.defineProperty(HD,"__esModule",{value:!0});HD.Request=void 0;var kie=Pp(),Nie=function(){function r(e,t,n,i,o){this.id=(0,kie.id)(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}return r.prototype.addChildRequest=function(e,t,n){var i=new r(e,this.parentContext,this,t,n);return this.childRequests.push(i),i},r}();HD.Request=Nie});var jL=re(Uo=>{"use strict";p();var Rie=Uo&&Uo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Aie=Uo&&Uo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),CH=Uo&&Uo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Rie(e,r,t);return Aie(e,r),e};Object.defineProperty(Uo,"__esModule",{value:!0});Uo.getBindingDictionary=Uo.createMockRequest=Uo.plan=void 0;var qD=nH(),UL=CH(Ui()),wH=Wa(),_H=CH(Mn()),Mie=AL(),ry=ty(),xH=cH(),WL=Va(),Oie=uH(),FL=IH(),VL=SH(),PH=OL();function DH(r){return r._bindingDictionary}Uo.getBindingDictionary=DH;function Lie(r,e,t,n,i,o){var s=r?_H.MULTI_INJECT_TAG:_H.INJECT_TAG,a=new WL.Metadata(s,t),l=new PH.Target(e,n,t,a);if(i!==void 0){var u=new WL.Metadata(i,o);l.metadata.push(u)}return l}function EH(r,e,t,n,i){var o=eC(t.container,i.serviceIdentifier),s=[];return o.length===qD.BindingCount.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),o=eC(t.container,i.serviceIdentifier)),e?s=o:s=o.filter(function(a){var l=new VL.Request(a.serviceIdentifier,t,n,a,i);return a.constraint(l)}),Kie(i.serviceIdentifier,s,i,t.container),s}function Kie(r,e,t,n){switch(e.length){case qD.BindingCount.NoBindingsAvailable:if(t.isOptional())return e;var i=(0,ry.getServiceIdentifierAsString)(r),o=UL.NOT_REGISTERED;throw o+=(0,ry.listMetadataForTarget)(i,t),o+=(0,ry.listRegisteredBindingsForServiceIdentifier)(n,i,eC),new Error(o);case qD.BindingCount.OnlyOneBindingAvailable:return e;case qD.BindingCount.MultipleBindingsAvailable:default:if(t.isArray())return e;var i=(0,ry.getServiceIdentifierAsString)(r),o=UL.AMBIGUOUS_MATCH+" "+i;throw o+=(0,ry.listRegisteredBindingsForServiceIdentifier)(n,i,eC),new Error(o)}}function TH(r,e,t,n,i,o){var s,a;if(i===null){s=EH(r,e,n,null,o),a=new VL.Request(t,n,null,s,o);var l=new Oie.Plan(n,a);n.addPlan(l)}else s=EH(r,e,n,i,o),a=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach(function(u){var c=null;if(o.isArray())c=a.addChildRequest(u.serviceIdentifier,u,o);else{if(u.cache)return;c=a}if(u.type===wH.BindingTypeEnum.Instance&&u.implementationType!==null){var d=(0,FL.getDependencies)(r,u.implementationType);if(!n.container.options.skipBaseClassChecks){var f=(0,FL.getBaseClassDependencyCount)(r,u.implementationType);if(d.length<f){var m=UL.ARGUMENTS_LENGTH_MISMATCH((0,FL.getFunctionName)(u.implementationType));throw new Error(m)}}d.forEach(function(g){TH(r,!1,g.serviceIdentifier,n,c,g)})}})}function eC(r,e){var t=[],n=DH(r);return n.hasKey(e)?t=n.get(e):r.parent!==null&&(t=eC(r.parent,e)),t}function Fie(r,e,t,n,i,o,s,a){a===void 0&&(a=!1);var l=new xH.Context(e),u=Lie(t,n,i,"",o,s);try{return TH(r,a,i,l,null,u),l}catch(c){throw(0,Mie.isStackOverflowExeption)(c)&&(0,ry.circularDependencyToException)(l.plan.rootRequest),c}}Uo.plan=Fie;function Uie(r,e,t,n){var i=new PH.Target(wH.TargetTypeEnum.Variable,"",e,new WL.Metadata(t,n)),o=new xH.Context(r),s=new VL.Request(e,o,null,[],i);return s}Uo.createMockRequest=Uie});var tC=re(ny=>{"use strict";p();Object.defineProperty(ny,"__esModule",{value:!0});ny.isPromiseOrContainsPromise=ny.isPromise=void 0;function BL(r){var e=typeof r=="object"&&r!==null||typeof r=="function";return e&&typeof r.then=="function"}ny.isPromise=BL;function Wie(r){return BL(r)?!0:Array.isArray(r)&&r.some(BL)}ny.isPromiseOrContainsPromise=Wie});var kH=re(dc=>{"use strict";p();var Vie=dc&&dc.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},jie=dc&&dc.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(dc,"__esModule",{value:!0});dc.saveToScope=dc.tryGetFromScope=void 0;var JD=he(),Bie=tC(),Hie=function(r,e){return e.scope===JD.BindingScopeEnum.Singleton&&e.activated?e.cache:e.scope===JD.BindingScopeEnum.Request&&r.has(e.id)?r.get(e.id):null};dc.tryGetFromScope=Hie;var qie=function(r,e,t){e.scope===JD.BindingScopeEnum.Singleton&&Gie(e,t),e.scope===JD.BindingScopeEnum.Request&&Jie(r,e,t)};dc.saveToScope=qie;var Jie=function(r,e,t){r.has(e.id)||r.set(e.id,t)},Gie=function(r,e){r.cache=e,r.activated=!0,(0,Bie.isPromise)(e)&&Yie(r,e)},Yie=function(r,e){return Vie(void 0,void 0,void 0,function(){var t,n;return jie(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return t=i.sent(),r.cache=t,[3,3];case 2:throw n=i.sent(),r.cache=null,r.activated=!1,n;case 3:return[2]}})})}});var NH=re(rC=>{"use strict";p();Object.defineProperty(rC,"__esModule",{value:!0});rC.FactoryType=void 0;var $ie;(function(r){r.DynamicValue="toDynamicValue",r.Factory="toFactory",r.Provider="toProvider"})($ie=rC.FactoryType||(rC.FactoryType={}))});var qL=re(Wo=>{"use strict";p();var zie=Wo&&Wo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Qie=Wo&&Wo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Xie=Wo&&Wo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&zie(e,r,t);return Qie(e,r),e};Object.defineProperty(Wo,"__esModule",{value:!0});Wo.getFactoryDetails=Wo.ensureFullyBound=Wo.multiBindToService=void 0;var Zie=he(),eoe=Xie(Ui()),pc=Wa(),HL=NH(),toe=function(r){return function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach(function(i){return r.bind(i).toService(e)})}}};Wo.multiBindToService=toe;var roe=function(r){var e=null;switch(r.type){case pc.BindingTypeEnum.ConstantValue:case pc.BindingTypeEnum.Function:e=r.cache;break;case pc.BindingTypeEnum.Constructor:case pc.BindingTypeEnum.Instance:e=r.implementationType;break;case pc.BindingTypeEnum.DynamicValue:e=r.dynamicValue;break;case pc.BindingTypeEnum.Provider:e=r.provider;break;case pc.BindingTypeEnum.Factory:e=r.factory;break}if(e===null){var t=(0,Zie.getServiceIdentifierAsString)(r.serviceIdentifier);throw new Error(eoe.INVALID_BINDING_TYPE+" "+t)}};Wo.ensureFullyBound=roe;var noe=function(r){switch(r.type){case pc.BindingTypeEnum.Factory:return{factory:r.factory,factoryType:HL.FactoryType.Factory};case pc.BindingTypeEnum.Provider:return{factory:r.provider,factoryType:HL.FactoryType.Provider};case pc.BindingTypeEnum.DynamicValue:return{factory:r.dynamicValue,factoryType:HL.FactoryType.DynamicValue};default:throw new Error("Unexpected factory type "+r.type)}};Wo.getFactoryDetails=noe});var KH=re(fi=>{"use strict";p();var iy=fi&&fi.__assign||function(){return iy=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},iy.apply(this,arguments)},ioe=fi&&fi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ooe=fi&&fi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),soe=fi&&fi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&ioe(e,r,t);return ooe(e,r),e},MH=fi&&fi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},OH=fi&&fi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},aoe=fi&&fi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(fi,"__esModule",{value:!0});fi.resolveInstance=void 0;var JL=Ui(),YL=Wa(),GL=soe(Mn()),$L=tC();function loe(r,e){return r.reduce(function(t,n){var i=e(n),o=n.target.type;return o===YL.TargetTypeEnum.ConstructorArgument?t.constructorInjections.push(i):(t.propertyRequests.push(n),t.propertyInjections.push(i)),t.isAsync||(t.isAsync=(0,$L.isPromiseOrContainsPromise)(i)),t},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function coe(r,e,t){var n;if(e.length>0){var i=loe(e,t),o=iy(iy({},i),{constr:r});i.isAsync?n=uoe(o):n=LH(o)}else n=new r;return n}function LH(r){var e,t=new((e=r.constr).bind.apply(e,aoe([void 0],r.constructorInjections,!1)));return r.propertyRequests.forEach(function(n,i){var o=n.target.identifier,s=r.propertyInjections[i];t[o]=s}),t}function uoe(r){return MH(this,void 0,void 0,function(){var e,t;return OH(this,function(n){switch(n.label){case 0:return[4,RH(r.constructorInjections)];case 1:return e=n.sent(),[4,RH(r.propertyInjections)];case 2:return t=n.sent(),[2,LH(iy(iy({},r),{constructorInjections:e,propertyInjections:t}))]}})})}function RH(r){return MH(this,void 0,void 0,function(){var e,t,n,i;return OH(this,function(o){for(e=[],t=0,n=r;t<n.length;t++)i=n[t],Array.isArray(i)?e.push(Promise.all(i)):e.push(i);return[2,Promise.all(e)]})})}function AH(r,e){var t=doe(r,e);return(0,$L.isPromise)(t)?t.then(function(){return e}):e}function doe(r,e){var t,n;if(Reflect.hasMetadata(GL.POST_CONSTRUCT,r)){var i=Reflect.getMetadata(GL.POST_CONSTRUCT,r);try{return(n=(t=e)[i.value])===null||n===void 0?void 0:n.call(t)}catch(o){throw new Error((0,JL.POST_CONSTRUCT_ERROR)(r.name,o.message))}}}function poe(r,e){r.scope!==YL.BindingScopeEnum.Singleton&&foe(r,e)}function foe(r,e){var t="Class cannot be instantiated in "+(r.scope===YL.BindingScopeEnum.Request?"request":"transient")+" scope.";if(typeof r.onDeactivation=="function")throw new Error((0,JL.ON_DEACTIVATION_ERROR)(e.name,t));if(Reflect.hasMetadata(GL.PRE_DESTROY,e))throw new Error((0,JL.PRE_DESTROY_ERROR)(e.name,t))}function moe(r,e,t,n){poe(r,e);var i=coe(e,t,n);return(0,$L.isPromise)(i)?i.then(function(o){return AH(e,o)}):AH(e,i)}fi.resolveInstance=moe});var jH=re(Vo=>{"use strict";p();var hoe=Vo&&Vo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),goe=Vo&&Vo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),voe=Vo&&Vo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&hoe(e,r,t);return goe(e,r),e},yoe=Vo&&Vo.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},boe=Vo&&Vo.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(Vo,"__esModule",{value:!0});Vo.resolve=void 0;var Ioe=voe(Ui()),GD=Wa(),Soe=jL(),FH=kH(),zL=tC(),WH=qL(),_oe=AL(),Eoe=KH(),QL=function(r){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,n=e.childRequests,i=e.target&&e.target.isArray(),o=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(i&&o)return n.map(function(a){var l=QL(r);return l(a)});if(e.target.isOptional()&&t.length===0)return;var s=t[0];return Poe(r,e,s)}},Coe=function(r,e){var t=(0,WH.getFactoryDetails)(r);return(0,_oe.tryAndThrowErrorIfStackOverflow)(function(){return t.factory.bind(r)(e)},function(){return new Error(Ioe.CIRCULAR_DEPENDENCY_IN_FACTORY(t.factoryType,e.currentRequest.serviceIdentifier.toString()))})},woe=function(r,e,t){var n,i=e.childRequests;switch((0,WH.ensureFullyBound)(t),t.type){case GD.BindingTypeEnum.ConstantValue:case GD.BindingTypeEnum.Function:n=t.cache;break;case GD.BindingTypeEnum.Constructor:n=t.implementationType;break;case GD.BindingTypeEnum.Instance:n=(0,Eoe.resolveInstance)(t,t.implementationType,i,QL(r));break;default:n=Coe(t,e.parentContext)}return n},xoe=function(r,e,t){var n=(0,FH.tryGetFromScope)(r,e);return n!==null||(n=t(),(0,FH.saveToScope)(r,e,n)),n},Poe=function(r,e,t){return xoe(r,t,function(){var n=woe(r,e,t);return(0,zL.isPromise)(n)?n=n.then(function(i){return UH(e,t,i)}):n=UH(e,t,n),n})};function UH(r,e,t){var n=Doe(r.parentContext,e,t),i=Noe(r.parentContext.container),o,s=i.next();do{o=s.value;var a=r.parentContext,l=r.serviceIdentifier,u=koe(o,l);(0,zL.isPromise)(n)?n=VH(u,a,n):n=Toe(u,a,n),s=i.next()}while(s.done!==!0&&!(0,Soe.getBindingDictionary)(o).hasKey(r.serviceIdentifier));return n}var Doe=function(r,e,t){var n;return typeof e.onActivation=="function"?n=e.onActivation(r,t):n=t,n},Toe=function(r,e,t){for(var n=r.next();!n.done;){if(t=n.value(e,t),(0,zL.isPromise)(t))return VH(r,e,t);n=r.next()}return t},VH=function(r,e,t){return yoe(void 0,void 0,void 0,function(){var n,i;return boe(this,function(o){switch(o.label){case 0:return[4,t];case 1:n=o.sent(),i=r.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(e,n)];case 3:return n=o.sent(),i=r.next(),[3,2];case 4:return[2,n]}})})},koe=function(r,e){var t=r._activations;return t.hasKey(e)?t.get(e).values():[].values()},Noe=function(r){for(var e=[r],t=r.parent;t!==null;)e.push(t),t=t.parent;var n=function(){var o=e.pop();return o!==void 0?{done:!1,value:o}:{done:!0,value:void 0}},i={next:n};return i};function Roe(r){var e=QL(r.plan.rootRequest.requestScope);return e(r.plan.rootRequest)}Vo.resolve=Roe});var XL=re(Vi=>{"use strict";p();var Aoe=Vi&&Vi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Moe=Vi&&Vi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Ooe=Vi&&Vi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Aoe(e,r,t);return Moe(e,r),e};Object.defineProperty(Vi,"__esModule",{value:!0});Vi.typeConstraint=Vi.namedConstraint=Vi.taggedConstraint=Vi.traverseAncerstors=void 0;var Loe=Ooe(Mn()),Koe=Va(),BH=function(r,e){var t=r.parentRequest;return t!==null?e(t)?!0:BH(t,e):!1};Vi.traverseAncerstors=BH;var HH=function(r){return function(e){var t=function(n){return n!==null&&n.target!==null&&n.target.matchesTag(r)(e)};return t.metaData=new Koe.Metadata(r,e),t}};Vi.taggedConstraint=HH;var Foe=HH(Loe.NAMED_TAG);Vi.namedConstraint=Foe;var Uoe=function(r){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof r=="string"){var n=t.serviceIdentifier;return n===r}else{var i=e.bindings[0].implementationType;return r===i}return!1}};Vi.typeConstraint=Uoe});var $D=re(YD=>{"use strict";p();Object.defineProperty(YD,"__esModule",{value:!0});YD.BindingWhenSyntax=void 0;var fo=zD(),$n=XL(),Woe=function(){function r(e){this._binding=e}return r.prototype.when=function(e){return this._binding.constraint=e,new fo.BindingOnSyntax(this._binding)},r.prototype.whenTargetNamed=function(e){return this._binding.constraint=(0,$n.namedConstraint)(e),new fo.BindingOnSyntax(this._binding)},r.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){if(e===null)return!1;var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new fo.BindingOnSyntax(this._binding)},r.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=(0,$n.taggedConstraint)(e)(t),new fo.BindingOnSyntax(this._binding)},r.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return t!==null&&(0,$n.typeConstraint)(e)(t.parentRequest)},new fo.BindingOnSyntax(this._binding)},r.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,$n.namedConstraint)(e)(t.parentRequest)},new fo.BindingOnSyntax(this._binding)},r.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,$n.taggedConstraint)(e)(t)(n.parentRequest)},new fo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&(0,$n.traverseAncerstors)(t,(0,$n.typeConstraint)(e))},new fo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,$n.traverseAncerstors)(t,(0,$n.typeConstraint)(e))},new fo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,$n.traverseAncerstors)(t,(0,$n.namedConstraint)(e))},new fo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,$n.traverseAncerstors)(t,(0,$n.namedConstraint)(e))},new fo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,$n.traverseAncerstors)(n,(0,$n.taggedConstraint)(e)(t))},new fo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&!(0,$n.traverseAncerstors)(n,(0,$n.taggedConstraint)(e)(t))},new fo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&(0,$n.traverseAncerstors)(t,e)},new fo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,$n.traverseAncerstors)(t,e)},new fo.BindingOnSyntax(this._binding)},r}();YD.BindingWhenSyntax=Woe});var zD=re(QD=>{"use strict";p();Object.defineProperty(QD,"__esModule",{value:!0});QD.BindingOnSyntax=void 0;var qH=$D(),Voe=function(){function r(e){this._binding=e}return r.prototype.onActivation=function(e){return this._binding.onActivation=e,new qH.BindingWhenSyntax(this._binding)},r.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new qH.BindingWhenSyntax(this._binding)},r}();QD.BindingOnSyntax=Voe});var ZL=re(XD=>{"use strict";p();Object.defineProperty(XD,"__esModule",{value:!0});XD.BindingWhenOnSyntax=void 0;var joe=zD(),Boe=$D(),Hoe=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Boe.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new joe.BindingOnSyntax(this._binding)}return r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();XD.BindingWhenOnSyntax=Hoe});var JH=re(ZD=>{"use strict";p();Object.defineProperty(ZD,"__esModule",{value:!0});ZD.BindingInSyntax=void 0;var eK=Wa(),tK=ZL(),qoe=function(){function r(e){this._binding=e}return r.prototype.inRequestScope=function(){return this._binding.scope=eK.BindingScopeEnum.Request,new tK.BindingWhenOnSyntax(this._binding)},r.prototype.inSingletonScope=function(){return this._binding.scope=eK.BindingScopeEnum.Singleton,new tK.BindingWhenOnSyntax(this._binding)},r.prototype.inTransientScope=function(){return this._binding.scope=eK.BindingScopeEnum.Transient,new tK.BindingWhenOnSyntax(this._binding)},r}();ZD.BindingInSyntax=qoe});var GH=re(eT=>{"use strict";p();Object.defineProperty(eT,"__esModule",{value:!0});eT.BindingInWhenOnSyntax=void 0;var Joe=JH(),Goe=zD(),Yoe=$D(),$oe=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Yoe.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Goe.BindingOnSyntax(this._binding),this._bindingInSyntax=new Joe.BindingInSyntax(e)}return r.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},r.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},r.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();eT.BindingInWhenOnSyntax=$oe});var zH=re(fc=>{"use strict";p();var zoe=fc&&fc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Qoe=fc&&fc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Xoe=fc&&fc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&zoe(e,r,t);return Qoe(e,r),e};Object.defineProperty(fc,"__esModule",{value:!0});fc.BindingToSyntax=void 0;var YH=Xoe(Ui()),mo=Wa(),$H=GH(),oy=ZL(),Zoe=function(){function r(e){this._binding=e}return r.prototype.to=function(e){return this._binding.type=mo.BindingTypeEnum.Instance,this._binding.implementationType=e,new $H.BindingInWhenOnSyntax(this._binding)},r.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+YH.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},r.prototype.toConstantValue=function(e){return this._binding.type=mo.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=mo.BindingScopeEnum.Singleton,new oy.BindingWhenOnSyntax(this._binding)},r.prototype.toDynamicValue=function(e){return this._binding.type=mo.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new $H.BindingInWhenOnSyntax(this._binding)},r.prototype.toConstructor=function(e){return this._binding.type=mo.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=mo.BindingScopeEnum.Singleton,new oy.BindingWhenOnSyntax(this._binding)},r.prototype.toFactory=function(e){return this._binding.type=mo.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=mo.BindingScopeEnum.Singleton,new oy.BindingWhenOnSyntax(this._binding)},r.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(YH.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=mo.BindingTypeEnum.Function,this._binding.scope=mo.BindingScopeEnum.Singleton,t},r.prototype.toAutoFactory=function(e){return this._binding.type=mo.BindingTypeEnum.Factory,this._binding.factory=function(t){var n=function(){return t.container.get(e)};return n},this._binding.scope=mo.BindingScopeEnum.Singleton,new oy.BindingWhenOnSyntax(this._binding)},r.prototype.toAutoNamedFactory=function(e){return this._binding.type=mo.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new oy.BindingWhenOnSyntax(this._binding)},r.prototype.toProvider=function(e){return this._binding.type=mo.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=mo.BindingScopeEnum.Singleton,new oy.BindingWhenOnSyntax(this._binding)},r.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},r}();fc.BindingToSyntax=Zoe});var QH=re(tT=>{"use strict";p();Object.defineProperty(tT,"__esModule",{value:!0});tT.ContainerSnapshot=void 0;var ese=function(){function r(){}return r.of=function(e,t,n,i,o){var s=new r;return s.bindings=e,s.middleware=t,s.deactivations=i,s.activations=n,s.moduleActivationStore=o,s},r}();tT.ContainerSnapshot=ese});var XH=re(rT=>{"use strict";p();Object.defineProperty(rT,"__esModule",{value:!0});rT.isClonable=void 0;function tse(r){return typeof r=="object"&&r!==null&&"clone"in r&&typeof r.clone=="function"}rT.isClonable=tse});var rK=re(mc=>{"use strict";p();var rse=mc&&mc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),nse=mc&&mc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),ise=mc&&mc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&rse(e,r,t);return nse(e,r),e};Object.defineProperty(mc,"__esModule",{value:!0});mc.Lookup=void 0;var Fm=ise(Ui()),ose=XH(),sse=function(){function r(){this._map=new Map}return r.prototype.getMap=function(){return this._map},r.prototype.add=function(e,t){if(e==null)throw new Error(Fm.NULL_ARGUMENT);if(t==null)throw new Error(Fm.NULL_ARGUMENT);var n=this._map.get(e);n!==void 0?n.push(t):this._map.set(e,[t])},r.prototype.get=function(e){if(e==null)throw new Error(Fm.NULL_ARGUMENT);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(Fm.KEY_NOT_FOUND)},r.prototype.remove=function(e){if(e==null)throw new Error(Fm.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(Fm.KEY_NOT_FOUND)},r.prototype.removeIntersection=function(e){var t=this;this.traverse(function(n,i){var o=e.hasKey(n)?e.get(n):void 0;if(o!==void 0){var s=i.filter(function(a){return!o.some(function(l){return a===l})});t._setValue(n,s)}})},r.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach(function(i,o){for(var s=[],a=0,l=i;a<l.length;a++){var u=l[a],c=e(u);c?n.push(u):s.push(u)}t._setValue(o,s)}),n},r.prototype.hasKey=function(e){if(e==null)throw new Error(Fm.NULL_ARGUMENT);return this._map.has(e)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){t.forEach(function(i){return e.add(n,(0,ose.isClonable)(i)?i.clone():i)})}),e},r.prototype.traverse=function(e){this._map.forEach(function(t,n){e(n,t)})},r.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},r}();mc.Lookup=sse});var e7=re(nT=>{"use strict";p();Object.defineProperty(nT,"__esModule",{value:!0});nT.ModuleActivationStore=void 0;var ZH=rK(),ase=function(){function r(){this._map=new Map}return r.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},r.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},r.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),e},r.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},r.prototype._getEmptyHandlersStore=function(){var e={onActivations:new ZH.Lookup,onDeactivations:new ZH.Lookup};return e},r}();nT.ModuleActivationStore=ase});var nK=re(mi=>{"use strict";p();var oT=mi&&mi.__assign||function(){return oT=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},oT.apply(this,arguments)},lse=mi&&mi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),cse=mi&&mi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),t7=mi&&mi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&lse(e,r,t);return cse(e,r),e},ea=mi&&mi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},ta=mi&&mi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},use=mi&&mi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(mi,"__esModule",{value:!0});mi.Container=void 0;var dse=rH(),ja=t7(Ui()),sy=Wa(),Um=t7(Mn()),pse=RL(),iT=jL(),fse=jH(),mse=zH(),Wm=tC(),hse=Pp(),gse=ty(),vse=QH(),nC=rK(),yse=e7(),bse=function(){function r(e){var t=e||{};if(typeof t!="object")throw new Error(""+ja.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(t.defaultScope===void 0)t.defaultScope=sy.BindingScopeEnum.Transient;else if(t.defaultScope!==sy.BindingScopeEnum.Singleton&&t.defaultScope!==sy.BindingScopeEnum.Transient&&t.defaultScope!==sy.BindingScopeEnum.Request)throw new Error(""+ja.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+ja.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+ja.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=(0,hse.id)(),this._bindingDictionary=new nC.Lookup,this._snapshots=[],this._middleware=null,this._activations=new nC.Lookup,this._deactivations=new nC.Lookup,this.parent=null,this._metadataReader=new pse.MetadataReader,this._moduleActivationStore=new yse.ModuleActivationStore}return r.merge=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new r,s=use([e,t],n,!0).map(function(u){return(0,iT.getBindingDictionary)(u)}),a=(0,iT.getBindingDictionary)(o);function l(u,c){u.traverse(function(d,f){f.forEach(function(m){c.add(m.serviceIdentifier,m.clone())})})}return s.forEach(function(u){l(u,a)}),o},r.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,o=e;i<o.length;i++){var s=o[i],a=n(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},r.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ea(this,void 0,void 0,function(){var n,i,o,s,a;return ta(this,function(l){switch(l.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,o=e,l.label=1;case 1:return i<o.length?(s=o[i],a=n(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:l.sent(),l.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},r.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach(function(i){var o=e._removeModuleBindings(i.id);e._deactivateSingletons(o),e._removeModuleHandlers(i.id)})},r.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ea(this,void 0,void 0,function(){var n,i,o,s;return ta(this,function(a){switch(a.label){case 0:n=0,i=e,a.label=1;case 1:return n<i.length?(o=i[n],s=this._removeModuleBindings(o.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(o.id),a.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.bind=function(e){var t=this.options.defaultScope||sy.BindingScopeEnum.Transient,n=new dse.Binding(e,t);return this._bindingDictionary.add(e,n),new mse.BindingToSyntax(n)},r.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},r.prototype.rebindAsync=function(e){return ea(this,void 0,void 0,function(){return ta(this,function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}})})},r.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},r.prototype.unbindAsync=function(e){return ea(this,void 0,void 0,function(){var t;return ta(this,function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}})})},r.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse(function(t,n){e._deactivateSingletons(n)}),this._bindingDictionary=new nC.Lookup},r.prototype.unbindAllAsync=function(){return ea(this,void 0,void 0,function(){var e,t=this;return ta(this,function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse(function(i,o){e.push(t._deactivateSingletonsAsync(o))}),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new nC.Lookup,[2]}})})},r.prototype.onActivation=function(e,t){this._activations.add(e,t)},r.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},r.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},r.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},r.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,Um.NAMED_TAG,t)},r.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),s=(0,iT.createMockRequest)(this,e,t,n);i=o.some(function(a){return a.constraint(s)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},r.prototype.snapshot=function(){this._snapshots.push(vse.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},r.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(ja.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},r.prototype.createChild=function(e){var t=new r(e||this.options);return t.parent=this,t},r.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(i,o){return o(i)},n)},r.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},r.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},r.prototype.getAsync=function(e){return ea(this,void 0,void 0,function(){var t;return ta(this,function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]})})},r.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},r.prototype.getTaggedAsync=function(e,t,n){return ea(this,void 0,void 0,function(){var i;return ta(this,function(o){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]})})},r.prototype.getNamed=function(e,t){return this.getTagged(e,Um.NAMED_TAG,t)},r.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,Um.NAMED_TAG,t)},r.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},r.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},r.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},r.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},r.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,Um.NAMED_TAG,t)},r.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,Um.NAMED_TAG,t)},r.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},r.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(Um.PRE_DESTROY,e)){var n=Reflect.getMetadata(Um.PRE_DESTROY,e);return t[n.value]()}},r.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},r.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition(function(t){return t.moduleId===e})},r.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var o=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if((0,Wm.isPromise)(o))return this._handleDeactivationError(o.then(function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)}),i)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if((0,Wm.isPromise)(s))return this._handleDeactivationError(s,i)}catch(a){throw new Error(ja.ON_DEACTIVATION_ERROR(i.name,a.message))}},r.prototype._handleDeactivationError=function(e,t){return ea(this,void 0,void 0,function(){var n;return ta(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:throw n=i.sent(),new Error(ja.ON_DEACTIVATION_ERROR(t.name,n.message));case 3:return[2]}})})},r.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var o=i.value(e);if((0,Wm.isPromise)(o))return o.then(function(){return n._deactivateContainerAsync(e,t)});i=t.next()}},r.prototype._deactivateContainerAsync=function(e,t){return ea(this,void 0,void 0,function(){var n;return ta(this,function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}})})},r.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(c,d){c._binding.moduleId=d},n=function(c){return function(d){var f=e.bind(d);return t(f,c),f}},i=function(){return function(c){return e.unbind(c)}},o=function(){return function(c){return e.unbindAsync(c)}},s=function(){return function(c){return e.isBound(c)}},a=function(c){return function(d){var f=e.rebind(d);return t(f,c),f}},l=function(c){return function(d,f){e._moduleActivationStore.addActivation(c,d,f),e.onActivation(d,f)}},u=function(c){return function(d,f){e._moduleActivationStore.addDeactivation(c,d,f),e.onDeactivation(d,f)}};return function(c){return{bindFunction:n(c),isboundFunction:s(),onActivationFunction:l(c),onDeactivationFunction:u(c),rebindFunction:a(c),unbindFunction:i(),unbindAsyncFunction:o()}}},r.prototype._getAll=function(e){return Promise.all(this._get(e))},r.prototype._get=function(e){var t=oT(oT({},e),{contextInterceptor:function(i){return i},targetType:sy.TargetTypeEnum.Variable});if(this._middleware){var n=this._middleware(t);if(n==null)throw new Error(ja.INVALID_MIDDLEWARE_RETURN);return n}return this._planAndResolve()(t)},r.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if((0,Wm.isPromiseOrContainsPromise)(t))throw new Error(ja.LAZY_IN_SYNC(e.serviceIdentifier));return t},r.prototype._getAllArgs=function(e){var t={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e};return t},r.prototype._getNotAllArgs=function(e,t,n,i){var o={avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i};return o},r.prototype._planAndResolve=function(){var e=this;return function(t){var n=(0,iT.plan)(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var i=(0,fse.resolve)(n);return i}},r.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return(0,Wm.isPromise)(e.cache)?e.cache.then(function(n){return t._deactivate(e,n)}):this._deactivate(e,e.cache)},r.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],o=this._deactivateIfSingleton(i);if((0,Wm.isPromise)(o))throw new Error(ja.ASYNC_UNBIND_REQUIRED)}},r.prototype._deactivateSingletonsAsync=function(e){return ea(this,void 0,void 0,function(){var t=this;return ta(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(i){return t._deactivateIfSingleton(i)}))];case 1:return n.sent(),[2]}})})},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return ea(this,void 0,void 0,function(){return ta(this,function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}})})},r.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(ja.CANNOT_UNBIND+" "+(0,gse.getServiceIdentifierAsString)(e))}},r.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if(typeof e.onDeactivation=="function"){var o=e.onDeactivation(t);if((0,Wm.isPromise)(o))return o.then(function(){return i._preDestroy(n,t)})}return this._preDestroy(n,t)},r.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return ea(this,void 0,void 0,function(){return ta(this,function(i){switch(i.label){case 0:return typeof e.onDeactivation!="function"?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}})})},r}();mi.Container=bse});var n7=re(ay=>{"use strict";p();Object.defineProperty(ay,"__esModule",{value:!0});ay.AsyncContainerModule=ay.ContainerModule=void 0;var r7=Pp(),Ise=function(){function r(e){this.id=(0,r7.id)(),this.registry=e}return r}();ay.ContainerModule=Ise;var Sse=function(){function r(e){this.id=(0,r7.id)(),this.registry=e}return r}();ay.AsyncContainerModule=Sse});var i7=re(sT=>{"use strict";p();Object.defineProperty(sT,"__esModule",{value:!0});sT.getFirstArrayDuplicate=void 0;function _se(r){for(var e=new Set,t=0,n=r;t<n.length;t++){var i=n[t];if(e.has(i))return i;e.add(i)}}sT.getFirstArrayDuplicate=_se});var Ku=re(ji=>{"use strict";p();var Ese=ji&&ji.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Cse=ji&&ji.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),s7=ji&&ji.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ese(e,r,t);return Cse(e,r),e};Object.defineProperty(ji,"__esModule",{value:!0});ji.createTaggedDecorator=ji.tagProperty=ji.tagParameter=ji.decorate=void 0;var aT=s7(Ui()),a7=s7(Mn()),wse=i7();function xse(r){return r.prototype!==void 0}function Pse(r){if(r!==void 0)throw new Error(aT.INVALID_DECORATOR_OPERATION)}function l7(r,e,t,n){Pse(e),u7(a7.TAGGED,r,t.toString(),n)}ji.tagParameter=l7;function c7(r,e,t){if(xse(r))throw new Error(aT.INVALID_DECORATOR_OPERATION);u7(a7.TAGGED_PROP,r.constructor,e,t)}ji.tagProperty=c7;function Dse(r){var e=[];if(Array.isArray(r)){e=r;var t=(0,wse.getFirstArrayDuplicate)(e.map(function(n){return n.key}));if(t!==void 0)throw new Error(aT.DUPLICATED_METADATA+" "+t.toString())}else e=[r];return e}function u7(r,e,t,n){var i=Dse(n),o={};Reflect.hasOwnMetadata(r,e)&&(o=Reflect.getMetadata(r,e));var s=o[t];if(s===void 0)s=[];else for(var a=function(d){if(i.some(function(f){return f.key===d.key}))throw new Error(aT.DUPLICATED_METADATA+" "+d.key.toString())},l=0,u=s;l<u.length;l++){var c=u[l];a(c)}s.push.apply(s,i),o[t]=s,Reflect.defineMetadata(r,o,e)}function Tse(r){return function(e,t,n){typeof n=="number"?l7(e,t,n,r):c7(e,t,r)}}ji.createTaggedDecorator=Tse;function o7(r,e){Reflect.decorate(r,e)}function kse(r,e){return function(t,n){e(t,n,r)}}function Nse(r,e,t){typeof t=="number"?o7([kse(t,r)],e):typeof t=="string"?Reflect.decorate([r],e,t):o7([r],e)}ji.decorate=Nse});var p7=re(hc=>{"use strict";p();var Rse=hc&&hc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ase=hc&&hc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),d7=hc&&hc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Rse(e,r,t);return Ase(e,r),e};Object.defineProperty(hc,"__esModule",{value:!0});hc.injectable=void 0;var Mse=d7(Ui()),iK=d7(Mn());function Ose(){return function(r){if(Reflect.hasOwnMetadata(iK.PARAM_TYPES,r))throw new Error(Mse.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(iK.DESIGN_PARAM_TYPES,r)||[];return Reflect.defineMetadata(iK.PARAM_TYPES,e,r),r}}hc.injectable=Ose});var f7=re(lT=>{"use strict";p();Object.defineProperty(lT,"__esModule",{value:!0});lT.tagged=void 0;var Lse=Va(),Kse=Ku();function Fse(r,e){return(0,Kse.createTaggedDecorator)(new Lse.Metadata(r,e))}lT.tagged=Fse});var m7=re(gc=>{"use strict";p();var Use=gc&&gc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Wse=gc&&gc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Vse=gc&&gc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Use(e,r,t);return Wse(e,r),e};Object.defineProperty(gc,"__esModule",{value:!0});gc.named=void 0;var jse=Vse(Mn()),Bse=Va(),Hse=Ku();function qse(r){return(0,Hse.createTaggedDecorator)(new Bse.Metadata(jse.NAMED_TAG,r))}gc.named=qse});var oK=re(cT=>{"use strict";p();Object.defineProperty(cT,"__esModule",{value:!0});cT.injectBase=void 0;var Jse=Ui(),Gse=Va(),Yse=Ku();function $se(r){return function(e){return function(t,n,i){if(e===void 0){var o=typeof t=="function"?t.name:t.constructor.name;throw new Error((0,Jse.UNDEFINED_INJECT_ANNOTATION)(o))}return(0,Yse.createTaggedDecorator)(new Gse.Metadata(r,e))(t,n,i)}}}cT.injectBase=$se});var h7=re(vc=>{"use strict";p();var zse=vc&&vc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Qse=vc&&vc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Xse=vc&&vc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&zse(e,r,t);return Qse(e,r),e};Object.defineProperty(vc,"__esModule",{value:!0});vc.inject=void 0;var Zse=Xse(Mn()),eae=oK(),tae=(0,eae.injectBase)(Zse.INJECT_TAG);vc.inject=tae});var g7=re(yc=>{"use strict";p();var rae=yc&&yc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),nae=yc&&yc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),iae=yc&&yc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&rae(e,r,t);return nae(e,r),e};Object.defineProperty(yc,"__esModule",{value:!0});yc.optional=void 0;var oae=iae(Mn()),sae=Va(),aae=Ku();function lae(){return(0,aae.createTaggedDecorator)(new sae.Metadata(oae.OPTIONAL_TAG,!0))}yc.optional=lae});var v7=re(bc=>{"use strict";p();var cae=bc&&bc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),uae=bc&&bc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),dae=bc&&bc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&cae(e,r,t);return uae(e,r),e};Object.defineProperty(bc,"__esModule",{value:!0});bc.unmanaged=void 0;var pae=dae(Mn()),fae=Va(),mae=Ku();function hae(){return function(r,e,t){var n=new fae.Metadata(pae.UNMANAGED_TAG,!0);(0,mae.tagParameter)(r,e,t,n)}}bc.unmanaged=hae});var y7=re(Ic=>{"use strict";p();var gae=Ic&&Ic.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),vae=Ic&&Ic.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),yae=Ic&&Ic.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&gae(e,r,t);return vae(e,r),e};Object.defineProperty(Ic,"__esModule",{value:!0});Ic.multiInject=void 0;var bae=yae(Mn()),Iae=oK(),Sae=(0,Iae.injectBase)(bae.MULTI_INJECT_TAG);Ic.multiInject=Sae});var b7=re(Sc=>{"use strict";p();var _ae=Sc&&Sc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Eae=Sc&&Sc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Cae=Sc&&Sc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&_ae(e,r,t);return Eae(e,r),e};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.targetName=void 0;var wae=Cae(Mn()),xae=Va(),Pae=Ku();function Dae(r){return function(e,t,n){var i=new xae.Metadata(wae.NAME_TAG,r);(0,Pae.tagParameter)(e,t,n,i)}}Sc.targetName=Dae});var sK=re(uT=>{"use strict";p();Object.defineProperty(uT,"__esModule",{value:!0});uT.propertyEventDecorator=void 0;var Tae=Va();function kae(r,e){return function(){return function(t,n){var i=new Tae.Metadata(r,n);if(Reflect.hasOwnMetadata(r,t.constructor))throw new Error(e);Reflect.defineMetadata(r,i,t.constructor)}}}uT.propertyEventDecorator=kae});var S7=re(_c=>{"use strict";p();var Nae=_c&&_c.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Rae=_c&&_c.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),I7=_c&&_c.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Nae(e,r,t);return Rae(e,r),e};Object.defineProperty(_c,"__esModule",{value:!0});_c.postConstruct=void 0;var Aae=I7(Ui()),Mae=I7(Mn()),Oae=sK(),Lae=(0,Oae.propertyEventDecorator)(Mae.POST_CONSTRUCT,Aae.MULTIPLE_POST_CONSTRUCT_METHODS);_c.postConstruct=Lae});var E7=re(Ec=>{"use strict";p();var Kae=Ec&&Ec.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Fae=Ec&&Ec.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),_7=Ec&&Ec.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Kae(e,r,t);return Fae(e,r),e};Object.defineProperty(Ec,"__esModule",{value:!0});Ec.preDestroy=void 0;var Uae=_7(Ui()),Wae=_7(Mn()),Vae=sK(),jae=(0,Vae.propertyEventDecorator)(Wae.PRE_DESTROY,Uae.MULTIPLE_PRE_DESTROY_METHODS);Ec.preDestroy=jae});var C7=re(dT=>{"use strict";p();Object.defineProperty(dT,"__esModule",{value:!0});dT.interfaces=void 0;var aK;aK||(aK={});dT.interfaces=aK});var he=re(Be=>{"use strict";p();var Bae=Be&&Be.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Hae=Be&&Be.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),qae=Be&&Be.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Bae(e,r,t);return Hae(e,r),e};Object.defineProperty(Be,"__esModule",{value:!0});Be.multiBindToService=Be.getServiceIdentifierAsString=Be.typeConstraint=Be.namedConstraint=Be.taggedConstraint=Be.traverseAncerstors=Be.decorate=Be.interfaces=Be.id=Be.MetadataReader=Be.preDestroy=Be.postConstruct=Be.targetName=Be.multiInject=Be.unmanaged=Be.optional=Be.LazyServiceIdentifer=Be.inject=Be.named=Be.tagged=Be.injectable=Be.createTaggedDecorator=Be.ContainerModule=Be.AsyncContainerModule=Be.TargetTypeEnum=Be.BindingTypeEnum=Be.BindingScopeEnum=Be.Container=Be.METADATA_KEY=void 0;var Jae=qae(Mn());Be.METADATA_KEY=Jae;var Gae=nK();Object.defineProperty(Be,"Container",{enumerable:!0,get:function(){return Gae.Container}});var lK=Wa();Object.defineProperty(Be,"BindingScopeEnum",{enumerable:!0,get:function(){return lK.BindingScopeEnum}});Object.defineProperty(Be,"BindingTypeEnum",{enumerable:!0,get:function(){return lK.BindingTypeEnum}});Object.defineProperty(Be,"TargetTypeEnum",{enumerable:!0,get:function(){return lK.TargetTypeEnum}});var w7=n7();Object.defineProperty(Be,"AsyncContainerModule",{enumerable:!0,get:function(){return w7.AsyncContainerModule}});Object.defineProperty(Be,"ContainerModule",{enumerable:!0,get:function(){return w7.ContainerModule}});var Yae=Ku();Object.defineProperty(Be,"createTaggedDecorator",{enumerable:!0,get:function(){return Yae.createTaggedDecorator}});var $ae=p7();Object.defineProperty(Be,"injectable",{enumerable:!0,get:function(){return $ae.injectable}});var zae=f7();Object.defineProperty(Be,"tagged",{enumerable:!0,get:function(){return zae.tagged}});var Qae=m7();Object.defineProperty(Be,"named",{enumerable:!0,get:function(){return Qae.named}});var Xae=h7();Object.defineProperty(Be,"inject",{enumerable:!0,get:function(){return Xae.inject}});var Zae=ML();Object.defineProperty(Be,"LazyServiceIdentifer",{enumerable:!0,get:function(){return Zae.LazyServiceIdentifer}});var ele=g7();Object.defineProperty(Be,"optional",{enumerable:!0,get:function(){return ele.optional}});var tle=v7();Object.defineProperty(Be,"unmanaged",{enumerable:!0,get:function(){return tle.unmanaged}});var rle=y7();Object.defineProperty(Be,"multiInject",{enumerable:!0,get:function(){return rle.multiInject}});var nle=b7();Object.defineProperty(Be,"targetName",{enumerable:!0,get:function(){return nle.targetName}});var ile=S7();Object.defineProperty(Be,"postConstruct",{enumerable:!0,get:function(){return ile.postConstruct}});var ole=E7();Object.defineProperty(Be,"preDestroy",{enumerable:!0,get:function(){return ole.preDestroy}});var sle=RL();Object.defineProperty(Be,"MetadataReader",{enumerable:!0,get:function(){return sle.MetadataReader}});var ale=Pp();Object.defineProperty(Be,"id",{enumerable:!0,get:function(){return ale.id}});var lle=C7();Object.defineProperty(Be,"interfaces",{enumerable:!0,get:function(){return lle.interfaces}});var cle=Ku();Object.defineProperty(Be,"decorate",{enumerable:!0,get:function(){return cle.decorate}});var pT=XL();Object.defineProperty(Be,"traverseAncerstors",{enumerable:!0,get:function(){return pT.traverseAncerstors}});Object.defineProperty(Be,"taggedConstraint",{enumerable:!0,get:function(){return pT.taggedConstraint}});Object.defineProperty(Be,"namedConstraint",{enumerable:!0,get:function(){return pT.namedConstraint}});Object.defineProperty(Be,"typeConstraint",{enumerable:!0,get:function(){return pT.typeConstraint}});var ule=ty();Object.defineProperty(Be,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return ule.getServiceIdentifierAsString}});var dle=qL();Object.defineProperty(Be,"multiBindToService",{enumerable:!0,get:function(){return dle.multiBindToService}})});var D7=re(Dp=>{"use strict";p();Object.defineProperty(Dp,"__esModule",{value:!0});Dp.PythonExtension=Dp.PVSC_EXTENSION_ID=void 0;var fle=require("vscode");Dp.PVSC_EXTENSION_ID="ms-python.python";var mle;(function(r){async function e(){let t=fle.extensions.getExtension(Dp.PVSC_EXTENSION_ID);if(t===void 0)throw new Error("Python extension is not installed or is disabled");return t.isActive||await t.activate(),t.exports}r.api=e})(mle=Dp.PythonExtension||(Dp.PythonExtension={}))});var dK=re((ANe,F7)=>{p();function yle(r){var e=/(%?)(%([jds]))/g,t=Array.prototype.slice.call(arguments,1);return t.length&&(r=r.replace(e,function(n,i,o,s){var a=t.shift();switch(s){case"s":a=""+a;break;case"d":a=Number(a);break;case"j":a=JSON.stringify(a);break}return i?(t.unshift(a),n):a})),t.length&&(r+=" "+t.join(" ")),r=r.replace(/%{2,2}/g,"%"),""+r}F7.exports=yle});var a8=re((c1e,hK)=>{"use strict";p();var gy=typeof Reflect=="object"?Reflect:null,Q7=gy&&typeof gy.apply=="function"?gy.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},_T;gy&&typeof gy.ownKeys=="function"?_T=gy.ownKeys:Object.getOwnPropertySymbols?_T=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:_T=function(e){return Object.getOwnPropertyNames(e)};function Nle(r){console&&console.warn&&console.warn(r)}var Z7=Number.isNaN||function(e){return e!==e};function Dr(){Dr.init.call(this)}hK.exports=Dr;hK.exports.once=Ole;Dr.EventEmitter=Dr;Dr.prototype._events=void 0;Dr.prototype._eventsCount=0;Dr.prototype._maxListeners=void 0;var X7=10;function ET(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Dr,"defaultMaxListeners",{enumerable:!0,get:function(){return X7},set:function(r){if(typeof r!="number"||r<0||Z7(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");X7=r}});Dr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Dr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Z7(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function e8(r){return r._maxListeners===void 0?Dr.defaultMaxListeners:r._maxListeners}Dr.prototype.getMaxListeners=function(){return e8(this)};Dr.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")Q7(l,this,t);else for(var u=l.length,c=o8(l,u),n=0;n<u;++n)Q7(c[n],this,t);return!0};function t8(r,e,t,n){var i,o,s;if(ET(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=e8(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=s.length,Nle(a)}return r}Dr.prototype.addListener=function(e,t){return t8(this,e,t,!1)};Dr.prototype.on=Dr.prototype.addListener;Dr.prototype.prependListener=function(e,t){return t8(this,e,t,!0)};function Rle(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r8(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Rle.bind(n);return i.listener=t,n.wrapFn=i,i}Dr.prototype.once=function(e,t){return ET(t),this.on(e,r8(this,e,t)),this};Dr.prototype.prependOnceListener=function(e,t){return ET(t),this.prependListener(e,r8(this,e,t)),this};Dr.prototype.removeListener=function(e,t){var n,i,o,s,a;if(ET(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():Ale(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Dr.prototype.off=Dr.prototype.removeListener;Dr.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function n8(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Mle(i):o8(i,i.length)}Dr.prototype.listeners=function(e){return n8(this,e,!0)};Dr.prototype.rawListeners=function(e){return n8(this,e,!1)};Dr.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):i8.call(r,e)};Dr.prototype.listenerCount=i8;function i8(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Dr.prototype.eventNames=function(){return this._eventsCount>0?_T(this._events):[]};function o8(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Ale(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Mle(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Ole(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}s8(r,e,o,{once:!0}),e!=="error"&&Lle(r,i,{once:!0})})}function Lle(r,e,t){typeof r.on=="function"&&s8(r,"error",e,t)}function s8(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var u8=re((yy,c8)=>{"use strict";p();var Kle=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof ju!="undefined")return ju;throw new Error("unable to locate global object")},ju=Kle();c8.exports=yy=ju.fetch;ju.fetch&&(yy.default=ju.fetch.bind(ju));yy.Headers=ju.Headers;yy.Request=ju.Request;yy.Response=ju.Response});var d8=re(lC=>{p();lC.get=function(r){var e=Error.stackTraceLimit;Error.stackTraceLimit=1/0;var t={},n=Error.prepareStackTrace;Error.prepareStackTrace=function(o,s){return s},Error.captureStackTrace(t,r||lC.get);var i=t.stack;return Error.prepareStackTrace=n,Error.stackTraceLimit=e,i};lC.parse=function(r){if(!r.stack)return[];var e=this,t=r.stack.split(`
`).slice(1);return t.map(function(n){if(n.match(/^\s*[-]{4,}$/))return e._createParsedCallSite({fileName:n,lineNumber:null,functionName:null,typeName:null,methodName:null,columnNumber:null,native:null});var i=n.match(/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);if(i){var o=null,s=null,a=null,l=null,u=null,c=i[5]==="native";if(i[1]){a=i[1];var d=a.lastIndexOf(".");if(a[d-1]=="."&&d--,d>0){o=a.substr(0,d),s=a.substr(d+1);var f=o.indexOf(".Module");f>0&&(a=a.substr(f+1),o=o.substr(0,f))}l=null}s&&(l=o,u=s),s==="<anonymous>"&&(u=null,a=null);var m={fileName:i[2]||null,lineNumber:parseInt(i[3],10)||null,functionName:a,typeName:l,methodName:u,columnNumber:parseInt(i[4],10)||null,native:c};return e._createParsedCallSite(m)}}).filter(function(n){return!!n})};function aC(r){for(var e in r)this[e]=r[e]}var Fle=["this","typeName","functionName","methodName","fileName","lineNumber","columnNumber","function","evalOrigin"],Ule=["topLevel","eval","native","constructor"];Fle.forEach(function(r){aC.prototype[r]=null,aC.prototype["get"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});Ule.forEach(function(r){aC.prototype[r]=!1,aC.prototype["is"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});lC._createParsedCallSite=function(r){return new aC(r)}});var Xr,dt,$t,Mt,uC,Er,ra,qa,wT,yo,nr,xT=ge(()=>{p();Xr="function",dt="object",$t="undefined",Mt="prototype",uC="hasOwnProperty",Er=Object,ra=Er[Mt],qa=Er.assign,wT=Er.create,yo=Er.defineProperty,nr=ra[uC]});function Kn(r){r===void 0&&(r=!0);var e=r===!1?null:b8;return e||(typeof globalThis!==$t&&(e=globalThis),!e&&typeof self!==$t&&(e=self),!e&&typeof window!==$t&&(e=window),!e&&typeof this!==$t&&(e=this),b8=e),e}function na(r){throw new TypeError(r)}function bo(r){var e=wT;if(e)return e(r);if(r==null)return{};var t=typeof r;t!==dt&&t!==Xr&&na("Object prototype may only be an Object:"+r);function n(){}return n[Mt]=r,new n}var b8,IK=ge(()=>{p();xT();b8=null});function yn(r,e){typeof e!==Xr&&e!==null&&na("Class extends value "+String(e)+" is not a constructor or null"),SK(r,e);function t(){this.constructor=r}r[Mt]=e===null?bo(e):(t[Mt]=e[Mt],new t)}function Hm(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r}var cRe,uRe,Yle,Io,SK,I8=ge(()=>{p();xT();IK();cRe=(Kn()||{}).Symbol,uRe=(Kn()||{}).Reflect,Yle=function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)ra[uC].call(e,i)&&(r[i]=e[i])}return r},Io=qa||Yle,SK=function(r,e){return SK=Er.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n[uC](i)&&(t[i]=n[i])},SK(r,e)}});var S8=ge(()=>{p()});var ir=ge(()=>{p();xT();IK();I8();S8()});var _K,_8=ge(()=>{"use strict";p();_K=100});var Ja,Pi,dC,Ga,Ot,Es,Cc,PT,jo,rt,qm,Ur,DT,Jm,Gm,EK,pC,Ym,Sy,fC,Bu,Cs,_y,Op,Ya,Ey,$m,ws,ia,Lp,Hu,TT,Kp,$a,Cy,Fp,mC,Up,kT,wy,za,CK,wK,NT,Fn,Bo,hC,zm,gC,Qm,Qa,RT,Xm,xy,Wp,vC,Cn=ge(()=>{p();Ja="initialize",Pi="name",dC="getNotifyMgr",Ga="identifier",Ot="push",Es="isInitialized",Cc="config",PT="instrumentationKey",jo="logger",rt="length",qm="time",Ur="processNext",DT="getProcessTelContext",Jm="addNotificationListener",Gm="removeNotificationListener",EK="stopPollingInternalLogs",pC="onComplete",Ym="getPlugin",Sy="flush",fC="_extensions",Bu="splice",Cs="teardown",_y="messageId",Op="message",Ya="isAsync",Ey="_doTeardown",$m="update",ws="getNext",ia="diagLog",Lp="setNextPlugin",Hu="createNew",TT="cookieCfg",Kp="indexOf",$a="substring",Cy="userAgent",Fp="split",mC="setEnabled",Up="substr",kT="nodeType",wy="apply",za="replace",CK="enableDebugExceptions",wK="logInternalMessage",NT="toLowerCase",Fn="call",Bo="type",hC="handler",zm="listeners",gC="isChildEvt",Qm="getCtx",Qa="setCtx",RT="complete",Xm="traceId",xy="spanId",Wp="traceFlags",vC="version"});var pt,xK,an,PK,yC,Py,E8,Ho,oa,Dy,Vp,Ty,jp,AT,bC,Zm,hi=ge(()=>{p();pt="",xK="channels",an="core",PK="createPerfMgr",yC="disabled",Py="extensionConfig",E8="extensions",Ho="processTelemetry",oa="priority",Dy="eventsSent",Vp="eventsDiscarded",Ty="eventsSendRequest",jp="perfEvent",AT="errorToConsole",bC="warnToConsole",Zm="getPerfMgr"});function ace(r){if(r){if(OT)return OT(r);var e=r[$le]||r[Mt]||r[MT];if(e)return e}return null}function ky(r,e){return typeof r===e}function cr(r){return r===void 0||typeof r===$t}function Ct(r){return r===null||cr(r)}function AK(r){return!Ct(r)}function qu(r,e){return!!(r&&nr[Fn](r,e))}function Di(r){return!!(r&&typeof r===dt)}function qt(r){return!!(r&&typeof r===Xr)}function eh(r){var e=r;return e&&ln(e)&&(e=e[za](ice,function(t,n){return n.toUpperCase()}),e=e[za](oce,"_"),e=e[za](sce,function(t,n){return"_"+n})),e}function Wr(r,e){if(r)for(var t in r)nr[Fn](r,t)&&e[Fn](r,t,r[t])}function th(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=Xle?r[R8](e):lce(r,e)),t}function lce(r,e){var t=!1,n=e?e[rt]:0,i=r?r[rt]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Ny(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=Zle?r[A8](e):cce(r,e)),t}function cce(r,e){var t=!1,n=e?e[rt]:0;if(r&&n&&r[rt]>=n&&!(t=r===e)){for(var i=0;i<n;i++)if(r[i]!==e[i])return!1;t=!0}return t}function wn(r,e){return r&&e?r[Kp](e)!==-1:!1}function Ry(r){return!!(r&&RK[Fn](r)==="[object Date]")}function uce(r){return!!(r&&RK[Fn](r)==="[object Array]")}function rh(r){return!!(r&&RK[Fn](r)==="[object Error]")}function ln(r){return typeof r=="string"}function qo(r){return typeof r=="number"}function Ju(r){return typeof r=="boolean"}function T8(r){var e=!1;if(r&&typeof r=="object"){var t=OT?OT(r):ace(r);t?(t[MT]&&nr[Fn](t,MT)&&(t=t[MT]),e=typeof t===Xr&&O8[Fn](t)===nce):e=!0}return e}function sa(r){if(r)return tce?r[N8]():dce(r)}function dce(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[rt]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function We(r,e,t){var n=r[rt];try{for(var i=0;i<n&&!(i in r&&e[Fn](t||r,r[i],i,r)===-1);i++);}catch(o){}}function zn(r,e,t){if(r){if(r[C8])return r[C8](e,t);var n=r[rt],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function nh(r,e,t){var n;if(r){if(r[w8])return r[w8](e,t);var i=r[rt],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[Fn](o,r[s],r))}catch(a){}}return n}function ih(r,e,t){var n;if(r){if(r[x8])return r[x8](e,t);var i=r[rt],o=0;if(arguments[rt]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function Vr(r){return r&&(r=Qle&&r[TK]?r[TK]():r[za]?r[za](/^\s+|(?=\s)\s+$/g,pt):r),r}function So(r){var e=typeof r;if(e!==Xr&&(e!==dt||r===null)&&na("objKeys called on non-object"),!k8&&D8)return D8(r);var t=[];for(var n in r)r&&nr[Fn](r,n)&&t[Ot](n);if(k8)for(var i=DK[rt],o=0;o<i;o++)r&&nr[Fn](r,DK[o])&&t[Ot](DK[o]);return t}function xs(r,e,t,n){if(P8)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),P8(r,e,i),!0}catch(o){}return!1}function L8(r){return r}function MK(r){return kK&&Wr(r,function(e,t){(bt(t)||Di(t))&&kK(t)}),Jo(r)}function Qn(){var r=Date;return r.now?r.now():new r().getTime()}function oh(r){return rh(r)?r[Pi]:pt}function Go(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Bp(r,e,t){var n;return r?(n=r[e],!n&&Ct(n)&&(n=cr(t)?{}:t,r[e]=n)):n=cr(t)?{}:t,n}function aa(r,e){return Ct(r)?e:r}function LK(r){return!r}function Ay(r){return!!r}function Xn(r){throw new Error(r)}function K8(r,e){var t=null,n=null;return qt(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][wy](n,i)}}function KK(r,e,t){if(r&&e&&Di(r)&&Di(e)){var n=function(o){if(ln(o)){var s=e[o];qt(s)?(!t||t(o,!0,e,r))&&(r[o]=K8(e,o)):(!t||t(o,!1,e,r))&&(qu(r,o)&&delete r[o],xs(r,o,function(){return e[o]},function(a){e[o]=a})||(r[o]=s))}};for(var i in e)n(i)}return r}function Hp(r,e,t,n,i){r&&e&&t&&(i!==!1||cr(r[e]))&&(r[e]=K8(t,n))}function sh(r,e,t,n){return r&&e&&Di(r)&&bt(t)&&We(t,function(i){ln(i)&&Hp(r,i,e,i,n)}),r}function Gu(r){return r&&qa&&(r=Er(qa({},r))),r}function My(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[rt],u=!1,c=1;for(l>0&&Ju(a)&&(u=a,a=s[c]||{},c++),Di(a)||(a={});c<l;c++){var d=s[c],f=bt(d),m=Di(d);for(var g in d){var b=f&&g in d||m&&nr[Fn](d,g);if(b){var v=d[g],k=void 0;if(u&&v&&((k=bt(v))||T8(v))){var R=a[g];k?bt(R)||(R=[]):T8(R)||(R={}),v=My(u,R,v)}v!==void 0&&(a[g]=v)}}}return a}var N8,R8,A8,C8,w8,x8,TK,M8,$le,MT,P8,kK,zle,D8,NK,Qle,Xle,Zle,ece,tce,rce,RK,O8,nce,ice,oce,sce,OT,bt,k8,DK,Jo,OK,xn=ge(()=>{p();ir();Cn();hi();N8="toISOString",R8="endsWith",A8="startsWith",C8="indexOf",w8="map",x8="reduce",TK="trim",M8="toString",$le="__proto__",MT="constructor",P8=yo,kK=Er.freeze,zle=Er.seal,D8=Er.keys,NK=String[Mt],Qle=NK[TK],Xle=NK[R8],Zle=NK[A8],ece=Date[Mt],tce=ece[N8],rce=Array.isArray,RK=ra[M8],O8=nr[M8],nce=O8[Fn](Er),ice=/-([a-z])/g,oce=/([^\w\d_$])/g,sce=/^(\d+[\w\d_$])/,OT=Object.getPrototypeOf;bt=rce||uce;k8=!{toString:null}.propertyIsEnumerable("toString"),DK=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Jo=kK||L8,OK=zle||L8});function _o(r){var e={};return Wr(r,function(t,n){e[t]=n,e[n]=t}),MK(e)}var LT=ge(()=>{p();xn()});var Xa,F8=ge(()=>{p();LT();Xa=_o({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5})});function fce(){var r;return typeof globalThis!==FT&&(r=globalThis),!r&&typeof self!==FT&&(r=self),!r&&typeof window!==FT&&(r=window),!r&&typeof this!==FT&&(r=this),r||{}}function $u(r,e){return r&&JT[Yu].hasOwnProperty.call(r,e)}function q8(r){return r&&(r===JT[Yu]||r===Array[Yu])}function HK(r){return q8(r)||r===Function[Yu]}function ah(r){var e;if(r){if(SC)return SC(r);var t=r[H8]||r[Yu]||(r[VT]?r[VT][Yu]:null);e=r[UT]||t,$u(r,UT)||(delete r[FK],e=r[UT]=r[FK]||r[UT],r[FK]=t)}return e}function HT(r,e){var t=[];if(V8)t=V8(r);else for(var n in r)typeof n=="string"&&$u(r,n)&&t.push(n);if(t&&t.length>0)for(var i=0;i<t.length;i++)e(t[i])}function qK(r,e,t){return e!==VT&&typeof r[e]===jT&&(t||$u(r,e))}function qT(r){throw new TypeError("DynamicProto: "+r)}function mce(r){var e={};return HT(r,function(t){!e[t]&&qK(r,t,!1)&&(e[t]=r[t])}),e}function JK(r,e){for(var t=r.length-1;t>=0;t--)if(r[t]===e)return!0;return!1}function hce(r,e,t,n){function i(l,u,c){var d=u[c];if(d[WK]&&n){var f=l[BT]||{};f[IC]!==!1&&(d=(f[u[Oy]]||{})[c]||d)}return function(){return d.apply(l,arguments)}}var o={};HT(t,function(l){o[l]=i(e,t,l)});for(var s=ah(r),a=[];s&&!HK(s)&&!JK(a,s);)HT(s,function(l){!o[l]&&qK(s,l,!SC)&&(o[l]=i(e,s,l))}),a.push(s),s=ah(s);return o}function gce(r,e,t,n){var i=null;if(r&&$u(t,Oy)){var o=r[BT]||{};if(i=(o[t[Oy]]||{})[e],i||qT("Missing ["+e+"] "+jT),!i[VK]&&o[IC]!==!1){for(var s=!$u(r,e),a=ah(r),l=[];s&&a&&!HK(a)&&!JK(l,a);){var u=a[e];if(u){s=u===n;break}l.push(a),a=ah(a)}try{s&&(r[e]=i),i[VK]=1}catch(c){o[IC]=!1}}}return i}function vce(r,e,t){var n=e[r];return n===t&&(n=ah(e)[r]),typeof n!==jT&&qT("["+r+"] is not a "+jT),n}function yce(r,e,t,n,i){function o(l,u){var c=function(){var d=gce(this,u,l,c)||vce(u,l,c);return d.apply(this,arguments)};return c[WK]=1,c}if(!q8(r)){var s=t[BT]=t[BT]||{},a=s[e]=s[e]||{};s[IC]!==!1&&(s[IC]=!!i),HT(t,function(l){qK(t,l,!1)&&t[l]!==n[l]&&(a[l]=t[l],delete t[l],(!$u(r,l)||r[l]&&!r[l][WK])&&(r[l]=o(r,l)))})}}function bce(r,e){if(SC){for(var t=[],n=ah(e);n&&!HK(n)&&!JK(t,n);){if(n===r)return!0;t.push(n),n=ah(n)}return!1}return!0}function UK(r,e){return $u(r,Yu)?r.name||e||U8:((r||{})[VT]||{}).name||e||U8}function He(r,e,t,n){$u(r,Yu)||qT("theClass is an invalid class definition.");var i=r[Yu];bce(i,e)||qT("["+UK(r)+"] not in hierarchy of ["+UK(e)+"]");var o=null;$u(i,Oy)?o=i[Oy]:(o=pce+UK(r,"_")+"$"+BK.n,BK.n++,i[Oy]=o);var s=He[B8],a=!!s[WT];a&&n&&n[WT]!==void 0&&(a=!!n[WT]);var l=mce(e),u=hce(i,e,l,a);t(e,u);var c=!!SC&&!!s[jK];c&&n&&(c=!!n[jK]),yce(i,o,e,l,c!==!1)}var KT,FT,VT,Yu,jT,BT,WK,Oy,pce,VK,IC,B8,U8,H8,UT,W8,FK,WT,jK,JT,SC,V8,j8,BK,ur=ge(()=>{p();FT="undefined",VT="constructor",Yu="prototype",jT="function",BT="_dynInstFuncs",WK="_isDynProxy",Oy="_dynClass",pce="_dynCls$",VK="_dynInstChk",IC=VK,B8="_dfOpts",U8="_unknown_",H8="__proto__",UT="_dyn"+H8,W8="__dynProto$Gbl",FK="_dynInstProto",WT="useBaseInst",jK="setInstFuncs",JT=Object,SC=JT.getPrototypeOf,V8=JT.getOwnPropertyNames;j8=fce(),BK=j8[W8]||(j8[W8]={o:(KT={},KT[jK]=!0,KT[WT]=!0,KT),n:1e3});He[B8]=BK.o});function z8(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Mt];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!cr(i[e])}catch(o){}}return t}function XK(r){$8=r}function cn(r){var e=Kn();return e&&e[r]?e[r]:r===J8&&_C()?window:null}function _C(){return!!(typeof window===dt&&window)}function wc(){return _C()?window:cn(J8)}function GT(){return!!(typeof document===dt&&document)}function Yo(){return GT()?document:cn(Ice)}function EC(){return!!(typeof navigator===dt&&navigator)}function Ps(){return EC()?navigator:cn(_ce)}function YT(){return!!(typeof history===dt&&history)}function ZK(){return YT()?history:cn(Ece)}function lh(r){if(r&&$8){var e=cn("__mockLocation");if(e)return e}return typeof location===dt&&location?location:cn(Cce)}function CC(){return typeof console!==$t?console:cn(wce)}function Ky(){return cn(xce)}function ch(){return!!(typeof JSON===dt&&JSON||cn(G8)!==null)}function Fy(){return ch()?JSON||cn(G8):null}function wC(){return cn(Pce)}function xC(){return cn(Dce)}function zu(){var r=Ps();return r&&r.product?r.product===Tce:!1}function Za(){var r=Ps();if(r&&(r[Cy]!==YK||GK===null)){YK=r[Cy];var e=(YK||pt)[NT]();GK=wn(e,zK)||wn(e,QK)}return GK}function eF(r){if(r===void 0&&(r=null),!r){var e=Ps()||{};r=e?(e[Cy]||pt)[NT]():pt}var t=(r||pt)[NT]();if(wn(t,zK)){var n=Yo()||{};return Math.max(parseInt(t[Fp](zK)[1]),n[Sce]||0)}else if(wn(t,QK)){var i=parseInt(t[Fp](QK)[1]);if(i)return i+4}return null}function Zr(r){var e=Object[Mt].toString[Fn](r),t=pt;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Pi]+"'":ch()&&(t=Fy().stringify(r)),e+t}function qp(){return $K===null&&($K=EC()&&!!Ps().sendBeacon),$K}function Uy(r){var e=!1;try{e=!!cn("fetch");var t=cn("Request");e&&r&&t&&(e=z8(t,"keepalive"))}catch(n){}return e}function uh(){return Ly===null&&(Ly=typeof XDomainRequest!==$t,Ly&&Wy()&&(Ly=Ly&&!z8(cn(Y8),"withCredentials"))),Ly}function Wy(){var r=!1;try{var e=cn(Y8);r=!!e}catch(t){}return r}function Q8(r,e){if(r)for(var t=0;t<r[rt];t++){var n=r[t];if(n[Pi]&&n[Pi]===e)return n}return{}}function tF(r){var e=Yo();return e&&r?Q8(e.querySelectorAll("meta"),r).content:null}function rF(r){var e,t=Ky();if(t){var n=t.getEntriesByType("navigation")||[];e=Q8((n[rt]>0?n[0]:{}).serverTiming,r).description}return e}var J8,Ice,Sce,_ce,Ece,Cce,wce,xce,G8,Pce,Dce,Tce,zK,QK,Y8,GK,YK,$8,Ly,$K,la=ge(()=>{"use strict";p();ir();Cn();xn();hi();J8="window",Ice="document",Sce="documentMode",_ce="navigator",Ece="history",Cce="location",wce="console",xce="performance",G8="JSON",Pce="crypto",Dce="msCrypto",Tce="ReactNative",zK="msie",QK="trident/",Y8="XMLHttpRequest",GK=null,YK=null,$8=!1,Ly=null,$K=null});function kce(r,e){return function(){var t=arguments,n=iF(e);if(n){var i=n.listener;i&&i[r]&&i[r][wy](i,t)}}}function Nce(){var r=cn("Microsoft");return r&&(zT=r.ApplicationInsights),zT}function iF(r){var e=zT;return!e&&r.disableDbgExt!==!0&&(e=zT||Nce()),e?e.ChromeDbgExt:null}function X8(r){if(!$T){$T={};for(var e=0;e<nF[rt];e++)$T[nF[e]]=kce(nF[e],r)}return $T}var nF,zT,$T,oF=ge(()=>{p();Cn();la();nF=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],zT=null});function Z8(r){return r?'"'+r[za](/\"/g,pt)+'"':pt}function e6(r,e){var t=CC();if(t){var n="log";t[r]&&(n=r),qt(t[n])&&t[n](e)}}function PC(r,e){return(r||{})[jo]||new el(e)}function sF(r){return r||new el}function Gr(r,e,t,n,i,o){o===void 0&&(o=!1),sF(r).throwInternal(e,t,n,i,o)}function tl(r,e){sF(r)[bC](e)}function aF(r,e,t){sF(r)[wK](e,t)}var Rce,Ace,Mce,dh,el,Jp=ge(()=>{"use strict";p();ur();Cn();oF();la();xn();hi();Rce="AI (Internal): ",Ace="AI: ",Mce="AITR_";dh=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[_y]=e,o[Op]=(n?Ace:Rce)+e;var s=pt;ch()&&(s=Fy().stringify(i));var a=(t?" message:"+Z8(t):pt)+(i?" props:"+Z8(s):pt);o[Op]+=a}return r.dataType="MessageData",r}();el=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[CK]=function(){return a},l.throwInternal=function(m,g,b,v,k){k===void 0&&(k=!1);var R=new dh(g,b,k,v);if(a)throw Zr(R);var P=m===1?AT:bC;if(cr(R[Op]))f("throw"+(m===1?"Critical":"Warning"),R);else{if(k){var D=+R[_y];!n[D]&&i>=m&&(l[P](R[Op]),n[D]=!0)}else i>=m&&l[P](R[Op]);u(m,R)}},l[bC]=function(m){e6("warn",m),f("warning",m)},l[AT]=function(m){e6("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[wK]=u;function u(m,g){if(!d()){var b=!0,v=Mce+g[_y];if(n[v]?b=!1:n[v]=!0,b&&(m<=o&&(l.queue[Ot](g),t++,f(m===1?"error":"warn",g)),t===s)){var k="Internal events throttle limit per PageView reached for this app.",R=new dh(23,k,!1);l.queue[Ot](R),m===1?l[AT](k):l[bC](k)}}}function c(m){i=aa(m.loggingLevelConsole,0),o=aa(m.loggingLevelTelemetry,1),s=aa(m.maxMessageLimit,25),a=aa(m[CK],!1)}function d(){return t>=s}function f(m,g){var b=iF(e||{});b&&b[ia]&&b[ia](m,g)}})}return r.__ieDyn=1,r}()});function bn(r,e,t,n,i){if(r){var o=r;if(o[Zm]&&(o=o[Zm]()),o){var s=void 0,a=o[Qm](lF);try{if(s=o.create(e(),n,i),s){if(a&&s[Qa]&&(s[Qa](ph[cF],a),a[Qm]&&a[Qa])){var l=a[Qm](ph[DC]);l||(l=[],a[Qa](ph[DC],l)),l[Ot](s)}return o[Qa](lF,s),t(s)}}catch(u){s&&s[Qa]&&s[Qa]("exception",u)}finally{s&&o.fire(s),o[Qa](lF,a)}}}return t()}function uF(){return Oce}var Vy,cF,DC,Oce,ph,TC,lF,kC=ge(()=>{p();ur();Cn();xn();hi();Vy="ctx",cF="ParentContextKey",DC="ChildrenContextKey",Oce=null,ph=function(){function r(e,t,n){var i=this,o=!1;if(i.start=Qn(),i[Pi]=e,i[Ya]=n,i[gC]=function(){return!1},qt(t)){var s;o=xs(i,"payload",function(){return!s&&qt(t)&&(s=t(),t=null),s})}i[Qm]=function(a){return a?a===r[cF]||a===r[DC]?i[a]:(i[Vy]||{})[a]:null},i[Qa]=function(a,l){if(a)if(a===r[cF])i[a]||(i[gC]=function(){return!0}),i[a]=l;else if(a===r[DC])i[a]=l;else{var u=i[Vy]=i[Vy]||{};u[a]=l}},i[RT]=function(){var a=0,l=i[Qm](r[DC]);if(bt(l))for(var u=0;u<l[rt];u++){var c=l[u];c&&(a+=c[qm])}i[qm]=Qn()-i.start,i.exTime=i[qm]-a,i[RT]=function(){},!o&&qt(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),TC=function(){function r(e){this.ctx={},He(r,this,function(t){t.create=function(n,i,o){return new ph(n,i,o)},t.fire=function(n){n&&(n[RT](),e&&qt(e[jp])&&e[jp](n))},t[Qa]=function(n,i){if(n){var o=t[Vy]=t[Vy]||{};o[n]=i}},t[Qm]=function(n){return(t[Vy]||{})[n]}})}return r.__ieDyn=1,r}(),lF="CoreUtils.doPerf"});function n6(r){r<0&&(r>>>=0),NC=123456789+r&Gp,RC=987654321-r&Gp,r6=!0}function i6(){try{var r=Qn()&2147483647;n6((Math.random()*t6^r)+r)}catch(e){}}function jy(r){return r>0?Math.floor(rl()/Gp*(r+1))>>>0:0}function rl(r){var e=0,t=wC()||xC();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&Gp),e===0&&Za()&&(r6||i6(),e=AC()&Gp),e===0&&(e=Math.floor(t6*Math.random()|0)),r||(e>>>=0),e}function QT(r){r?n6(r):i6()}function AC(r){RC=36969*(RC&65535)+(RC>>16)&Gp,NC=18e3*(NC&65535)+(NC>>16)&Gp;var e=(RC<<16)+(NC&65535)>>>0&Gp|0;return r||(e>>>=0),e}function Yp(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=rl()>>>0,n=0,i=pt;i[rt]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(rl()<<2&4294967295|t&3)>>>0,n=0);return i}var t6,Gp,r6,NC,RC,XT=ge(()=>{p();Cn();la();xn();hi();t6=4294967296,Gp=4294967295,r6=!1,NC=123456789,RC=987654321});function Fce(r,e,t){if(o6)try{return o6(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function a6(r){return r[kT]===1||r[kT]===9||!+r[kT]}function Uce(r,e){var t=e[r.id];if(!t){t={};try{a6(e)&&(Fce(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function nl(r,e){return e===void 0&&(e=!1),eh(r+Kce+++(e?"."+s6:pt)+Lce)}function ZT(r){var e={id:nl("_aiData-"+(r||pt)+"."+s6),accept:function(t){return a6(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[eh(n)]:(o&&(s=Uce(e,t),s[eh(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var o6,s6,Lce,Kce,MC=ge(()=>{p();ir();Cn();xn();hi();XT();o6=yo,s6="2.8.10",Lce="."+Yp(6),Kce=0});function Wce(r,e){var t=Qu[$p]||rk[$p];return t||(t=Qu[$p]=Qu(r,e),rk[$p]=t),t}function tk(r){return r?r.isEnabled():!0}function Vce(r){var e=r[TT]=r[TT]||{};if(Go(e,"domain",r.cookieDomain,AK,Ct),Go(e,"path",r.cookiePath||"/",null,Ct),Ct(e[fF])){var t=void 0;cr(r[u6])||(t=!r[u6]),cr(r[d6])||(t=!r[d6]),e[fF]=t}return e}function v6(r,e){return e&&r&&bt(r.ignoreCookies)?r.ignoreCookies[Kp](e)!==-1:!1}function jce(r,e){return e&&r&&bt(r.blockedCookies)&&r.blockedCookies[Kp](e)!==-1?!0:v6(r,e)}function zp(r,e){var t;if(r)t=r.getCookieMgr();else if(e){var n=e[TT];n[$p]?t=n[$p]:t=Qu(e)}return t||(t=Wce(e,(r||{})[jo])),t}function Qu(r,e){var t,n=Vce(r||rk),i=n.path||"/",o=n.domain,s=n[fF]!==!1,a=(t={isEnabled:function(){var l=s&&il(e),u=rk[$p];return l&&u&&a!==u&&(l=tk(u)),l}},t[mC]=function(l){s=l!==!1},t.set=function(l,u,c,d,f){var m=!1;if(tk(a)&&!jce(n,l)){var g={},b=Vr(u||pt),v=b[Kp](";");if(v!==-1&&(b=Vr(u[$a](0,v)),g=y6(u[$a](v+1))),Go(g,"domain",d||o,Ay,cr),!Ct(c)){var k=Za();if(cr(g[dF])){var R=Qn(),P=R+c*1e3;if(P>0){var D=new Date;D.setTime(P),Go(g,dF,m6(D,k?l6:c6)||m6(D,k?l6:c6)||pt,Ay)}}k||Go(g,"max-age",pt+c,null,cr)}var K=lh();K&&K.protocol==="https:"&&(Go(g,"secure",null,null,cr),pF===null&&(pF=!By((Ps()||{})[Cy])),pF&&Go(g,"SameSite","None",null,cr)),Go(g,"path",f||i,null,cr);var L=n.setCookie||g6;L(l,h6(b,g)),m=!0}return m},t.get=function(l){var u=pt;return tk(a)&&!v6(n,l)&&(u=(n.getCookie||Bce)(l)),u},t.del=function(l,u){var c=!1;return tk(a)&&(c=a.purge(l,u)),c},t.purge=function(l,u){var c,d=!1;if(il(e)){var f=(c={},c.path=u||"/",c[dF]="Thu, 01 Jan 1970 00:00:01 GMT",c);Za()||(f["max-age"]="0");var m=n.delCookie||g6;m(l,h6(pt,f)),d=!0}return d},t);return a[$p]=a,a}function il(r){if(ek===null){ek=!1;try{var e=OC||{};ek=e[mF]!==void 0}catch(t){Gr(r,2,68,"Cannot access document.cookie - "+oh(t),{exception:Zr(t)})}}return ek}function y6(r){var e={};if(r&&r[rt]){var t=Vr(r)[Fp](";");We(t,function(n){if(n=Vr(n||pt),n){var i=n[Kp]("=");i===-1?e[n]=null:e[Vr(n[$a](0,i))]=Vr(n[$a](i+1))}})}return e}function m6(r,e){return qt(r[e])?r[e]():null}function h6(r,e){var t=r||pt;return Wr(e,function(n,i){t+="; "+n+(Ct(i)?pt:"="+i)}),t}function Bce(r){var e=pt;if(OC){var t=OC[mF]||pt;p6!==t&&(f6=y6(t),p6=t),e=Vr(f6[r]||pt)}return e}function g6(r,e){OC&&(OC[mF]=r+"="+e)}function By(r){return ln(r)?!!(wn(r,"CPU iPhone OS 12")||wn(r,"iPad; CPU OS 12")||wn(r,"Macintosh; Intel Mac OS X 10_14")&&wn(r,"Version/")&&wn(r,"Safari")||wn(r,"Macintosh; Intel Mac OS X 10_14")&&th(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||wn(r,"Chrome/5")||wn(r,"Chrome/6")||wn(r,"UnrealEngine")&&!wn(r,"Chrome")||wn(r,"UCBrowser/12")||wn(r,"UCBrowser/11")):!1}var l6,c6,mF,dF,fF,u6,d6,$p,ek,pF,p6,OC,f6,rk,hF=ge(()=>{p();Cn();Jp();la();xn();hi();l6="toGMTString",c6="toUTCString",mF="cookie",dF="expires",fF="enabled",u6="isCookieUseDisabled",d6="disableCookiesUsage",$p="_ckMgr",ek=null,pF=null,p6=null,OC=Yo(),f6={},rk={}});function E6(r){return r&&r[za]?r[za](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,pt):r}function ok(r,e){var t;if(e){var n=pt;bt(e)?(n=pt,We(e,function(o){o=E6(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=E6(e),n&&(n[0]!=="."&&(n="."+n),r=(r||pt)+n)}var i=Gce.exec(r||pt)||[];return t={},t[Bo]=i[1],t.ns=(i[2]||pt).replace(Hce,".").replace(qce,pt)[Fp](".").sort().join("."),t}function gF(r,e,t){var n=[],i=KC.get(r,nk,{},!1),o=ok(e,t);return Wr(i,function(s,a){We(a,function(l){var u;(!o[Bo]||o[Bo]===l.evtName[Bo])&&(!o.ns||o.ns===o.ns)&&n[Ot]((u={},u[Pi]=l.evtName[Bo]+(l.evtName.ns?"."+l.evtName.ns:pt),u.handler=l[hC],u))})}),n}function N6(r,e,t){t===void 0&&(t=!0);var n=KC.get(r,nk,{},t),i=n[e];return i||(i=n[e]=[]),i}function R6(r,e,t,n){r&&e&&e[Bo]&&(r[_6]?r[_6](e[Bo],t,n):r[S6]&&r[S6](w6+e[Bo],t))}function Yce(r,e,t,n){var i=!1;return r&&e&&e[Bo]&&t&&(r[I6]?(r[I6](e[Bo],t,n),i=!0):r[b6]&&(r[b6](w6+e[Bo],t),i=!0)),i}function C6(r,e,t,n){for(var i=e[rt];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(R6(r,o.evtName,o[hC],o.capture),e[Bu](i,1))}}function $ce(r,e,t){if(e[Bo])C6(r,N6(r,e[Bo]),e,t);else{var n=KC.get(r,nk,{});Wr(n,function(i,o){C6(r,o,e,t)}),So(n)[rt]===0&&KC.kill(r,nk)}}function Xu(r,e){var t;return e?(bt(e)?t=[r].concat(e):t=[r,e],t=ok("xx",t).ns[Fp](".")):t=r,t}function fh(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=ok(e,n);if(s=Yce(r,a,t,i),s&&KC.accept(r)){var l=(o={guid:Jce++,evtName:a},o[hC]=t,o.capture=i,o);N6(r,a.type)[Ot](l)}}catch(u){}return s}function mh(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=ok(e,n),s=!1;$ce(r,o,function(a){return o.ns&&!t||a[hC]===t?(s=!0,!0):!1}),s||R6(r,o,t,i)}catch(a){}}function qy(r,e,t,n){return n===void 0&&(n=!1),fh(r,e,t,null,n)}function Jy(r,e,t,n){n===void 0&&(n=!1),mh(r,e,t,null,n)}function Xp(r,e,t){var n=!1,i=wc();i&&(n=fh(i,r,e,t),n=fh(i.body,r,e,t)||n);var o=Yo();return o&&(n=fh(o,r,e,t)||n),n}function sk(r,e,t){var n=wc();n&&(mh(n,r,e,t),mh(n.body,r,e,t));var i=Yo();i&&mh(i,r,e,t)}function Hy(r,e,t,n){var i=!1;return e&&r&&r[rt]>0&&We(r,function(o){o&&(!t||zn(t,o)===-1)&&(i=Xp(o,e,n)||i)}),i}function ak(r,e,t,n){var i=!1;return e&&r&&bt(r)&&(i=Hy(r,e,t,n),!i&&t&&t[rt]>0&&(i=Hy(r,e,null,n))),i}function Qp(r,e,t){r&&bt(r)&&We(r,function(n){n&&sk(n,e,t)})}function hh(r,e,t){return ak([D6,P6,ik],r,e,t)}function FC(r,e){Qp([D6,P6,ik],r,e)}function Gy(r,e,t){function n(s){var a=Yo();r&&a&&a.visibilityState==="hidden"&&r(s)}var i=Xu(T6,t),o=Hy([ik],r,e,i);return(!e||zn(e,LC)===-1)&&(o=Hy([LC],n,e,i)||o),!o&&e&&(o=Gy(r,null,t)),o}function UC(r,e){var t=Xu(T6,e);Qp([ik],r,t),Qp([LC],null,t)}function Yy(r,e,t){function n(s){var a=Yo();r&&a&&a.visibilityState==="visible"&&r(s)}var i=Xu(k6,t),o=Hy([x6],r,e,i);return o=Hy([LC],n,e,i)||o,!o&&e&&(o=Yy(r,null,t)),o}function WC(r,e){var t=Xu(k6,e);Qp([x6],r,t),Qp([LC],null,t)}var w6,b6,I6,S6,_6,nk,LC,ik,x6,P6,D6,T6,k6,Hce,qce,Jce,KC,Gce,vF=ge(()=>{p();Cn();MC();la();xn();hi();w6="on",b6="attachEvent",I6="addEventListener",S6="detachEvent",_6="removeEventListener",nk="events",LC="visibilitychange",ik="pagehide",x6="pageshow",P6="unload",D6="beforeunload",T6=nl("aiEvtPageHide"),k6=nl("aiEvtPageShow"),Hce=/\.[\.]+/g,qce=/[\.]+$/,Jce=1,KC=ZT("events"),Gce=/^([^.]*)(?:\.(.+)|)/});function $y(){var r=Zu();return r[$a](0,8)+"-"+r[$a](8,12)+"-"+r[$a](12,16)+"-"+r[$a](16,20)+"-"+r[$a](20)}function zy(){var r=Ky();return r&&r.now?r.now():Qn()}function Zu(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=pt,t,n=0;n<4;n++)t=rl(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(rl()&3)|0];return e[Up](0,8)+e[Up](9,4)+"4"+e[Up](13,3)+i+e[Up](16,3)+e[Up](19,12)}var yF,bF=ge(()=>{"use strict";p();Cn();la();vF();xn();hi();XT();yF={Attach:qy,AttachEvent:qy,Detach:Jy,DetachEvent:Jy}});function ed(r,e,t){return r&&r[rt]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function M6(r,e,t){return ed(r,e)?r:t}function O6(r){(isNaN(r)||r<0||r>255)&&(r=1);for(var e=r.toString(16);e[rt]<2;)e="0"+e;return e}function _F(r,e,t,n){var i;return i={},i[vC]=ed(n,2,SF)?n:IF,i[Xm]=Qy(r)?r:Zu(),i.spanId=Xy(e)?e:Zu()[Up](0,16),i.traceFlags=t>=0&&t<=255?t:1,i}function VC(r){var e;if(!r||(bt(r)&&(r=r[0]||""),!r||!ln(r)||r[rt]>8192))return null;var t=zce.exec(Vr(r));return!t||t[1]===SF||t[2]===lk||t[3]===ck?null:(e={},e[vC]=t[1],e[Xm]=t[2],e[xy]=t[3],e[Wp]=parseInt(t[4],16),e)}function Qy(r){return ed(r,32,lk)}function Xy(r){return ed(r,16,ck)}function uk(r){return!(!r||!ed(r[vC],2,SF)||!ed(r[Xm],32,lk)||!ed(r[xy],16,ck)||!ed(O6(r[Wp]),2))}function EF(r){return uk(r)?(r[Wp]&A6)===A6:!1}function CF(r){if(r){var e=O6(r[Wp]);ed(e,2)||(e="01");var t=r[vC]||IF;return t!=="00"&&t!=="ff"&&(t=IF),"".concat(t,"-").concat(M6(r.traceId,32,lk),"-").concat(M6(r.spanId,16,ck),"-").concat(e)}return""}function wF(){var r="traceparent",e=VC(tF(r));return e||(e=VC(rF(r))),e}var zce,IF,SF,lk,ck,A6,xF=ge(()=>{p();Cn();bF();la();xn();zce=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]*)?$/,IF="00",SF="ff",lk="00000000000000000000000000000000",ck="0000000000000000",A6=1});function td(r){return Qce.get(r,"state",{},!0)}function dk(r,e){for(var t=[],n=null,i=r[ws](),o;i;){var s=i[Ym]();if(s){n&&qt(n[Lp])&&qt(s[Ho])&&n[Lp](s);var a=!1;qt(s[Es])?a=s[Es]():(o=td(s),a=o[Es]),a||t[Ot](s),n=s,i=i[ws]()}}We(t,function(l){var u=r[an]();l[Ja](r.getCfg(),u,e,r[ws]()),o=td(l),!l[an]&&!o[an]&&(o[an]=u),o[Es]=!0,delete o[Cs]})}function pk(r){return r.sort(function(e,t){var n=0;if(t){var i=qt(t[Ho]);qt(e[Ho])?n=i?e[oa]-t[oa]:1:i&&(n=-1)}else n=e?1:-1;return n})}function L6(r){var e={};return{getName:function(){return e[Pi]},setName:function(t){r&&r.setName(t),e[Pi]=t},getTraceId:function(){return e[Xm]},setTraceId:function(t){r&&r.setTraceId(t),Qy(t)&&(e[Xm]=t)},getSpanId:function(){return e[xy]},setSpanId:function(t){r&&r.setSpanId(t),Xy(t)&&(e[xy]=t)},getTraceFlags:function(){return e[Wp]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[Wp]=t}}}var Qce,fk=ge(()=>{"use strict";p();Cn();MC();xn();hi();xF();Qce=ZT("plugin")});function Zce(r,e,t){for(;r;){if(r[Ym]()===t)return r;r=r[ws]()}return xc([t],e[Cc]||{},e)}function PF(r,e,t,n){var i=null,o=[];n!==null&&(i=n?Zce(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return PC(t,e)},getCfg:function(){return e},getExtCfg:u,getConfig:c,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:d,onComplete:a}};function a(f,m){for(var g=[],b=2;b<arguments.length;b++)g[b-2]=arguments[b];f&&o[Ot]({func:f,self:cr(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[ws]():null,!f){var m=o;m&&m[rt]>0&&(We(m,function(g){try{g.func[Fn](g.self,g.args)}catch(b){Gr(t[jo],2,73,"Unexpected Exception during onComplete - "+Zr(b))}}),o=[])}return f}function u(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var b;if(e){var v=e[Py];v&&f&&(b=v[f])}if(!b)b=m;else if(Di(m)&&g!==0){var k=My(!0,m,b);e&&g===2&&Wr(m,function(R){if(Ct(k[R])){var P=e[R];Ct(P)||(k[R]=P)}}),b=k}return b}function c(f,m,g){g===void 0&&(g=!1);var b,v=u(f,null);return v&&!Ct(v[m])?b=v[m]:e&&!Ct(e[m])&&(b=e[m]),Ct(b)?g:b}function d(f){for(var m;m=s._next();){var g=m[Ym]();g&&f(g)}}return s}function $o(r,e,t,n){var i=PF(r,e,t,n),o=i.ctx;function s(l){var u=i._next();return u&&u[Ho](l,o),!u}function a(l,u){return l===void 0&&(l=null),bt(l)&&(l=xc(l,e,t,u)),$o(l||o[ws](),e,t,u)}return o[Ur]=s,o[Hu]=a,o}function Zy(r,e,t){var n=e[Cc]||{},i=PF(r,n,e,t),o=i.ctx;function s(l){var u=i._next();return u&&u.unload(o,l),!u}function a(l,u){return l===void 0&&(l=null),bt(l)&&(l=xc(l,n,e,u)),Zy(l||o[ws](),e,u)}return o[Ur]=s,o[Hu]=a,o}function jC(r,e,t){var n=e[Cc]||{},i=PF(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(u){qt(u[$m])&&u[$m](o,l)})}function a(l,u){return l===void 0&&(l=null),bt(l)&&(l=xc(l,n,e,u)),jC(l||o[ws](),e,u)}return o[Ur]=s,o[Hu]=a,o}function xc(r,e,t,n){var i=null,o=!n;if(bt(r)&&r[rt]>0){var s=null;We(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&qt(a[Ho])){var l=eue(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?xc([n],e,t):i}function eue(r,e,t){var n=null,i=qt(r[Ho]),o=qt(r[Lp]),s;r?s=r[Ga]+"-"+r[oa]+"-"+U6++:s="Unknown-0-"+U6++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:c,unload:d,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&qt(r[F6])&&(m=r[F6]()),m||(m=$o(a,e,t)),m}function u(m,g,b,v,k){var R=!1,P=r?r[Ga]:Xce,D=m[K6];return D||(D=m[K6]={}),m.setNext(n),r&&bn(m[an](),function(){return P+":"+b},function(){D[s]=!0;try{var K=n?n._id:pt;K&&(D[K]=!1),R=g(m)}catch(B){var L=n?D[n._id]:!0;L&&(R=!0),(!n||!L)&&Gr(m[ia](),1,73,"Plugin ["+P+"] failed during "+b+" - "+Zr(B)+", run flags: "+Zr(D))}},v,k),R}function c(m,g){g=g||l();function b(v){if(!r||!i)return!1;var k=td(r);return k[Cs]||k[yC]?!1:(o&&r[Lp](n),r[Ho](m,v),!0)}u(g,b,"processTelemetry",function(){return{item:m}},!m.sync)||g[Ur](m)}function d(m,g){function b(){var v=!1;if(r){var k=td(r),R=r[an]||k[an];r&&(!R||R===m.core())&&!k[Cs]&&(k[an]=null,k[Cs]=!0,k[Es]=!1,r[Cs]&&r[Cs](m,g)===!0&&(v=!0))}return v}u(m,b,"unload",function(){},g[Ya])||m[Ur](g)}function f(m,g){function b(){var v=!1;if(r){var k=td(r),R=r[an]||k[an];r&&(!R||R===m.core())&&!k[Cs]&&r[$m]&&r[$m](m,g)===!0&&(v=!0)}return v}u(m,b,"update",function(){},!1)||m[Ur](g)}return Jo(a)}var Xce,K6,F6,U6,DF,BC=ge(()=>{"use strict";p();Cn();Jp();la();xn();hi();kC();fk();Xce="TelemetryPluginChain",K6="_hasRun",F6="_getTelCtx",U6=0;DF=function(){function r(e,t,n,i){var o=this,s=$o(e,t,n,i);sh(o,s,So(s))}return r}()});function W6(r,e,t){e&&bt(e)&&e[rt]>0&&(e=e.sort(function(n,i){return n[oa]-i[oa]}),We(e,function(n){n[oa]<HC&&Xn(tue+n[Ga])}),r[Ot]({queue:Jo(e),chain:xc(e,t[Cc],t)}))}function V6(r,e){function t(){return $o(null,e[Cc],e,null)}function n(u,c,d,f){var m=u?u[rt]+1:1;function g(){m--,m===0&&(f&&f(),f=null)}m>0&&We(u,function(b){if(b&&b.queue[rt]>0){var v=b.chain,k=c[Hu](v);k[pC](g),d(k)}else m--}),g()}function i(u,c){var d=c||{reason:0};return n(r,u,function(f){f[Ur](d)},function(){u[Ur](d)}),!0}function o(u,c){var d=c||{reason:0,isAsync:!1};return n(r,u,function(f){f[Ur](d)},function(){u[Ur](d),a=!1}),!0}function s(u){var c=null;return r&&r[rt]>0&&We(r,function(d){if(d&&d.queue[rt]>0&&(We(d.queue,function(f){if(f[Ga]===u)return c=f,-1}),c))return-1}),c}var a=!1,l={identifier:"ChannelControllerPlugin",priority:HC,initialize:function(u,c,d,f){a=!0,We(r,function(m){m&&m.queue[rt]>0&&dk($o(m.chain,u,c),d)})},isInitialized:function(){return a},processTelemetry:function(u,c){n(r,c||t(),function(d){d[Ur](u)},function(){c[Ur](u)})},update:i,pause:function(){n(r,t(),function(u){u.iterate(function(c){c.pause&&c.pause()})},null)},resume:function(){n(r,t(),function(u){u.iterate(function(c){c.resume&&c.resume()})},null)},teardown:o,getChannel:s,flush:function(u,c,d,f){var m=1,g=!1,b=null;f=f||5e3;function v(){m--,g&&m===0&&(b&&(clearTimeout(b),b=null),c&&c(g),c=null)}return n(r,t(),function(k){k.iterate(function(R){if(R[Sy]){m++;var P=!1;R[Sy](u,function(){P=!0,v()},d)||P||(u&&b==null?b=setTimeout(function(){b=null,v()},f):v())}})},function(){g=!0,v()}),!0},_setQueue:function(u){r=u}};return l}function j6(r,e,t){var n=[];if(r&&We(r,function(o){return W6(n,o,t)}),e){var i=[];We(e,function(o){o[oa]>HC&&i[Ot](o)}),W6(n,i,t)}return n}var HC,tue,B6=ge(()=>{p();Cn();xn();hi();BC();fk();HC=500,tue="Channel has invalid priority - "});function gh(){var r=[];function e(n){n&&r[Ot](n)}function t(n,i){We(r,function(o){try{o(n,i)}catch(s){Gr(n[ia](),2,73,"Unexpected error calling unload handler - "+Zr(s))}}),r=[]}return{add:e,run:t}}var mk=ge(()=>{p();Cn();Jp();la();xn()});var Zp,vh,TF=ge(()=>{"use strict";p();ur();Cn();xn();hi();BC();mk();Zp="getPlugin",vh=function(){function r(){var e=this,t,n,i,o,s;u(),He(r,e,function(c){c[Ja]=function(d,f,m,g){l(d,f,g),t=!0},c[Cs]=function(d,f){var m,g=c[an];if(!g||d&&g!==d[an]())return;var b,v=!1,k=d||Zy(null,g,i&&i[Zp]?i[Zp]():i),R=f||(m={reason:0},m[Ya]=!1,m);function P(){if(!v){v=!0,o.run(k,f);var D=s;s=[],We(D,function(K){K.rm()}),b===!0&&k[Ur](R),u()}}return!c[Ey]||c[Ey](k,R,P)!==!0?P():b=!0,b},c[$m]=function(d,f){var m=c[an];if(!m||d&&m!==d[an]())return;var g,b=!1,v=d||jC(null,m,i&&i[Zp]?i[Zp]():i),k=f||{reason:0};function R(){b||(b=!0,l(v.getCfg(),v.core(),v[ws]()))}return!c._doUpdate||c._doUpdate(v,k,R)!==!0?R():g=!0,g},c._addHook=function(d){d&&(bt(d)?s=s.concat(d):s[Ot](d))},Hp(c,"_addUnloadCb",function(){return o},"add")}),e[ia]=function(c){return a(c)[ia]()},e[Es]=function(){return t},e.setInitialized=function(c){t=c},e[Lp]=function(c){i=c},e[Ur]=function(c,d){d?d[Ur](c):i&&qt(i[Ho])&&i[Ho](c,null)},e._getTelCtx=a;function a(c){c===void 0&&(c=null);var d=c;if(!d){var f=n||$o(null,{},e[an]);i&&i[Zp]?d=f[Hu](null,i[Zp]):d=f[Hu](null,i)}return d}function l(c,d,f){c&&Go(c,Py,[],null,Ct),!f&&d&&(f=d[DT]()[ws]());var m=i;i&&i[Zp]&&(m=i[Zp]()),e[an]=d,n=$o(f,c,d,m)}function u(){t=!1,e[an]=null,n=null,i=null,s=[],o=gh()}}return r.__ieDyn=1,r}()});var H6,q6=ge(()=>{p();ir();ur();Cn();TF();Jp();la();xn();hi();H6=function(r){yn(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),He(e,t,function(s,a){s.addTelemetryInitializer=function(l){var u={id:n++,fn:l};i[Ot](u);var c={remove:function(){We(i,function(d,f){if(d.id===u.id)return i[Bu](f,1),-1})}};return c},s[Ho]=function(l,u){for(var c=!1,d=i[rt],f=0;f<d;++f){var m=i[f];if(m)try{if(m.fn[wy](null,[l])===!1){c=!0;break}}catch(g){Gr(u[ia](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+oh(g),{exception:Zr(g)},!0)}}c||s[Ur](l,u)},s[Ey]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(vh)});function iue(r,e){return new TC(e)}function oue(r,e,t){var n,i=[],o={};return We(t,function(s){(Ct(s)||Ct(s[Ja]))&&Xn($6);var a=s[oa],l=s[Ga];s&&a&&(Ct(o[a])?o[a]=l:tl(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Ot](s)}),n={all:t},n[an]=i,n}function Y6(r,e){var t=!1;return We(e,function(n){if(n===r)return t=!0,-1}),t}function sue(){var r;return bo((r={},r[Jm]=function(e){},r[Gm]=function(e){},r[Dy]=function(e){},r[Vp]=function(e,t){},r[Ty]=function(e,t){},r))}var $6,J6,G6,rue,nue,yh,kF=ge(()=>{"use strict";p();ir();ur();ir();Cn();B6();hF();MC();oF();Jp();xn();hi();kC();BC();fk();q6();mk();$6="Plugins must provide initialize method",J6="_notificationManager",G6="SDK is still unloading...",rue="SDK is not initialized",nue={loggingLevelConsole:1};yh=function(){function r(){var e,t,n,i,o,s,a,l,u,c,d,f,m,g,b,v,k,R,P,D,K=0;He(r,this,function(L){B(),L[Es]=function(){return t},L[Ja]=function(q,$,de,pe){g&&Xn(G6),L[Es]()&&Xn("Core should not be initialized more than once"),e=q||{},L[Cc]=e,Ct(q[PT])&&Xn("Please provide instrumentation key"),i=pe,L[J6]=pe,Y(),Z(),ie(),de&&(L[jo]=de);var ye=Bp(e,E8,[]);u=[],u[Ot].apply(u,Hm(Hm([],$,!1),ye,!1)),f=Bp(e,xK,[]),O(null),(!m||m[rt]===0)&&Xn("No "+xK+" available"),t=!0,L.releaseQueue()},L.getTransmissionControls=function(){var q=[];return m&&We(m,function($){q[Ot]($.queue)}),Jo(q)},L.track=function(q){q.iKey=q.iKey||e[PT],q[qm]=q[qm]||sa(new Date),q.ver=q.ver||"4.0",!g&&L[Es]()?N()[Ur](q):n[Ot](q)},L[DT]=N,L[dC]=function(){return i||(i=sue(),L[J6]=i),i},L[Jm]=function(q){i&&i[Jm](q)},L[Gm]=function(q){i&&i[Gm](q)},L.getCookieMgr=function(){return a||(a=Qu(e,L[jo])),a},L.setCookieMgr=function(q){a=q},L[Zm]=function(){if(!o&&!s&&aa(e.enablePerfMgr)){var q=aa(e[PK]);qt(q)&&(s=q(L,L[dC]()))}return o||s||uF()},L.setPerfMgr=function(q){o=q},L.eventCnt=function(){return n[rt]},L.releaseQueue=function(){if(t&&n[rt]>0){var q=n;n=[],We(q,function($){N()[Ur]($)})}},L.pollInternalLogs=function(q){v=q||null;var $=aa(e.diagnosticLogInterval);return(!$||!($>0))&&($=1e4),K&&clearInterval(K),K=setInterval(function(){T()},$),K},L[EK]=function(){K&&(clearInterval(K),K=0,T())},sh(L,function(){return b},["addTelemetryInitializer"]),L.unload=function(q,$,de){var pe;q===void 0&&(q=!0),t||Xn(rue),g&&Xn(G6);var ye=(pe={reason:50},pe[Ya]=q,pe.flushComplete=!1,pe),z=Zy(y(),L);z[pC](function(){B(),$&&$(ye)},L);function fe(Se){ye.flushComplete=Se,g=!0,R.run(z,ye),L[EK](),z[Ur](ye)}H(q,fe,6,de)||fe(!1)},L[Ym]=h,L.addPlugin=function(q,$,de,pe){if(!q){pe&&pe(!1),be($6);return}var ye=h(q[Ga]);if(ye&&!$){pe&&pe(!1),be("Plugin ["+q[Ga]+"] is already loaded!");return}var z={reason:16};function fe(Le){u[Ot](q),z.added=[q],O(z),pe&&pe(!0)}if(ye){var Se=[ye.plugin],Te={reason:2,isAsync:!!de};w(Se,Te,function(Le){Le?(z.removed=Se,z.reason|=32,fe(!0)):pe&&pe(!1)})}else fe(!1)},L.evtNamespace=function(){return k},L[Sy]=H,L.getTraceCtx=function(q){return D||(D=L6()),D},L.setTraceCtx=function(q){D=q||null},Hp(L,"addUnloadCb",function(){return R},"add");function B(){t=!1,e=My(!0,{},nue),L[Cc]=e,L[jo]=new el(e),L[fC]=[],b=new H6,n=[],i=null,o=null,s=null,a=null,l=null,c=null,u=[],d=null,f=null,m=null,g=!1,v=null,k=nl("AIBaseCore",!0),R=gh(),D=null}function N(){return $o(y(),e,L)}function O(q){var $=oue(L[jo],HC,u);c=$[an],l=null;var de=$.all;if(m=Jo(j6(f,de,L)),d){var pe=zn(de,d);pe!==-1&&de[Bu](pe,1),pe=zn(c,d),pe!==-1&&c[Bu](pe,1),d._setQueue(m)}else d=V6(m,L);de[Ot](d),c[Ot](d),L[fC]=pk(de),d[Ja](e,L,de),dk(N(),de),L[fC]=Jo(pk(c||[])).slice(),q&&ce(q)}function h(q){var $,de=null,pe=null;return We(L[fC],function(ye){if(ye[Ga]===q&&ye!==d&&ye!==b)return pe=ye,-1}),!pe&&d&&(pe=d.getChannel(q)),pe&&(de=($={plugin:pe},$[mC]=function(ye){td(pe)[yC]=!ye},$.isEnabled=function(){var ye=td(pe);return!ye[Cs]&&!ye[yC]},$.remove=function(ye,z){var fe;ye===void 0&&(ye=!0);var Se=[pe],Te=(fe={reason:1},fe[Ya]=ye,fe);w(Se,Te,function(Le){Le&&O({reason:32,removed:Se}),z&&z(Le)})},$)),de}function y(){if(!l){var q=(c||[]).slice();zn(q,b)===-1&&q[Ot](b),l=xc(pk(q),e,L)}return l}function w(q,$,de){if(q&&q[rt]>0){var pe=xc(q,e,L),ye=Zy(pe,L);ye[pC](function(){var z=!1,fe=[];We(u,function(Te,Le){Y6(Te,q)?z=!0:fe[Ot](Te)}),u=fe;var Se=[];f&&(We(f,function(Te,Le){var $e=[];We(Te,function(Ge){Y6(Ge,q)?z=!0:$e[Ot](Ge)}),Se[Ot]($e)}),f=Se),de&&de(z)}),ye[Ur]($)}else de(!1)}function T(){var q=L[jo]?L[jo].queue:[];q&&(We(q,function($){var de,pe=(de={},de[Pi]=v||"InternalMessageId: "+$[_y],de.iKey=aa(e[PT]),de.time=sa(new Date),de.baseType=dh.dataType,de.baseData={message:$[Op]},de);L.track(pe)}),q[rt]=0)}function H(q,$,de,pe){return d?d[Sy](q,$,de||6,pe):($&&$(!1),!0)}function Y(){var q=aa(e.disableDbgExt);q===!0&&P&&(i[Gm](P),P=null),i&&!P&&q!==!0&&(P=X8(e),i[Jm](P))}function Z(){var q=aa(e.enablePerfMgr);!q&&s&&(s=null),q&&Bp(e,PK,iue)}function ie(){var q=Bp(e,Py,{});q.NotificationManager=i}function ce(q){var $=jC(y(),L);(!L._updateHook||L._updateHook($,q)!==!0)&&$[Ur](q)}function be(q){var $=L[jo];$?Gr($,2,73,q):Xn(q)}})}return r.__ieDyn=1,r}()});function hk(r,e,t,n){We(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var qC,NF=ge(()=>{p();ur();Cn();xn();hi();qC=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;He(r,this,function(n){n[Jm]=function(i){n.listeners[Ot](i)},n[Gm]=function(i){for(var o=zn(n[zm],i);o>-1;)n.listeners[Bu](o,1),o=zn(n[zm],i)},n[Dy]=function(i){hk(n[zm],Dy,!0,function(o){o[Dy](i)})},n[Vp]=function(i,o){hk(n[zm],Vp,!0,function(s){s[Vp](i,o)})},n[Ty]=function(i,o){hk(n[zm],Ty,o,function(s){s[Ty](i,o)})},n[jp]=function(i){i&&(t||!i[gC]())&&hk(n[zm],jp,!1,function(o){i[Ya]?setTimeout(function(){return o[jp](i)},0):o[jp](i)})}})}return r.__ieDyn=1,r}()});var JC,z6=ge(()=>{p();ir();ur();Cn();kF();Jp();xn();hi();NF();kC();JC=function(r){yn(e,r);function e(){var t=r.call(this)||this;return He(e,t,function(n,i){n[Ja]=function(a,l,u,c){i[Ja](a,l,u||new el(a),c||new qC(a))},n.track=function(a){bn(n[Zm](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),Xn("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){Ct(a[Pi])&&(s(a),Xn("telemetry name required"))}function s(a){var l=n[dC]();l&&l[Vp]([a],2)}}),t}return e.__ieDyn=1,e}(yh)});var Ae,Tr,bh,ol,Q6,X6,gk,RF,GC,vk,eb,sl,ef,rd,YC,Z6,AF,$C,e5=ge(()=>{p();LT();Tr="Failed",bh=Tr+"MonitorAjax",ol="Track",Q6="Start",X6="Stop",gk="Event",RF="AuthContext",GC="Exception",vk="Local",eb="Session",sl="Storage",ef="Browser",rd="Cannot",YC="Buffer",Z6="InstrumentationKey",AF=_o({CRITICAL:1,WARNING:2}),$C=_o((Ae={},Ae[ef+"DoesNotSupport"+vk+sl]=0,Ae[ef+rd+"Read"+vk+sl]=1,Ae[ef+rd+"Read"+eb+sl]=2,Ae[ef+rd+"Write"+vk+sl]=3,Ae[ef+rd+"Write"+eb+sl]=4,Ae[ef+Tr+"RemovalFrom"+vk+sl]=5,Ae[ef+Tr+"RemovalFrom"+eb+sl]=6,Ae[rd+"SendEmptyTelemetry"]=7,Ae.ClientPerformanceMathError=8,Ae["ErrorParsingAI"+eb+"Cookie"]=9,Ae.ErrorPVCalc=10,Ae[GC+"WhileLoggingError"]=11,Ae[Tr+"AddingTelemetryTo"+YC]=12,Ae[bh+"Abort"]=13,Ae[bh+"Dur"]=14,Ae[bh+"Open"]=15,Ae[bh+"RSC"]=16,Ae[bh+"Send"]=17,Ae[bh+"GetCorrelationHeader"]=18,Ae[Tr+"ToAddHandlerForOnBeforeUnload"]=19,Ae[Tr+"ToSendQueuedTelemetry"]=20,Ae[Tr+"ToReportDataLoss"]=21,Ae["Flush"+Tr]=22,Ae.MessageLimitPerPVExceeded=23,Ae.MissingRequiredFieldSpecification=24,Ae.NavigationTimingNotSupported=25,Ae.OnError=26,Ae[eb+"RenewalDateIsZero"]=27,Ae.SenderNotInitialized=28,Ae[Q6+ol+gk+Tr]=29,Ae[X6+ol+gk+Tr]=30,Ae[Q6+ol+Tr]=31,Ae[X6+ol+Tr]=32,Ae.TelemetrySampledAndNotSent=33,Ae[ol+gk+Tr]=34,Ae[ol+GC+Tr]=35,Ae[ol+"Metric"+Tr]=36,Ae[ol+"PV"+Tr]=37,Ae[ol+"PV"+Tr+"Calc"]=38,Ae[ol+"Trace"+Tr]=39,Ae["Transmission"+Tr]=40,Ae[Tr+"ToSet"+sl+YC]=41,Ae[Tr+"ToRestore"+sl+YC]=42,Ae.InvalidBackendResponse=43,Ae[Tr+"ToFixDepricatedValues"]=44,Ae.InvalidDurationValue=45,Ae.TelemetryEnvelopeInvalid=46,Ae.CreateEnvelopeError=47,Ae[rd+"SerializeObject"]=48,Ae[rd+"SerializeObjectNonSerializable"]=49,Ae.CircularReferenceDetected=50,Ae["Clear"+RF+Tr]=51,Ae[GC+"Truncated"]=52,Ae.IllegalCharsInName=53,Ae.ItemNotInArray=54,Ae.MaxAjaxPerPVExceeded=55,Ae.MessageTruncated=56,Ae.NameTooLong=57,Ae.SampleRateOutOfRange=58,Ae["Set"+RF+Tr]=59,Ae["Set"+RF+Tr+"AccountName"]=60,Ae.StringValueTooLong=61,Ae.StartCalledMoreThanOnce=62,Ae.StopCalledWithoutStart=63,Ae["TelemetryInitializer"+Tr]=64,Ae.TrackArgumentsNotSpecified=65,Ae.UrlTooLong=66,Ae[eb+sl+YC+"Full"]=67,Ae[rd+"AccessCookie"]=68,Ae.IdTooLong=69,Ae.InvalidEvent=70,Ae[bh+"SetRequestHeader"]=71,Ae["Send"+ef+"InfoOnUserInit"]=72,Ae["Plugin"+GC]=73,Ae["Notification"+GC]=74,Ae.SnippetScriptLoadFailure=99,Ae["Invalid"+Z6]=100,Ae[rd+"ParseAiBlobValue"]=101,Ae.InvalidContentBlob=102,Ae[ol+"PageAction"+gk+Tr]=103,Ae[Tr+"AddingCustomDefinedRequestContext"]=104,Ae["InMemory"+sl+YC+"Full"]=105,Ae[Z6+"Deprecation"]=106,Ae))});var nd=ge(()=>{p();_8();F8();z6();kF();TF();XT();bF();xn();LT();vF();la();ir();NF();kC();Jp();BC();e5();hF();MC();mk();xF()});var t5,r5,n5,i5,o5,s5,a5=ge(()=>{p();ir();nd();t5=_o({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32}),r5=_o({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),n5=_o({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),i5=_o({Normal:1,Critical:2}),o5=_o({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),s5=Jo(Io(Io({},$C),_o({AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520})))});var al,yk,aue,kLe,MF,bk,zC=ge(()=>{p();al="",yk="https://browser.events.data.microsoft.com/OneCollector/1.0/",aue="pluginVersionString",kLe=aue+"Arr",MF="version",bk="properties"});function Un(r){return!(r===al||Ct(r))}function XC(r){if(r){var e=r.indexOf("-");if(e>-1)return r.substring(0,e)}return al}function KF(){return OF===null&&(OF=!cr(Uint8Array)&&!pue()&&!zu()),OF}function ZC(r){return!!(r&&qo(r)&&r>=1&&r<=4)}function ew(r,e,t){if(!e&&!Un(e)||typeof r!="string")return null;var n=typeof e;if(n==="string"||n==="number"||n==="boolean"||bt(e))e={value:e};else if(n==="object"&&!nr.call(e,"value"))e={value:t?JSON.stringify(e):e};else if(Ct(e.value)||e.value===al||!ln(e.value)&&!qo(e.value)&&!Ju(e.value)&&!bt(e.value))return null;if(bt(e.value)&&!Sk(e.value))return null;if(!Ct(e.kind)){if(bt(e.value)||!tb(e.kind))return null;e.value=e.value.toString()}return e}function tw(r,e,t){var n=-1;if(!cr(r))if(e>0&&(e===32?n=8192:e<=13&&(n=e<<5)),due(t))n===-1&&(n=0),n|=t;else{var i=uue[ll(r)]||-1;n!==-1&&i!==-1?n|=i:i===6&&(n=i)}return n}function FF(){zp(null).setEnabled(!1)}function UF(r,e,t){il(null)&&zp(null).set(r,e,t*86400,null,"/")}function WF(r){il(null)&&zp(null).del(r)}function VF(r){return il(null)?jF(zp(null),r):al}function jF(r,e,t){t===void 0&&(t=!0);var n;return r&&(n=r.get(e),t&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||al}function BF(r){r===void 0&&(r="D");var e=$y();return r==="B"?e="{"+e+"}":r==="P"?e="("+e+")":r==="N"&&(e=e.replace(/-/g,al)),e}function tf(r,e,t,n,i){var o={},s=!1,a=0,l=arguments.length,u=Object[Mt],c=arguments;for(u.toString.call(c[0])==="[object Boolean]"&&(s=c[0],a++);a<l;a++){var r=c[a];Wr(r,function(f,m){s&&m&&Di(m)?bt(m)?(o[f]=o[f]||[],We(m,function(g,b){g&&Di(g)?o[f][b]=tf(!0,o[f][b],g):o[f][b]=g})):o[f]=tf(!0,o[f],m):o[f]=m})}return o}function tb(r){return r===0||r>0&&r<=13||r===32}function due(r){return r>=0&&r<=9}function pue(){var r=Ps();if(!cr(r)&&r.userAgent){var e=r.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}function Sk(r){return r.length>0}function Ih(r,e){var t=r;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[e]=Eo()}function ll(r){var e=0;if(r!=null){var t=typeof r;t==="string"?e=1:t==="number"?e=2:t==="boolean"?e=3:t===dt&&(e=4,bt(r)?(e=4096,r.length>0&&(e|=ll(r[0]))):nr.call(r,"value")&&(e=8192|ll(r.value)))}return e}function _k(){return!!cn("chrome")}function Ek(r,e,t,n,i,o){n===void 0&&(n=!1),i===void 0&&(i=!1);function s(l,u,c){try{l[u]=c}catch(d){}}var a=new XMLHttpRequest;return n&&s(a,lue,n),t&&s(a,l5,t),a.open(r,e,!i),t&&s(a,l5,t),!i&&o&&s(a,cue,o),a}var id,Ik,od,lue,l5,cue,uue,OF,QC,LF,Eo,c5,u5,rw=ge(()=>{p();nd();ir();zC();Ik="3.2.9",od="1DS-Web-JS-"+Ik,lue="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",l5="withCredentials",cue="timeout",uue=(id={},id[0]=0,id[2]=6,id[1]=1,id[3]=7,id[4098]=6,id[4097]=1,id[4099]=7,id),OF=null,QC=!!Yo(),LF=!!wc();Eo=zy;c5={Version:Ik,FullVersionString:od,strUndefined:$t,strObject:dt,Undefined:$t,arrForEach:We,arrIndexOf:zn,arrMap:nh,arrReduce:ih,objKeys:So,toISOString:sa,isReactNative:zu,isString:ln,isNumber:qo,isBoolean:Ju,isFunction:qt,isArray:bt,isObject:Di,strTrim:Vr,isDocumentObjectAvailable:QC,isWindowObjectAvailable:LF,isValueAssigned:Un,getTenantId:XC,isBeaconsSupported:qp,isUint8ArrayAvailable:KF,isLatency:ZC,sanitizeProperty:ew,getISOString:sa,useXDomainRequest:uh,getCommonSchemaMetaData:tw,cookieAvailable:il,disallowsSameSiteNone:By,setCookie:UF,deleteCookie:WF,getCookie:VF,createGuid:BF,extend:tf,getTime:Eo,isValueKind:tb,isArrayValid:Sk,objDefineAccessors:xs,addPageUnloadEventListener:hh,setProcessTelemetryTimings:Ih,addEventHandler:Xp,getFieldValueType:ll,strEndsWith:th,objForEachKey:Wr},u5={_canUseCookies:void 0,isTypeof:ky,isUndefined:cr,isNullOrUndefined:Ct,hasOwnProperty:qu,isFunction:qt,isObject:Di,isDate:Ry,isArray:bt,isError:rh,isString:ln,isNumber:qo,isBoolean:Ju,toISOString:sa,arrForEach:We,arrIndexOf:zn,arrMap:nh,arrReduce:ih,strTrim:Vr,objCreate:bo,objKeys:So,objDefineAccessors:xs,addEventHandler:Xp,dateNow:Qn,isIE:Za,disableCookies:FF,newGuid:$y,perfNow:zy,newId:Yp,randomValue:jy,random32:rl,mwcRandomSeed:QT,mwcRandom32:AC,generateW3CId:Zu}});var fue,d5,p5=ge(()=>{p();ir();ur();nd();zC();rw();fue=function(r){yn(e,r);function e(){var t=r.call(this)||this;return t.pluginVersionStringArr=[],He(e,t,function(n,i){(!n.logger||!n.logger.queue)&&(n.logger=new el({loggingLevelConsole:1})),n.initialize=function(o,s,a,l){bn(n,function(){return"AppInsightsCore.initialize"},function(){var u=n.pluginVersionStringArr;if(o){o.endpointUrl||(o.endpointUrl=yk);var c=o.propertyStorageOverride;c&&(!c.getProperty||!c.setProperty)&&Xn("Invalid property storage override passed."),o.channels&&We(o.channels,function(m){m&&We(m,function(g){if(g.identifier&&g.version){var b=g.identifier+"="+g.version;u.push(b)}})})}n.getWParam=function(){return typeof document!="undefined"||o.enableWParam?0:-1},s&&We(s,function(m){if(m&&m.identifier&&m.version){var g=m.identifier+"="+m.version;u.push(g)}}),n.pluginVersionString=u.join(";"),n.pluginVersionStringArr=u;try{i.initialize(o,s,a,l),n.pollInternalLogs("InternalLog")}catch(m){var d=n.logger,f=Zr(m);f.indexOf("channels")!==-1&&(f+=`
 - Channels must be provided through config.channels only!`),Gr(d,1,514,"SDK Initialization Failed - no telemetry will be sent: "+f)}},function(){return{config:o,extensions:s,logger:a,notificationManager:l}})},n.track=function(o){bn(n,function(){return"AppInsightsCore.track"},function(){var s=o;if(s){s.timings=s.timings||{},s.timings.trackStart=Eo(),ZC(s.latency)||(s.latency=1);var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=od;var l=s.baseData=s.baseData||{};l[bk]=l[bk]||{};var u=l[bk];u[MF]=u[MF]||n.pluginVersionString||al}i.track(s)},function(){return{item:o}},!o.sync)}}),t}return e.__ieDyn=1,e}(JC),d5=fue});var mue,f5,m5=ge(()=>{p();ir();ur();nd();zC();rw();mue=function(r){yn(e,r);function e(){var t=r.call(this)||this;return He(e,t,function(n,i){n.initialize=function(o,s,a,l){o&&!o.endpointUrl&&(o.endpointUrl=yk),n.getWParam=function(){return QC||o.enableWParam?0:-1};try{i.initialize(o,s,a,l)}catch(u){Gr(n.logger,1,514,"Initialization Failed: "+Zr(u)+`
 - Note: Channels must be provided through config.channels only`)}},n.track=function(o){var s=o;if(s){var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=od}i.track(s)}}),t}return e.__ieDyn=1,e}(yh),f5=mue});function hue(r,e,t){return function(n){r[e]=n,t()}}var Sh,gue,rf,HF=ge(()=>{p();ur();nd();Sh=qt;gue=function(){function r(e){var t=0,n=null,i=[];He(r,this,function(u){u.then=function(c,d){return new r(function(f,m){o(c,d,f,m)})},u.catch=function(c){return u.then(null,c)}});function o(u,c,d,f){i.push(function(){var m;try{t===1?m=Sh(u)?u(n):n:m=Sh(c)?c(n):n,m instanceof r?m.then(d,f):t===2&&!Sh(c)?f(m):d(m)}catch(g){f(g);return}}),t!==0&&s()}function s(){if(i.length>0){var u=i.slice();i=[],setTimeout(function(){for(var c=0,d=u.length;c<d;++c)try{u[c]()}catch(f){}},0)}}function a(u){t===0&&(n=u,t=1,s())}function l(u){t===0&&(n=u,t=2,s())}(function(){if(!Sh(e))throw new TypeError("ESPromise: resolvedFunc argument is not a Function");try{e(a,l)}catch(c){l(c)}})()}return r.resolve=function(e){return e instanceof r?e:e&&Sh(e.then)?new r(function(t,n){try{e.then(t,n)}catch(i){n(i)}}):new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.all=function(e){if(!(!e||!e.length))return new r(function(t,n){try{for(var i=[],o=0,s=0;s<e.length;s++){var a=e[s];a&&Sh(a.then)?(o++,a.then(hue(i,s,function(){--o===0&&t(i)}),n)):i[s]=a}o===0&&setTimeout(function(){t(i)},0)}catch(l){n(l)}})},r.race=function(e){return new r(function(t,n){if(!(!e||!e.length))try{for(var i=function(s){var a=e[s];a&&Sh(a.then)?a.then(t,n):setTimeout(function(){t(a)},0)},o=0;o<e.length;o++)i(o)}catch(s){n(s)}})},r}(),rf=gue});function rb(){return new Date().getTime()}var vue,h5,nw,_h,qF,yue,g5,v5=ge(()=>{p();ur();HF();nd();vue=6e5,h5=0,nw=[],_h=[],qF=[];yue=function(){function r(e,t){var n=0,i=(e||"<unnamed>")+"."+h5;h5++,He(r,this,function(a){var l=null,u=0;a.scheduleEvent=function(d,f,m){var g=i+"."+u;u++,f&&(g+="-("+f+")");var b=g+"{"+n+"}";n++;var v={evt:null,tm:rb(),id:b,isRunning:!1,isAborted:!1};return l?v.evt=B(v,l):v.evt=L(v),l=v,l.evt._schId=b,v.evt;function k(N){for(var O=rb(),h=O-vue,y=N.length,w=0;w<y;){var T=N[w];if(T&&T.tm<h){var H=null;T.abort?(H="Aborting ["+T.id+"] due to Excessive runtime ("+(O-T.tm)+" ms)",T.abort(H)):H="Removing ["+T.id+"] due to Excessive runtime ("+(O-T.tm)+" ms)",s(H),N.splice(w,1),y--}else w++}}function R(N,O){var h=!1,y=c(nw,N);if(y||(y=c(qF,N),h=!0),y){y.to&&(clearTimeout(y.to),y.to=null);var w=rb()-y.tm;O?h?s("Timed out event ["+N+"] finally complete -- "+w+" ms"):o("Promise ["+N+"] Complete -- "+w+" ms"):(qF.push(y),s("Event ["+N+"] Timed out and removed -- "+w+" ms"))}else o("Failed to remove ["+N+"] from running queue");l&&l.id===N&&(l=null),k(nw),k(_h),k(qF)}function P(N,O){return function(h){return R(N,!0),O&&O(h),h}}function D(N,O,h,y){O.then(function(w){return w instanceof rf?(o("Event ["+N+"] returned a promise -- waiting"),D(N,w,h,y),w):P(N,h)(w)},P(N,y))}function K(N,O){var h=N.id;return new rf(function(y,w){o("Event ["+h+"] Starting -- waited for "+(N.wTm||"--")+" ms"),N.isRunning=!0,N.abort=function(H){N.abort=null,N.isAborted=!0,R(h,!1),w(new Error(H))};var T=O(h);T instanceof rf?(m&&(N.to=setTimeout(function(){R(h,!1),w(new Error("Timed out after ["+m+"] ms"))},m)),D(h,T,function(H){o("Event ["+h+"] Resolving after "+(rb()-N.tm)+" ms"),y(H)},w)):(o("Promise ["+h+"] Auto completed as the start action did not return a promise"),y())})}function L(N){var O=rb();return N.wTm=O-N.tm,N.tm=O,N.isAborted?rf.reject(new Error("["+g+"] was aborted")):(nw.push(N),K(N,d))}function B(N,O){var h=new rf(function(y,w){var T=rb()-O.tm,H=O.id;o("["+g+"] is waiting for ["+H+":"+T+" ms] to complete before starting -- ["+_h.length+"] waiting and ["+nw.length+"] running"),N.abort=function(Y){N.abort=null,c(_h,g),N.isAborted=!0,w(new Error(Y))},O.evt.then(function(Y){c(_h,g),L(N).then(y,w)},function(Y){c(_h,g),L(N).then(y,w)})});return _h.push(N),h}};function c(d,f){for(var m=0;m<d.length;m++)if(d[m].id===f)return d.splice(m,1)[0];return null}});function o(a){var l=Kn();l&&l.QUnit&&console&&console.log("ESPromiseScheduler["+i+"] "+a)}function s(a){tl(t,"ESPromiseScheduler["+i+"] "+a)}}return r.incomplete=function(){return nw},r.waitingToStart=function(){return _h},r}(),g5=yue});var y5,b5=ge(()=>{p();nd();zC();rw();y5=function(){function r(e){var t=this,n={},i=[],o=[];e&&o.push(e);function s(c,d){var f,m=n[c];if(m&&(f=m[d]),!f&&f!==null){if(ln(c)&&ln(d))if(o.length>0){for(var g=0;g<o.length;g++)if(o[g].handleField(c,d)){f={canHandle:!0,fieldHandler:o[g]};break}}else i.length===0&&(f={canHandle:!0});if(!f&&f!==null){f=null;for(var g=0;g<i.length;g++)if(i[g].handleField(c,d)){f={canHandle:!0,handler:i[g],fieldHandler:null};break}}m||(m=n[c]={}),m[d]=f}return f}t.addSanitizer=function(c){c&&(i.push(c),n={})},t.addFieldSanitizer=function(c){c&&(o.push(c),n={})},t.handleField=function(c,d){var f=s(c,d);return f?f.canHandle:!1},t.value=function(c,d,f,m){var g=s(c,d);if(g&&g.canHandle){if(!g||!g.canHandle)return null;if(g.handler)return g.handler.value(c,d,f,m);if(!ln(d)||Ct(f)||f===al)return null;var b=null,v=ll(f);if((v&8192)===8192){var k=v&-8193;if(b=f,!Un(b.value)||k!==1&&k!==2&&k!==3&&(k&4096)!==4096)return null}else v===1||v===2||v===3||(v&4096)===4096?b=l(c,d,f):v===4&&(b=l(c,d,m?JSON.stringify(f):f));if(b)return a(g,c,d,v,b,m)}return null},t.property=function(c,d,f,m){var g=s(c,d);if(!g||!g.canHandle||!ln(d)||Ct(f)||!Un(f.value))return null;var b=ll(f.value);return b===0?null:a(g,c,d,b,f,m)};function a(c,d,f,m,g,b){if(c.handler)return c.handler.property(d,f,g,b);if(!Ct(g.kind)){if((m&4096)===4096||!tb(g.kind))return null;g.value=g.value.toString()}return u(c.fieldHandler,d,f,m,g)}function l(c,d,f){return Un(f)?{value:f}:null}function u(c,d,f,m,g){if(g&&c){var b=c.getSanitizer(d,f,m,g.kind,g.propertyType);if(b)if(m===4){var v={},k=g.value;Wr(k,function(P,D){var K=d+"."+f;if(Un(D)){var L=l(K,P,D);L=u(c,K,P,ll(D),L),L&&(v[P]=L.value)}}),g.value=v}else{var R={path:d,name:f,type:m,prop:g,sanitizer:t};g=b.call(t,R)}}return g}}return r.getFieldType=ll,r}()});var I5={};Vv(I5,{AppInsightsCore:()=>d5,BaseCore:()=>f5,BaseTelemetryPlugin:()=>vh,CoreUtils:()=>u5,DiagnosticLogger:()=>el,ESPromise:()=>rf,ESPromiseScheduler:()=>g5,EventHelper:()=>yF,EventLatency:()=>r5,EventPersistence:()=>i5,EventPropertyType:()=>n5,EventsDiscardedReason:()=>Xa,FullVersionString:()=>od,InternalAppInsightsCore:()=>JC,InternalBaseCore:()=>yh,LoggingSeverity:()=>AF,MinChannelPriorty:()=>_K,NotificationManager:()=>qC,PerfEvent:()=>ph,PerfManager:()=>TC,ProcessTelemetryContext:()=>DF,TraceLevel:()=>o5,Undefined:()=>$t,Utils:()=>c5,ValueKind:()=>t5,ValueSanitizer:()=>y5,Version:()=>Ik,_ExtendedInternalMessageId:()=>s5,_InternalLogMessage:()=>dh,_InternalMessageId:()=>$C,__getRegisteredEvents:()=>gF,_logInternalMessage:()=>aF,_throwInternal:()=>Gr,_warnToConsole:()=>tl,addEventHandler:()=>Xp,addEventListeners:()=>ak,addPageHideEventListener:()=>Gy,addPageShowEventListener:()=>Yy,addPageUnloadEventListener:()=>hh,areCookiesSupported:()=>il,arrForEach:()=>We,arrIndexOf:()=>zn,arrMap:()=>nh,arrReduce:()=>ih,attachEvent:()=>qy,cookieAvailable:()=>il,createCookieMgr:()=>Qu,createEnumStyle:()=>_o,createGuid:()=>BF,createProcessTelemetryContext:()=>$o,createTraceParent:()=>_F,createUniqueNamespace:()=>nl,createUnloadHandlerContainer:()=>gh,dateNow:()=>Qn,deleteCookie:()=>WF,detachEvent:()=>Jy,disableCookies:()=>FF,disallowsSameSiteNone:()=>By,doPerf:()=>bn,dumpObj:()=>Zr,eventOff:()=>mh,eventOn:()=>fh,extend:()=>tf,findW3cTraceParent:()=>wF,formatTraceParent:()=>CF,generateW3CId:()=>Zu,getCommonSchemaMetaData:()=>tw,getConsole:()=>CC,getCookie:()=>VF,getCookieValue:()=>jF,getCrypto:()=>wC,getDocument:()=>Yo,getExceptionName:()=>oh,getFieldValueType:()=>ll,getGlobal:()=>Kn,getGlobalInst:()=>cn,getHistory:()=>ZK,getIEVersion:()=>eF,getISOString:()=>sa,getJSON:()=>Fy,getLocation:()=>lh,getMsCrypto:()=>xC,getNavigator:()=>Ps,getPerformance:()=>Ky,getSetValue:()=>Bp,getTenantId:()=>XC,getTime:()=>Eo,getWindow:()=>wc,hasDocument:()=>GT,hasHistory:()=>YT,hasJSON:()=>ch,hasNavigator:()=>EC,hasOwnProperty:()=>qu,hasWindow:()=>_C,isArray:()=>bt,isArrayValid:()=>Sk,isBeaconsSupported:()=>qp,isBoolean:()=>Ju,isChromium:()=>_k,isDate:()=>Ry,isDocumentObjectAvailable:()=>QC,isError:()=>rh,isFetchSupported:()=>Uy,isFunction:()=>qt,isIE:()=>Za,isLatency:()=>ZC,isNotTruthy:()=>LK,isNullOrUndefined:()=>Ct,isNumber:()=>qo,isObject:()=>Di,isReactNative:()=>zu,isSampledFlag:()=>EF,isString:()=>ln,isTruthy:()=>Ay,isTypeof:()=>ky,isUint8ArrayAvailable:()=>KF,isUndefined:()=>cr,isValidSpanId:()=>Xy,isValidTraceId:()=>Qy,isValidTraceParent:()=>uk,isValueAssigned:()=>Un,isValueKind:()=>tb,isWindowObjectAvailable:()=>LF,isXhrSupported:()=>Wy,mergeEvtNamespace:()=>Xu,newGuid:()=>$y,newId:()=>Yp,normalizeJsName:()=>eh,objCreate:()=>bo,objDefineAccessors:()=>xs,objForEachKey:()=>Wr,objFreeze:()=>Jo,objKeys:()=>So,objSeal:()=>OK,openXhr:()=>Ek,optimizeObject:()=>Gu,parseTraceParent:()=>VC,perfNow:()=>zy,proxyAssign:()=>KK,proxyFunctionAs:()=>Hp,proxyFunctions:()=>sh,random32:()=>rl,randomValue:()=>jy,removeEventHandler:()=>sk,removeEventListeners:()=>Qp,removePageHideEventListener:()=>UC,removePageShowEventListener:()=>WC,removePageUnloadEventListener:()=>FC,safeGetCookieMgr:()=>zp,safeGetLogger:()=>PC,sanitizeProperty:()=>ew,setCookie:()=>UF,setEnableEnvMocks:()=>XK,setProcessTelemetryTimings:()=>Ih,setValue:()=>Go,strContains:()=>wn,strEndsWith:()=>th,strFunction:()=>Xr,strObject:()=>dt,strPrototype:()=>Mt,strStartsWith:()=>Ny,strTrim:()=>Vr,strUndefined:()=>$t,throwError:()=>Xn,toISOString:()=>sa,useXDomainRequest:()=>uh});var Eh=ge(()=>{p();a5();p5();m5();HF();v5();b5();nd();rw()});var Ch,Ck,wk,JF=ge(()=>{p();Ch="REAL_TIME",Ck="NEAR_REAL_TIME",wk="BEST_EFFORT"});var cl,xk,S5,Pk,_5,GF,E5,C5,w5,YF,$F,Dk,x5,zF,P5,QF,Tk,XF,kk,Nk,Rk,iw,ZF,D5,nb,eU,Ak,ow=ge(()=>{p();cl="",xk="POST",S5="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Pk="drop",_5="send",GF="requeue",E5="rspFail",C5="oth",w5="no-cache, no-store",YF="application/x-json-stream",$F="cache-control",Dk="content-type",x5="kill-tokens",zF="kill-duration",P5="kill-duration-seconds",QF="time-delta-millis",Tk="client-version",XF="client-id",kk="time-delta-to-apply-millis",Nk="upload-time",Rk="apikey",iw="AuthMsaDeviceTicket",ZF="AuthXToken",D5="NoResponseBody",nb="msfpc",eU="trace",Ak="user"});function k5(r){var e=(r.ext||{}).intweb;return e&&Un(e[nb])?e[nb]:null}function T5(r){for(var e=null,t=0;e===null&&t<r.length;t++)e=k5(r[t]);return e}var ib,tU=ge(()=>{p();Eh();ow();ib=function(){function r(e,t){var n=t?[].concat(t):[],i=this,o=T5(n);i.iKey=function(){return e},i.Msfpc=function(){return o||cl},i.count=function(){return n.length},i.events=function(){return n},i.addEvent=function(s){return s?(n.push(s),o||(o=k5(s)),!0):!1},i.split=function(s,a){var l;if(s<n.length){var u=n.length-s;Ct(a)||(u=a<u?a:u),l=n.splice(s,u),o=T5(n)}return new r(e,l)}}return r.create=function(e,t){return new r(e,t)},r}()});var bue,N5,R5=ge(()=>{p();ur();bue=function(){function r(){var e=!0,t=!0,n=!0,i="use-collector-delta",o=!1;He(r,this,function(s){s.allowRequestSending=function(){return e},s.firstRequestSent=function(){n&&(n=!1,o||(e=!1))},s.shouldAddClockSkewHeaders=function(){return t},s.getClockSkewHeaderValue=function(){return i},s.setClockSkew=function(a){o||(a?(i=a,t=!0,o=!0):t=!1,e=!0)}})}return r.__ieDyn=1,r}(),N5=bue});var Iue,Sue,A5,M5=ge(()=>{p();ur();Eh();Iue=1e3,Sue=function(){function r(){var e={};function t(n){var i=[];return n&&We(n,function(o){i.push(Vr(o))}),i}He(r,this,function(n){n.setKillSwitchTenants=function(i,o){if(i&&o)try{var s=t(i.split(","));if(o==="this-request-only")return s;for(var a=parseInt(o,10)*Iue,l=0;l<s.length;++l)e[s[l]]=Qn()+a}catch(u){return[]}return[]},n.isTenantKilled=function(i){var o=e,s=Vr(i);return o[s]!==void 0&&o[s]>Qn()?!0:(delete o[s],!1)}})}return r.__ieDyn=1,r}(),A5=Sue});function L5(r){return!(r>=300&&r<500&&r!=408&&r!=429||r==501||r==505)}function Mk(r){var e=0,t=O5*_ue,n=O5*Eue,i=Math.floor(Math.random()*(n-t))+t;return e=Math.pow(2,r)*i,Math.min(e,Cue)}var _ue,Eue,O5,Cue,rU=ge(()=>{p();_ue=.8,Eue=1.2,O5=3e3,Cue=6e5});function F5(r,e,t,n){if(n&&r){var i=tw(n.value,n.kind,n.propertyType);if(i>-1){var o=r[K5];o||(o=r[K5]={f:{}});var s=o[Ok];if(s||(s=o[Ok]={}),e)for(var a=0;a<e.length;a++){var l=e[a];s[l]||(s[l]={f:{}});var u=s[l][Ok];u||(u=s[l][Ok]={}),s=u}s=s[t]={},bt(n.value)?s.a={t:i}:s.t=i}}}var wue,xue,U5,W5,Pue,K5,Ok,Due,V5,j5=ge(()=>{p();ur();Eh();tU();ow();wue=20,xue=3984588,U5=65e3,W5=2e6,Pue=Math.min(W5,U5),K5="metadata",Ok="f",Due=/\./,V5=function(){function r(e,t,n,i){var o="data",s="baseData",a="ext",l=!!i,u=!0,c=t,d={};He(r,this,function(f){f.createPayload=function(b,v,k,R,P,D){return{apiKeys:[],payloadBlob:cl,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:b,isTeardown:v,isSync:k,isBeacon:R,sendType:D,sendReason:P}},f.appendPayload=function(b,v,k){var R=b&&v&&!b.overflow;return R&&bn(e,function(){return"Serializer:appendPayload"},function(){for(var P=v.events(),D=b.payloadBlob,K=b.numEvents,L=!1,B=[],N=[],O=b.isBeacon,h=O?U5:xue,y=O?Pue:W5,w=0,T=0;w<P.length;){var H=P[w];if(H){if(K>=k){b.overflow=v.split(w);break}var Y=f.getEventBlob(H);if(Y&&Y.length<=y){var Z=Y.length,ie=D.length;if(ie+Z>h){b.overflow=v.split(w);break}D&&(D+=`
`),D+=Y,T++,T>wue&&(D.substr(0,1),T=0),L=!0,K++}else Y?B.push(H):N.push(H),P.splice(w,1),w--}w++}if(B&&B.length>0&&b.sizeExceed.push(ib.create(v.iKey(),B)),N&&N.length>0&&b.failedEvts.push(ib.create(v.iKey(),N)),L){b.batches.push(v),b.payloadBlob=D,b.numEvents=K;var ce=v.iKey();zn(b.apiKeys,ce)===-1&&b.apiKeys.push(ce)}},function(){return{payload:b,theBatch:{iKey:v.iKey(),evts:v.events()},max:k}}),R},f.getEventBlob=function(b){try{return bn(e,function(){return"Serializer.getEventBlob"},function(){var v={};v.name=b.name,v.time=b.time,v.ver=b.ver,v.iKey="o:"+XC(b.iKey);var k={},R=b[a];R&&(v[a]=k,Wr(R,function(K,L){var B=k[K]={};g(L,B,"ext."+K,!0,null,null,!0)}));var P=v[o]={};P.baseType=b.baseType;var D=P[s]={};return g(b.baseData,D,s,!1,[s],function(K,L,B){F5(k,K,L,B)},u),g(b.data,P,o,!1,[],function(K,L,B){F5(k,K,L,B)},u),JSON.stringify(v)},function(){return{item:b}})}catch(v){return null}};function m(b,v){var k=d[b];return k===void 0&&(b.length>=7&&(k=Ny(b,"ext.metadata")||Ny(b,"ext.web")),d[b]=k),k}function g(b,v,k,R,P,D,K){Wr(b,function(L,B){var N=null;if(B||Un(B)){var O=k,h=L,y=P,w=v;if(l&&!R&&Due.test(L)){var T=L.split("."),H=T.length;if(H>1){y&&(y=y.slice());for(var Y=0;Y<H-1;Y++){var Z=T[Y];w=w[Z]=w[Z]||{},O+="."+Z,y&&y.push(Z)}h=T[H-1]}}var ie=R&&m(O,h);if(!ie&&c&&c.handleField(O,h)?N=c.value(O,h,B,n):N=ew(h,B,n),N){var ce=N.value;if(w[h]=ce,D&&D(y,h,N),K&&typeof ce=="object"&&!bt(ce)){var be=y;be&&(be=be.slice(),be.push(h)),g(B,ce,O+"."+h,R,be,D,K)}}}})}})}return r.__ieDyn=1,r}()});function xh(r,e,t){iU[r]=e,t!==!1&&(oU[e]=r)}function H5(r){try{return r.responseText}catch(e){}return cl}function q5(r,e){var t=!1;if(r&&e){var n=So(r);if(n&&n.length>0)for(var i=e.toLowerCase(),o=0;o<n.length;o++){var s=n[o];if(s&&qu(e,s)&&s.toLowerCase()===i){t=!0;break}}}return t}function ob(r,e,t,n){e&&t&&t.length>0&&(n&&iU[e]?(r.hdrs[iU[e]]=t,r.useHdrs=!0):r.url+="&"+e+"="+t)}function J5(r,e){return e&&(qo(e)?r=[e].concat(r):bt(e)&&(r=e.concat(r))),r}var wh,nU,B5,Tue,iU,oU,G5,Y5=ge(()=>{p();ur();R5();M5();Eh();ow();rU();j5();nU="sendAttempt",B5="&"+D5+"=true",Tue=(wh={},wh[1]=GF,wh[100]=GF,wh[200]="sent",wh[8004]=Pk,wh[8003]=Pk,wh),iU={},oU={};xh(iw,iw,!1);xh(Tk,Tk);xh(XF,"Client-Id");xh(Rk,Rk);xh(kk,kk);xh(Nk,Nk);xh(ZF,ZF);G5=function(){function r(e,t,n,i,o){this._responseHandlers=[];var s="?cors=true&"+Dk.toLowerCase()+"="+YF,a=new A5,l=!1,u=new N5,c=!1,d=0,f,m,g,b,v=!0,k=[],R={},P=[],D=null,K=!1,L,B=!1,N=!1,O,h,y,w,T;He(r,this,function(H){var Y=!0;H.initialize=function(Q,we,G,X,ue){var _e;ue||(ue={}),s=Q+s,N=cr(ue.avoidOptions)?!0:!ue.avoidOptions,b=we,L=we.getCookieMgr(),K=!b.config.disableEventTimings;var xe=!!b.config.enableCompoundKey;f=G,m=f.diagLog();var ee=ue.valueSanitizer,se=ue.stringifyObjects;cr(ue.enableCompoundKey)||(xe=!!ue.enableCompoundKey),O=ue.xhrTimeout,h=!!ue.disableXhrSync,y=!!ue.disableFetchKeepAlive,T=ue.addNoResponse!==!1,c=!zu(),D=new V5(b,ee,se,xe),Ct(ue.useSendBeacon)||(c=!!ue.useSendBeacon);var ae=X,Ie=ue.alwaysUseXhrOverride?X:null,Pe=ue.alwaysUseXhrOverride?X:null,Ne=[3,2];if(!X){v=!1;var vt=lh();vt&&vt.protocol&&vt.protocol.toLowerCase()==="file:"&&(Y=!1);var Yt=[];zu()?(Yt=[2,1],Ne=[2,1,3]):Yt=[1,2,3],Yt=J5(Yt,ue.transports),X=Z(Yt,!1),X||tl(m,"No available transport to send events"),ae=Z(Yt,!0)}Ie||(Ne=J5(Ne,ue.unloadTransports),Ie=Z(Ne,!0)),w=!v&&(c&&qp()||!y&&Uy(!0)),g=(_e={},_e[0]=X,_e[1]=ae||Z([1,2,3],!0),_e[2]=Ie||ae||Z([1],!0),_e[3]=Pe||Z([2,3],!0)||ae||Z([1],!0),_e)};function Z(Q,we){for(var G=0,X=null,ue=0;X==null&&ue<Q.length;)G=Q[ue],G===1?uh()?X=ie:Wy()&&(X=be):G===2&&Uy(we)&&(!we||we&&!y)?X=ce:c&&G===3&&qp()&&(X=$),ue++;return X?{_transport:G,_isSync:we,sendPOST:X}:null}H._getDbgPlgTargets=function(){return[g[0],a,D,g]};function ie(Q,we,G){var X=new XDomainRequest;X.open(xk,Q.urlString),Q.timeout&&(X.timeout=Q.timeout),X.onload=function(){var ue=H5(X);q(we,200,{},ue),j(ue)},X.onerror=function(){q(we,400,{})},X.ontimeout=function(){q(we,500,{})},X.onprogress=function(){},G?X.send(Q.data):o.set(function(){X.send(Q.data)},0)}function ce(Q,we,G){var X,ue=Q.urlString,_e=!1,xe=!1,ee=(X={body:Q.data,method:xk},X[S5]=!0,X);G&&(ee.keepalive=!0,Q._sendReason===2&&(_e=!0,T&&(ue+=B5))),Y&&(ee.credentials="include"),Q.headers&&So(Q.headers).length>0&&(ee.headers=Q.headers),fetch(ue,ee).then(function(se){var ae={},Ie=cl,Pe=se.headers;Pe&&Pe.forEach(function(Ne,vt){ae[vt]=Ne}),se.body&&se.text().then(function(Ne){Ie=Ne}),xe||(xe=!0,q(we,se.status,ae,Ie),j(Ie))}).catch(function(se){xe||(xe=!0,q(we,0,{}))}),_e&&!xe&&(xe=!0,q(we,200,{})),!xe&&Q.timeout>0&&o.set(function(){xe||(xe=!0,q(we,500,{}))},Q.timeout)}function be(Q,we,G){var X=Q.urlString;function ue(se,ae,Ie){if(!se[Ie]&&ae&&ae.getResponseHeader){var Pe=ae.getResponseHeader(Ie);Pe&&(se[Ie]=Vr(Pe))}return se}function _e(se){var ae={};return se.getAllResponseHeaders?ae=_(se.getAllResponseHeaders()):(ae=ue(ae,se,QF),ae=ue(ae,se,zF),ae=ue(ae,se,P5)),ae}function xe(se,ae){q(we,se.status,_e(se),ae)}G&&Q.disableXhrSync&&(G=!1);var ee=Ek(xk,X,Y,!0,G,Q.timeout);Wr(Q.headers,function(se,ae){ee.setRequestHeader(se,ae)}),ee.onload=function(){var se=H5(ee);xe(ee,se),j(se)},ee.onerror=function(){xe(ee)},ee.ontimeout=function(){xe(ee)},ee.send(Q.data)}function q(Q,we,G,X){try{Q(we,G,X)}catch(ue){Gr(m,2,518,Zr(ue))}}function $(Q,we,G){var X=Q,ue=200,_e=X._thePayload,xe=Q.urlString+(T?B5:cl);try{var ee=Ps();if(!ee.sendBeacon(xe,Q.data))if(_e){var se=[];We(_e.batches,function(ae){if(se&&ae&&ae.count()>0){for(var Ie=ae.events(),Pe=0;Pe<Ie.length;Pe++)if(!ee.sendBeacon(xe,D.getEventBlob(Ie[Pe]))){se.push(ae.split(Pe));break}}else se.push(ae.split(0))}),me(se,8003,_e.sendType,!0)}else ue=0}catch(ae){tl(m,"Failed to send telemetry using sendBeacon API. Ex:"+Zr(ae)),ue=0}finally{q(we,ue,{},cl)}}function de(Q){return Q===2||Q===3}function pe(Q){return B&&de(Q)&&(Q=2),Q}H.addQueryStringParameter=function(Q,we){for(var G=0;G<k.length;G++)if(k[G].name===Q){k[G].value=we;return}k.push({name:Q,value:we})},H.addHeader=function(Q,we){R[Q]=we},H.canSendRequest=function(){return ye()&&u.allowRequestSending()},H.sendQueuedRequests=function(Q,we){cr(Q)&&(Q=0),B&&(Q=pe(Q),we=2),fe(P,Q,0)&&Te(z(),0,!1,Q,we||0)},H.isCompletelyIdle=function(){return!l&&d===0&&P.length===0},H.setUnloading=function(Q){B=Q},H.addBatch=function(Q){if(Q&&Q.count()>0){if(a.isTenantKilled(Q.iKey()))return!1;P.push(Q)}return!0},H.teardown=function(){P.length>0&&Te(z(),0,!0,2,2)},H.pause=function(){l=!0},H.resume=function(){l=!1,H.sendQueuedRequests(0,4)},H.sendSynchronousBatch=function(Q,we,G){Q&&Q.count()>0&&(Ct(we)&&(we=1),B&&(we=pe(we),G=2),Te([Q],0,!1,we,G||0))};function ye(){return!l&&d<t}function z(){var Q=P;return P=[],Q}function fe(Q,we,G){var X=!1;return Q&&Q.length>0&&!l&&g[we]&&D&&(X=we!==0||ye()&&(G>0||u.allowRequestSending())),X}function Se(Q){var we={};return Q&&We(Q,function(G,X){we[X]={iKey:G.iKey(),evts:G.events()}}),we}function Te(Q,we,G,X,ue){if(!(!Q||Q.length===0)){if(l){me(Q,1,X);return}X=pe(X);try{var _e=Q,xe=X!==0;bn(b,function(){return"HttpManager:_sendBatches"},function(ee){ee&&(Q=Q.slice(0));for(var se=[],ae=null,Ie=Eo(),Pe=g[X]||(xe?g[1]:g[0]),Ne=Pe&&Pe._transport,vt=w&&(B||de(X)||Ne===3||Pe._isSync&&Ne===2);fe(Q,X,we);){var Yt=Q.shift();Yt&&Yt.count()>0&&(a.isTenantKilled(Yt.iKey())?se.push(Yt):(ae=ae||D.createPayload(we,G,xe,vt,ue,X),D.appendPayload(ae,Yt,e)?ae.overflow!==null&&(Q=[ae.overflow].concat(Q),ae.overflow=null,Ge(ae,Ie,Eo(),ue),Ie=Eo(),ae=null):(Ge(ae,Ie,Eo(),ue),Ie=Eo(),Q=[Yt].concat(Q),ae=null)))}ae&&Ge(ae,Ie,Eo(),ue),Q.length>0&&(P=Q.concat(P)),me(se,8004,X)},function(){return{batches:Se(_e),retryCount:we,isTeardown:G,isSynchronous:xe,sendReason:ue,useSendBeacon:de(X),sendType:X}},!xe)}catch(ee){Gr(m,2,48,"Unexpected Exception sending batch: "+Zr(ee))}}}function Le(Q,we){var G={url:s,hdrs:{},useHdrs:!1};we?(G.hdrs=tf(G.hdrs,R),G.useHdrs=So(G.hdrs).length>0):Wr(R,function(ee,se){oU[ee]?ob(G,oU[ee],se,!1):(G.hdrs[ee]=se,G.useHdrs=!0)}),ob(G,XF,"NO_AUTH",we),ob(G,Tk,od,we);var X=cl;We(Q.apiKeys,function(ee){X.length>0&&(X+=","),X+=ee}),ob(G,Rk,X,we),ob(G,Nk,Qn().toString(),we);var ue=F(Q);if(Un(ue)&&(G.url+="&ext.intweb.msfpc="+ue),u.shouldAddClockSkewHeaders()&&ob(G,kk,u.getClockSkewHeaderValue(),we),b.getWParam){var _e=b.getWParam();_e>=0&&(G.url+="&w="+_e)}for(var xe=0;xe<k.length;xe++)G.url+="&"+k[xe].name+"="+k[xe].value;return G}function $e(Q,we,G){Q[we]=Q[we]||{},Q[we][f.identifier]=G}function Ge(Q,we,G,X){if(Q&&Q.payloadBlob&&Q.payloadBlob.length>0){var ue=!!H.sendHook,_e=g[Q.sendType];!de(Q.sendType)&&Q.isBeacon&&Q.sendReason===2&&(_e=g[2]||g[3]||_e);var xe=N;(Q.isBeacon||_e._transport===3)&&(xe=!1);var ee=Le(Q,xe);xe=xe||ee.useHdrs;var se=Eo();bn(b,function(){return"HttpManager:_doPayloadSend"},function(){for(var ae=0;ae<Q.batches.length;ae++)for(var Ie=Q.batches[ae],Pe=Ie.events(),Ne=0;Ne<Pe.length;Ne++){var vt=Pe[Ne];if(K){var Yt=vt.timings=vt.timings||{};$e(Yt,"sendEventStart",se),$e(Yt,"serializationStart",we),$e(Yt,"serializationCompleted",G)}vt[nU]>0?vt[nU]++:vt[nU]=1}me(Q.batches,1e3+(X||0),Q.sendType,!0);var Fr={data:Q.payloadBlob,urlString:ee.url,headers:ee.hdrs,_thePayload:Q,_sendReason:X,timeout:O,disableXhrSync:h,disableFetchKeepAlive:y};xe&&(q5(Fr.headers,$F)||(Fr.headers[$F]=w5),q5(Fr.headers,Dk)||(Fr.headers[Dk]=YF));var Mm=null;_e&&(Mm=function(Wv){u.firstRequestSent();var Om=function(LE,dL){A(LE,dL,Q,X)},Ys=Q.isTeardown||Q.isSync;try{_e.sendPOST(Wv,Om,Ys),H.sendListener&&H.sendListener(Fr,Wv,Ys,Q.isBeacon)}catch(LE){tl(m,"Unexpected exception sending payload. Ex:"+Zr(LE)),q(Om,0,{})}}),bn(b,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(Mm)if(Q.sendType===0&&d++,ue&&!Q.isBeacon&&_e._transport!==3){var Wv={data:Fr.data,urlString:Fr.urlString,headers:tf({},Fr.headers),timeout:Fr.timeout,disableXhrSync:Fr.disableXhrSync,disableFetchKeepAlive:Fr.disableFetchKeepAlive},Om=!1;bn(b,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{H.sendHook(Wv,function(Ys){Om=!0,!v&&!Ys._thePayload&&(Ys._thePayload=Ys._thePayload||Fr._thePayload,Ys._sendReason=Ys._sendReason||Fr._sendReason),Mm(Ys)},Q.isSync||Q.isTeardown)}catch(Ys){Om||Mm(Fr)}})}else Mm(Fr)})},function(){return{thePayload:Q,serializationStart:we,serializationCompleted:G,sendReason:X}},Q.isSync)}Q.sizeExceed&&Q.sizeExceed.length>0&&me(Q.sizeExceed,8003,Q.sendType),Q.failedEvts&&Q.failedEvts.length>0&&me(Q.failedEvts,8002,Q.sendType)}function Bt(Q,we){K&&We(Q,function(G){var X=G.timings=G.timings||{};$e(X,"sendEventCompleted",we)})}function A(Q,we,G,X){var ue=9e3,_e=null,xe=!1,ee=!1;try{var se=!0;if(typeof Q!==$t){if(we){u.setClockSkew(we[QF]);var ae=we[zF]||we["kill-duration-seconds"];We(a.setKillSwitchTenants(we[x5],ae),function(Pe){We(G.batches,function(Ne){if(Ne.iKey()===Pe){_e=_e||[];var vt=Ne.split(0);G.numEvents-=vt.count(),_e.push(vt)}})})}if(Q==200||Q==204){ue=200;return}(!L5(Q)||G.numEvents<=0)&&(se=!1),ue=9e3+Q%1e3}if(se){ue=100;var Ie=G.retryCnt;G.sendType===0&&(Ie<n?(xe=!0,S(function(){G.sendType===0&&d--,Te(G.batches,Ie+1,G.isTeardown,B?2:G.sendType,5)},B,Mk(Ie))):(ee=!0,B&&(ue=8001)))}}finally{xe||(u.setClockSkew(),M(G,ue,X,ee)),me(_e,8004,G.sendType)}}function M(Q,we,G,X){try{X&&f._backOffTransmission(),we===200&&(!X&&!Q.isSync&&f._clearBackOff(),I(Q.batches)),me(Q.batches,we,Q.sendType,!0)}finally{Q.sendType===0&&(d--,G!==5&&H.sendQueuedRequests(Q.sendType,G))}}function I(Q){if(K){var we=Eo();We(Q,function(G){G&&G.count()>0&&Bt(G.events(),we)})}}function S(Q,we,G){we?Q():o.set(Q,G)}function _(Q){var we={};if(ln(Q)){var G=Vr(Q).split(/[\r\n]+/);We(G,function(X){if(X){var ue=X.indexOf(": ");if(ue!==-1){var _e=Vr(X.substring(0,ue)).toLowerCase(),xe=Vr(X.substring(ue+1));we[_e]=xe}else we[Vr(X)]=1}})}return we}function F(Q){for(var we=0;we<Q.batches.length;we++){var G=Q.batches[we].Msfpc();if(G)return encodeURIComponent(G)}return cl}function j(Q){var we=H._responseHandlers;try{for(var G=0;G<we.length;G++)try{we[G](Q)}catch(ue){Gr(m,1,519,"Response handler failed: "+ue)}if(Q){var X=JSON.parse(Q);Un(X.webResult)&&Un(X.webResult[nb])&&L.set("MSFPC",X.webResult[nb],365*86400)}}catch(ue){}}function me(Q,we,G,X){if(Q&&Q.length>0&&i){var ue=i[Fe(we)];if(ue){var _e=G!==0;bn(b,function(){return"HttpManager:_sendBatchesNotification"},function(){S(function(){try{ue.call(i,Q,we,_e,G)}catch(xe){Gr(m,1,74,"send request notification failed: "+xe)}},X||_e,0)},function(){return{batches:Se(Q),reason:we,isSync:_e,sendSync:X,sendType:G}},!_e)}}}function Fe(Q){var we=Tue[Q];return Un(we)||(we=C5,Q>=9e3&&Q<=9999?we=E5:Q>=8e3&&Q<=8999?we=Pk:Q>=1e3&&Q<=1999&&(we=_5)),we}})}return r.__ieDyn=1,r}()});function kue(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout(r,e,t)}function Nue(r){clearTimeout(r)}function sw(r,e){return{set:r||kue,clear:e||Nue}}var $5=ge(()=>{p()});var Rue,z5,Aue,Q5,X5,Mue,Z5,Oue,Ph,Lk,e3,t3,Lue,Kue,r3,n3=ge(()=>{p();ir();ur();Eh();JF();tU();Y5();ow();rU();$5();Rue=.25,z5=500,Aue=20,Q5=6,X5=2,Mue=4,Z5=2,Oue=1,Ph="eventsDiscarded",Lk="overrideInstrumentationKey",e3="maxEventRetryAttempts",t3="maxUnloadEventRetryAttempts",Lue="addUnloadCb",Kue=function(r){yn(e,r);function e(){var t=r.call(this)||this;t.identifier="PostChannel",t.priority=1011,t.version="3.2.9";var n,i=!1,o=[],s=null,a=!1,l=0,u=500,c=0,d=1e4,f={},m=Ch,g=null,b=null,v=0,k=0,R,P,D={},K,L,B=-1,N,O=!0,h=!1,y=Q5,w=X5,T,H;return He(e,t,function(Y,Z){ye(),Y._getDbgPlgTargets=function(){return[P]},Y.initialize=function(ee,se,ae){bn(se,function(){return"PostChannel:initialize"},function(){var Ie=se;Z.initialize(ee,se,ae);try{var Pe=!!se[Lue];T=Xu(nl(Y.identifier),se.evtNamespace&&se.evtNamespace());var Ne=Y._getTelCtx();ee.extensionConfig[Y.identifier]=ee.extensionConfig[Y.identifier]||{},n=Ne.getExtCfg(Y.identifier),H=sw(n.setTimeoutOverride,n.clearTimeoutOverride),O=!n.disableOptimizeObj&&_k(),ie(Ie),n.eventsLimitInMem>0&&(d=n.eventsLimitInMem),n.immediateEventLimit>0&&(u=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(K=n.autoFlushEventsLimit),qo(n[e3])&&(y=n[e3]),qo(n[t3])&&(w=n[t3]),xe(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(R=n.httpXHROverride),Un(ee.anonCookieName)&&P.addQueryStringParameter("anoncknm",ee.anonCookieName),P.sendHook=n.payloadPreprocessor,P.sendListener=n.payloadListener;var vt=n.overrideEndpointUrl?n.overrideEndpointUrl:ee.endpointUrl;Y._notificationManager=se.getNotifyMgr(),P.initialize(vt,Y.core,Y,R,n);var Yt=ee.disablePageUnloadEvents||[];hh(ce,Yt,T),Gy(ce,Yt,T),Yy(be,ee.disablePageShowEvents,T)}catch(Fr){throw Y.setInitialized(!1),Fr}},function(){return{coreConfig:ee,core:se,extensions:ae}})},Y.processTelemetry=function(ee,se){Ih(ee,Y.identifier),se=Y._getTelCtx(se);var ae=se.getExtCfg(Y.identifier),Ie=!!n.disableTelemetry;ae&&(Ie=Ie||!!ae.disableTelemetry);var Pe=ee;!Ie&&!i&&(n[Lk]&&(Pe.iKey=n[Lk]),ae&&ae[Lk]&&(Pe.iKey=ae[Lk]),q(Pe,!0),h?Se(2,2):pe()),Y.processNext(Pe,se)},Y._doTeardown=function(ee,se){Se(2,2),i=!0,P.teardown(),FC(null,T),UC(null,T),WC(null,T),ye()};function ie(ee){var se=ee.getWParam;ee.getWParam=function(){var ae=0;return n.ignoreMc1Ms0CookieProcessing&&(ae=ae|2),ae|se()}}function ce(ee){var se=ee||wc().event;se.type!=="beforeunload"&&(h=!0,P.setUnloading(h)),Se(2,2)}function be(ee){h=!1,P.setUnloading(h)}function q(ee,se){if(ee.sendAttempt||(ee.sendAttempt=0),ee.latency||(ee.latency=1),ee.ext&&ee.ext[eU]&&delete ee.ext[eU],ee.ext&&ee.ext[Ak]&&ee.ext[Ak].id&&delete ee.ext[Ak].id,O&&(Ih,ee.ext=Gu(ee.ext),ee.baseData&&(ee.baseData=Gu(ee.baseData)),ee.data&&(ee.data=Gu(ee.data))),ee.sync){if(v||a)ee.latency=3,ee.sync=!1;else if(P){O&&(ee=Gu(ee)),P.sendSynchronousBatch(ib.create(ee.iKey,[ee]),ee.sync===!0?1:ee.sync,3);return}}var ae=ee.latency,Ie=c,Pe=d;ae===4&&(Ie=l,Pe=u);var Ne=!1;if(Ie<Pe)Ne=!Ge(ee,se);else{var vt=1,Yt=Aue;ae===4&&(vt=4,Yt=1),Ne=!0,Bt(ee.iKey,ee.latency,vt,Yt)&&(Ne=!Ge(ee,se))}Ne&&Fe(Ph,[ee],Xa.QueueFull)}Y.setEventQueueLimits=function(ee,se){d=ee>0?ee:1e4,K=se>0?se:0,xe();var ae=c>ee;if(!ae&&L>0)for(var Ie=1;!ae&&Ie<=3;Ie++){var Pe=D[Ie];Pe&&Pe.batches&&We(Pe.batches,function(Ne){Ne&&Ne.count()>=L&&(ae=!0)})}$e(!0,ae)},Y.pause=function(){fe(),a=!0,P.pause()},Y.resume=function(){a=!1,P.resume(),pe()},Y.addResponseHandler=function(ee){P._responseHandlers.push(ee)},Y._loadTransmitProfiles=function(ee){_(),Wr(ee,function(se,ae){var Ie=ae.length;if(Ie>=2){var Pe=Ie>2?ae[2]:0;if(ae.splice(0,Ie-2),ae[1]<0&&(ae[0]=-1),ae[1]>0&&ae[0]>0){var Ne=ae[0]/ae[1];ae[0]=Math.ceil(Ne)*ae[1]}Pe>=0&&ae[1]>=0&&Pe>ae[1]&&(Pe=ae[1]),ae.push(Pe),f[se]=ae}})},Y.flush=function(ee,se,ae){if(ee===void 0&&(ee=!0),!a)if(ae=ae||1,ee)s==null?(fe(),M(1,0,ae),s=z(function(){s=null,I(se,ae)},0)):o.push(se);else{var Ie=fe();$(1,1,ae),se!=null&&se(),Ie&&pe()}},Y.setMsaAuthTicket=function(ee){P.addHeader(iw,ee)},Y.hasEvents=de,Y._setTransmitProfile=function(ee){m!==ee&&f[ee]!==void 0&&(fe(),m=ee,pe())};function $(ee,se,ae){var Ie=M(ee,se,ae);return P.sendQueuedRequests(se,ae),Ie}function de(){return c>0}function pe(){if(B>=0&&M(B,0,N)&&P.sendQueuedRequests(0,N),l>0&&!b&&!a){var ee=f[m][2];ee>=0&&(b=z(function(){b=null,$(4,0,1),pe()},ee))}var se=f[m][1];!g&&!s&&se>=0&&!a&&(de()?g=z(function(){g=null,$(k===0?3:1,0,1),k++,k%=2,pe()},se):k=0)}Y._backOffTransmission=function(){v<Mue&&(v++,fe(),pe())},Y._clearBackOff=function(){v&&(v=0,fe(),pe())};function ye(){n=null,i=!1,o=[],s=null,a=!1,l=0,u=500,c=0,d=1e4,f={},m=Ch,g=null,b=null,v=0,k=0,R=null,D={},K=void 0,L=0,B=-1,N=null,O=!0,h=!1,y=Q5,w=X5,T=null,H=sw(),P=new G5(z5,Z5,Oue,{requeue:j,send:we,sent:G,drop:X,rspFail:ue,oth:_e},H),F(),Te(),xe()}function z(ee,se){se===0&&v&&(se=1);var ae=1e3;return v&&(ae=Mk(v-1)),H.set(ee,se*ae)}function fe(){return g!==null?(H.clear(g),g=null,k=0,!0):!1}function Se(ee,se){fe(),s&&(H.clear(s),s=null),a||$(1,ee,se)}function Te(){D[4]={batches:[],iKeyMap:{}},D[3]={batches:[],iKeyMap:{}},D[2]={batches:[],iKeyMap:{}},D[1]={batches:[],iKeyMap:{}}}function Le(ee,se,ae){var Ie=D[se];Ie||(se=1,Ie=D[se]);var Pe=Ie.iKeyMap[ee];return!Pe&&ae&&(Pe=ib.create(ee),Ie.batches.push(Pe),Ie.iKeyMap[ee]=Pe),Pe}function $e(ee,se){P.canSendRequest()&&!v&&(K>0&&c>K&&(se=!0),se&&s==null&&Y.flush(ee,null,20))}function Ge(ee,se){O&&(ee=Gu(ee));var ae=ee.latency,Ie=Le(ee.iKey,ae,!0);return Ie.addEvent(ee)?(ae!==4?(c++,se&&ee.sendAttempt===0&&$e(!ee.sync,L>0&&Ie.count()>=L)):l++,!0):!1}function Bt(ee,se,ae,Ie){for(;ae<=se;){var Pe=Le(ee,se,!0);if(Pe&&Pe.count()>0){var Ne=Pe.split(0,Ie),vt=Ne.count();if(vt>0)return ae===4?l-=vt:c-=vt,Q(Ph,[Ne],Xa.QueueFull),!0}ae++}return A(),!1}function A(){for(var ee=0,se=0,ae=function(Pe){var Ne=D[Pe];Ne&&Ne.batches&&We(Ne.batches,function(vt){Pe===4?ee+=vt.count():se+=vt.count()})},Ie=1;Ie<=4;Ie++)ae(Ie);c=se,l=ee}function M(ee,se,ae){var Ie=!1,Pe=se===0;return!Pe||P.canSendRequest()?bn(Y.core,function(){return"PostChannel._queueBatches"},function(){for(var Ne=[],vt=4;vt>=ee;){var Yt=D[vt];Yt&&Yt.batches&&Yt.batches.length>0&&(We(Yt.batches,function(Fr){P.addBatch(Fr)?Ie=Ie||Fr&&Fr.count()>0:Ne=Ne.concat(Fr.events()),vt===4?l-=Fr.count():c-=Fr.count()}),Yt.batches=[],Yt.iKeyMap={}),vt--}Ne.length>0&&Fe(Ph,Ne,Xa.KillSwitch),Ie&&B>=ee&&(B=-1,N=0)},function(){return{latency:ee,sendType:se,sendReason:ae}},!Pe):(B=B>=0?Math.min(B,ee):ee,N=Math.max(N,ae)),Ie}function I(ee,se){$(1,0,se),A(),S(function(){ee&&ee(),o.length>0?s=z(function(){s=null,I(o.shift(),se)},0):(s=null,pe())})}function S(ee){P.isCompletelyIdle()?ee():s=z(function(){s=null,S(ee)},Rue)}function _(){fe(),F(),m=Ch,pe()}function F(){f={},f[Ch]=[2,1,0],f[Ck]=[6,3,0],f[wk]=[18,9,0]}function j(ee,se){var ae=[],Ie=y;h&&(Ie=w),We(ee,function(Pe){Pe&&Pe.count()>0&&We(Pe.events(),function(Ne){Ne&&(Ne.sync&&(Ne.latency=4,Ne.sync=!1),Ne.sendAttempt<Ie?(Ih(Ne,Y.identifier),q(Ne,!1)):ae.push(Ne))})}),ae.length>0&&Fe(Ph,ae,Xa.NonRetryableStatus),h&&Se(2,2)}function me(ee,se){var ae=Y._notificationManager||{},Ie=ae[ee];if(Ie)try{Ie.apply(ae,se)}catch(Pe){Gr(Y.diagLog(),1,74,ee+" notification failed: "+Pe)}}function Fe(ee,se){for(var ae=[],Ie=2;Ie<arguments.length;Ie++)ae[Ie-2]=arguments[Ie];se&&se.length>0&&me(ee,[se].concat(ae))}function Q(ee,se){for(var ae=[],Ie=2;Ie<arguments.length;Ie++)ae[Ie-2]=arguments[Ie];se&&se.length>0&&We(se,function(Pe){Pe&&Pe.count()>0&&me(ee,[Pe.events()].concat(ae))})}function we(ee,se,ae){ee&&ee.length>0&&me("eventsSendRequest",[se>=1e3&&se<=1999?se-1e3:0,ae!==!0])}function G(ee,se){Q("eventsSent",ee,se),pe()}function X(ee,se){Q(Ph,ee,se>=8e3&&se<=8999?se-8e3:Xa.Unknown)}function ue(ee){Q(Ph,ee,Xa.NonRetryableStatus),pe()}function _e(ee,se){Q(Ph,ee,Xa.Unknown),pe()}function xe(){!n||!n.disableAutoBatchFlushLimit?L=Math.max(z5*(Z5+1),d/6):L=0}xs(Y,"_setTimeoutOverride",function(){return H.set},function(ee){H=sw(ee,H.clear)}),xs(Y,"_clearTimeoutOverride",function(){return H.clear},function(ee){H=sw(H.set,ee)})}),t}return e.__ieDyn=1,e}(vh),r3=Kue});var i3={};Vv(i3,{BE_PROFILE:()=>wk,NRT_PROFILE:()=>Ck,PostChannel:()=>r3,RT_PROFILE:()=>Ch});var o3=ge(()=>{p();n3();JF()});var Fue,s3,a3=ge(()=>{p();Fue=async(r,e,t)=>{let n=await Promise.resolve().then(()=>(Eh(),I5)),i=await Promise.resolve().then(()=>(o3(),i3)),o=new n.AppInsightsCore,s=new i.PostChannel,a={instrumentationKey:r,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[s]]};if(t){a.extensionConfig={};let c={alwaysUseXhrOverride:!0,httpXHROverride:t};a.extensionConfig[s.identifier]=c}let u=e.workspace.getConfiguration("telemetry").get("internalTesting");return o.initialize(a,[]),o.addTelemetryInitializer(c=>{var d,f;u&&(c.ext=(d=c.ext)!=null?d:{},c.ext.utc=(f=c.ext.utc)!=null?f:{},c.ext.utc.flags=8462029)}),o},s3=async(r,e,t)=>{let n=await Fue(r,e,t);return{logEvent:(o,s)=>{try{n==null||n.track({name:o,baseData:{name:o,properties:s==null?void 0:s.properties,measurements:s==null?void 0:s.measurements}})}catch(a){throw new Error(`Failed to log event to app insights!
`+a.message)}},flush:async()=>{try{n==null||n.unload()}catch(o){throw new Error(`Failed to flush app insights!
`+o.message)}}}}});var sd,Kk,l3=ge(()=>{p();(function(r){r[r.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",r[r.INSTANTIATING=1]="INSTANTIATING",r[r.INSTANTIATED=2]="INSTANTIATED"})(sd||(sd={}));Kk=class{constructor(e,t){this._instantiationStatus=sd.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=t,this._key=e}sendEventData(e,t){if(!this._telemetryClient){this._instantiationStatus!==sd.INSTANTIATED&&this._eventQueue.push({eventName:e,data:t});return}this._telemetryClient.logEvent(e,t)}sendErrorData(e,t){if(!this._telemetryClient){this._instantiationStatus!==sd.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:t});return}}async flush(){this._telemetryClient&&(await this._telemetryClient.flush(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach(({eventName:e,data:t})=>this.sendEventData(e,t)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:e,data:t})=>this.sendErrorData(e,t)),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===sd.NOT_INSTANTIATED&&(this._instantiationStatus=sd.INSTANTIATING,this._clientFactory(this._key).then(e=>{this._telemetryClient=e,this._instantiationStatus=sd.INSTANTIATED,this._flushQueues()}).catch(e=>{console.error(e),this._instantiationStatus=sd.INSTANTIATED}))}}});var Fk,c3=ge(()=>{p();Fk=class{constructor(e,t,n){this.telemetrySender=e,this.vscodeAPI=t,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,n),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates(()=>{this.updateUserOptIn()})}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logUsage(e,{properties:t,measurements:n})}sendTelemetryEvent(e,t,n){this.internalSendTelemetryEvent(e,t,n,!1)}sendDangerousTelemetryEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,t,n,!0)}internalSendTelemetryErrorEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryErrorEvent(e,t,n){this.internalSendTelemetryErrorEvent(e,t,n,!1)}sendDangerousTelemetryErrorEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,t,n,!0)}internalSendTelemetryException(e,t,n,i){i?this.telemetrySender.sendErrorData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryException(e,t,n){this.internalSendTelemetryException(e,t,n,!1)}sendDangerousTelemetryException(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryException(e,t,n,!0)}dispose(){return this.telemetryLogger.dispose(),Promise.all(this.disposables.map(e=>e.dispose()))}}});var sb,u3=ge(()=>{p();sb=class r{static applyReplacements(e,t){for(let n of Object.keys(e))for(let i of t)i.lookup.test(n)&&(i.replacementString!==void 0?e[n]=i.replacementString:delete e[n])}static shouldUseOneDataSystemSDK(e){return e.length===74&&e[32]==="-"&&e[41]==="-"&&e[46]==="-"&&e[51]==="-"&&e[56]==="-"&&e[69]==="-"}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.7.7"}}static getInstance(){return r._instance||(r._instance=new r),r._instance}}});var Uk,ab,ad,Wk,lb,sU,aw,aU,d3,ca,Vk=ge(()=>{p();Uk="name",ab="push",ad="length",Wk="messageId",lb="message",sU="diagLog",aw="replace",aU="enableDebugExceptions",d3="logInternalMessage",ca="call"});var ul,jk,Bk,Hk=ge(()=>{p();ul="",jk="errorToConsole",Bk="warnToConsole"});function qk(r){return r===void 0||typeof r===$t}function Dh(r){return r===null||qk(r)}function Th(r){return!!(r&&typeof r===dt)}function lw(r){return!!(r&&typeof r===Xr)}function Pc(r,e){if(r)for(var t in r)nr[ca](r,t)&&e[ca](r,t,r[t])}function Gue(r){return!!(r&&b3[ca](r)==="[object Array]")}function cw(r){return!!(r&&b3[ca](r)==="[object Error]")}function zo(r){return typeof r=="string"}function Jk(r){if(r)return Hue?r[v3]():Yue(r)}function Yue(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[ad]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function uw(r,e,t){var n=r[ad];try{for(var i=0;i<n&&!(i in r&&e[ca](t||r,r[i],i,r)===-1);i++);}catch(o){}}function pU(r,e,t){if(r){if(r[p3])return r[p3](e,t);var n=r[ad],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function Nh(r,e,t){var n;if(r){if(r[f3])return r[f3](e,t);var i=r[ad],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[ca](o,r[s],r))}catch(a){}}return n}function fU(r,e,t){var n;if(r){if(r[m3])return r[m3](e,t);var i=r[ad],o=0;if(arguments[ad]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function dl(r){return r&&(r=jue&&r[cU]?r[cU]():r[aw]?r[aw](/^\s+|(?=\s)\s+$/g,ul):r),r}function mU(r){var e=typeof r;if(e!==Xr&&(e!==dt||r===null)&&na("objKeys called on non-object"),!g3&&h3)return h3(r);var t=[];for(var n in r)r&&nr[ca](r,n)&&t[ab](n);if(g3)for(var i=lU[ad],o=0;o<i;o++)r&&nr[ca](r,lU[o])&&t[ab](lU[o]);return t}function $ue(r){return r}function Gk(r){return uU&&Pc(r,function(e,t){(kh(t)||Th(t))&&uU(t)}),I3(r)}function dw(r){return cw(r)?r[Uk]:ul}function pw(r,e){return Dh(r)?e:r}function hU(r){return function(){function e(){var t=this;r&&Pc(r,function(n,i){t[n]=i})}return e}()}var v3,Wue,Vue,p3,f3,m3,cU,y3,uU,NFe,h3,dU,jue,RFe,AFe,Bue,Hue,que,b3,Jue,MFe,kh,g3,lU,I3,Yk=ge(()=>{p();ir();Vk();Hk();v3="toISOString",Wue="endsWith",Vue="startsWith",p3="indexOf",f3="map",m3="reduce",cU="trim",y3="toString",uU=Er.freeze,NFe=Er.seal,h3=Er.keys,dU=String[Mt],jue=dU[cU],RFe=dU[Wue],AFe=dU[Vue],Bue=Date[Mt],Hue=Bue[v3],que=Array.isArray,b3=ra[y3],Jue=nr[y3],MFe=Jue[ca](Er);kh=que||Gue;g3=!{toString:null}.propertyIsEnumerable("toString"),lU=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];I3=uU||$ue});function cb(r){var e={};return Pc(r,function(t,n){e[t]=n,e[n]=t}),Gk(e)}function gU(r){var e={};return Pc(r,function(t,n){e[t]=n[1],e[n[0]]=n[1]}),Gk(e)}var S3=ge(()=>{p();Yk()});function ld(r){var e=Kn();return e&&e[r]?e[r]:r===zue&&E3()?window:null}function E3(){return!!(typeof window===dt&&window)}function C3(){return!!(typeof document===dt&&document)}function vU(){return C3()?document:ld(Que)}function yU(){return typeof console!==$t?console:ld(Xue)}function Rh(){return!!(typeof JSON===dt&&JSON||ld(_3)!==null)}function ub(){return Rh()?JSON||ld(_3):null}function Ah(r){var e=Object[Mt].toString[ca](r),t=ul;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Uk]+"'":Rh()&&(t=ub().stringify(r)),e+t}var zue,Que,Xue,_3,$k=ge(()=>{"use strict";p();ir();Vk();Hk();zue="window",Que="document",Xue="console",_3="JSON"});function Zue(){var r=ld("Microsoft");return r&&(zk=r.ApplicationInsights),zk}function w3(r){var e=zk;return!e&&r.disableDbgExt!==!0&&(e=zk||Zue()),e?e.ChromeDbgExt:null}var zk,x3=ge(()=>{p();$k();zk=null});function P3(r){return r?'"'+r[aw](/\"/g,ul)+'"':ul}function D3(r,e){var t=yU();if(t){var n="log";t[r]&&(n=r),lw(t[n])&&t[n](e)}}function nde(r){return r||new T3}function pl(r,e,t,n,i,o){o===void 0&&(o=!1),nde(r).throwInternal(e,t,n,i,o)}var ede,tde,rde,bU,T3,k3=ge(()=>{"use strict";p();ur();Vk();x3();$k();Yk();Hk();ede="AI (Internal): ",tde="AI: ",rde="AITR_";bU=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Wk]=e,o[lb]=(n?tde:ede)+e;var s=ul;Rh()&&(s=ub().stringify(i));var a=(t?" message:"+P3(t):ul)+(i?" props:"+P3(s):ul);o[lb]+=a}return r.dataType="MessageData",r}(),T3=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[aU]=function(){return a},l.throwInternal=function(m,g,b,v,k){k===void 0&&(k=!1);var R=new bU(g,b,k,v);if(a)throw Ah(R);var P=m===1?jk:Bk;if(qk(R[lb]))f("throw"+(m===1?"Critical":"Warning"),R);else{if(k){var D=+R[Wk];!n[D]&&i>=m&&(l[P](R[lb]),n[D]=!0)}else i>=m&&l[P](R[lb]);u(m,R)}},l[Bk]=function(m){D3("warn",m),f("warning",m)},l[jk]=function(m){D3("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[d3]=u;function u(m,g){if(!d()){var b=!0,v=rde+g[Wk];if(n[v]?b=!1:n[v]=!0,b&&(m<=o&&(l.queue[ab](g),t++,f(m===1?"error":"warn",g)),t===s)){var k="Internal events throttle limit per PageView reached for this app.",R=new bU(23,k,!1);l.queue[ab](R),m===1?l[jk](k):l[Bk](k)}}}function c(m){i=pw(m.loggingLevelConsole,0),o=pw(m.loggingLevelTelemetry,1),s=pw(m.maxMessageLimit,25),a=pw(m[aU],!1)}function d(){return t>=s}function f(m,g){var b=w3(e||{});b&&b[sU]&&b[sU](m,g)}})}return r.__ieDyn=1,r}()});var ua=ge(()=>{p();Yk();S3();$k();ir();k3()});var fw,mw,hw,Qk,Mh,cd,Ti,fl=ge(()=>{p();fw="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",mw="sampleRate",hw="ProcessLegacy",Qk="http.method",Mh="https://dc.services.visualstudio.com",cd="/v2/track",Ti="not_specified"});var Oh,At,Lh,gw,ml,N3,Hi,ud,R3,vw,yw,Xk,Kh,da,qi,Ji,Fh,Dc,Uh,Zk,e0,IU,Wh,bw,Iw,Vh,db,pb,jh,SU,Bh,A3,M3,O3,L3,Co=ge(()=>{p();Oh="split",At="length",Lh="toLowerCase",gw="ingestionendpoint",ml="toString",N3="removeItem",Hi="name",ud="message",R3="count",vw="stringify",yw="pathname",Xk="indexOf",Kh="exceptions",da="parsedStack",qi="properties",Ji="measurements",Fh="sizeInBytes",Dc="typeName",Uh="severityLevel",Zk="problemGroup",e0="isManual",IU="CreateFromInterface",Wh="assembly",bw="hasFullStack",Iw="level",Vh="method",db="fileName",pb="line",jh="duration",SU="receivedResponse",Bh="substring",A3="sanitizeKeyAndAddUniqueness",M3="sanitizeException",O3="sanitizeProperties",L3="sanitizeMeasurements"});function t0(r){(isNaN(r)||r<0)&&(r=0),r=Math.round(r);var e=Sw+r%1e3,t=Sw+Math.floor(r/1e3)%60,n=Sw+Math.floor(r/(1e3*60))%60,i=Sw+Math.floor(r/(1e3*60*60))%24,o=Math.floor(r/(1e3*60*60*24));return e=e[At]===1?"00"+e:e[At]===2?"0"+e:e,t=t[At]<2?"0"+t:t,n=n[At]<2?"0"+n:n,i=i[At]<2?"0"+i:i,(o>0?o+".":Sw)+i+":"+n+":"+t+"."+e}var Sw,_U=ge(()=>{p();Co();Sw=""});var fb,K3=ge(()=>{p();ua();fb=gU({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})});var r0,hWe,F3=ge(()=>{p();ua();r0=cb({LocalStorage:0,SessionStorage:1}),hWe=cb({AI:0,AI_AND_W3C:1,W3C:2})});function U3(r){try{if(Dh(Kn()))return null;var e=new Date()[ml](),t=ld(r===r0.LocalStorage?"localStorage":"sessionStorage");t.setItem(e,e);var n=t.getItem(e)!==e;if(t[N3](e),!n)return t}catch(i){}return null}function W3(){return n0()?U3(r0.SessionStorage):null}function n0(r){return(r||_w===void 0)&&(_w=!!U3(r0.SessionStorage)),_w}function EU(r,e){var t=W3();if(t!==null)try{return t.getItem(e)}catch(n){_w=!1,pl(r,2,2,"Browser failed read of session storage. "+dw(n),{exception:Ah(n)})}return null}function i0(r,e,t){var n=W3();if(n!==null)try{return n.setItem(e,t),!0}catch(i){_w=!1,pl(r,2,4,"Browser failed write to session storage. "+dw(i),{exception:Ah(i)})}return!1}var _w,V3=ge(()=>{p();ua();F3();Co();_w=void 0});function o0(r,e,t){var n=e[At],i=CU(r,e);if(i[At]!==n){for(var o=0,s=i;t[s]!==void 0;)o++,s=i[Bh](0,150-3)+wU(o);i=s}return i}function CU(r,e){var t;return e&&(e=dl(e[ml]()),e[At]>150&&(t=e[Bh](0,150),pl(r,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),t||e}function Yr(r,e,t){t===void 0&&(t=1024);var n;return e&&(t=t||1024,e=dl(e),e.toString()[At]>t&&(n=e[ml]()[Bh](0,t),pl(r,2,61,"string value is too long. It has been truncated to "+t+" characters.",{value:e},!0))),n||e}function nf(r,e){return l0(r,e,2048,66)}function mb(r,e){var t;return e&&e[At]>32768&&(t=e[Bh](0,32768),pl(r,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),t||e}function s0(r,e){var t;if(e){var n=""+e;n[At]>32768&&(t=n[Bh](0,32768),pl(r,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return t||e}function Gi(r,e){if(e){var t={};Pc(e,function(n,i){if(Th(i)&&Rh())try{i=ub()[vw](i)}catch(o){pl(r,2,49,"custom property is not valid",{exception:o},!0)}i=Yr(r,i,8192),n=o0(r,n,t),t[n]=i}),e=t}return e}function Yi(r,e){if(e){var t={};Pc(e,function(n,i){n=o0(r,n,t),t[n]=i}),e=t}return e}function a0(r,e){return e&&l0(r,e,128,69)[ml]()}function l0(r,e,t,n){var i;return e&&(e=dl(e),e[At]>t&&(i=e[Bh](0,t),pl(r,2,n,"input is too long, it has been truncated to "+t+" characters.",{data:e},!0))),i||e}function wU(r){var e="00"+r;return e.substr(e[At]-3)}var Qo,cde,hl=ge(()=>{p();ua();Co();cde=(Qo={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768},Qo[A3]=o0,Qo.sanitizeKey=CU,Qo.sanitizeString=Yr,Qo.sanitizeUrl=nf,Qo.sanitizeMessage=mb,Qo[M3]=s0,Qo[O3]=Gi,Qo[L3]=Yi,Qo.sanitizeId=a0,Qo.sanitizeInput=l0,Qo.padNumber=wU,Qo.trim=dl,Qo)});function H3(r){var e=B3,t=ude,n=t[e];return j3.createElement?t[e]||(n=t[e]=j3.createElement("a")):n={host:q3(r,!0)},n.href=r,e++,e>=t[At]&&(e=0),B3=e,n}function q3(r,e){var t=J3(r,e)||"";if(t){var n=t.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[At]>3&&zo(n[2])&&n[2][At]>0)return n[2]+(n[3]||"")}return t}function J3(r,e){var t=null;if(r){var n=r.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[At]>2&&zo(n[2])&&n[2][At]>0&&(t=n[2]||"",e&&n[At]>2)){var i=(n[1]||"")[Lh](),o=n[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),t+=o}}return t}var j3,B3,ude,G3=ge(()=>{p();ua();Co();j3=vU()||{},B3=0,ude=[null,null,null,null,null]});function Ew(r){return pU(dde,r[Lh]())!==-1}function Y3(r,e,t,n){var i,o=n,s=n;if(e&&e[At]>0){var a=H3(e);if(i=a.host,!o)if(a[yw]!=null){var l=a.pathname[At]===0?"/":a[yw];l.charAt(0)!=="/"&&(l="/"+l),s=a[yw],o=Yr(r,t?t+" "+l:l)}else o=Yr(r,e)}else i=n,o=n;return{target:i,name:o,data:s}}var dde,xU=ge(()=>{p();ua();fl();hl();G3();Co();dde=[Mh+cd,"https://breeze.aimon.applicationinsights.io"+cd,"https://dc-int.services.visualstudio.com"+cd]});function PU(r){if(!r)return{};var e=r[Oh](pde),t=fU(e,function(i,o){var s=o[Oh](fde);if(s[At]===2){var a=s[0][Lh](),l=s[1];i[a]=l}return i},{});if(mU(t)[At]>0){if(t.endpointsuffix){var n=t.location?t.location+".":"";t[gw]=t[gw]||"https://"+n+"dc."+t.endpointsuffix}t[gw]=t[gw]||Mh}return t}var pde,fde,$3=ge(()=>{p();ua();fl();Co();pde=";",fde="="});var DU,z3=ge(()=>{p();ua();fl();Co();hl();DU=function(){function r(e,t,n){var i=this,o=this;o.ver=1,o.sampleRate=100,o.tags={},o[Hi]=Yr(e,n)||Ti,o.data=t,o.time=Jk(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return i.sampleRate===100?4:1},tags:1,data:1}}return r}()});var dd,Q3=ge(()=>{p();fl();Co();hl();dd=function(){function r(e,t,n,i){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var o=this;o.ver=2,o[Hi]=Yr(e,t)||Ti,o[qi]=Gi(e,n),o[Ji]=Yi(e,i)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Event",r.dataType="EventData",r}()});function RU(r,e){var t=r;return t&&!zo(t)&&(JSON&&JSON[vw]?(t=JSON[vw](r),e&&(!t||t==="{}")&&(lw(r[ml])?t=r[ml]():t=""+r)):t=""+r+" - (Missing JSON.stringify)"),t||""}function rq(r,e){var t=r;return r&&(t&&!zo(t)&&(t=r[NU]||r[tq]||t),t&&!zo(t)&&(t=RU(t,!0)),r.filename&&(t=t+" @"+(r.filename||"")+":"+(r.lineno||"?")+":"+(r.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(t||"")[Xk](e)===-1&&(t=e+": "+t),t||""}function hde(r){try{if(Th(r))return"hasFullStack"in r&&"typeName"in r}catch(e){}return!1}function gde(r){try{if(Th(r))return"ver"in r&&"exceptions"in r&&"properties"in r}catch(e){}return!1}function Z3(r){return r&&r.src&&zo(r.src)&&r.obj&&kh(r.obj)}function Hh(r){var e=r||"";zo(e)||(zo(e[Xo])?e=e[Xo]:e=""+e);var t=e[Oh](`
`);return{src:e,obj:t}}function vde(r){for(var e=[],t=r[Oh](`
`),n=0;n<t[At];n++){var i=t[n];t[n+1]&&(i+="@"+t[n+1],n++),e.push(i)}return{src:r,obj:e}}function nq(r){var e=null;if(r)try{if(r[Xo])e=Hh(r[Xo]);else if(r[hb]&&r[hb][Xo])e=Hh(r[hb][Xo]);else if(r.exception&&r.exception[Xo])e=Hh(r.exception[Xo]);else if(Z3(r))e=r;else if(Z3(r[kU]))e=r[kU];else if(window&&window.opera&&r[NU])e=vde(r[ud]);else if(r.reason&&r.reason[Xo])e=Hh(r.reason[Xo]);else if(zo(r))e=Hh(r);else{var t=r[NU]||r[tq]||"";zo(r[X3])&&(t&&(t+=`
`),t+=" from "+r[X3]),t&&(e=Hh(t))}}catch(n){e=Hh(n)}return e||{src:"",obj:null}}function yde(r){var e="";return r&&(r.obj?uw(r.obj,function(t){e+=t+`
`}):e=r.src||""),e}function bde(r){var e,t=r.obj;if(t&&t[At]>0){e=[];var n=0,i=0;uw(t,function(g){var b=g[ml]();if(AU.regex.test(b)){var v=new AU(b,n++);i+=v[Fh],e.push(v)}});var o=32*1024;if(i>o)for(var s=0,a=e[At]-1,l=0,u=s,c=a;s<a;){var d=e[s][Fh],f=e[a][Fh];if(l+=d+f,l>o){var m=c-u+1;e.splice(u,m);break}u=s,c=a,s++,a--}}return e}function c0(r){var e="";if(r&&(e=r.typeName||r[Hi]||"",!e))try{var t=/function (.{1,200})\(/,n=t.exec(r.constructor[ml]());e=n&&n[At]>1?n[1]:""}catch(i){}return e}function TU(r){if(r)try{if(!zo(r)){var e=c0(r),t=RU(r,!1);return(!t||t==="{}")&&(r[hb]&&(r=r[hb],e=c0(r)),t=RU(r,!0)),t[Xk](e)!==0&&e!=="String"?e+":"+t:t}}catch(n){}return""+(r||"")}var mde,hb,Xo,kU,X3,NU,tq,qh,eq,AU,iq=ge(()=>{p();ir();ua();fl();Co();hl();mde="<no_method>",hb="error",Xo="stack",kU="stackDetails",X3="errorSrc",NU="message",tq="description";qh=function(){function r(e,t,n,i,o,s){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var a=this;a.ver=2,gde(t)?(a[Kh]=t[Kh]||[],a[qi]=t[qi],a[Ji]=t[Ji],t[Uh]&&(a[Uh]=t[Uh]),t.id&&(a.id=t.id),t[Zk]&&(a[Zk]=t[Zk]),Dh(t[e0])||(a[e0]=t[e0])):(n||(n={}),a[Kh]=[new eq(e,t,n)],a[qi]=Gi(e,n),a[Ji]=Yi(e,i),o&&(a[Uh]=o),s&&(a.id=s))}return r.CreateAutoException=function(e,t,n,i,o,s,a,l){var u,c=c0(o||s||e);return u={},u[ud]=rq(e,c),u.url=t,u.lineNumber=n,u.columnNumber=i,u.error=TU(o||s||e),u.evt=TU(s||e),u[Dc]=c,u.stackDetails=nq(a||o||s),u.errorSrc=l,u},r.CreateFromInterface=function(e,t,n,i){var o=t[Kh]&&Nh(t[Kh],function(a){return eq[IU](e,a)}),s=new r(e,Io(Io({},t),{exceptions:o}),n,i);return s},r.prototype.toInterface=function(){var e,t=this,n=t.exceptions,i=t.properties,o=t.measurements,s=t.severityLevel,a=t.problemGroup,l=t.id,u=t.isManual,c=n instanceof Array&&Nh(n,function(d){return d.toInterface()})||void 0;return e={ver:"4.0"},e[Kh]=c,e.severityLevel=s,e.properties=i,e.measurements=o,e.problemGroup=a,e.id=l,e.isManual=u,e},r.CreateSimpleException=function(e,t,n,i,o,s){var a;return{exceptions:[(a={},a[bw]=!0,a.message=e,a.stack=o,a.typeName=t,a)]}},r.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",r.dataType="ExceptionData",r.formatError=TU,r}(),eq=function(){function r(e,t,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var i=this;if(hde(t))i[Dc]=t[Dc],i[ud]=t[ud],i[Xo]=t[Xo],i[da]=t[da]||[],i[bw]=t[bw];else{var o=t,s=o&&o.evt;cw(o)||(o=o[hb]||s||o),i[Dc]=Yr(e,c0(o))||Ti,i[ud]=mb(e,rq(t||o,i[Dc]))||Ti;var a=t[kU]||nq(t);i[da]=bde(a),kh(i[da])&&Nh(i[da],function(l){return l[Wh]=Yr(e,l[Wh])}),i[Xo]=s0(e,yde(a)),i.hasFullStack=kh(i.parsedStack)&&i.parsedStack[At]>0,n&&(n[Dc]=n[Dc]||i[Dc])}}return r.prototype.toInterface=function(){var e,t=this,n=t[da]instanceof Array&&Nh(t[da],function(o){return o.toInterface()}),i=(e={id:t.id,outerId:t.outerId,typeName:t[Dc],message:t[ud],hasFullStack:t[bw],stack:t[Xo]},e[da]=n||void 0,e);return i},r.CreateFromInterface=function(e,t){var n=t[da]instanceof Array&&Nh(t[da],function(o){return AU[IU](o)})||t[da],i=new r(e,Io(Io({},t),{parsedStack:n}));return i},r}(),AU=function(){function r(e,t){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[Fh]=0,typeof e=="string"){var i=e;n[Iw]=t,n[Vh]=mde,n[Wh]=dl(i),n[db]="",n[pb]=0;var o=i.match(r.regex);o&&o[At]>=5&&(n[Vh]=dl(o[2])||n[Vh],n[db]=dl(o[4]),n[pb]=parseInt(o[5])||0)}else n[Iw]=e[Iw],n[Vh]=e[Vh],n[Wh]=e[Wh],n[db]=e[db],n[pb]=e[pb],n[Fh]=0;n.sizeInBytes+=n.method[At],n.sizeInBytes+=n.fileName[At],n.sizeInBytes+=n.assembly[At],n[Fh]+=r.baseSize,n.sizeInBytes+=n.level.toString()[At],n.sizeInBytes+=n.line.toString()[At]}return r.CreateFromInterface=function(e){return new r(e,null)},r.prototype.toInterface=function(){var e=this;return{level:e[Iw],method:e[Vh],assembly:e[Wh],fileName:e[db],line:e[pb]}},r.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,r.baseSize=58,r}()});var oq,sq=ge(()=>{p();oq=function(){function r(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return r}()});var pd,aq=ge(()=>{p();fl();Co();sq();hl();pd=function(){function r(e,t,n,i,o,s,a,l,u){this.aiDataContract={ver:1,metrics:1,properties:0};var c=this;c.ver=2;var d=new oq;d[R3]=i>0?i:void 0,d.max=isNaN(s)||s===null?void 0:s,d.min=isNaN(o)||o===null?void 0:o,d[Hi]=Yr(e,t)||Ti,d.value=n,d.stdDev=isNaN(a)||a===null?void 0:a,c.metrics=[d],c[qi]=Gi(e,l),c[Ji]=Yi(e,u)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",r.dataType="MetricData",r}()});var Jh,lq=ge(()=>{p();fl();_U();Co();hl();Jh=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var l=this;l.ver=2,l.id=a0(e,a),l.url=nf(e,n),l[Hi]=Yr(e,t)||Ti,isNaN(i)||(l[jh]=t0(i)),l[qi]=Gi(e,o),l[Ji]=Yi(e,s)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",r.dataType="PageviewData",r}()});var Gh,cq=ge(()=>{p();_U();xU();Co();hl();Gh=function(){function r(e,t,n,i,o,s,a,l,u,c,d,f){u===void 0&&(u="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=t,m[jh]=t0(o),m.success=s,m.resultCode=a+"",m.type=Yr(e,u);var g=Y3(e,n,l,i);m.data=nf(e,i)||g.data,m.target=Yr(e,g.target),c&&(m.target="".concat(m.target," | ").concat(c)),m[Hi]=Yr(e,g[Hi]),m[qi]=Gi(e,d),m[Ji]=Yi(e,f)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",r.dataType="RemoteDependencyData",r}()});var Yh,uq=ge(()=>{p();fl();Co();hl();Yh=function(){function r(e,t,n,i,o){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var s=this;s.ver=2,t=t||Ti,s[ud]=mb(e,t),s[qi]=Gi(e,i),s[Ji]=Yi(e,o),n&&(s[Uh]=n)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Message",r.dataType="MessageData",r}()});var $h,dq=ge(()=>{p();fl();Co();hl();$h=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var l=this;l.ver=2,l.url=nf(e,n),l[Hi]=Yr(e,t)||Ti,l[qi]=Gi(e,o),l[Ji]=Yi(e,s),a&&(l.domProcessing=a.domProcessing,l[jh]=a[jh],l.networkConnect=a.networkConnect,l.perfTotal=a.perfTotal,l[SU]=a[SU],l.sentRequest=a.sentRequest)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",r.dataType="PageviewPerformanceData",r}()});var fd,pq=ge(()=>{p();fd=function(){function r(e,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=t}return r}()});var MU,fq=ge(()=>{p();ua();MU=cb({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})});function sf(r){var e="ai."+r+".";return function(t){return e+t}}var Cw,Zn,u0,gb,OU,of,zh,ww,xw,LU=ge(()=>{p();ir();ua();Cw=sf("application"),Zn=sf("device"),u0=sf("location"),gb=sf("operation"),OU=sf("session"),of=sf("user"),zh=sf("cloud"),ww=sf("internal"),xw=function(r){yn(e,r);function e(){return r.call(this)||this}return e}(hU({applicationVersion:Cw("ver"),applicationBuild:Cw("build"),applicationTypeId:Cw("typeId"),applicationId:Cw("applicationId"),applicationLayer:Cw("layer"),deviceId:Zn("id"),deviceIp:Zn("ip"),deviceLanguage:Zn("language"),deviceLocale:Zn("locale"),deviceModel:Zn("model"),deviceFriendlyName:Zn("friendlyName"),deviceNetwork:Zn("network"),deviceNetworkName:Zn("networkName"),deviceOEMName:Zn("oemName"),deviceOS:Zn("os"),deviceOSVersion:Zn("osVersion"),deviceRoleInstance:Zn("roleInstance"),deviceRoleName:Zn("roleName"),deviceScreenResolution:Zn("screenResolution"),deviceType:Zn("type"),deviceMachineName:Zn("machineName"),deviceVMName:Zn("vmName"),deviceBrowser:Zn("browser"),deviceBrowserVersion:Zn("browserVersion"),locationIp:u0("ip"),locationCountry:u0("country"),locationProvince:u0("province"),locationCity:u0("city"),operationId:gb("id"),operationName:gb("name"),operationParentId:gb("parentId"),operationRootId:gb("rootId"),operationSyntheticSource:gb("syntheticSource"),operationCorrelationVector:gb("correlationVector"),sessionId:OU("id"),sessionIsFirst:OU("isFirst"),sessionIsNew:OU("isNew"),userAccountAcquisitionDate:of("accountAcquisitionDate"),userAccountId:of("accountId"),userAgent:of("userAgent"),userId:of("id"),userStoreRegion:of("storeRegion"),userAuthUserId:of("authUserId"),userAnonymousUserAcquisitionDate:of("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:of("authUserAcquisitionDate"),cloudName:zh("name"),cloudRole:zh("role"),cloudRoleVer:zh("roleVer"),cloudRoleInstance:zh("roleInstance"),cloudEnvironment:zh("environment"),cloudLocation:zh("location"),cloudDeploymentUnit:zh("deploymentUnit"),internalNodeName:ww("nodeName"),internalSdkVersion:ww("sdkVersion"),internalAgentVersion:ww("agentVersion"),internalSnippet:ww("snippet"),internalSdkSrc:ww("sdkSrc")}))});var ei,mq=ge(()=>{p();LU();ei=new xw});var hq,af=ge(()=>{p();xU();$3();K3();fl();z3();Q3();iq();aq();lq();cq();uq();dq();pq();fq();LU();hl();mq();V3();hq="AppInsightsChannelPlugin"});var gq,Qh,KU,$i,d0,p0,f0,ki,m0,gl,vq,FU,yq,md,h0,vb,yb,UU,Xh,hd,Tc,Pw,Zh,WU,g0,bb,v0,bq,gd,VU,Iq,y0,zi,kc,b0,jU,eg,vl,I0,yl=ge(()=>{p();gq="initialize",Qh="name",KU="identifier",$i="push",d0="isInitialized",p0="config",f0="logger",ki="length",m0="time",gl="processNext",vq="getProcessTelContext",FU="getPlugin",yq="splice",md="teardown",h0="messageId",vb="message",yb="isAsync",UU="_doTeardown",Xh="update",hd="getNext",Tc="diagLog",Pw="setNextPlugin",Zh="createNew",WU="indexOf",g0="userAgent",bb="split",v0="nodeType",bq="apply",gd="replace",VU="enableDebugExceptions",Iq="logInternalMessage",y0="toLowerCase",zi="call",kc="type",b0="handler",jU="isChildEvt",eg="getCtx",vl="setCtx",I0="complete"});var Cr,wo,Sq,S0,lf,_q,BU,_0,Dw,HU,Nc=ge(()=>{p();Cr="",wo="core",Sq="disabled",S0="extensionConfig",lf="processTelemetry",_q="priority",BU="perfEvent",_0="errorToConsole",Dw="warnToConsole",HU="getPerfMgr"});function Rde(r){if(r){if(C0)return C0(r);var e=r[Ede]||r[Mt]||r[E0];if(e)return e}return null}function bl(r){return r===void 0||typeof r===$t}function Ut(r){return r===null||bl(r)}function cf(r){return!!(r&&typeof r===dt)}function en(r){return!!(r&&typeof r===Xr)}function Tw(r){var e=r;return e&&uf(e)&&(e=e[gd](Tde,function(t,n){return n.toUpperCase()}),e=e[gd](kde,"_"),e=e[gd](Nde,function(t,n){return"_"+n})),e}function Qi(r,e){if(r)for(var t in r)nr[zi](r,t)&&e[zi](r,t,r[t])}function Ib(r,e){return r&&e?r[WU](e)!==-1:!1}function Ade(r){return!!(r&&kq[zi](r)==="[object Array]")}function Rq(r){return!!(r&&kq[zi](r)==="[object Error]")}function uf(r){return typeof r=="string"}function GU(r){return typeof r=="number"}function Aq(r){return typeof r=="boolean"}function xq(r){var e=!1;if(r&&typeof r=="object"){var t=C0?C0(r):Rde(r);t?(t[E0]&&nr[zi](t,E0)&&(t=t[E0]),e=typeof t===Xr&&Nq[zi](t)===Dde):e=!0}return e}function YU(r){if(r)return xde?r[Dq]():Mde(r)}function Mde(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[ki]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function gi(r,e,t){var n=r[ki];try{for(var i=0;i<n&&!(i in r&&e[zi](t||r,r[i],i,r)===-1);i++);}catch(o){}}function w0(r,e,t){if(r){if(r[Eq])return r[Eq](e,t);var n=r[ki],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function df(r){var e=typeof r;if(e!==Xr&&(e!==dt||r===null)&&na("objKeys called on non-object"),!Pq&&wq)return wq(r);var t=[];for(var n in r)r&&nr[zi](r,n)&&t[$i](n);if(Pq)for(var i=qU[ki],o=0;o<i;o++)r&&nr[zi](r,qU[o])&&t[$i](qU[o]);return t}function $U(r,e,t,n){if(Cq)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),Cq(r,e,i),!0}catch(o){}return!1}function Ode(r){return r}function vd(){var r=Date;return r.now?r.now():new r().getTime()}function pa(r){return Rq(r)?r[Qh]:Cr}function kw(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Nw(r,e){return Ut(r)?e:r}function QU(r){return!!r}function Lde(r,e){var t=null,n=null;return en(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][bq](n,i)}}function x0(r,e,t,n,i){r&&e&&t&&(i!==!1||bl(r[e]))&&(r[e]=Lde(t,n))}function XU(r,e,t,n){return r&&e&&cf(r)&&$r(t)&&gi(t,function(i){uf(i)&&x0(r,i,e,i,n)}),r}function P0(r){return r&&qa&&(r=Er(qa({},r))),r}function D0(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[ki],u=!1,c=1;for(l>0&&Aq(a)&&(u=a,a=s[c]||{},c++),cf(a)||(a={});c<l;c++){var d=s[c],f=$r(d),m=cf(d);for(var g in d){var b=f&&g in d||m&&nr[zi](d,g);if(b){var v=d[g],k=void 0;if(u&&v&&((k=$r(v))||xq(v))){var R=a[g];k?$r(R)||(R=[]):xq(R)||(R={}),v=D0(u,R,v)}v!==void 0&&(a[g]=v)}}}return a}var Dq,Ide,Sde,Eq,_de,Tq,Ede,E0,Cq,Cde,tje,wq,JU,rje,nje,ije,wde,xde,Pde,kq,Nq,Dde,Tde,kde,Nde,C0,$r,Pq,qU,zU,Il=ge(()=>{p();ir();yl();Nc();Dq="toISOString",Ide="endsWith",Sde="startsWith",Eq="indexOf",_de="trim",Tq="toString",Ede="__proto__",E0="constructor",Cq=yo,Cde=Er.freeze,tje=Er.seal,wq=Er.keys,JU=String[Mt],rje=JU[_de],nje=JU[Ide],ije=JU[Sde],wde=Date[Mt],xde=wde[Dq],Pde=Array.isArray,kq=ra[Tq],Nq=nr[Tq],Dde=Nq[zi](Er),Tde=/-([a-z])/g,kde=/([^\w\d_$])/g,Nde=/^(\d+[\w\d_$])/,C0=Object.getPrototypeOf;$r=Pde||Ade;Pq=!{toString:null}.propertyIsEnumerable("toString"),qU=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];zU=Cde||Ode});function Kq(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Mt];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!bl(i[e])}catch(o){}}return t}function xo(r){var e=Kn();return e&&e[r]?e[r]:r===Mq&&iW()?window:null}function iW(){return!!(typeof window===dt&&window)}function _b(){return iW()?window:xo(Mq)}function Fq(){return!!(typeof document===dt&&document)}function T0(){return Fq()?document:xo(Kde)}function oW(){return!!(typeof navigator===dt&&navigator)}function pf(){return oW()?navigator:xo(Ude)}function sW(){return typeof console!==$t?console:xo(Wde)}function tg(){return!!(typeof JSON===dt&&JSON||xo(Oq)!==null)}function Zo(){return tg()?JSON||xo(Oq):null}function aW(){return xo(Vde)}function lW(){return xo(jde)}function cW(){var r=pf();if(r&&(r[g0]!==eW||ZU===null)){eW=r[g0];var e=(eW||Cr)[y0]();ZU=Ib(e,rW)||Ib(e,nW)}return ZU}function uW(r){if(r===void 0&&(r=null),!r){var e=pf()||{};r=e?(e[g0]||Cr)[y0]():Cr}var t=(r||Cr)[y0]();if(Ib(t,rW)){var n=T0()||{};return Math.max(parseInt(t[bb](rW)[1]),n[Fde]||0)}else if(Ib(t,nW)){var i=parseInt(t[bb](nW)[1]);if(i)return i+4}return null}function Wn(r){var e=Object[Mt].toString[zi](r),t=Cr;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Qh]+"'":tg()&&(t=Zo().stringify(r)),e+t}function Eb(){return tW===null&&(tW=oW()&&!!pf().sendBeacon),tW}function k0(r){var e=!1;try{e=!!xo("fetch");var t=xo("Request");e&&r&&t&&(e=Kq(t,"keepalive"))}catch(n){}return e}function N0(){return Sb===null&&(Sb=typeof XDomainRequest!==$t,Sb&&Rw()&&(Sb=Sb&&!Kq(xo(Lq),"withCredentials"))),Sb}function Rw(){var r=!1;try{var e=xo(Lq);r=!!e}catch(t){}return r}var Mq,Kde,Fde,Ude,Wde,Oq,Vde,jde,rW,nW,Lq,ZU,eW,Sb,tW,rg=ge(()=>{"use strict";p();ir();yl();Il();Nc();Mq="window",Kde="document",Fde="documentMode",Ude="navigator",Wde="console",Oq="JSON",Vde="crypto",jde="msCrypto",rW="msie",nW="trident/",Lq="XMLHttpRequest",ZU=null,eW=null,Sb=null,tW=null});function Bde(){var r=xo("Microsoft");return r&&(R0=r.ApplicationInsights),R0}function Uq(r){var e=R0;return!e&&r.disableDbgExt!==!0&&(e=R0||Bde()),e?e.ChromeDbgExt:null}var R0,Wq=ge(()=>{p();rg();R0=null});function Vq(r){return r?'"'+r[gd](/\"/g,Cr)+'"':Cr}function jq(r,e){var t=sW();if(t){var n="log";t[r]&&(n=r),en(t[n])&&t[n](e)}}function Aw(r,e){return(r||{})[f0]||new pW(e)}function Bq(r){return r||new pW}function ft(r,e,t,n,i,o){o===void 0&&(o=!1),Bq(r).throwInternal(e,t,n,i,o)}function Mw(r,e){Bq(r)[Dw](e)}var Hde,qde,Jde,dW,pW,A0=ge(()=>{"use strict";p();ur();yl();Wq();rg();Il();Nc();Hde="AI (Internal): ",qde="AI: ",Jde="AITR_";dW=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[h0]=e,o[vb]=(n?qde:Hde)+e;var s=Cr;tg()&&(s=Zo().stringify(i));var a=(t?" message:"+Vq(t):Cr)+(i?" props:"+Vq(s):Cr);o[vb]+=a}return r.dataType="MessageData",r}();pW=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[VU]=function(){return a},l.throwInternal=function(m,g,b,v,k){k===void 0&&(k=!1);var R=new dW(g,b,k,v);if(a)throw Wn(R);var P=m===1?_0:Dw;if(bl(R[vb]))f("throw"+(m===1?"Critical":"Warning"),R);else{if(k){var D=+R[h0];!n[D]&&i>=m&&(l[P](R[vb]),n[D]=!0)}else i>=m&&l[P](R[vb]);u(m,R)}},l[Dw]=function(m){jq("warn",m),f("warning",m)},l[_0]=function(m){jq("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[Iq]=u;function u(m,g){if(!d()){var b=!0,v=Jde+g[h0];if(n[v]?b=!1:n[v]=!0,b&&(m<=o&&(l.queue[$i](g),t++,f(m===1?"error":"warn",g)),t===s)){var k="Internal events throttle limit per PageView reached for this app.",R=new dW(23,k,!1);l.queue[$i](R),m===1?l[_0](k):l[Dw](k)}}}function c(m){i=Nw(m.loggingLevelConsole,0),o=Nw(m.loggingLevelTelemetry,1),s=Nw(m.maxMessageLimit,25),a=Nw(m[VU],!1)}function d(){return t>=s}function f(m,g){var b=Uq(e||{});b&&b[Tc]&&b[Tc](m,g)}})}return r.__ieDyn=1,r}()});function Hq(r,e,t,n,i){if(r){var o=r;if(o[HU]&&(o=o[HU]()),o){var s=void 0,a=o[eg](fW);try{if(s=o.create(e(),n,i),s){if(a&&s[vl]&&(s[vl](M0[mW],a),a[eg]&&a[vl])){var l=a[eg](M0[Ow]);l||(l=[],a[vl](M0[Ow],l)),l[$i](s)}return o[vl](fW,s),t(s)}}catch(u){s&&s[vl]&&s[vl]("exception",u)}finally{s&&o.fire(s),o[vl](fW,a)}}}return t()}var Cb,mW,Ow,M0,Dje,fW,qq=ge(()=>{p();ur();yl();Il();Nc();Cb="ctx",mW="ParentContextKey",Ow="ChildrenContextKey",M0=function(){function r(e,t,n){var i=this,o=!1;if(i.start=vd(),i[Qh]=e,i[yb]=n,i[jU]=function(){return!1},en(t)){var s;o=$U(i,"payload",function(){return!s&&en(t)&&(s=t(),t=null),s})}i[eg]=function(a){return a?a===r[mW]||a===r[Ow]?i[a]:(i[Cb]||{})[a]:null},i[vl]=function(a,l){if(a)if(a===r[mW])i[a]||(i[jU]=function(){return!0}),i[a]=l;else if(a===r[Ow])i[a]=l;else{var u=i[Cb]=i[Cb]||{};u[a]=l}},i[I0]=function(){var a=0,l=i[eg](r[Ow]);if($r(l))for(var u=0;u<l[ki];u++){var c=l[u];c&&(a+=c[m0])}i[m0]=vd()-i.start,i.exTime=i[m0]-a,i[I0]=function(){},!o&&en(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),Dje=function(){function r(e){this.ctx={},He(r,this,function(t){t.create=function(n,i,o){return new M0(n,i,o)},t.fire=function(n){n&&(n[I0](),e&&en(e[BU])&&e[BU](n))},t[vl]=function(n,i){if(n){var o=t[Cb]=t[Cb]||{};o[n]=i}},t[eg]=function(n){return(t[Cb]||{})[n]}})}return r.__ieDyn=1,r}(),fW="CoreUtils.doPerf"});function Gde(r){r<0&&(r>>>=0),Lw=123456789+r&ng,Kw=987654321-r&ng,Yq=!0}function Yde(){try{var r=vd()&2147483647;Gde((Math.random()*Gq^r)+r)}catch(e){}}function Jq(r){var e=0,t=aW()||lW();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&ng),e===0&&cW()&&(Yq||Yde(),e=$de()&ng),e===0&&(e=Math.floor(Gq*Math.random()|0)),r||(e>>>=0),e}function $de(r){Kw=36969*(Kw&65535)+(Kw>>16)&ng,Lw=18e3*(Lw&65535)+(Lw>>16)&ng;var e=(Kw<<16)+(Lw&65535)>>>0&ng|0;return r||(e>>>=0),e}function $q(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=Jq()>>>0,n=0,i=Cr;i[ki]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(Jq()<<2&4294967295|t&3)>>>0,n=0);return i}var Gq,ng,Yq,Lw,Kw,zq=ge(()=>{p();yl();rg();Il();Nc();Gq=4294967296,ng=4294967295,Yq=!1,Lw=123456789,Kw=987654321});function Xde(r,e,t){if(Qq)try{return Qq(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function Zq(r){return r[v0]===1||r[v0]===9||!+r[v0]}function Zde(r,e){var t=e[r.id];if(!t){t={};try{Zq(e)&&(Xde(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function yd(r,e){return e===void 0&&(e=!1),Tw(r+Qde+++(e?"."+Xq:Cr)+zde)}function O0(r){var e={id:yd("_aiData-"+(r||Cr)+"."+Xq),accept:function(t){return Zq(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[Tw(n)]:(o&&(s=Zde(e,t),s[Tw(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var Qq,Xq,zde,Qde,L0=ge(()=>{p();ir();yl();Il();Nc();zq();Qq=yo,Xq="2.8.11",zde="."+$q(6),Qde=0});function iJ(r){return r&&r[gd]?r[gd](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Cr):r}function gW(r,e){var t;if(e){var n=Cr;$r(e)?(n=Cr,gi(e,function(o){o=iJ(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=iJ(e),n&&(n[0]!=="."&&(n="."+n),r=(r||Cr)+n)}var i=npe.exec(r||Cr)||[];return t={},t[kc]=i[1],t.ns=(i[2]||Cr).replace(epe,".").replace(tpe,Cr)[bb](".").sort().join("."),t}function aJ(r,e,t){t===void 0&&(t=!0);var n=K0.get(r,hW,{},t),i=n[e];return i||(i=n[e]=[]),i}function lJ(r,e,t,n){r&&e&&e[kc]&&(r[nJ]?r[nJ](e[kc],t,n):r[rJ]&&r[rJ](sJ+e[kc],t))}function ipe(r,e,t,n){var i=!1;return r&&e&&e[kc]&&t&&(r[tJ]?(r[tJ](e[kc],t,n),i=!0):r[eJ]&&(r[eJ](sJ+e[kc],t),i=!0)),i}function oJ(r,e,t,n){for(var i=e[ki];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(lJ(r,o.evtName,o[b0],o.capture),e[yq](i,1))}}function ope(r,e,t){if(e[kc])oJ(r,aJ(r,e[kc]),e,t);else{var n=K0.get(r,hW,{});Qi(n,function(i,o){oJ(r,o,e,t)}),df(n)[ki]===0&&K0.kill(r,hW)}}function Fw(r,e){var t;return e?($r(e)?t=[r].concat(e):t=[r,e],t=gW("xx",t).ns[bb](".")):t=r,t}function F0(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=gW(e,n);if(s=ipe(r,a,t,i),s&&K0.accept(r)){var l=(o={guid:rpe++,evtName:a},o[b0]=t,o.capture=i,o);aJ(r,a.type)[$i](l)}}catch(u){}return s}function vW(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=gW(e,n),s=!1;ope(r,o,function(a){return o.ns&&!t||a[b0]===t?(s=!0,!0):!1}),s||lJ(r,o,t,i)}catch(a){}}var sJ,eJ,tJ,rJ,nJ,hW,Yje,$je,epe,tpe,rpe,K0,npe,cJ=ge(()=>{p();yl();L0();Il();Nc();sJ="on",eJ="attachEvent",tJ="addEventListener",rJ="detachEvent",nJ="removeEventListener",hW="events",Yje=yd("aiEvtPageHide"),$je=yd("aiEvtPageShow"),epe=/\.[\.]+/g,tpe=/[\.]+$/,rpe=1,K0=O0("events"),npe=/^([^.]*)(?:\.(.+)|)/});function U0(r){return spe.get(r,"state",{},!0)}var spe,uJ=ge(()=>{"use strict";p();L0();spe=O0("plugin")});function lpe(r,e,t){for(;r;){if(r[FU]()===t)return r;r=r[hd]()}return Uw([t],e[p0]||{},e)}function yW(r,e,t,n){var i=null,o=[];n!==null&&(i=n?lpe(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return Aw(t,e)},getCfg:function(){return e},getExtCfg:u,getConfig:c,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:d,onComplete:a}};function a(f,m){for(var g=[],b=2;b<arguments.length;b++)g[b-2]=arguments[b];f&&o[$i]({func:f,self:bl(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[hd]():null,!f){var m=o;m&&m[ki]>0&&(gi(m,function(g){try{g.func[zi](g.self,g.args)}catch(b){ft(t[f0],2,73,"Unexpected Exception during onComplete - "+Wn(b))}}),o=[])}return f}function u(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var b;if(e){var v=e[S0];v&&f&&(b=v[f])}if(!b)b=m;else if(cf(m)&&g!==0){var k=D0(!0,m,b);e&&g===2&&Qi(m,function(R){if(Ut(k[R])){var P=e[R];Ut(P)||(k[R]=P)}}),b=k}return b}function c(f,m,g){g===void 0&&(g=!1);var b,v=u(f,null);return v&&!Ut(v[m])?b=v[m]:e&&!Ut(e[m])&&(b=e[m]),Ut(b)?g:b}function d(f){for(var m;m=s._next();){var g=m[FU]();g&&f(g)}}return s}function wb(r,e,t,n){var i=yW(r,e,t,n),o=i.ctx;function s(l){var u=i._next();return u&&u[lf](l,o),!u}function a(l,u){return l===void 0&&(l=null),$r(l)&&(l=Uw(l,e,t,u)),wb(l||o[hd](),e,t,u)}return o[gl]=s,o[Zh]=a,o}function bW(r,e,t){var n=e[p0]||{},i=yW(r,n,e,t),o=i.ctx;function s(l){var u=i._next();return u&&u.unload(o,l),!u}function a(l,u){return l===void 0&&(l=null),$r(l)&&(l=Uw(l,n,e,u)),bW(l||o[hd](),e,u)}return o[gl]=s,o[Zh]=a,o}function IW(r,e,t){var n=e[p0]||{},i=yW(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(u){en(u[Xh])&&u[Xh](o,l)})}function a(l,u){return l===void 0&&(l=null),$r(l)&&(l=Uw(l,n,e,u)),IW(l||o[hd](),e,u)}return o[gl]=s,o[Zh]=a,o}function Uw(r,e,t,n){var i=null,o=!n;if($r(r)&&r[ki]>0){var s=null;gi(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&en(a[lf])){var l=cpe(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Uw([n],e,t):i}function cpe(r,e,t){var n=null,i=en(r[lf]),o=en(r[Pw]),s;r?s=r[KU]+"-"+r[_q]+"-"+fJ++:s="Unknown-0-"+fJ++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:c,unload:d,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&en(r[pJ])&&(m=r[pJ]()),m||(m=wb(a,e,t)),m}function u(m,g,b,v,k){var R=!1,P=r?r[KU]:ape,D=m[dJ];return D||(D=m[dJ]={}),m.setNext(n),r&&Hq(m[wo](),function(){return P+":"+b},function(){D[s]=!0;try{var K=n?n._id:Cr;K&&(D[K]=!1),R=g(m)}catch(B){var L=n?D[n._id]:!0;L&&(R=!0),(!n||!L)&&ft(m[Tc](),1,73,"Plugin ["+P+"] failed during "+b+" - "+Wn(B)+", run flags: "+Wn(D))}},v,k),R}function c(m,g){g=g||l();function b(v){if(!r||!i)return!1;var k=U0(r);return k[md]||k[Sq]?!1:(o&&r[Pw](n),r[lf](m,v),!0)}u(g,b,"processTelemetry",function(){return{item:m}},!m.sync)||g[gl](m)}function d(m,g){function b(){var v=!1;if(r){var k=U0(r),R=r[wo]||k[wo];r&&(!R||R===m.core())&&!k[md]&&(k[wo]=null,k[md]=!0,k[d0]=!1,r[md]&&r[md](m,g)===!0&&(v=!0))}return v}u(m,b,"unload",function(){},g[yb])||m[gl](g)}function f(m,g){function b(){var v=!1;if(r){var k=U0(r),R=r[wo]||k[wo];r&&(!R||R===m.core())&&!k[md]&&r[Xh]&&r[Xh](m,g)===!0&&(v=!0)}return v}u(m,b,"update",function(){},!1)||m[gl](g)}return zU(a)}var ape,dJ,pJ,fJ,l9e,mJ=ge(()=>{"use strict";p();yl();A0();rg();Il();Nc();qq();uJ();ape="TelemetryPluginChain",dJ="_hasRun",pJ="_getTelCtx",fJ=0;l9e=function(){function r(e,t,n,i){var o=this,s=wb(e,t,n,i);XU(o,s,df(s))}return r}()});function hJ(){var r=[];function e(n){n&&r[$i](n)}function t(n,i){gi(r,function(o){try{o(n,i)}catch(s){ft(n[Tc](),2,73,"Unexpected error calling unload handler - "+Wn(s))}}),r=[]}return{add:e,run:t}}var gJ=ge(()=>{p();yl();A0();rg();Il()});var ff,SW,vJ=ge(()=>{"use strict";p();ur();yl();Il();Nc();mJ();gJ();ff="getPlugin",SW=function(){function r(){var e=this,t,n,i,o,s;u(),He(r,e,function(c){c[gq]=function(d,f,m,g){l(d,f,g),t=!0},c[md]=function(d,f){var m,g=c[wo];if(!g||d&&g!==d[wo]())return;var b,v=!1,k=d||bW(null,g,i&&i[ff]?i[ff]():i),R=f||(m={reason:0},m[yb]=!1,m);function P(){if(!v){v=!0,o.run(k,f);var D=s;s=[],gi(D,function(K){K.rm()}),b===!0&&k[gl](R),u()}}return!c[UU]||c[UU](k,R,P)!==!0?P():b=!0,b},c[Xh]=function(d,f){var m=c[wo];if(!m||d&&m!==d[wo]())return;var g,b=!1,v=d||IW(null,m,i&&i[ff]?i[ff]():i),k=f||{reason:0};function R(){b||(b=!0,l(v.getCfg(),v.core(),v[hd]()))}return!c._doUpdate||c._doUpdate(v,k,R)!==!0?R():g=!0,g},c._addHook=function(d){d&&($r(d)?s=s.concat(d):s[$i](d))},x0(c,"_addUnloadCb",function(){return o},"add")}),e[Tc]=function(c){return a(c)[Tc]()},e[d0]=function(){return t},e.setInitialized=function(c){t=c},e[Pw]=function(c){i=c},e[gl]=function(c,d){d?d[gl](c):i&&en(i[lf])&&i[lf](c,null)},e._getTelCtx=a;function a(c){c===void 0&&(c=null);var d=c;if(!d){var f=n||wb(null,{},e[wo]);i&&i[ff]?d=f[Zh](null,i[ff]):d=f[Zh](null,i)}return d}function l(c,d,f){c&&kw(c,S0,[],null,Ut),!f&&d&&(f=d[vq]()[hd]());var m=i;i&&i[ff]&&(m=i[ff]()),e[wo]=d,n=wb(f,c,d,m)}function u(){t=!1,e[wo]=null,n=null,i=null,s=[],o=hJ()}}return r.__ieDyn=1,r}()});var ig=ge(()=>{p();vJ();Il();cJ();rg();A0();L0()});var mf,yJ=ge(()=>{p();mf="duration"});var Vn,W0,es,Rc,og,Tt,hf,gf,fa,vf,bd,Ww,sg,yf,Id,Vw,bf,ag,If,lg,xb,Sf,Pb,Sd,V0,cg,Xi,_W,j0,Db,jr,ug,EW,CW,jw,_f,wW,Tb,xW,B0,H0,kb,PW,bJ,ma,q0,Bw,Hw,IJ,Nb,J0,DW,TW,kW,G0,SJ,_d=ge(()=>{p();Vn="tags",W0="deviceType",es="data",Rc="name",og="traceID",Tt="length",hf="stringify",gf="measurements",fa="dataType",vf="envelopeType",bd="toString",Ww="onLine",sg="enqueue",yf="count",Id="push",Vw="emitLineDelimitedJson",bf="clear",ag="batchPayloads",If="markAsSent",lg="clearSent",xb="BUFFER_KEY",Sf="SENT_BUFFER_KEY",Pb="MAX_BUFFER_SIZE",Sd="namePrefix",V0="maxBatchSizeInBytes",cg="triggerSend",Xi="diagLog",_W="onunloadDisableBeacon",j0="isBeaconApiDisabled",Db="_sender",jr="_senderConfig",ug="_buffer",EW="enableSessionStorageBuffer",CW="samplingPercentage",jw="instrumentationKey",_f="endpointUrl",wW="customHeaders",Tb="disableXhr",xW="onunloadDisableFetch",B0="disableTelemetry",H0="baseType",kb="sampleRate",PW="convertUndefined",bJ="_xhrReadyStateChange",ma="_onError",q0="_onPartialSuccess",Bw="_onSuccess",Hw="itemsAccepted",IJ="itemsReceived",Nb="isRetryDisabled",J0="setRequestHeader",DW="maxBatchInterval",TW="eventsSendRequest",kW="disableInstrumentationKeyValidation",G0="getSamplingScore",SJ="getHashCodeScore"});function jn(r,e,t){return kw(r,e,t,QU)}function upe(r,e,t){var n=t[Vn]=t[Vn]||{},i=e.ext=e.ext||{},o=e[Vn]=e[Vn]||[],s=i.user;s&&(jn(n,ei.userAuthUserId,s.authId),jn(n,ei.userId,s.id||s.localId));var a=i.app;a&&jn(n,ei.sessionId,a.sesId);var l=i.device;l&&(jn(n,ei.deviceId,l.id||l.localId),jn(n,ei[W0],l.deviceClass),jn(n,ei.deviceIp,l.ip),jn(n,ei.deviceModel,l.model),jn(n,ei[W0],l[W0]));var u=e.ext.web;if(u){jn(n,ei.deviceLanguage,u.browserLang),jn(n,ei.deviceBrowserVersion,u.browserVer),jn(n,ei.deviceBrowser,u.browser);var c=t[es]=t[es]||{},d=c[tn]=c[tn]||{},f=d[vi]=d[vi]||{};jn(f,"domain",u.domain),jn(f,"isManual",u.isManual?_J:null),jn(f,"screenRes",u.screenRes),jn(f,"userConsent",u.userConsent?_J:null)}var m=i.os;m&&jn(n,ei.deviceOS,m[Rc]);var g=i.trace;g&&(jn(n,ei.operationParentId,g.parentID),jn(n,ei.operationName,Yr(r,g[Rc])),jn(n,ei.operationId,g[og]));for(var b={},v=o[Tt]-1;v>=0;v--){var k=o[v];Qi(k,function(P,D){b[P]=D}),o.splice(v,1)}Qi(o,function(P,D){b[P]=D});var R=Io(Io({},n),b);R[ei.internalSdkVersion]||(R[ei.internalSdkVersion]="javascript:".concat(dpe.Version)),t[Vn]=P0(R)}function Ef(r,e,t){Ut(r)||Qi(r,function(n,i){GU(i)?t[n]=i:uf(i)?e[n]=i:tg()&&(e[n]=Zo()[hf](i))})}function dg(r,e){Ut(r)||Qi(r,function(t,n){r[t]=n||e})}function pg(r,e,t,n){var i=new DU(r,n,e);jn(i,"sampleRate",t[mw]),(t[tn]||{}).startTime&&(i.time=YU(t[tn].startTime)),i.iKey=t.iKey;var o=t.iKey.replace(/-/g,"");return i[Rc]=i[Rc].replace("{0}",o),upe(r,t,i),t[Vn]=t[Vn]||[],P0(i)}function fg(r,e){Ut(e[tn])&&ft(r,1,46,"telemetryItem.baseData cannot be null.")}function EJ(r,e,t){fg(r,e);var n=e[tn][gf]||{},i=e[tn][vi]||{};Ef(e[es],i,n),Ut(t)||dg(i,t);var o=e[tn];if(Ut(o))return Mw(r,"Invalid input for dependency data"),null;var s=o[vi]&&o[vi][Qk]?o[vi][Qk]:"GET",a=new Gh(r,o.id,o.target,o[Rc],o[mf],o.success,o.responseCode,s,o.type,o.correlationContext,i,n),l=new fd(Gh[fa],a);return pg(r,Gh[vf],e,l)}function RW(r,e,t){fg(r,e);var n={},i={};e[NW]!==dd[fa]&&(n.baseTypeSource=e[NW]),e[NW]===dd[fa]?(n=e[tn][vi]||{},i=e[tn][gf]||{}):e[tn]&&Ef(e[tn],n,i),Ef(e[es],n,i),Ut(t)||dg(n,t);var o=e[tn][Rc],s=new dd(r,o,n,i),a=new fd(dd[fa],s);return pg(r,dd[vf],e,a)}function CJ(r,e,t){fg(r,e);var n=e[tn][gf]||{},i=e[tn][vi]||{};Ef(e[es],i,n),Ut(t)||dg(i,t);var o=e[tn],s=qh.CreateFromInterface(r,o,i,n),a=new fd(qh[fa],s);return pg(r,qh[vf],e,a)}function wJ(r,e,t){fg(r,e);var n=e[tn],i=n[vi]||{},o=n[gf]||{};Ef(e[es],i,o),Ut(t)||dg(i,t);var s=new pd(r,n[Rc],n.average,n.sampleCount,n.min,n.max,n.stdDev,i,o),a=new fd(pd[fa],s);return pg(r,pd[vf],e,a)}function xJ(r,e,t){fg(r,e);var n,i=e[tn];!Ut(i)&&!Ut(i[vi])&&!Ut(i[vi][mf])?(n=i[vi][mf],delete i[vi][mf]):!Ut(e[es])&&!Ut(e[es][mf])&&(n=e[es][mf],delete e[es][mf]);var o=e[tn],s;((e.ext||{}).trace||{})[og]&&(s=e.ext.trace[og]);var a=o.id||s,l=o[Rc],u=o.uri,c=o[vi]||{},d=o[gf]||{};if(Ut(o.refUri)||(c.refUri=o.refUri),Ut(o.pageType)||(c.pageType=o.pageType),Ut(o.isLoggedIn)||(c.isLoggedIn=o.isLoggedIn[bd]()),!Ut(o[vi])){var f=o[vi];Qi(f,function(b,v){c[b]=v})}Ef(e[es],c,d),Ut(t)||dg(c,t);var m=new Jh(r,l,u,n,c,d,a),g=new fd(Jh[fa],m);return pg(r,Jh[vf],e,g)}function PJ(r,e,t){fg(r,e);var n=e[tn],i=n[Rc],o=n.uri||n.url,s=n[vi]||{},a=n[gf]||{};Ef(e[es],s,a),Ut(t)||dg(s,t);var l=new $h(r,i,o,void 0,s,a,n),u=new fd($h[fa],l);return pg(r,$h[vf],e,u)}function DJ(r,e,t){fg(r,e);var n=e[tn].message,i=e[tn].severityLevel,o=e[tn][vi]||{},s=e[tn][gf]||{};Ef(e[es],o,s),Ut(t)||dg(o,t);var a=new Yh(r,n,i,o,s),l=new fd(Yh[fa],a);return pg(r,Yh[vf],e,l)}var NW,tn,vi,_J,dpe,TJ=ge(()=>{p();ir();af();ig();yJ();_d();NW="baseType",tn="baseData",vi="properties",_J="true";dpe={Version:"2.8.11"}});function kJ(r,e){vW(r,null,null,e)}function NJ(r){var e=T0(),t=pf(),n=!1,i=!0,o=Fw(yd("OfflineListener"),r);try{if(a(_b())&&(n=!0),e){var s=e.body||e;s.ononline&&a(s)&&(n=!0)}n&&t&&!Ut(t[Ww])&&(i=t[Ww])}catch(f){n=!1}function a(f){var m=!1;return f&&(m=F0(f,"online",l,o),m&&F0(f,"offline",u,o)),m}function l(){i=!0}function u(){i=!1}function c(){var f=!0;return n?f=i:t&&!Ut(t[Ww])&&(f=t[Ww]),f}function d(){var f=_b();if(f&&n){if(kJ(f,o),e){var m=e.body||e;bl(m.ononline)||kJ(m,o)}n=!1}}return{isOnline:c,isListening:function(){return n},unload:d}}var RJ=ge(()=>{p();ig();_d()});var AJ,MJ,OJ,LJ=ge(()=>{p();ir();ur();af();ig();_d();AJ=function(){function r(e,t){var n=[],i=!1;this._get=function(){return n},this._set=function(o){return n=o,n},He(r,this,function(o){o[sg]=function(s){if(o[yf]()>=t.eventsLimitInMem()){i||(ft(e,2,105,"Maximum in-memory buffer size reached: "+o[yf](),!0),i=!0);return}n[Id](s)},o[yf]=function(){return n[Tt]},o.size=function(){for(var s=n[Tt],a=0;a<n[Tt];a++)s+=n[a][Tt];return t[Vw]()||(s+=2),s},o[bf]=function(){n=[],i=!1},o.getItems=function(){return n.slice(0)},o[ag]=function(s){if(s&&s[Tt]>0){var a=t[Vw]()?s.join(`
`):"["+s.join(",")+"]";return a}return null}})}return r.__ieDyn=1,r}(),MJ=function(r){yn(e,r);function e(t,n){var i=r.call(this,t,n)||this;return He(e,i,function(o,s){o[If]=function(a){s[bf]()},o[lg]=function(a){}}),i}return e.__ieDyn=1,e}(AJ),OJ=function(r){yn(e,r);function e(t,n){var i=r.call(this,t,n)||this,o=!1;return He(e,i,function(s,a){var l=f(e[xb]),u=f(e[Sf]),c=s._set(l.concat(u));c[Tt]>e[Pb]&&(c[Tt]=e[Pb]),m(e[Sf],[]),m(e[xb],c),s[sg]=function(g){if(s[yf]()>=e[Pb]){o||(ft(t,2,67,"Maximum buffer size reached: "+s[yf](),!0),o=!0);return}a[sg](g),m(e[xb],s._get())},s[bf]=function(){a[bf](),m(e[xb],s._get()),m(e[Sf],[]),o=!1},s[If]=function(g){m(e[xb],s._set(d(g,s._get())));var b=f(e[Sf]);b instanceof Array&&g instanceof Array&&(b=b.concat(g),b[Tt]>e[Pb]&&(ft(t,1,67,"Sent buffer reached its maximum size: "+b[Tt],!0),b[Tt]=e[Pb]),m(e[Sf],b))},s[lg]=function(g){var b=f(e[Sf]);b=d(g,b),m(e[Sf],b)};function d(g,b){var v=[];return gi(b,function(k){!en(k)&&w0(g,k)===-1&&v[Id](k)}),v}function f(g){var b=g;try{b=n[Sd]&&n[Sd]()?n[Sd]()+"_"+b:b;var v=EU(t,b);if(v){var k=Zo().parse(v);if(uf(k)&&(k=Zo().parse(k)),k&&$r(k))return k}}catch(R){ft(t,1,42," storage key: "+b+", "+pa(R),{exception:Wn(R)})}return[]}function m(g,b){var v=g;try{v=n[Sd]&&n[Sd]()?n[Sd]()+"_"+v:v;var k=JSON[hf](b);i0(t,v,k)}catch(R){i0(t,v,JSON[hf]([])),ft(t,2,41," storage key: "+v+", "+pa(R)+". Buffer cleared",{exception:Wn(R)})}}}),i}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(AJ)});var KJ,FJ=ge(()=>{p();ur();ig();_d();KJ=function(){function r(e){He(r,this,function(t){t.serialize=function(s){var a=n(s,"root");try{return Zo()[hf](a)}catch(l){ft(e,1,48,l&&en(l[bd])?l[bd]():"Error serializing object",null,!0)}};function n(s,a){var l="__aiCircularRefCheck",u={};if(!s)return ft(e,1,48,"cannot serialize object because it is null or undefined",{name:a},!0),u;if(s[l])return ft(e,2,50,"Circular reference detected while serializing object",{name:a},!0),u;if(!s.aiDataContract){if(a==="measurements")u=o(s,"number",a);else if(a==="properties")u=o(s,"string",a);else if(a==="tags")u=o(s,"string",a);else if($r(s))u=i(s,a);else{ft(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:a},!0);try{Zo()[hf](s),u=s}catch(c){ft(e,1,48,c&&en(c[bd])?c[bd]():"Error serializing object",null,!0)}}return u}return s[l]=!0,Qi(s.aiDataContract,function(c,d){var f=en(d)?d()&1:d&1,m=en(d)?d()&4:d&4,g=d&2,b=s[c]!==void 0,v=cf(s[c])&&s[c]!==null;if(f&&!b&&!g)ft(e,1,24,"Missing required field specification. The field is required but not present on source",{field:c,name:a});else if(!m){var k=void 0;v?g?k=i(s[c],c):k=n(s[c],c):k=s[c],k!==void 0&&(u[c]=k)}}),delete s[l],u}function i(s,a){var l;if(s)if(!$r(s))ft(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:a},!0);else{l=[];for(var u=0;u<s[Tt];u++){var c=s[u],d=n(c,a+"["+u+"]");l[Id](d)}}return l}function o(s,a,l){var u;return s&&(u={},Qi(s,function(c,d){if(a==="string")d===void 0?u[c]="undefined":d===null?u[c]="null":d[bd]?u[c]=d[bd]():u[c]="invalid field: toString() is not defined.";else if(a==="number")if(d===void 0)u[c]="undefined";else if(d===null)u[c]="null";else{var f=parseFloat(d);isNaN(f)?u[c]="NaN":u[c]=f}else u[c]="invalid field: "+l+" is of unknown type.",ft(e,1,u[c],null,!0)})),u}})}return r.__ieDyn=1,r}()});var ppe,UJ,WJ=ge(()=>{p();_d();ppe=8,UJ=function(){function r(){}return r.prototype.getHashCodeScore=function(e){var t=this.getHashCode(e)/r.INT_MAX_VALUE;return t*100},r.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[Tt]<ppe;)e=e.concat(e);for(var t=5381,n=0;n<e[Tt];++n)t=(t<<5)+t+e.charCodeAt(n),t=t&t;return Math.abs(t)},r.INT_MAX_VALUE=2147483647,r}()});var VJ,jJ=ge(()=>{p();af();_d();WJ();VJ=function(){function r(){var e=this,t=new UJ,n=new xw;e[G0]=function(i){var o=0;return i[Vn]&&i[Vn][n.userId]?o=t.getHashCodeScore(i[Vn][n.userId]):i.ext&&i.ext.user&&i.ext.user.id?o=t[SJ](i.ext.user.id):i[Vn]&&i[Vn][n.operationId]?o=t.getHashCodeScore(i[Vn][n.operationId]):i.ext&&i.ext.telemetryTrace&&i.ext.telemetryTrace[og]?o=t.getHashCodeScore(i.ext.telemetryTrace[og]):o=Math.random()*100,o}}return r}()});var BJ,HJ=ge(()=>{p();af();ig();_d();jJ();BJ=function(){function r(e,t){this.INT_MAX_VALUE=2147483647;var n=t||Aw(null);(e>100||e<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[kb]=e,this.samplingScoreGenerator=new VJ}return r.prototype.isSampledIn=function(e){var t=this[kb],n=!1;return t==null||t>=100||e.baseType===pd[fa]?!0:(n=this.samplingScoreGenerator[G0](e)<t,n)},r}()});function Y0(r){try{return r.responseText}catch(e){}return null}function qJ(){var r,e,t;return r={endpointUrl:function(){return Mh+cd}},r[Vw]=function(){return!1},r[DW]=function(){return 15e3},r[V0]=function(){return 102400},r[B0]=function(){return!1},r[EW]=function(){return!0},r[Nb]=function(){return!1},r[j0]=function(){return!0},r[Tb]=function(){return!1},r[xW]=function(){return!1},r[_W]=function(){return!1},r[jw]=function(){return e},r[Sd]=function(){return e},r[CW]=function(){return 100},r[wW]=function(){return t},r[PW]=function(){return e},r.eventsLimitInMem=function(){return 1e4},r}var Ed,fpe,mpe,qw,JJ=ge(()=>{p();ir();ur();af();ig();TJ();RJ();LJ();FJ();HJ();_d();fpe=65e3;mpe=(Ed={},Ed[dd.dataType]=RW,Ed[Yh.dataType]=DJ,Ed[Jh.dataType]=xJ,Ed[$h.dataType]=PJ,Ed[qh.dataType]=CJ,Ed[pd.dataType]=wJ,Ed[Gh.dataType]=EJ,Ed),qw=function(r){yn(e,r);function e(){var t=r.call(this)||this;t.priority=1001,t.identifier=hq,t._senderConfig=qJ();var n,i,o,s,a,l,u,c,d=0,f,m,g,b;return He(e,t,function(v,k){ye(),v.pause=function(){Z(),s=!0},v.resume=function(){s&&(s=!1,i=null,v._buffer.size()>v._senderConfig[V0]()&&v[cg](!0,null,10),Y())},v.flush=function(z,fe,Se){if(z===void 0&&(z=!0),!s){Z();try{v[cg](z,null,Se||1)}catch(Te){ft(v[Xi](),1,22,"flush failed, telemetry will not be collected: "+pa(Te),{exception:Wn(Te)})}}},v.onunloadFlush=function(){if(!s)if((v._senderConfig[_W]()===!1||v[jr][j0]()===!1)&&Eb())try{v[cg](!0,K,2)}catch(z){ft(v[Xi](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+pa(z),{exception:Wn(z)})}else v.flush()},v.addHeader=function(z,fe){c[z]=fe},v.initialize=function(z,fe,Se,Te){v.isInitialized()&&ft(v[Xi](),1,28,"Sender is already initialized"),k.initialize(z,fe,Se,Te);var Le=v._getTelCtx(),$e=v.identifier;l=new KJ(fe.logger),n=0,i=null,o=0,v[Db]=null,u=0;var Ge=v[Xi]();b=Fw(yd("Sender"),fe.evtNamespace&&fe.evtNamespace()),g=NJ(b);var Bt=qJ();Qi(Bt,function(I,S){v[jr][I]=function(){var _=Le.getConfig($e,I,S());return!_&&I==="endpointUrl"&&(_=S()),_}}),v._buffer=v[jr][EW]()&&n0()?new OJ(Ge,v[jr]):new MJ(Ge,v[jr]),v._sample=new BJ(v[jr][CW](),Ge),pe(z)||ft(Ge,1,100,"Invalid Instrumentation key "+z[jw]),!Ew(v._senderConfig.endpointUrl())&&v._senderConfig.customHeaders()&&v._senderConfig.customHeaders()[Tt]>0&&gi(v[jr][wW](),function(I){t.addHeader(I.header,I.value)});var A=v[jr],M=null;!A[Tb]()&&N0()?M=be:!A[Tb]()&&Rw()&&(M=N),!M&&k0()&&(M=h),f=M||N,!A[j0]()&&Eb()&&(M=B),v[Db]=M||N,!A[xW]()&&k0(!0)?m=O:Eb()?m=B:!A[Tb]()&&N0()?m=be:!A[Tb]()&&Rw()?m=N:m=f},v.processTelemetry=function(z,fe){fe=v._getTelCtx(fe);var Se=fe[Xi]();try{if(v[jr][B0]())return;if(!z){ft(Se,1,7,"Cannot send empty telemetry");return}if(z.baseData&&!z[H0]){ft(Se,1,70,"Cannot send telemetry without baseData and baseType");return}if(z[H0]||(z[H0]="EventData"),!v[Db]){ft(Se,1,28,"Sender was not initialized");return}if(R(z))z[mw]=v._sample[kb];else{ft(Se,2,33,"Telemetry item was sampled out and not sent",{SampleRate:v._sample[kb]});return}var Te=v[jr][PW]()||void 0,Le=z.iKey||v[jr][jw](),$e=e.constructEnvelope(z,Le,Se,Te);if(!$e){ft(Se,1,47,"Unable to create an AppInsights envelope");return}var Ge=!1;if(z[Vn]&&z[Vn][hw]&&(gi(z[Vn][hw],function(I){try{I&&I($e)===!1&&(Ge=!0,Mw(Se,"Telemetry processor check returns false"))}catch(S){ft(Se,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+pa(S),{exception:Wn(S)},!0)}}),delete z[Vn][hw]),Ge)return;var Bt=l.serialize($e),A=v[ug],M=A.size();M+Bt[Tt]>v[jr][V0]()&&v[cg](!0,null,10),A[sg](Bt),Y()}catch(I){ft(Se,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+pa(I),{exception:Wn(I)})}v.processNext(z,fe)},v[bJ]=function(z,fe,Se){z.readyState===4&&P(z.status,fe,z.responseURL,Se,ce(z),Y0(z)||z.response)},v[cg]=function(z,fe,Se){if(z===void 0&&(z=!0),!s)try{var Te=v[ug];if(v[jr][B0]())Te[bf]();else{if(Te[yf]()>0){var Le=Te.getItems();de(Se||0,z),fe?fe.call(t,Le,z):v[Db](Le,z)}o=+new Date}Z()}catch(Ge){var $e=uW();(!$e||$e>9)&&ft(v[Xi](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+pa(Ge),{exception:Wn(Ge)})}},v._doTeardown=function(z,fe){v.onunloadFlush(),g.unload(),ye()},v[ma]=function(z,fe,Se){ft(v[Xi](),2,26,"Failed to send telemetry.",{message:fe}),v._buffer[lg](z)},v[q0]=function(z,fe){for(var Se=[],Te=[],Le=fe.errors.reverse(),$e=0,Ge=Le;$e<Ge.length;$e++){var Bt=Ge[$e],A=z.splice(Bt.index,1)[0];ie(Bt.statusCode)?Te[Id](A):Se[Id](A)}z[Tt]>0&&v[Bw](z,fe[Hw]),Se[Tt]>0&&v[ma](Se,ce(null,["partial success",fe[Hw],"of",fe.itemsReceived].join(" "))),Te[Tt]>0&&(T(Te),ft(v[Xi](),2,40,"Partial success. Delivered: "+z[Tt]+", Failed: "+Se[Tt]+". Will retry to send "+Te[Tt]+" our of "+fe[IJ]+" items"))},v[Bw]=function(z,fe){v._buffer[lg](z)},v._xdrOnLoad=function(z,fe){var Se=Y0(z);if(z&&(Se+""=="200"||Se===""))n=0,v[Bw](fe,0);else{var Te=w(Se);Te&&Te.itemsReceived&&Te.itemsReceived>Te[Hw]&&!v[jr][Nb]()?v[q0](fe,Te):v[ma](fe,q(z))}};function R(z){return v._sample.isSampledIn(z)}function P(z,fe,Se,Te,Le,$e){var Ge=null;if(v._appId||(Ge=w($e),Ge&&Ge.appId&&(v._appId=Ge.appId)),(z<200||z>=300)&&z!==0){if((z===301||z===307||z===308)&&!D(Se)){v[ma](fe,Le);return}!v[jr][Nb]()&&ie(z)?(T(fe),ft(v[Xi](),2,40,". Response code "+z+". Will retry to send "+fe[Tt]+" items.")):v[ma](fe,Le)}else if(g&&!g.isOnline()){if(!v[jr][Nb]()){var Bt=10;T(fe,Bt),ft(v[Xi](),2,40,". Offline - Response Code: ".concat(z,". Offline status: ").concat(!g.isOnline(),". Will retry to send ").concat(fe.length," items."))}}else D(Se),z===206?(Ge||(Ge=w($e)),Ge&&!v[jr][Nb]()?v[q0](fe,Ge):v[ma](fe,Le)):(n=0,v[Bw](fe,Te))}function D(z){return u>=10?!1:!Ut(z)&&z!==""&&z!==v[jr][_f]()?(v[jr][_f]=function(){return z},++u,!0):!1}function K(z,fe){m?m(z,!1):B(z,fe)}function L(z){var fe=pf(),Se=v[ug],Te=v[jr][_f](),Le=v._buffer[ag](z),$e=new Blob([Le],{type:"text/plain;charset=UTF-8"}),Ge=fe.sendBeacon(Te,$e);return Ge&&(Se[If](z),v._onSuccess(z,z[Tt])),Ge}function B(z,fe){if($r(z)&&z[Tt]>0&&!L(z)){for(var Se=[],Te=0;Te<z[Tt];Te++){var Le=z[Te];L([Le])||Se[Id](Le)}Se[Tt]>0&&(f&&f(Se,!0),ft(v[Xi](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function N(z,fe){var Se=new XMLHttpRequest,Te=v[jr][_f]();try{Se[fw]=!0}catch($e){}Se.open("POST",Te,fe),Se[J0]("Content-type","application/json"),Ew(Te)&&Se[J0](fb[6],fb[7]),gi(df(c),function($e){Se[J0]($e,c[$e])}),Se.onreadystatechange=function(){return v._xhrReadyStateChange(Se,z,z[Tt])},Se.onerror=function($e){return v[ma](z,ce(Se),$e)};var Le=v._buffer[ag](z);Se.send(Le),v._buffer[If](z)}function O(z,fe){if($r(z)){for(var Se=z[Tt],Te=0;Te<z[Tt];Te++)Se+=z[Te][Tt];d+Se<=fpe?y(z,!1):Eb()?B(z,fe):(f&&f(z,!0),ft(v[Xi](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function h(z,fe){y(z,!0)}function y(z,fe){var Se,Te=v[jr][_f](),Le=v._buffer[ag](z),$e=new Blob([Le],{type:"application/json"}),Ge=new Headers,Bt=Le[Tt],A=!1,M=!1;Ew(Te)&&Ge.append(fb[6],fb[7]),gi(df(c),function(_){Ge.append(_,c[_])});var I=(Se={method:"POST",headers:Ge,body:$e},Se[fw]=!0,Se);fe||(I.keepalive=!0,A=!0,d+=Bt);var S=new Request(Te,I);try{S[fw]=!0}catch(_){}v._buffer[If](z);try{fetch(S).then(function(_){fe||(d-=Bt,Bt=0),M||(M=!0,_.ok?_.text().then(function(F){P(_.status,z,_.url,z[Tt],_.statusText,F)}):v[ma](z,_.statusText))}).catch(function(_){fe||(d-=Bt,Bt=0),M||(M=!0,v[ma](z,_.message))})}catch(_){M||v[ma](z,Wn(_))}A&&!M&&(M=!0,v._onSuccess(z,z[Tt]))}function w(z){try{if(z&&z!==""){var fe=Zo().parse(z);if(fe&&fe.itemsReceived&&fe.itemsReceived>=fe[Hw]&&fe.itemsReceived-fe.itemsAccepted===fe.errors[Tt])return fe}}catch(Se){ft(v[Xi](),1,43,"Cannot parse the response. "+pa(Se),{response:z})}return null}function T(z,fe){if(fe===void 0&&(fe=1),!(!z||z[Tt]===0)){var Se=v[ug];Se[lg](z),n++;for(var Te=0,Le=z;Te<Le.length;Te++){var $e=Le[Te];Se[sg]($e)}H(fe),Y()}}function H(z){var fe=10,Se;if(n<=1)Se=fe;else{var Te=(Math.pow(2,n)-1)/2,Le=Math.floor(Math.random()*Te*fe)+1;Le=z*Le,Se=Math.max(Math.min(Le,3600),fe)}var $e=vd()+Se*1e3;i=$e}function Y(){if(!a&&!s){var z=i?Math.max(0,i-vd()):0,fe=Math.max(v[jr][DW](),z);a=setTimeout(function(){a=null,v[cg](!0,null,1)},fe)}}function Z(){clearTimeout(a),a=null,i=null}function ie(z){return z===401||z===403||z===408||z===429||z===500||z===502||z===503||z===504}function ce(z,fe){return z?"XMLHttpRequest,Status:"+z.status+",Response:"+Y0(z)||z.response||"":fe}function be(z,fe){var Se=v[ug],Te=_b(),Le=new XDomainRequest;Le.onload=function(){return v._xdrOnLoad(Le,z)},Le.onerror=function(A){return v[ma](z,q(Le),A)};var $e=Te&&Te.location&&Te.location.protocol||"";if(v[jr][_f]().lastIndexOf($e,0)!==0){ft(v[Xi](),2,40,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),Se[bf]();return}var Ge=v[jr][_f]().replace(/^(https?:)/,"");Le.open("POST",Ge);var Bt=Se[ag](z);Le.send(Bt),Se[If](z)}function q(z,fe){return z?"XDomainRequest,Response:"+Y0(z)||"":fe}function $(){var z="getNotifyMgr";return v.core[z]?v.core[z]():v.core._notificationManager}function de(z,fe){var Se=$();if(Se&&Se[TW])try{Se[TW](z,fe)}catch(Te){ft(v[Xi](),1,74,"send request notification failed: "+pa(Te),{exception:Wn(Te)})}}function pe(z){var fe=Ut(z[kW])?!1:z[kW];if(fe)return!0;var Se="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",Te=new RegExp(Se);return Te.test(z[jw])}function ye(){v[Db]=null,v[ug]=null,v._appId=null,v._sample=null,c={},g=null,n=0,i=null,o=null,s=!1,a=null,l=null,u=0,d=0,f=null,m=null,b=null}}),t}return e.constructEnvelope=function(t,n,i,o){var s;n!==t.iKey&&!Ut(n)?s=Io(Io({},t),{iKey:n}):s=t;var a=mpe[s.baseType]||RW;return a(i,s,o)},e}(SW)});var AW=ge(()=>{p();JJ()});var Sl,ts,Jw,_l,Lt,Ds,Ac,$0,Ts,_t,mg,Br,z0,hg,gg,MW,Gw,vg,Rb,Yw,Cf,ks,Ab,wf,El,Mb,yg,Ns,ha,xf,Cd,OW,Pf,Cl,$w,zw,wd,bg,Q0,Ob,wl,LW,GJ,YJ,Bn,Qw,$J,Ig,Xw,Sg,xl,X0,Z0,eN,tN,Pn=ge(()=>{p();Sl="initialize",ts="name",Jw="getNotifyMgr",_l="identifier",Lt="push",Ds="isInitialized",Ac="config",$0="instrumentationKey",Ts="logger",_t="length",mg="time",Br="processNext",z0="getProcessTelContext",hg="addNotificationListener",gg="removeNotificationListener",MW="stopPollingInternalLogs",Gw="onComplete",vg="getPlugin",Rb="flush",Yw="_extensions",Cf="splice",ks="teardown",Ab="messageId",wf="message",El="isAsync",Mb="_doTeardown",yg="update",Ns="getNext",ha="diagLog",xf="setNextPlugin",Cd="createNew",OW="cookieCfg",Pf="indexOf",Cl="substring",$w="userAgent",zw="split",wd="setEnabled",bg="substr",Q0="nodeType",Ob="apply",wl="replace",LW="enableDebugExceptions",GJ="logInternalMessage",YJ="toLowerCase",Bn="call",Qw="type",$J="handler",Ig="listeners",Xw="isChildEvt",Sg="getCtx",xl="setCtx",X0="complete",Z0="traceId",eN="spanId",tN="traceFlags"});var kt,KW,un,FW,Zw,Lb,zJ,rs,ga,Kb,Df,Fb,Tf,rN,ex,_g,yi=ge(()=>{p();kt="",KW="channels",un="core",FW="createPerfMgr",Zw="disabled",Lb="extensionConfig",zJ="extensions",rs="processTelemetry",ga="priority",Kb="eventsSent",Df="eventsDiscarded",Fb="eventsSendRequest",Tf="perfEvent",rN="errorToConsole",ex="warnToConsole",_g="getPerfMgr"});function xpe(r){if(r){if(iN)return iN(r);var e=r[gpe]||r[Mt]||r[nN];if(e)return e}return null}function HW(r,e){return typeof r===e}function Dn(r){return r===void 0||typeof r===$t}function or(r){return r===null||Dn(r)}function qW(r){return!or(r)}function JW(r,e){return!!(r&&nr[Bn](r,e))}function xd(r){return!!(r&&typeof r===dt)}function wr(r){return!!(r&&typeof r===Xr)}function tx(r){var e=r;return e&&kf(e)&&(e=e[wl](Epe,function(t,n){return n.toUpperCase()}),e=e[wl](Cpe,"_"),e=e[wl](wpe,function(t,n){return"_"+n})),e}function Pd(r,e){if(r)for(var t in r)nr[Bn](r,t)&&e[Bn](r,t,r[t])}function GW(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=ype?r[o4](e):Ppe(r,e)),t}function Ppe(r,e){var t=!1,n=e?e[_t]:0,i=r?r[_t]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Ni(r,e){return r&&e?r[Pf](e)!==-1:!1}function YW(r){return!!(r&&BW[Bn](r)==="[object Date]")}function Dpe(r){return!!(r&&BW[Bn](r)==="[object Array]")}function oN(r){return!!(r&&BW[Bn](r)==="[object Error]")}function kf(r){return typeof r=="string"}function $W(r){return typeof r=="number"}function Ub(r){return typeof r=="boolean"}function r4(r){var e=!1;if(r&&typeof r=="object"){var t=iN?iN(r):xpe(r);t?(t[nN]&&nr[Bn](t,nN)&&(t=t[nN]),e=typeof t===Xr&&a4[Bn](t)===_pe):e=!0}return e}function Wb(r){if(r)return Ipe?r[i4]():Tpe(r)}function Tpe(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[_t]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function wt(r,e,t){var n=r[_t];try{for(var i=0;i<n&&!(i in r&&e[Bn](t||r,r[i],i,r)===-1);i++);}catch(o){}}function va(r,e,t){if(r){if(r[QJ])return r[QJ](e,t);var n=r[_t],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function zW(r,e,t){var n;if(r){if(r[XJ])return r[XJ](e,t);var i=r[_t],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[Bn](o,r[s],r))}catch(a){}}return n}function QW(r,e,t){var n;if(r){if(r[ZJ])return r[ZJ](e,t);var i=r[_t],o=0;if(arguments[_t]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function Pl(r){return r&&(r=vpe&&r[WW]?r[WW]():r[wl]?r[wl](/^\s+|(?=\s)\s+$/g,kt):r),r}function Vb(r){var e=typeof r;if(e!==Xr&&(e!==dt||r===null)&&na("objKeys called on non-object"),!n4&&t4)return t4(r);var t=[];for(var n in r)r&&nr[Bn](r,n)&&t[Lt](n);if(n4)for(var i=UW[_t],o=0;o<i;o++)r&&nr[Bn](r,UW[o])&&t[Lt](UW[o]);return t}function jb(r,e,t,n){if(e4)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),e4(r,e,i),!0}catch(o){}return!1}function kpe(r){return r}function XW(r){return VW&&Pd(r,function(e,t){(rn(t)||xd(t))&&VW(t)}),Mc(r)}function Dl(){var r=Date;return r.now?r.now():new r().getTime()}function rx(r){return oN(r)?r[ts]:kt}function ya(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Bb(r,e,t){var n;return r?(n=r[e],!n&&or(n)&&(n=Dn(t)?{}:t,r[e]=n)):n=Dn(t)?{}:t,n}function ba(r,e){return or(r)?e:r}function sN(r){return!!r}function ti(r){throw new Error(r)}function Npe(r,e){var t=null,n=null;return wr(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][Ob](n,i)}}function Hb(r,e,t,n,i){r&&e&&t&&(i!==!1||Dn(r[e]))&&(r[e]=Npe(t,n))}function Dd(r,e,t,n){return r&&e&&xd(r)&&rn(t)&&wt(t,function(i){kf(i)&&Hb(r,i,e,i,n)}),r}function qb(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[_t],u=!1,c=1;for(l>0&&Ub(a)&&(u=a,a=s[c]||{},c++),xd(a)||(a={});c<l;c++){var d=s[c],f=rn(d),m=xd(d);for(var g in d){var b=f&&g in d||m&&nr[Bn](d,g);if(b){var v=d[g],k=void 0;if(u&&v&&((k=rn(v))||r4(v))){var R=a[g];k?rn(R)||(R=[]):r4(R)||(R={}),v=qb(u,R,v)}v!==void 0&&(a[g]=v)}}}return a}var i4,o4,hpe,QJ,XJ,ZJ,WW,s4,gpe,nN,e4,VW,kHe,t4,jW,vpe,ype,NHe,bpe,Ipe,Spe,BW,a4,_pe,Epe,Cpe,wpe,iN,rn,n4,UW,Mc,Hn=ge(()=>{p();ir();Pn();yi();i4="toISOString",o4="endsWith",hpe="startsWith",QJ="indexOf",XJ="map",ZJ="reduce",WW="trim",s4="toString",gpe="__proto__",nN="constructor",e4=yo,VW=Er.freeze,kHe=Er.seal,t4=Er.keys,jW=String[Mt],vpe=jW[WW],ype=jW[o4],NHe=jW[hpe],bpe=Date[Mt],Ipe=bpe[i4],Spe=Array.isArray,BW=ra[s4],a4=nr[s4],_pe=a4[Bn](Er),Epe=/-([a-z])/g,Cpe=/([^\w\d_$])/g,wpe=/^(\d+[\w\d_$])/,iN=Object.getPrototypeOf;rn=Spe||Dpe;n4=!{toString:null}.propertyIsEnumerable("toString"),UW=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Mc=VW||kpe});function ZW(r){var e={};return Pd(r,function(t,n){e[t]=n,e[n]=t}),XW(e)}var l4=ge(()=>{p();Hn()});function Rs(r){var e=Kn();return e&&e[r]?e[r]:r===c4&&d4()?window:null}function d4(){return!!(typeof window===dt&&window)}function p4(){return d4()?window:Rs(c4)}function jpe(){return!!(typeof document===dt&&document)}function aN(){return jpe()?document:Rs(Rpe)}function Bpe(){return!!(typeof navigator===dt&&navigator)}function r2(){return Bpe()?navigator:Rs(Ape)}function f4(r){if(r&&Vpe){var e=Rs("__mockLocation");if(e)return e}return typeof location===dt&&location?location:Rs(Mpe)}function m4(){return typeof console!==$t?console:Rs(Ope)}function h4(){return Rs(Lpe)}function lN(){return!!(typeof JSON===dt&&JSON||Rs(u4)!==null)}function n2(){return lN()?JSON||Rs(u4):null}function g4(){return Rs(Kpe)}function v4(){return Rs(Fpe)}function Eg(){var r=r2();if(r&&(r[$w]!==t2||e2===null)){t2=r[$w];var e=(t2||kt)[YJ]();e2=Ni(e,Upe)||Ni(e,Wpe)}return e2}function Ia(r){var e=Object[Mt].toString[Bn](r),t=kt;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[ts]+"'":lN()&&(t=n2().stringify(r)),e+t}var c4,Rpe,Ape,Mpe,Ope,Lpe,u4,Kpe,Fpe,Upe,Wpe,e2,t2,Vpe,Oc=ge(()=>{"use strict";p();ir();Pn();Hn();yi();c4="window",Rpe="document",Ape="navigator",Mpe="location",Ope="console",Lpe="performance",u4="JSON",Kpe="crypto",Fpe="msCrypto",Upe="msie",Wpe="trident/",e2=null,t2=null,Vpe=!1});function Hpe(r,e){return function(){var t=arguments,n=o2(e);if(n){var i=n.listener;i&&i[r]&&i[r][Ob](i,t)}}}function qpe(){var r=Rs("Microsoft");return r&&(uN=r.ApplicationInsights),uN}function o2(r){var e=uN;return!e&&r.disableDbgExt!==!0&&(e=uN||qpe()),e?e.ChromeDbgExt:null}function y4(r){if(!cN){cN={};for(var e=0;e<i2[_t];e++)cN[i2[e]]=Hpe(i2[e],r)}return cN}var i2,uN,cN,s2=ge(()=>{p();Pn();Oc();i2=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],uN=null});function b4(r){return r?'"'+r[wl](/\"/g,kt)+'"':kt}function I4(r,e){var t=m4();if(t){var n="log";t[r]&&(n=r),wr(t[n])&&t[n](e)}}function S4(r,e){return(r||{})[Ts]||new Jb(e)}function _4(r){return r||new Jb}function Tl(r,e,t,n,i,o){o===void 0&&(o=!1),_4(r).throwInternal(e,t,n,i,o)}function E4(r,e){_4(r)[ex](e)}var Jpe,Gpe,Ype,dN,Jb,Cg=ge(()=>{"use strict";p();ur();Pn();s2();Oc();Hn();yi();Jpe="AI (Internal): ",Gpe="AI: ",Ype="AITR_";dN=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Ab]=e,o[wf]=(n?Gpe:Jpe)+e;var s=kt;lN()&&(s=n2().stringify(i));var a=(t?" message:"+b4(t):kt)+(i?" props:"+b4(s):kt);o[wf]+=a}return r.dataType="MessageData",r}();Jb=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[LW]=function(){return a},l.throwInternal=function(m,g,b,v,k){k===void 0&&(k=!1);var R=new dN(g,b,k,v);if(a)throw Ia(R);var P=m===1?rN:ex;if(Dn(R[wf]))f("throw"+(m===1?"Critical":"Warning"),R);else{if(k){var D=+R[Ab];!n[D]&&i>=m&&(l[P](R[wf]),n[D]=!0)}else i>=m&&l[P](R[wf]);u(m,R)}},l[ex]=function(m){I4("warn",m),f("warning",m)},l[rN]=function(m){I4("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[GJ]=u;function u(m,g){if(!d()){var b=!0,v=Ype+g[Ab];if(n[v]?b=!1:n[v]=!0,b&&(m<=o&&(l.queue[Lt](g),t++,f(m===1?"error":"warn",g)),t===s)){var k="Internal events throttle limit per PageView reached for this app.",R=new dN(23,k,!1);l.queue[Lt](R),m===1?l[rN](k):l[ex](k)}}}function c(m){i=ba(m.loggingLevelConsole,0),o=ba(m.loggingLevelTelemetry,1),s=ba(m.maxMessageLimit,25),a=ba(m[LW],!1)}function d(){return t>=s}function f(m,g){var b=o2(e||{});b&&b[ha]&&b[ha](m,g)}})}return r.__ieDyn=1,r}()});function fN(r,e,t,n,i){if(r){var o=r;if(o[_g]&&(o=o[_g]()),o){var s=void 0,a=o[Sg](a2);try{if(s=o.create(e(),n,i),s){if(a&&s[xl]&&(s[xl](pN[l2],a),a[Sg]&&a[xl])){var l=a[Sg](pN[nx]);l||(l=[],a[xl](pN[nx],l)),l[Lt](s)}return o[xl](a2,s),t(s)}}catch(u){s&&s[xl]&&s[xl]("exception",u)}finally{s&&o.fire(s),o[xl](a2,a)}}}return t()}function w4(){return $pe}var Gb,l2,nx,$pe,pN,C4,a2,mN=ge(()=>{p();ur();Pn();Hn();yi();Gb="ctx",l2="ParentContextKey",nx="ChildrenContextKey",$pe=null,pN=function(){function r(e,t,n){var i=this,o=!1;if(i.start=Dl(),i[ts]=e,i[El]=n,i[Xw]=function(){return!1},wr(t)){var s;o=jb(i,"payload",function(){return!s&&wr(t)&&(s=t(),t=null),s})}i[Sg]=function(a){return a?a===r[l2]||a===r[nx]?i[a]:(i[Gb]||{})[a]:null},i[xl]=function(a,l){if(a)if(a===r[l2])i[a]||(i[Xw]=function(){return!0}),i[a]=l;else if(a===r[nx])i[a]=l;else{var u=i[Gb]=i[Gb]||{};u[a]=l}},i[X0]=function(){var a=0,l=i[Sg](r[nx]);if(rn(l))for(var u=0;u<l[_t];u++){var c=l[u];c&&(a+=c[mg])}i[mg]=Dl()-i.start,i.exTime=i[mg]-a,i[X0]=function(){},!o&&wr(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),C4=function(){function r(e){this.ctx={},He(r,this,function(t){t.create=function(n,i,o){return new pN(n,i,o)},t.fire=function(n){n&&(n[X0](),e&&wr(e[Tf])&&e[Tf](n))},t[xl]=function(n,i){if(n){var o=t[Gb]=t[Gb]||{};o[n]=i}},t[Sg]=function(n){return(t[Gb]||{})[n]}})}return r.__ieDyn=1,r}(),a2="CoreUtils.doPerf"});function D4(r){r<0&&(r>>>=0),ix=123456789+r&Nf,ox=987654321-r&Nf,P4=!0}function T4(){try{var r=Dl()&2147483647;D4((Math.random()*x4^r)+r)}catch(e){}}function k4(r){return r>0?Math.floor(wg()/Nf*(r+1))>>>0:0}function wg(r){var e=0,t=g4()||v4();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&Nf),e===0&&Eg()&&(P4||T4(),e=c2()&Nf),e===0&&(e=Math.floor(x4*Math.random()|0)),r||(e>>>=0),e}function N4(r){r?D4(r):T4()}function c2(r){ox=36969*(ox&65535)+(ox>>16)&Nf,ix=18e3*(ix&65535)+(ix>>16)&Nf;var e=(ox<<16)+(ix&65535)>>>0&Nf|0;return r||(e>>>=0),e}function hN(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=wg()>>>0,n=0,i=kt;i[_t]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(wg()<<2&4294967295|t&3)>>>0,n=0);return i}var x4,Nf,P4,ix,ox,u2=ge(()=>{p();Pn();Oc();Hn();yi();x4=4294967296,Nf=4294967295,P4=!1,ix=123456789,ox=987654321});function Xpe(r,e,t){if(R4)try{return R4(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function M4(r){return r[Q0]===1||r[Q0]===9||!+r[Q0]}function Zpe(r,e){var t=e[r.id];if(!t){t={};try{M4(e)&&(Xpe(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function Yb(r,e){return e===void 0&&(e=!1),tx(r+Qpe+++(e?"."+A4:kt)+zpe)}function gN(r){var e={id:Yb("_aiData-"+(r||kt)+"."+A4),accept:function(t){return M4(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[tx(n)]:(o&&(s=Zpe(e,t),s[tx(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var R4,A4,zpe,Qpe,vN=ge(()=>{p();ir();Pn();Hn();yi();u2();R4=yo,A4="2.8.11",zpe="."+hN(6),Qpe=0});function q4(r,e){var t=sx[$b]||IN[$b];return t||(t=sx[$b]=sx(r,e),IN[$b]=t),t}function bN(r){return r?r.isEnabled():!0}function efe(r){var e=r[OW]=r[OW]||{};if(ya(e,"domain",r.cookieDomain,qW,or),ya(e,"path",r.cookiePath||"/",null,or),or(e[f2])){var t=void 0;Dn(r[K4])||(t=!r[K4]),Dn(r[F4])||(t=!r[F4]),e[f2]=t}return e}function J4(r,e){return e&&r&&rn(r.ignoreCookies)?r.ignoreCookies[Pf](e)!==-1:!1}function tfe(r,e){return e&&r&&rn(r.blockedCookies)&&r.blockedCookies[Pf](e)!==-1?!0:J4(r,e)}function sx(r,e){var t,n=efe(r||IN),i=n.path||"/",o=n.domain,s=n[f2]!==!1,a=(t={isEnabled:function(){var l=s&&V4(e),u=IN[$b];return l&&u&&a!==u&&(l=bN(u)),l}},t[wd]=function(l){s=l!==!1},t.set=function(l,u,c,d,f){var m=!1;if(bN(a)&&!tfe(n,l)){var g={},b=Pl(u||kt),v=b[Pf](";");if(v!==-1&&(b=Pl(u[Cl](0,v)),g=G4(u[Cl](v+1))),ya(g,"domain",d||o,sN,Dn),!or(c)){var k=Eg();if(Dn(g[d2])){var R=Dl(),P=R+c*1e3;if(P>0){var D=new Date;D.setTime(P),ya(g,d2,j4(D,k?O4:L4)||j4(D,k?O4:L4)||kt,sN)}}k||ya(g,"max-age",kt+c,null,Dn)}var K=f4();K&&K.protocol==="https:"&&(ya(g,"secure",null,null,Dn),p2===null&&(p2=!nfe((r2()||{})[$w])),p2&&ya(g,"SameSite","None",null,Dn)),ya(g,"path",f||i,null,Dn);var L=n.setCookie||H4;L(l,B4(b,g)),m=!0}return m},t.get=function(l){var u=kt;return bN(a)&&!J4(n,l)&&(u=(n.getCookie||rfe)(l)),u},t.del=function(l,u){var c=!1;return bN(a)&&(c=a.purge(l,u)),c},t.purge=function(l,u){var c,d=!1;if(V4(e)){var f=(c={},c.path=u||"/",c[d2]="Thu, 01 Jan 1970 00:00:01 GMT",c);Eg()||(f["max-age"]="0");var m=n.delCookie||H4;m(l,B4(kt,f)),d=!0}return d},t);return a[$b]=a,a}function V4(r){if(yN===null){yN=!1;try{var e=ax||{};yN=e[m2]!==void 0}catch(t){Tl(r,2,68,"Cannot access document.cookie - "+rx(t),{exception:Ia(t)})}}return yN}function G4(r){var e={};if(r&&r[_t]){var t=Pl(r)[zw](";");wt(t,function(n){if(n=Pl(n||kt),n){var i=n[Pf]("=");i===-1?e[n]=null:e[Pl(n[Cl](0,i))]=Pl(n[Cl](i+1))}})}return e}function j4(r,e){return wr(r[e])?r[e]():null}function B4(r,e){var t=r||kt;return Pd(e,function(n,i){t+="; "+n+(or(i)?kt:"="+i)}),t}function rfe(r){var e=kt;if(ax){var t=ax[m2]||kt;U4!==t&&(W4=G4(t),U4=t),e=Pl(W4[r]||kt)}return e}function H4(r,e){ax&&(ax[m2]=r+"="+e)}function nfe(r){return kf(r)?!!(Ni(r,"CPU iPhone OS 12")||Ni(r,"iPad; CPU OS 12")||Ni(r,"Macintosh; Intel Mac OS X 10_14")&&Ni(r,"Version/")&&Ni(r,"Safari")||Ni(r,"Macintosh; Intel Mac OS X 10_14")&&GW(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Ni(r,"Chrome/5")||Ni(r,"Chrome/6")||Ni(r,"UnrealEngine")&&!Ni(r,"Chrome")||Ni(r,"UCBrowser/12")||Ni(r,"UCBrowser/11")):!1}var O4,L4,m2,d2,f2,K4,F4,$b,yN,p2,U4,ax,W4,IN,h2=ge(()=>{p();Pn();Cg();Oc();Hn();yi();O4="toGMTString",L4="toUTCString",m2="cookie",d2="expires",f2="enabled",K4="isCookieUseDisabled",F4="disableCookiesUsage",$b="_ckMgr",yN=null,p2=null,U4=null,ax=aN(),W4={},IN={}});function z4(r){return r&&r[wl]?r[wl](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,kt):r}function ufe(r,e){var t;if(e){var n=kt;rn(e)?(n=kt,wt(e,function(o){o=z4(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=z4(e),n&&(n[0]!=="."&&(n="."+n),r=(r||kt)+n)}var i=cfe.exec(r||kt)||[];return t={},t[Qw]=i[1],t.ns=(i[2]||kt).replace(sfe,".").replace(afe,kt)[zw](".").sort().join("."),t}function dfe(r,e,t){t===void 0&&(t=!0);var n=Q4.get(r,ofe,{},t),i=n[e];return i||(i=n[e]=[]),i}function pfe(r,e,t,n){var i=!1;return r&&e&&e[Qw]&&t&&(r[$4]?(r[$4](e[Qw],t,n),i=!0):r[Y4]&&(r[Y4](ife+e[Qw],t),i=!0)),i}function g2(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=ufe(e,n);if(s=pfe(r,a,t,i),s&&Q4.accept(r)){var l=(o={guid:lfe++,evtName:a},o[$J]=t,o.capture=i,o);dfe(r,a.type)[Lt](l)}}catch(u){}return s}function X4(r,e,t){var n=!1,i=p4();i&&(n=g2(i,r,e,t),n=g2(i.body,r,e,t)||n);var o=aN();return o&&(n=g2(o,r,e,t)||n),n}var ife,Y4,$4,ofe,R7e,A7e,sfe,afe,lfe,Q4,cfe,Z4=ge(()=>{p();Pn();vN();Oc();Hn();yi();ife="on",Y4="attachEvent",$4="addEventListener",ofe="events",R7e=Yb("aiEvtPageHide"),A7e=Yb("aiEvtPageShow"),sfe=/\.[\.]+/g,afe=/[\.]+$/,lfe=1,Q4=gN("events"),cfe=/^([^.]*)(?:\.(.+)|)/});function eG(){var r=v2();return r[Cl](0,8)+"-"+r[Cl](8,12)+"-"+r[Cl](12,16)+"-"+r[Cl](16,20)+"-"+r[Cl](20)}function tG(){var r=h4();return r&&r.now?r.now():Dl()}function v2(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=kt,t,n=0;n<4;n++)t=wg(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(wg()&3)|0];return e[bg](0,8)+e[bg](9,4)+"4"+e[bg](13,3)+i+e[bg](16,3)+e[bg](19,12)}function rG(r,e){var t=q4(r,e),n=ux._canUseCookies;return lx===null&&(lx=[],cx=n,jb(ux,"_canUseCookies",function(){return cx},function(i){cx=i,wt(lx,function(o){o[wd](i)})})),va(lx,t)===-1&&lx[Lt](t),Ub(n)&&t[wd](n),Ub(cx)&&t[wd](cx),t}function nG(){rG()[wd](!1)}var lx,cx,ux,iG=ge(()=>{"use strict";p();ir();Pn();h2();Oc();Z4();Hn();yi();u2();lx=null;ux={_canUseCookies:void 0,isTypeof:HW,isUndefined:Dn,isNullOrUndefined:or,hasOwnProperty:JW,isFunction:wr,isObject:xd,isDate:YW,isArray:rn,isError:oN,isString:kf,isNumber:$W,isBoolean:Ub,toISOString:Wb,arrForEach:wt,arrIndexOf:va,arrMap:zW,arrReduce:QW,strTrim:Pl,objCreate:bo,objKeys:Vb,objDefineAccessors:jb,addEventHandler:X4,dateNow:Dl,isIE:Eg,disableCookies:nG,newGuid:eG,perfNow:tG,newId:hN,randomValue:k4,random32:wg,mwcRandomSeed:N4,mwcRandom32:c2,generateW3CId:v2}});function oG(r,e,t){return r&&r[_t]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function sG(r){return oG(r,32,ffe)}function aG(r){return oG(r,16,mfe)}var ffe,mfe,lG=ge(()=>{p();Pn();ffe="00000000000000000000000000000000",mfe="0000000000000000"});function Td(r){return hfe.get(r,"state",{},!0)}function SN(r,e){for(var t=[],n=null,i=r[Ns](),o;i;){var s=i[vg]();if(s){n&&wr(n[xf])&&wr(s[rs])&&n[xf](s);var a=!1;wr(s[Ds])?a=s[Ds]():(o=Td(s),a=o[Ds]),a||t[Lt](s),n=s,i=i[Ns]()}}wt(t,function(l){var u=r[un]();l[Sl](r.getCfg(),u,e,r[Ns]()),o=Td(l),!l[un]&&!o[un]&&(o[un]=u),o[Ds]=!0,delete o[ks]})}function _N(r){return r.sort(function(e,t){var n=0;if(t){var i=wr(t[rs]);wr(e[rs])?n=i?e[ga]-t[ga]:1:i&&(n=-1)}else n=e?1:-1;return n})}function cG(r){var e={};return{getName:function(){return e[ts]},setName:function(t){r&&r.setName(t),e[ts]=t},getTraceId:function(){return e[Z0]},setTraceId:function(t){r&&r.setTraceId(t),sG(t)&&(e[Z0]=t)},getSpanId:function(){return e[eN]},setSpanId:function(t){r&&r.setSpanId(t),aG(t)&&(e[eN]=t)},getTraceFlags:function(){return e[tN]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[tN]=t}}}var hfe,EN=ge(()=>{"use strict";p();Pn();vN();Hn();yi();lG();hfe=gN("plugin")});function vfe(r,e,t){for(;r;){if(r[vg]()===t)return r;r=r[Ns]()}return Lc([t],e[Ac]||{},e)}function y2(r,e,t,n){var i=null,o=[];n!==null&&(i=n?vfe(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return S4(t,e)},getCfg:function(){return e},getExtCfg:u,getConfig:c,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:d,onComplete:a}};function a(f,m){for(var g=[],b=2;b<arguments.length;b++)g[b-2]=arguments[b];f&&o[Lt]({func:f,self:Dn(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[Ns]():null,!f){var m=o;m&&m[_t]>0&&(wt(m,function(g){try{g.func[Bn](g.self,g.args)}catch(b){Tl(t[Ts],2,73,"Unexpected Exception during onComplete - "+Ia(b))}}),o=[])}return f}function u(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var b;if(e){var v=e[Lb];v&&f&&(b=v[f])}if(!b)b=m;else if(xd(m)&&g!==0){var k=qb(!0,m,b);e&&g===2&&Pd(m,function(R){if(or(k[R])){var P=e[R];or(P)||(k[R]=P)}}),b=k}return b}function c(f,m,g){g===void 0&&(g=!1);var b,v=u(f,null);return v&&!or(v[m])?b=v[m]:e&&!or(e[m])&&(b=e[m]),or(b)?g:b}function d(f){for(var m;m=s._next();){var g=m[vg]();g&&f(g)}}return s}function kl(r,e,t,n){var i=y2(r,e,t,n),o=i.ctx;function s(l){var u=i._next();return u&&u[rs](l,o),!u}function a(l,u){return l===void 0&&(l=null),rn(l)&&(l=Lc(l,e,t,u)),kl(l||o[Ns](),e,t,u)}return o[Br]=s,o[Cd]=a,o}function zb(r,e,t){var n=e[Ac]||{},i=y2(r,n,e,t),o=i.ctx;function s(l){var u=i._next();return u&&u.unload(o,l),!u}function a(l,u){return l===void 0&&(l=null),rn(l)&&(l=Lc(l,n,e,u)),zb(l||o[Ns](),e,u)}return o[Br]=s,o[Cd]=a,o}function dx(r,e,t){var n=e[Ac]||{},i=y2(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(u){wr(u[yg])&&u[yg](o,l)})}function a(l,u){return l===void 0&&(l=null),rn(l)&&(l=Lc(l,n,e,u)),dx(l||o[Ns](),e,u)}return o[Br]=s,o[Cd]=a,o}function Lc(r,e,t,n){var i=null,o=!n;if(rn(r)&&r[_t]>0){var s=null;wt(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&wr(a[rs])){var l=yfe(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Lc([n],e,t):i}function yfe(r,e,t){var n=null,i=wr(r[rs]),o=wr(r[xf]),s;r?s=r[_l]+"-"+r[ga]+"-"+pG++:s="Unknown-0-"+pG++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:c,unload:d,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&wr(r[dG])&&(m=r[dG]()),m||(m=kl(a,e,t)),m}function u(m,g,b,v,k){var R=!1,P=r?r[_l]:gfe,D=m[uG];return D||(D=m[uG]={}),m.setNext(n),r&&fN(m[un](),function(){return P+":"+b},function(){D[s]=!0;try{var K=n?n._id:kt;K&&(D[K]=!1),R=g(m)}catch(B){var L=n?D[n._id]:!0;L&&(R=!0),(!n||!L)&&Tl(m[ha](),1,73,"Plugin ["+P+"] failed during "+b+" - "+Ia(B)+", run flags: "+Ia(D))}},v,k),R}function c(m,g){g=g||l();function b(v){if(!r||!i)return!1;var k=Td(r);return k[ks]||k[Zw]?!1:(o&&r[xf](n),r[rs](m,v),!0)}u(g,b,"processTelemetry",function(){return{item:m}},!m.sync)||g[Br](m)}function d(m,g){function b(){var v=!1;if(r){var k=Td(r),R=r[un]||k[un];r&&(!R||R===m.core())&&!k[ks]&&(k[un]=null,k[ks]=!0,k[Ds]=!1,r[ks]&&r[ks](m,g)===!0&&(v=!0))}return v}u(m,b,"unload",function(){},g[El])||m[Br](g)}function f(m,g){function b(){var v=!1;if(r){var k=Td(r),R=r[un]||k[un];r&&(!R||R===m.core())&&!k[ks]&&r[yg]&&r[yg](m,g)===!0&&(v=!0)}return v}u(m,b,"update",function(){},!1)||m[Br](g)}return Mc(a)}var gfe,uG,dG,pG,p8e,CN=ge(()=>{"use strict";p();Pn();Cg();Oc();Hn();yi();mN();EN();gfe="TelemetryPluginChain",uG="_hasRun",dG="_getTelCtx",pG=0;p8e=function(){function r(e,t,n,i){var o=this,s=kl(e,t,n,i);Dd(o,s,Vb(s))}return r}()});function fG(r,e,t){e&&rn(e)&&e[_t]>0&&(e=e.sort(function(n,i){return n[ga]-i[ga]}),wt(e,function(n){n[ga]<px&&ti(bfe+n[_l])}),r[Lt]({queue:Mc(e),chain:Lc(e,t[Ac],t)}))}function mG(r,e){function t(){return kl(null,e[Ac],e,null)}function n(u,c,d,f){var m=u?u[_t]+1:1;function g(){m--,m===0&&(f&&f(),f=null)}m>0&&wt(u,function(b){if(b&&b.queue[_t]>0){var v=b.chain,k=c[Cd](v);k[Gw](g),d(k)}else m--}),g()}function i(u,c){var d=c||{reason:0};return n(r,u,function(f){f[Br](d)},function(){u[Br](d)}),!0}function o(u,c){var d=c||{reason:0,isAsync:!1};return n(r,u,function(f){f[Br](d)},function(){u[Br](d),a=!1}),!0}function s(u){var c=null;return r&&r[_t]>0&&wt(r,function(d){if(d&&d.queue[_t]>0&&(wt(d.queue,function(f){if(f[_l]===u)return c=f,-1}),c))return-1}),c}var a=!1,l={identifier:"ChannelControllerPlugin",priority:px,initialize:function(u,c,d,f){a=!0,wt(r,function(m){m&&m.queue[_t]>0&&SN(kl(m.chain,u,c),d)})},isInitialized:function(){return a},processTelemetry:function(u,c){n(r,c||t(),function(d){d[Br](u)},function(){c[Br](u)})},update:i,pause:function(){n(r,t(),function(u){u.iterate(function(c){c.pause&&c.pause()})},null)},resume:function(){n(r,t(),function(u){u.iterate(function(c){c.resume&&c.resume()})},null)},teardown:o,getChannel:s,flush:function(u,c,d,f){var m=1,g=!1,b=null;f=f||5e3;function v(){m--,g&&m===0&&(b&&(clearTimeout(b),b=null),c&&c(g),c=null)}return n(r,t(),function(k){k.iterate(function(R){if(R[Rb]){m++;var P=!1;R[Rb](u,function(){P=!0,v()},d)||P||(u&&b==null?b=setTimeout(function(){b=null,v()},f):v())}})},function(){g=!0,v()}),!0},_setQueue:function(u){r=u}};return l}function hG(r,e,t){var n=[];if(r&&wt(r,function(o){return fG(n,o,t)}),e){var i=[];wt(e,function(o){o[ga]>px&&i[Lt](o)}),fG(n,i,t)}return n}var px,bfe,gG=ge(()=>{p();Pn();Hn();yi();CN();EN();px=500,bfe="Channel has invalid priority - "});function wN(){var r=[];function e(n){n&&r[Lt](n)}function t(n,i){wt(r,function(o){try{o(n,i)}catch(s){Tl(n[ha](),2,73,"Unexpected error calling unload handler - "+Ia(s))}}),r=[]}return{add:e,run:t}}var b2=ge(()=>{p();Pn();Cg();Oc();Hn()});var Rf,vG,yG=ge(()=>{"use strict";p();ur();Pn();Hn();yi();CN();b2();Rf="getPlugin",vG=function(){function r(){var e=this,t,n,i,o,s;u(),He(r,e,function(c){c[Sl]=function(d,f,m,g){l(d,f,g),t=!0},c[ks]=function(d,f){var m,g=c[un];if(!g||d&&g!==d[un]())return;var b,v=!1,k=d||zb(null,g,i&&i[Rf]?i[Rf]():i),R=f||(m={reason:0},m[El]=!1,m);function P(){if(!v){v=!0,o.run(k,f);var D=s;s=[],wt(D,function(K){K.rm()}),b===!0&&k[Br](R),u()}}return!c[Mb]||c[Mb](k,R,P)!==!0?P():b=!0,b},c[yg]=function(d,f){var m=c[un];if(!m||d&&m!==d[un]())return;var g,b=!1,v=d||dx(null,m,i&&i[Rf]?i[Rf]():i),k=f||{reason:0};function R(){b||(b=!0,l(v.getCfg(),v.core(),v[Ns]()))}return!c._doUpdate||c._doUpdate(v,k,R)!==!0?R():g=!0,g},c._addHook=function(d){d&&(rn(d)?s=s.concat(d):s[Lt](d))},Hb(c,"_addUnloadCb",function(){return o},"add")}),e[ha]=function(c){return a(c)[ha]()},e[Ds]=function(){return t},e.setInitialized=function(c){t=c},e[xf]=function(c){i=c},e[Br]=function(c,d){d?d[Br](c):i&&wr(i[rs])&&i[rs](c,null)},e._getTelCtx=a;function a(c){c===void 0&&(c=null);var d=c;if(!d){var f=n||kl(null,{},e[un]);i&&i[Rf]?d=f[Cd](null,i[Rf]):d=f[Cd](null,i)}return d}function l(c,d,f){c&&ya(c,Lb,[],null,or),!f&&d&&(f=d[z0]()[Ns]());var m=i;i&&i[Rf]&&(m=i[Rf]()),e[un]=d,n=kl(f,c,d,m)}function u(){t=!1,e[un]=null,n=null,i=null,s=[],o=wN()}}return r.__ieDyn=1,r}()});var bG,IG=ge(()=>{p();ir();ur();Pn();yG();Cg();Oc();Hn();yi();bG=function(r){yn(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),He(e,t,function(s,a){s.addTelemetryInitializer=function(l){var u={id:n++,fn:l};i[Lt](u);var c={remove:function(){wt(i,function(d,f){if(d.id===u.id)return i[Cf](f,1),-1})}};return c},s[rs]=function(l,u){for(var c=!1,d=i[_t],f=0;f<d;++f){var m=i[f];if(m)try{if(m.fn[Ob](null,[l])===!1){c=!0;break}}catch(g){Tl(u[ha](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+rx(g),{exception:Ia(g)},!0)}}c||s[Br](l,u)},s[Mb]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(vG)});function _fe(r,e){return new C4(e)}function Efe(r,e,t){var n,i=[],o={};return wt(t,function(s){(or(s)||or(s[Sl]))&&ti(CG);var a=s[ga],l=s[_l];s&&a&&(or(o[a])?o[a]=l:E4(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Lt](s)}),n={all:t},n[un]=i,n}function EG(r,e){var t=!1;return wt(e,function(n){if(n===r)return t=!0,-1}),t}function Cfe(){var r;return bo((r={},r[hg]=function(e){},r[gg]=function(e){},r[Kb]=function(e){},r[Df]=function(e,t){},r[Fb]=function(e,t){},r))}var CG,SG,_G,Ife,Sfe,wG,xG=ge(()=>{"use strict";p();ir();ur();ir();Pn();gG();h2();vN();s2();Cg();Hn();yi();mN();CN();EN();IG();b2();CG="Plugins must provide initialize method",SG="_notificationManager",_G="SDK is still unloading...",Ife="SDK is not initialized",Sfe={loggingLevelConsole:1};wG=function(){function r(){var e,t,n,i,o,s,a,l,u,c,d,f,m,g,b,v,k,R,P,D,K=0;He(r,this,function(L){B(),L[Ds]=function(){return t},L[Sl]=function(q,$,de,pe){g&&ti(_G),L[Ds]()&&ti("Core should not be initialized more than once"),e=q||{},L[Ac]=e,or(q[$0])&&ti("Please provide instrumentation key"),i=pe,L[SG]=pe,Y(),Z(),ie(),de&&(L[Ts]=de);var ye=Bb(e,zJ,[]);u=[],u[Lt].apply(u,Hm(Hm([],$,!1),ye,!1)),f=Bb(e,KW,[]),O(null),(!m||m[_t]===0)&&ti("No "+KW+" available"),t=!0,L.releaseQueue()},L.getTransmissionControls=function(){var q=[];return m&&wt(m,function($){q[Lt]($.queue)}),Mc(q)},L.track=function(q){q.iKey=q.iKey||e[$0],q[mg]=q[mg]||Wb(new Date),q.ver=q.ver||"4.0",!g&&L[Ds]()?N()[Br](q):n[Lt](q)},L[z0]=N,L[Jw]=function(){return i||(i=Cfe(),L[SG]=i),i},L[hg]=function(q){i&&i[hg](q)},L[gg]=function(q){i&&i[gg](q)},L.getCookieMgr=function(){return a||(a=sx(e,L[Ts])),a},L.setCookieMgr=function(q){a=q},L[_g]=function(){if(!o&&!s&&ba(e.enablePerfMgr)){var q=ba(e[FW]);wr(q)&&(s=q(L,L[Jw]()))}return o||s||w4()},L.setPerfMgr=function(q){o=q},L.eventCnt=function(){return n[_t]},L.releaseQueue=function(){if(t&&n[_t]>0){var q=n;n=[],wt(q,function($){N()[Br]($)})}},L.pollInternalLogs=function(q){v=q||null;var $=ba(e.diagnosticLogInterval);return(!$||!($>0))&&($=1e4),K&&clearInterval(K),K=setInterval(function(){T()},$),K},L[MW]=function(){K&&(clearInterval(K),K=0,T())},Dd(L,function(){return b},["addTelemetryInitializer"]),L.unload=function(q,$,de){var pe;q===void 0&&(q=!0),t||ti(Ife),g&&ti(_G);var ye=(pe={reason:50},pe[El]=q,pe.flushComplete=!1,pe),z=zb(y(),L);z[Gw](function(){B(),$&&$(ye)},L);function fe(Se){ye.flushComplete=Se,g=!0,R.run(z,ye),L[MW](),z[Br](ye)}H(q,fe,6,de)||fe(!1)},L[vg]=h,L.addPlugin=function(q,$,de,pe){if(!q){pe&&pe(!1),be(CG);return}var ye=h(q[_l]);if(ye&&!$){pe&&pe(!1),be("Plugin ["+q[_l]+"] is already loaded!");return}var z={reason:16};function fe(Le){u[Lt](q),z.added=[q],O(z),pe&&pe(!0)}if(ye){var Se=[ye.plugin],Te={reason:2,isAsync:!!de};w(Se,Te,function(Le){Le?(z.removed=Se,z.reason|=32,fe(!0)):pe&&pe(!1)})}else fe(!1)},L.evtNamespace=function(){return k},L[Rb]=H,L.getTraceCtx=function(q){return D||(D=cG()),D},L.setTraceCtx=function(q){D=q||null},Hb(L,"addUnloadCb",function(){return R},"add");function B(){t=!1,e=qb(!0,{},Sfe),L[Ac]=e,L[Ts]=new Jb(e),L[Yw]=[],b=new bG,n=[],i=null,o=null,s=null,a=null,l=null,c=null,u=[],d=null,f=null,m=null,g=!1,v=null,k=Yb("AIBaseCore",!0),R=wN(),D=null}function N(){return kl(y(),e,L)}function O(q){var $=Efe(L[Ts],px,u);c=$[un],l=null;var de=$.all;if(m=Mc(hG(f,de,L)),d){var pe=va(de,d);pe!==-1&&de[Cf](pe,1),pe=va(c,d),pe!==-1&&c[Cf](pe,1),d._setQueue(m)}else d=mG(m,L);de[Lt](d),c[Lt](d),L[Yw]=_N(de),d[Sl](e,L,de),SN(N(),de),L[Yw]=Mc(_N(c||[])).slice(),q&&ce(q)}function h(q){var $,de=null,pe=null;return wt(L[Yw],function(ye){if(ye[_l]===q&&ye!==d&&ye!==b)return pe=ye,-1}),!pe&&d&&(pe=d.getChannel(q)),pe&&(de=($={plugin:pe},$[wd]=function(ye){Td(pe)[Zw]=!ye},$.isEnabled=function(){var ye=Td(pe);return!ye[ks]&&!ye[Zw]},$.remove=function(ye,z){var fe;ye===void 0&&(ye=!0);var Se=[pe],Te=(fe={reason:1},fe[El]=ye,fe);w(Se,Te,function(Le){Le&&O({reason:32,removed:Se}),z&&z(Le)})},$)),de}function y(){if(!l){var q=(c||[]).slice();va(q,b)===-1&&q[Lt](b),l=Lc(_N(q),e,L)}return l}function w(q,$,de){if(q&&q[_t]>0){var pe=Lc(q,e,L),ye=zb(pe,L);ye[Gw](function(){var z=!1,fe=[];wt(u,function(Te,Le){EG(Te,q)?z=!0:fe[Lt](Te)}),u=fe;var Se=[];f&&(wt(f,function(Te,Le){var $e=[];wt(Te,function(Ge){EG(Ge,q)?z=!0:$e[Lt](Ge)}),Se[Lt]($e)}),f=Se),de&&de(z)}),ye[Br]($)}else de(!1)}function T(){var q=L[Ts]?L[Ts].queue:[];q&&(wt(q,function($){var de,pe=(de={},de[ts]=v||"InternalMessageId: "+$[Ab],de.iKey=ba(e[$0]),de.time=Wb(new Date),de.baseType=dN.dataType,de.baseData={message:$[wf]},de);L.track(pe)}),q[_t]=0)}function H(q,$,de,pe){return d?d[Rb](q,$,de||6,pe):($&&$(!1),!0)}function Y(){var q=ba(e.disableDbgExt);q===!0&&P&&(i[gg](P),P=null),i&&!P&&q!==!0&&(P=y4(e),i[hg](P))}function Z(){var q=ba(e.enablePerfMgr);!q&&s&&(s=null),q&&Bb(e,FW,_fe)}function ie(){var q=Bb(e,Lb,{});q.NotificationManager=i}function ce(q){var $=dx(y(),L);(!L._updateHook||L._updateHook($,q)!==!0)&&$[Br](q)}function be(q){var $=L[Ts];$?Tl($,2,73,q):ti(q)}})}return r.__ieDyn=1,r}()});function xN(r,e,t,n){wt(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var PG,DG=ge(()=>{p();ur();Pn();Hn();yi();PG=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;He(r,this,function(n){n[hg]=function(i){n.listeners[Lt](i)},n[gg]=function(i){for(var o=va(n[Ig],i);o>-1;)n.listeners[Cf](o,1),o=va(n[Ig],i)},n[Kb]=function(i){xN(n[Ig],Kb,!0,function(o){o[Kb](i)})},n[Df]=function(i,o){xN(n[Ig],Df,!0,function(s){s[Df](i,o)})},n[Fb]=function(i,o){xN(n[Ig],Fb,o,function(s){s[Fb](i,o)})},n[Tf]=function(i){i&&(t||!i[Xw]())&&xN(n[Ig],Tf,!1,function(o){i[El]?setTimeout(function(){return o[Tf](i)},0):o[Tf](i)})}})}return r.__ieDyn=1,r}()});var fx,TG=ge(()=>{p();ir();ur();Pn();xG();Cg();Hn();yi();DG();mN();fx=function(r){yn(e,r);function e(){var t=r.call(this)||this;return He(e,t,function(n,i){n[Sl]=function(a,l,u,c){i[Sl](a,l,u||new Jb(a),c||new PG(a))},n.track=function(a){fN(n[_g](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),ti("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){or(a[ts])&&(s(a),ti("telemetry name required"))}function s(a){var l=n[Jw]();l&&l[Df]([a],2)}}),t}return e.__ieDyn=1,e}(wG)});var Me,kr,xg,Nl,kG,NG,PN,I2,mx,DN,Qb,Rl,Af,kd,hx,RG,wfe,S2,AG=ge(()=>{p();l4();kr="Failed",xg=kr+"MonitorAjax",Nl="Track",kG="Start",NG="Stop",PN="Event",I2="AuthContext",mx="Exception",DN="Local",Qb="Session",Rl="Storage",Af="Browser",kd="Cannot",hx="Buffer",RG="InstrumentationKey",wfe=ZW({CRITICAL:1,WARNING:2}),S2=ZW((Me={},Me[Af+"DoesNotSupport"+DN+Rl]=0,Me[Af+kd+"Read"+DN+Rl]=1,Me[Af+kd+"Read"+Qb+Rl]=2,Me[Af+kd+"Write"+DN+Rl]=3,Me[Af+kd+"Write"+Qb+Rl]=4,Me[Af+kr+"RemovalFrom"+DN+Rl]=5,Me[Af+kr+"RemovalFrom"+Qb+Rl]=6,Me[kd+"SendEmptyTelemetry"]=7,Me.ClientPerformanceMathError=8,Me["ErrorParsingAI"+Qb+"Cookie"]=9,Me.ErrorPVCalc=10,Me[mx+"WhileLoggingError"]=11,Me[kr+"AddingTelemetryTo"+hx]=12,Me[xg+"Abort"]=13,Me[xg+"Dur"]=14,Me[xg+"Open"]=15,Me[xg+"RSC"]=16,Me[xg+"Send"]=17,Me[xg+"GetCorrelationHeader"]=18,Me[kr+"ToAddHandlerForOnBeforeUnload"]=19,Me[kr+"ToSendQueuedTelemetry"]=20,Me[kr+"ToReportDataLoss"]=21,Me["Flush"+kr]=22,Me.MessageLimitPerPVExceeded=23,Me.MissingRequiredFieldSpecification=24,Me.NavigationTimingNotSupported=25,Me.OnError=26,Me[Qb+"RenewalDateIsZero"]=27,Me.SenderNotInitialized=28,Me[kG+Nl+PN+kr]=29,Me[NG+Nl+PN+kr]=30,Me[kG+Nl+kr]=31,Me[NG+Nl+kr]=32,Me.TelemetrySampledAndNotSent=33,Me[Nl+PN+kr]=34,Me[Nl+mx+kr]=35,Me[Nl+"Metric"+kr]=36,Me[Nl+"PV"+kr]=37,Me[Nl+"PV"+kr+"Calc"]=38,Me[Nl+"Trace"+kr]=39,Me["Transmission"+kr]=40,Me[kr+"ToSet"+Rl+hx]=41,Me[kr+"ToRestore"+Rl+hx]=42,Me.InvalidBackendResponse=43,Me[kr+"ToFixDepricatedValues"]=44,Me.InvalidDurationValue=45,Me.TelemetryEnvelopeInvalid=46,Me.CreateEnvelopeError=47,Me[kd+"SerializeObject"]=48,Me[kd+"SerializeObjectNonSerializable"]=49,Me.CircularReferenceDetected=50,Me["Clear"+I2+kr]=51,Me[mx+"Truncated"]=52,Me.IllegalCharsInName=53,Me.ItemNotInArray=54,Me.MaxAjaxPerPVExceeded=55,Me.MessageTruncated=56,Me.NameTooLong=57,Me.SampleRateOutOfRange=58,Me["Set"+I2+kr]=59,Me["Set"+I2+kr+"AccountName"]=60,Me.StringValueTooLong=61,Me.StartCalledMoreThanOnce=62,Me.StopCalledWithoutStart=63,Me["TelemetryInitializer"+kr]=64,Me.TrackArgumentsNotSpecified=65,Me.UrlTooLong=66,Me[Qb+Rl+hx+"Full"]=67,Me[kd+"AccessCookie"]=68,Me.IdTooLong=69,Me.InvalidEvent=70,Me[xg+"SetRequestHeader"]=71,Me["Send"+Af+"InfoOnUserInit"]=72,Me["Plugin"+mx]=73,Me["Notification"+mx]=74,Me.SnippetScriptLoadFailure=99,Me["Invalid"+RG]=100,Me[kd+"ParseAiBlobValue"]=101,Me.InvalidContentBlob=102,Me[Nl+"PageAction"+PN+kr]=103,Me[kr+"AddingCustomDefinedRequestContext"]=104,Me["InMemory"+Rl+hx+"Full"]=105,Me[RG+"Deprecation"]=106,Me))});var _2=ge(()=>{p();TG();iG();Hn();AG()});var TN,kN,gx,MG=ge(()=>{p();TN="instrumentationKey",kN="connectionString",gx="diagnosticLogInterval"});var OG={};Vv(OG,{AppInsightsCore:()=>fx,ApplicationInsights:()=>xfe,CoreUtils:()=>ux,Sender:()=>qw,SeverityLevel:()=>MU,_InternalMessageId:()=>S2,arrForEach:()=>wt,isNullOrUndefined:()=>or,proxyFunctions:()=>Dd,throwError:()=>ti});var xfe,LG=ge(()=>{p();ur();AW();af();_2();MG();_2();af();AW();xfe=function(){function r(e){var t=new fx;(or(e)||or(e[TN])&&or(e[kN]))&&ti("Invalid input configuration"),He(r,this,function(n){if(e[kN]){var i=PU(e[kN]),o=i.ingestionendpoint;e.endpointUrl=o?o+cd:e.endpointUrl,e[TN]=i.instrumentationkey||e[TN]}n.config=e,s(),n.initialize=s,n.getSKUDefaults=function(){n.config[gx]=n.config[gx]&&n.config[gx]>0?n.config[gx]:1e4},n.getSKUDefaults(),Dd(n,t,["track","flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb"]);function s(){t.initialize(n.config,[new qw]),t.pollInternalLogs()}})}return r.__ieDyn=1,r}()});var FG={};Vv(FG,{default:()=>NN});function Dfe(r){if(r.userAgentData){let e=r.userAgentData.brands[r.userAgentData.brands.length-1];return`${r.userAgentData.platform} - ${e==null?void 0:e.brand} v${e==null?void 0:e.version}}`}else return r.appVersion}var KG,Pfe,NN,UG=ge(()=>{p();KG=oe(require("vscode"));a3();l3();c3();u3();Pfe=async(r,e)=>{let t;try{let i=await Promise.resolve().then(()=>(LG(),OG));t=new i.ApplicationInsights({instrumentationKey:r,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0})}catch(i){return Promise.reject(i)}return{logEvent:(i,o)=>{let s={...o==null?void 0:o.properties,...o==null?void 0:o.measurements};e!=null&&e.length&&sb.applyReplacements(s,e),t==null||t.track({name:i,data:s})},flush:async()=>{t==null||t.flush()}}};NN=class extends Fk{constructor(e,t){let n=s=>Pfe(s,t);sb.shouldUseOneDataSystemSDK(e)&&(n=s=>s3(s,KG));let i={release:Dfe(navigator),platform:"web",architecture:"web"},o=new Kk(e,n);if(e&&e.indexOf("AIF")===0)throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(o,KG,{additionalCommonProperties:sb.getAdditionalCommonProperties(i)})}}});var GN=re((mt,aY)=>{p();mt=aY.exports=zt;var xr;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?xr=function(){var r=Array.prototype.slice.call(arguments,0);r.unshift("SEMVER"),console.log.apply(console,r)}:xr=function(){};mt.SEMVER_SPEC_VERSION="2.0.0";var vx=256,FN=Number.MAX_SAFE_INTEGER||9007199254740991,x2=16,Age=vx-6,yx=mt.re=[],Hr=mt.safeRe=[],De=mt.src=[],Jt=0,N2="[a-zA-Z0-9-]",P2=[["\\s",1],["\\d",vx],[N2,Age]];function HN(r){for(var e=0;e<P2.length;e++){var t=P2[e][0],n=P2[e][1];r=r.split(t+"*").join(t+"{0,"+n+"}").split(t+"+").join(t+"{1,"+n+"}")}return r}var tI=Jt++;De[tI]="0|[1-9]\\d*";var rI=Jt++;De[rI]="\\d+";var R2=Jt++;De[R2]="\\d*[a-zA-Z-]"+N2+"*";var GG=Jt++;De[GG]="("+De[tI]+")\\.("+De[tI]+")\\.("+De[tI]+")";var YG=Jt++;De[YG]="("+De[rI]+")\\.("+De[rI]+")\\.("+De[rI]+")";var D2=Jt++;De[D2]="(?:"+De[tI]+"|"+De[R2]+")";var T2=Jt++;De[T2]="(?:"+De[rI]+"|"+De[R2]+")";var A2=Jt++;De[A2]="(?:-("+De[D2]+"(?:\\."+De[D2]+")*))";var M2=Jt++;De[M2]="(?:-?("+De[T2]+"(?:\\."+De[T2]+")*))";var k2=Jt++;De[k2]=N2+"+";var Ix=Jt++;De[Ix]="(?:\\+("+De[k2]+"(?:\\."+De[k2]+")*))";var O2=Jt++,$G="v?"+De[GG]+De[A2]+"?"+De[Ix]+"?";De[O2]="^"+$G+"$";var L2="[v=\\s]*"+De[YG]+De[M2]+"?"+De[Ix]+"?",K2=Jt++;De[K2]="^"+L2+"$";var aI=Jt++;De[aI]="((?:<|>)?=?)";var UN=Jt++;De[UN]=De[rI]+"|x|X|\\*";var WN=Jt++;De[WN]=De[tI]+"|x|X|\\*";var Dg=Jt++;De[Dg]="[v=\\s]*("+De[WN]+")(?:\\.("+De[WN]+")(?:\\.("+De[WN]+")(?:"+De[A2]+")?"+De[Ix]+"?)?)?";var iI=Jt++;De[iI]="[v=\\s]*("+De[UN]+")(?:\\.("+De[UN]+")(?:\\.("+De[UN]+")(?:"+De[M2]+")?"+De[Ix]+"?)?)?";var zG=Jt++;De[zG]="^"+De[aI]+"\\s*"+De[Dg]+"$";var QG=Jt++;De[QG]="^"+De[aI]+"\\s*"+De[iI]+"$";var XG=Jt++;De[XG]="(?:^|[^\\d])(\\d{1,"+x2+"})(?:\\.(\\d{1,"+x2+"}))?(?:\\.(\\d{1,"+x2+"}))?(?:$|[^\\d])";var qN=Jt++;De[qN]="(?:~>?)";var oI=Jt++;De[oI]="(\\s*)"+De[qN]+"\\s+";yx[oI]=new RegExp(De[oI],"g");Hr[oI]=new RegExp(HN(De[oI]),"g");var Mge="$1~",ZG=Jt++;De[ZG]="^"+De[qN]+De[Dg]+"$";var eY=Jt++;De[eY]="^"+De[qN]+De[iI]+"$";var JN=Jt++;De[JN]="(?:\\^)";var sI=Jt++;De[sI]="(\\s*)"+De[JN]+"\\s+";yx[sI]=new RegExp(De[sI],"g");Hr[sI]=new RegExp(HN(De[sI]),"g");var Oge="$1^",tY=Jt++;De[tY]="^"+De[JN]+De[Dg]+"$";var rY=Jt++;De[rY]="^"+De[JN]+De[iI]+"$";var F2=Jt++;De[F2]="^"+De[aI]+"\\s*("+L2+")$|^$";var U2=Jt++;De[U2]="^"+De[aI]+"\\s*("+$G+")$|^$";var Tg=Jt++;De[Tg]="(\\s*)"+De[aI]+"\\s*("+L2+"|"+De[Dg]+")";yx[Tg]=new RegExp(De[Tg],"g");Hr[Tg]=new RegExp(HN(De[Tg]),"g");var Lge="$1$2$3",nY=Jt++;De[nY]="^\\s*("+De[Dg]+")\\s+-\\s+("+De[Dg]+")\\s*$";var iY=Jt++;De[iY]="^\\s*("+De[iI]+")\\s+-\\s+("+De[iI]+")\\s*$";var oY=Jt++;De[oY]="(<|>)?=?\\s*\\*";for(Fc=0;Fc<Jt;Fc++)xr(Fc,De[Fc]),yx[Fc]||(yx[Fc]=new RegExp(De[Fc]),Hr[Fc]=new RegExp(HN(De[Fc])));var Fc;mt.parse=kg;function kg(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof zt)return r;if(typeof r!="string"||r.length>vx)return null;var t=e.loose?Hr[K2]:Hr[O2];if(!t.test(r))return null;try{return new zt(r,e)}catch(n){return null}}mt.valid=Kge;function Kge(r,e){var t=kg(r,e);return t?t.version:null}mt.clean=Fge;function Fge(r,e){var t=kg(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null}mt.SemVer=zt;function zt(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof zt){if(r.loose===e.loose)return r;r=r.version}else if(typeof r!="string")throw new TypeError("Invalid Version: "+r);if(r.length>vx)throw new TypeError("version is longer than "+vx+" characters");if(!(this instanceof zt))return new zt(r,e);xr("SemVer",r,e),this.options=e,this.loose=!!e.loose;var t=r.trim().match(e.loose?Hr[K2]:Hr[O2]);if(!t)throw new TypeError("Invalid Version: "+r);if(this.raw=r,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>FN||this.major<0)throw new TypeError("Invalid major version");if(this.minor>FN||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>FN||this.patch<0)throw new TypeError("Invalid patch version");t[4]?this.prerelease=t[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<FN)return i}return n}):this.prerelease=[],this.build=t[5]?t[5].split("."):[],this.format()}zt.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};zt.prototype.toString=function(){return this.version};zt.prototype.compare=function(r){return xr("SemVer.compare",this.version,this.options,r),r instanceof zt||(r=new zt(r,this.options)),this.compareMain(r)||this.comparePre(r)};zt.prototype.compareMain=function(r){return r instanceof zt||(r=new zt(r,this.options)),nI(this.major,r.major)||nI(this.minor,r.minor)||nI(this.patch,r.patch)};zt.prototype.comparePre=function(r){if(r instanceof zt||(r=new zt(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;var e=0;do{var t=this.prerelease[e],n=r.prerelease[e];if(xr("prerelease compare",e,t,n),t===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(t===void 0)return-1;if(t===n)continue;return nI(t,n)}while(++e)};zt.prototype.inc=function(r,e){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)typeof this.prerelease[t]=="number"&&(this.prerelease[t]++,t=-2);t===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+r)}return this.format(),this.raw=this.version,this};mt.inc=Uge;function Uge(r,e,t,n){typeof t=="string"&&(n=t,t=void 0);try{return new zt(r,t).inc(e,n).version}catch(i){return null}}mt.diff=Wge;function Wge(r,e){if(W2(r,e))return null;var t=kg(r),n=kg(e),i="";if(t.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in t)if((s==="major"||s==="minor"||s==="patch")&&t[s]!==n[s])return i+s;return o}mt.compareIdentifiers=nI;var JG=/^[0-9]+$/;function nI(r,e){var t=JG.test(r),n=JG.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1}mt.rcompareIdentifiers=Vge;function Vge(r,e){return nI(e,r)}mt.major=jge;function jge(r,e){return new zt(r,e).major}mt.minor=Bge;function Bge(r,e){return new zt(r,e).minor}mt.patch=Hge;function Hge(r,e){return new zt(r,e).patch}mt.compare=Rd;function Rd(r,e,t){return new zt(r,t).compare(new zt(e,t))}mt.compareLoose=qge;function qge(r,e){return Rd(r,e,!0)}mt.rcompare=Jge;function Jge(r,e,t){return Rd(e,r,t)}mt.sort=Gge;function Gge(r,e){return r.sort(function(t,n){return mt.compare(t,n,e)})}mt.rsort=Yge;function Yge(r,e){return r.sort(function(t,n){return mt.rcompare(t,n,e)})}mt.gt=bx;function bx(r,e,t){return Rd(r,e,t)>0}mt.lt=VN;function VN(r,e,t){return Rd(r,e,t)<0}mt.eq=W2;function W2(r,e,t){return Rd(r,e,t)===0}mt.neq=sY;function sY(r,e,t){return Rd(r,e,t)!==0}mt.gte=V2;function V2(r,e,t){return Rd(r,e,t)>=0}mt.lte=j2;function j2(r,e,t){return Rd(r,e,t)<=0}mt.cmp=jN;function jN(r,e,t,n){switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return W2(r,t,n);case"!=":return sY(r,t,n);case">":return bx(r,t,n);case">=":return V2(r,t,n);case"<":return VN(r,t,n);case"<=":return j2(r,t,n);default:throw new TypeError("Invalid operator: "+e)}}mt.Comparator=Sa;function Sa(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof Sa){if(r.loose===!!e.loose)return r;r=r.value}if(!(this instanceof Sa))return new Sa(r,e);r=r.trim().split(/\s+/).join(" "),xr("comparator",r,e),this.options=e,this.loose=!!e.loose,this.parse(r),this.semver===Sx?this.value="":this.value=this.operator+this.semver.version,xr("comp",this)}var Sx={};Sa.prototype.parse=function(r){var e=this.options.loose?Hr[F2]:Hr[U2],t=r.match(e);if(!t)throw new TypeError("Invalid comparator: "+r);this.operator=t[1],this.operator==="="&&(this.operator=""),t[2]?this.semver=new zt(t[2],this.options.loose):this.semver=Sx};Sa.prototype.toString=function(){return this.value};Sa.prototype.test=function(r){return xr("Comparator.test",r,this.options.loose),this.semver===Sx?!0:(typeof r=="string"&&(r=new zt(r,this.options)),jN(r,this.operator,this.semver,this.options))};Sa.prototype.intersects=function(r,e){if(!(r instanceof Sa))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var t;if(this.operator==="")return t=new dn(r.value,e),BN(this.value,t,e);if(r.operator==="")return t=new dn(this.value,e),BN(r.semver,t,e);var n=(this.operator===">="||this.operator===">")&&(r.operator===">="||r.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(r.operator==="<="||r.operator==="<"),o=this.semver.version===r.semver.version,s=(this.operator===">="||this.operator==="<=")&&(r.operator===">="||r.operator==="<="),a=jN(this.semver,"<",r.semver,e)&&(this.operator===">="||this.operator===">")&&(r.operator==="<="||r.operator==="<"),l=jN(this.semver,">",r.semver,e)&&(this.operator==="<="||this.operator==="<")&&(r.operator===">="||r.operator===">");return n||i||o&&s||a||l};mt.Range=dn;function dn(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof dn)return r.loose===!!e.loose&&r.includePrerelease===!!e.includePrerelease?r:new dn(r.raw,e);if(r instanceof Sa)return new dn(r.value,e);if(!(this instanceof dn))return new dn(r,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=r.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}dn.prototype.format=function(){return this.range=this.set.map(function(r){return r.join(" ").trim()}).join("||").trim(),this.range};dn.prototype.toString=function(){return this.range};dn.prototype.parseRange=function(r){var e=this.options.loose,t=e?Hr[iY]:Hr[nY];r=r.replace(t,ive),xr("hyphen replace",r),r=r.replace(Hr[Tg],Lge),xr("comparator trim",r,Hr[Tg]),r=r.replace(Hr[oI],Mge),r=r.replace(Hr[sI],Oge);var n=e?Hr[F2]:Hr[U2],i=r.split(" ").map(function(o){return zge(o,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(o){return!!o.match(n)})),i=i.map(function(o){return new Sa(o,this.options)},this),i};dn.prototype.intersects=function(r,e){if(!(r instanceof dn))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(n){return r.set.some(function(i){return i.every(function(o){return n.intersects(o,e)})})})})};mt.toComparators=$ge;function $ge(r,e){return new dn(r,e).set.map(function(t){return t.map(function(n){return n.value}).join(" ").trim().split(" ")})}function zge(r,e){return xr("comp",r,e),r=Zge(r,e),xr("caret",r),r=Qge(r,e),xr("tildes",r),r=tve(r,e),xr("xrange",r),r=nve(r,e),xr("stars",r),r}function Po(r){return!r||r.toLowerCase()==="x"||r==="*"}function Qge(r,e){return r.trim().split(/\s+/).map(function(t){return Xge(t,e)}).join(" ")}function Xge(r,e){var t=e.loose?Hr[eY]:Hr[ZG];return r.replace(t,function(n,i,o,s,a){xr("tilde",r,n,i,o,s,a);var l;return Po(i)?l="":Po(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Po(s)?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":a?(xr("replaceTilde pr",a),l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0"):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0",xr("tilde return",l),l})}function Zge(r,e){return r.trim().split(/\s+/).map(function(t){return eve(t,e)}).join(" ")}function eve(r,e){xr("caret",r,e);var t=e.loose?Hr[rY]:Hr[tY];return r.replace(t,function(n,i,o,s,a){xr("caret",r,n,i,o,s,a);var l;return Po(i)?l="":Po(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Po(s)?i==="0"?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+".0 <"+(+i+1)+".0.0":a?(xr("replaceCaret pr",a),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+"-"+a+" <"+(+i+1)+".0.0"):(xr("no pr"),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+" <"+(+i+1)+".0.0"),xr("caret return",l),l})}function tve(r,e){return xr("replaceXRanges",r,e),r.split(/\s+/).map(function(t){return rve(t,e)}).join(" ")}function rve(r,e){r=r.trim();var t=e.loose?Hr[QG]:Hr[zG];return r.replace(t,function(n,i,o,s,a,l){xr("xRange",r,n,i,o,s,a,l);var u=Po(o),c=u||Po(s),d=c||Po(a),f=d;return i==="="&&f&&(i=""),u?i===">"||i==="<"?n="<0.0.0":n="*":i&&f?(c&&(s=0),a=0,i===">"?(i=">=",c?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",c?o=+o+1:s=+s+1),n=i+o+"."+s+"."+a):c?n=">="+o+".0.0 <"+(+o+1)+".0.0":d&&(n=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0"),xr("xRange return",n),n})}function nve(r,e){return xr("replaceStars",r,e),r.trim().replace(Hr[oY],"")}function ive(r,e,t,n,i,o,s,a,l,u,c,d,f){return Po(t)?e="":Po(n)?e=">="+t+".0.0":Po(i)?e=">="+t+"."+n+".0":e=">="+e,Po(l)?a="":Po(u)?a="<"+(+l+1)+".0.0":Po(c)?a="<"+l+"."+(+u+1)+".0":d?a="<="+l+"."+u+"."+c+"-"+d:a="<="+a,(e+" "+a).trim()}dn.prototype.test=function(r){if(!r)return!1;typeof r=="string"&&(r=new zt(r,this.options));for(var e=0;e<this.set.length;e++)if(ove(this.set[e],r,this.options))return!0;return!1};function ove(r,e,t){for(var n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(n=0;n<r.length;n++)if(xr(r[n].semver),r[n].semver!==Sx&&r[n].semver.prerelease.length>0){var i=r[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}mt.satisfies=BN;function BN(r,e,t){try{e=new dn(e,t)}catch(n){return!1}return e.test(r)}mt.maxSatisfying=sve;function sve(r,e,t){var n=null,i=null;try{var o=new dn(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===-1)&&(n=s,i=new zt(n,t))}),n}mt.minSatisfying=ave;function ave(r,e,t){var n=null,i=null;try{var o=new dn(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===1)&&(n=s,i=new zt(n,t))}),n}mt.minVersion=lve;function lve(r,e){r=new dn(r,e);var t=new zt("0.0.0");if(r.test(t)||(t=new zt("0.0.0-0"),r.test(t)))return t;t=null;for(var n=0;n<r.set.length;++n){var i=r.set[n];i.forEach(function(o){var s=new zt(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!t||bx(t,s))&&(t=s);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+o.operator)}})}return t&&r.test(t)?t:null}mt.validRange=cve;function cve(r,e){try{return new dn(r,e).range||"*"}catch(t){return null}}mt.ltr=uve;function uve(r,e,t){return B2(r,e,"<",t)}mt.gtr=dve;function dve(r,e,t){return B2(r,e,">",t)}mt.outside=B2;function B2(r,e,t,n){r=new zt(r,n),e=new dn(e,n);var i,o,s,a,l;switch(t){case">":i=bx,o=j2,s=VN,a=">",l=">=";break;case"<":i=VN,o=V2,s=bx,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(BN(r,e,n))return!1;for(var u=0;u<e.set.length;++u){var c=e.set[u],d=null,f=null;if(c.forEach(function(m){m.semver===Sx&&(m=new Sa(">=0.0.0")),d=d||m,f=f||m,i(m.semver,d.semver,n)?d=m:s(m.semver,f.semver,n)&&(f=m)}),d.operator===a||d.operator===l||(!f.operator||f.operator===a)&&o(r,f.semver))return!1;if(f.operator===l&&s(r,f.semver))return!1}return!0}mt.prerelease=pve;function pve(r,e){var t=kg(r,e);return t&&t.prerelease.length?t.prerelease:null}mt.intersects=fve;function fve(r,e,t){return r=new dn(r,t),e=new dn(e,t),r.intersects(e)}mt.coerce=mve;function mve(r){if(r instanceof zt)return r;if(typeof r!="string")return null;var e=r.match(Hr[XG]);return e==null?null:kg(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var $2=re((n1,TY)=>{p();(function(r,e){typeof n1=="object"&&typeof TY!="undefined"?e(n1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(n1,function(r){"use strict";r.ArrayExt=void 0,function(h){function y(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(A[me]===M)return me}return-1}h.firstIndexOf=y;function w(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(A[me]===M)return me}return-1}h.lastIndexOf=w;function T(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(M(A[me],me))return me}return-1}h.findFirstIndex=T;function H(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(M(A[me],me))return me}return-1}h.findLastIndex=H;function Y(A,M,I=0,S=-1){let _=T(A,M,I,S);return _!==-1?A[_]:void 0}h.findFirstValue=Y;function Z(A,M,I=-1,S=0){let _=H(A,M,I,S);return _!==-1?A[_]:void 0}h.findLastValue=Z;function ie(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function ce(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=ce;function be(A,M,I){if(A===M)return!0;if(A.length!==M.length)return!1;for(let S=0,_=A.length;S<_;++S)if(I?!I(A[S],M[S]):A[S]!==M[S])return!1;return!0}h.shallowEqual=be;function q(A,M={}){let{start:I,stop:S,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=A.length;I===void 0?I=_<0?F-1:0:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F),S===void 0?S=_<0?-1:F:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F);let j;_<0&&S>=I||_>0&&I>=S?j=0:_<0?j=Math.floor((S-I+1)/_+1):j=Math.floor((S-I-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=A[I+Fe*_];return me}h.slice=q;function $(A,M,I){let S=A.length;if(S<=1||(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1),M===I))return;let _=A[M],F=M<I?1:-1;for(let j=M;j!==I;j+=F)A[j]=A[j+F];A[I]=_}h.move=$;function de(A,M=0,I=-1){let S=A.length;if(!(S<=1))for(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1);M<I;){let _=A[M],F=A[I];A[M++]=F,A[I--]=_}}h.reverse=de;function pe(A,M,I=0,S=-1){let _=A.length;if(_<=1||(I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I>=S))return;let F=S-I+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=I+M;de(A,I,j-1),de(A,j,S),de(A,I,S)}h.rotate=pe;function ye(A,M,I=0,S=-1){let _=A.length;if(_===0)return;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j)A[(I+j)%_]=M}h.fill=ye;function z(A,M,I){let S=A.length;M<0?M=Math.max(0,M+S):M=Math.min(M,S);for(let _=S;_>M;--_)A[_]=A[_-1];A[M]=I}h.insert=z;function fe(A,M){let I=A.length;if(M<0&&(M+=I),M<0||M>=I)return;let S=A[M];for(let _=M+1;_<I;++_)A[_-1]=A[_];return A.length=I-1,S}h.removeAt=fe;function Se(A,M,I=0,S=-1){let _=y(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeFirstOf=Se;function Te(A,M,I=-1,S=0){let _=w(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeLastOf=Te;function Le(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&A[j]===M||S<I&&(j<=S||j>=I)&&A[j]===M?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllOf=Le;function $e(A,M,I=0,S=-1){let _,F=T(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeFirstWhere=$e;function Ge(A,M,I=-1,S=0){let _,F=H(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeLastWhere=Ge;function Bt(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&M(A[j],j)||S<I&&(j<=S||j>=I)&&M(A[j],j)?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let y of h)yield*y}function*t(){}function*n(h,y=0){for(let w of h)yield[y++,w]}function*i(h,y){let w=0;for(let T of h)y(T,w++)&&(yield T)}function o(h,y){let w=0;for(let T of h)if(y(T,w++))return T}function s(h,y){let w=0;for(let T of h)if(y(T,w++))return w-1;return-1}function a(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)<0&&(w=T)}return w}function l(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)>0&&(w=T)}return w}function u(h,y){let w=!0,T,H;for(let Y of h)w?(T=Y,H=Y,w=!1):y(Y,T)<0?T=Y:y(Y,H)>0&&(H=Y);return w?void 0:[T,H]}function c(h){return Array.from(h)}function d(h){let y={};for(let[w,T]of h)y[w]=T;return y}function f(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return}function m(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return!1;return!0}function g(h,y){let w=0;for(let T of h)if(y(T,w++))return!0;return!1}function*b(h,y){let w=0;for(let T of h)yield y(T,w++)}function*v(h,y,w){y===void 0?(y=h,h=0,w=1):w===void 0&&(w=1);let T=k.rangeLength(h,y,w);for(let H=0;H<T;H++)yield h+w*H}var k;(function(h){function y(w,T,H){return H===0?1/0:w>T&&H>0||w<T&&H<0?0:Math.ceil((T-w)/H)}h.rangeLength=y})(k||(k={}));function R(h,y,w){let T=h[Symbol.iterator](),H=0,Y=T.next();if(Y.done&&w===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return w;let Z=T.next();if(Z.done&&w===void 0)return Y.value;if(Z.done)return y(w,Y.value,H++);let ie;w===void 0?ie=y(Y.value,Z.value,H++):ie=y(y(w,Y.value,H++),Z.value,H++);let ce;for(;!(ce=T.next()).done;)ie=y(ie,ce.value,H++);return ie}function*P(h,y){for(;0<y--;)yield h}function*D(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let y=h.length-1;y>-1;y--)yield h[y]}function L(h){let y=[],w=new Set,T=new Map;for(let Z of h)H(Z);for(let[Z]of T)Y(Z);return y;function H(Z){let[ie,ce]=Z,be=T.get(ce);be?be.push(ie):T.set(ce,[ie])}function Y(Z){if(w.has(Z))return;w.add(Z);let ie=T.get(Z);if(ie)for(let ce of ie)Y(ce);y.push(Z)}}function*B(h,y){let w=0;for(let T of h)w++%y===0&&(yield T)}r.StringExt=void 0,function(h){function y(Z,ie,ce=0){let be=new Array(ie.length);for(let q=0,$=ce,de=ie.length;q<de;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=y;function w(Z,ie,ce=0){let be=y(Z,ie,ce);if(!be)return null;let q=0;for(let $=0,de=be.length;$<de;++$){let pe=be[$]-ce;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=w;function T(Z,ie,ce=0){let be=y(Z,ie,ce);if(!be)return null;let q=0,$=ce-1;for(let de=0,pe=be.length;de<pe;++de){let ye=be[de];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=T;function H(Z,ie,ce){let be=[],q=0,$=0,de=ie.length;for(;q<de;){let pe=ie[q],ye=ie[q];for(;++q<de&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(ce(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,y){if(y<1)return;let w=h[Symbol.iterator](),T;for(;0<y--&&!(T=w.next()).done;)yield T.value}function*O(...h){let y=h.map(T=>T[Symbol.iterator]()),w=y.map(T=>T.next());for(;m(w,T=>!T.done);w=y.map(T=>T.next()))yield w.map(T=>T.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=D,r.range=v,r.reduce=R,r.repeat=P,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var jc=re((i1,kY)=>{p();(function(r,e){typeof i1=="object"&&typeof kY!="undefined"?e(i1,$2()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(i1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"}u.isPrimitive=c;function d(P){return Array.isArray(P)}u.isArray=d;function f(P){return!c(P)&&!d(P)}u.isObject=f;function m(P,D){if(P===D)return!0;if(c(P)||c(D))return!1;let K=d(P),L=d(D);return K!==L?!1:K&&L?b(P,D):v(P,D)}u.deepEqual=m;function g(P){return c(P)?P:d(P)?k(P):R(P)}u.deepCopy=g;function b(P,D){if(P===D)return!0;if(P.length!==D.length)return!1;for(let K=0,L=P.length;K<L;++K)if(!m(P[K],D[K]))return!1;return!0}function v(P,D){if(P===D)return!0;for(let K in P)if(P[K]!==void 0&&!(K in D))return!1;for(let K in D)if(D[K]!==void 0&&!(K in P))return!1;for(let K in P){let L=P[K],B=D[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function k(P){let D=new Array(P.length);for(let K=0,L=P.length;K<L;++K)D[K]=g(P[K]);return D}function R(P){let D={};for(let K in P){let L=P[K];L!==void 0&&(D[K]=g(L))}return D}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(v=>{let k=this._services.get(v);return k?this._plugins.get(k).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(v){var k,R,P,D;this._activated=!1,this._promise=null,this._service=null,this.id=v.id,this.description=(k=v.description)!==null&&k!==void 0?k:"",this.activate=v.activate,this.deactivate=(R=v.deactivate)!==null&&R!==void 0?R:null,this.provides=(P=v.provides)!==null&&P!==void 0?P:null,this.autoStart=(D=v.autoStart)!==null&&D!==void 0?D:!1,this.requires=v.requires?v.requires.slice():[],this.optional=v.optional?v.optional.slice():[]}get activated(){return this._activated}set activated(v){this._activated=v}get service(){return this._service}set service(v){this._service=v}get promise(){return this._promise}set promise(v){this._promise=v}}function d(b){return new c(b)}u.createPluginData=d;function f(b,v,k){let R=[...b.requires,...b.optional],P=K=>{if(K===b.provides)return!0;let L=k.get(K);if(!L)return!1;let B=v.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(D.push(L),N.some(P)?!0:(D.pop(),!1))};if(!b.provides||R.length===0)return;let D=[b.id];if(R.some(P))throw new ReferenceError(`Cycle detected: ${D.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,v,k){let R=new Array,P=N=>{let O=v.get(N),h=[...O.requires,...O.optional];R.push(...h.reduce((y,w)=>{let T=k.get(w);return T&&y.push([N,T]),y},[]))};for(let N of v.keys())P(N);let D=R.filter(N=>N[1]===b),K=0;for(;D.length>K;){let N=D.length,O=new Set(D.map(h=>h[0]));for(let h of O)R.filter(y=>y[1]===h).forEach(y=>{D.includes(y)||D.push(y)});K=N}let L=e.topologicSort(D),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,v){let k=new Set;for(let R of b.keys())b.get(R).autoStart===!0&&k.add(R);if(v.startPlugins)for(let R of v.startPlugins)k.add(R);if(v.ignorePlugins)for(let R of v.ignorePlugins)k.delete(R);return Array.from(k)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var As=re((o1,NY)=>{p();(function(r,e){typeof o1=="object"&&typeof NY!="undefined"?e(o1,$2(),jc()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(o1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let y=g.get(N.sender);if(y||(y=[],g.set(N.sender,y)),R(y,N,O,h))return!1;let w=h||O,T=b.get(w);T||(T=[],b.set(w,T));let H={signal:N,slot:O,thisArg:h};return y.push(H),T.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let y=g.get(N.sender);if(!y||y.length===0)return!1;let w=R(y,N,O,h);if(!w)return!1;let T=h||O,H=b.get(T);return w.signal=null,D(y),D(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let y=b.get(O);if(!(!y||y.length===0)){for(let w of y)w.signal&&w.signal.sender===N&&(w.signal=null);D(h),D(y)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.thisArg||h.slot;h.signal=null,D(b.get(y))}D(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.signal.sender;h.signal=null,D(g.get(y))}D(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let y=0,w=h.length;y<w;++y){let T=h[y];T.signal===N&&P(T,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,v=new Set,k=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function R(N,O,h,y){return e.find(N,w=>w.signal===O&&w.slot===h&&w.thisArg===y)}function P(N,O){let{signal:h,slot:y,thisArg:w}=N;try{y.call(w,h.sender,O)}catch(T){s.exceptionHandler(T)}}function D(N){v.size===0&&k(K),v.add(N)}function K(){v.forEach(L),v.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var z2=re((s1,RY)=>{p();(function(r,e){typeof s1=="object"&&typeof RY!="undefined"?e(s1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(s1,function(r){"use strict";r.ArrayExt=void 0,function(h){function y(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(A[me]===M)return me}return-1}h.firstIndexOf=y;function w(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(A[me]===M)return me}return-1}h.lastIndexOf=w;function T(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(M(A[me],me))return me}return-1}h.findFirstIndex=T;function H(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(M(A[me],me))return me}return-1}h.findLastIndex=H;function Y(A,M,I=0,S=-1){let _=T(A,M,I,S);return _!==-1?A[_]:void 0}h.findFirstValue=Y;function Z(A,M,I=-1,S=0){let _=H(A,M,I,S);return _!==-1?A[_]:void 0}h.findLastValue=Z;function ie(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function ce(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=ce;function be(A,M,I){if(A===M)return!0;if(A.length!==M.length)return!1;for(let S=0,_=A.length;S<_;++S)if(I?!I(A[S],M[S]):A[S]!==M[S])return!1;return!0}h.shallowEqual=be;function q(A,M={}){let{start:I,stop:S,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=A.length;I===void 0?I=_<0?F-1:0:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F),S===void 0?S=_<0?-1:F:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F);let j;_<0&&S>=I||_>0&&I>=S?j=0:_<0?j=Math.floor((S-I+1)/_+1):j=Math.floor((S-I-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=A[I+Fe*_];return me}h.slice=q;function $(A,M,I){let S=A.length;if(S<=1||(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1),M===I))return;let _=A[M],F=M<I?1:-1;for(let j=M;j!==I;j+=F)A[j]=A[j+F];A[I]=_}h.move=$;function de(A,M=0,I=-1){let S=A.length;if(!(S<=1))for(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1);M<I;){let _=A[M],F=A[I];A[M++]=F,A[I--]=_}}h.reverse=de;function pe(A,M,I=0,S=-1){let _=A.length;if(_<=1||(I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I>=S))return;let F=S-I+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=I+M;de(A,I,j-1),de(A,j,S),de(A,I,S)}h.rotate=pe;function ye(A,M,I=0,S=-1){let _=A.length;if(_===0)return;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j)A[(I+j)%_]=M}h.fill=ye;function z(A,M,I){let S=A.length;M<0?M=Math.max(0,M+S):M=Math.min(M,S);for(let _=S;_>M;--_)A[_]=A[_-1];A[M]=I}h.insert=z;function fe(A,M){let I=A.length;if(M<0&&(M+=I),M<0||M>=I)return;let S=A[M];for(let _=M+1;_<I;++_)A[_-1]=A[_];return A.length=I-1,S}h.removeAt=fe;function Se(A,M,I=0,S=-1){let _=y(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeFirstOf=Se;function Te(A,M,I=-1,S=0){let _=w(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeLastOf=Te;function Le(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&A[j]===M||S<I&&(j<=S||j>=I)&&A[j]===M?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllOf=Le;function $e(A,M,I=0,S=-1){let _,F=T(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeFirstWhere=$e;function Ge(A,M,I=-1,S=0){let _,F=H(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeLastWhere=Ge;function Bt(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&M(A[j],j)||S<I&&(j<=S||j>=I)&&M(A[j],j)?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let y of h)yield*y}function*t(){}function*n(h,y=0){for(let w of h)yield[y++,w]}function*i(h,y){let w=0;for(let T of h)y(T,w++)&&(yield T)}function o(h,y){let w=0;for(let T of h)if(y(T,w++))return T}function s(h,y){let w=0;for(let T of h)if(y(T,w++))return w-1;return-1}function a(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)<0&&(w=T)}return w}function l(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)>0&&(w=T)}return w}function u(h,y){let w=!0,T,H;for(let Y of h)w?(T=Y,H=Y,w=!1):y(Y,T)<0?T=Y:y(Y,H)>0&&(H=Y);return w?void 0:[T,H]}function c(h){return Array.from(h)}function d(h){let y={};for(let[w,T]of h)y[w]=T;return y}function f(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return}function m(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return!1;return!0}function g(h,y){let w=0;for(let T of h)if(y(T,w++))return!0;return!1}function*b(h,y){let w=0;for(let T of h)yield y(T,w++)}function*v(h,y,w){y===void 0?(y=h,h=0,w=1):w===void 0&&(w=1);let T=k.rangeLength(h,y,w);for(let H=0;H<T;H++)yield h+w*H}var k;(function(h){function y(w,T,H){return H===0?1/0:w>T&&H>0||w<T&&H<0?0:Math.ceil((T-w)/H)}h.rangeLength=y})(k||(k={}));function R(h,y,w){let T=h[Symbol.iterator](),H=0,Y=T.next();if(Y.done&&w===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return w;let Z=T.next();if(Z.done&&w===void 0)return Y.value;if(Z.done)return y(w,Y.value,H++);let ie;w===void 0?ie=y(Y.value,Z.value,H++):ie=y(y(w,Y.value,H++),Z.value,H++);let ce;for(;!(ce=T.next()).done;)ie=y(ie,ce.value,H++);return ie}function*P(h,y){for(;0<y--;)yield h}function*D(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let y=h.length-1;y>-1;y--)yield h[y]}function L(h){let y=[],w=new Set,T=new Map;for(let Z of h)H(Z);for(let[Z]of T)Y(Z);return y;function H(Z){let[ie,ce]=Z,be=T.get(ce);be?be.push(ie):T.set(ce,[ie])}function Y(Z){if(w.has(Z))return;w.add(Z);let ie=T.get(Z);if(ie)for(let ce of ie)Y(ce);y.push(Z)}}function*B(h,y){let w=0;for(let T of h)w++%y===0&&(yield T)}r.StringExt=void 0,function(h){function y(Z,ie,ce=0){let be=new Array(ie.length);for(let q=0,$=ce,de=ie.length;q<de;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=y;function w(Z,ie,ce=0){let be=y(Z,ie,ce);if(!be)return null;let q=0;for(let $=0,de=be.length;$<de;++$){let pe=be[$]-ce;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=w;function T(Z,ie,ce=0){let be=y(Z,ie,ce);if(!be)return null;let q=0,$=ce-1;for(let de=0,pe=be.length;de<pe;++de){let ye=be[de];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=T;function H(Z,ie,ce){let be=[],q=0,$=0,de=ie.length;for(;q<de;){let pe=ie[q],ye=ie[q];for(;++q<de&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(ce(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,y){if(y<1)return;let w=h[Symbol.iterator](),T;for(;0<y--&&!(T=w.next()).done;)yield T.value}function*O(...h){let y=h.map(T=>T[Symbol.iterator]()),w=y.map(T=>T.next());for(;m(w,T=>!T.done);w=y.map(T=>T.next()))yield w.map(T=>T.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=D,r.range=v,r.reduce=R,r.repeat=P,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var l1=re((a1,AY)=>{p();(function(r,e){typeof a1=="object"&&typeof AY!="undefined"?e(a1,z2()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(a1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"}u.isPrimitive=c;function d(P){return Array.isArray(P)}u.isArray=d;function f(P){return!c(P)&&!d(P)}u.isObject=f;function m(P,D){if(P===D)return!0;if(c(P)||c(D))return!1;let K=d(P),L=d(D);return K!==L?!1:K&&L?b(P,D):v(P,D)}u.deepEqual=m;function g(P){return c(P)?P:d(P)?k(P):R(P)}u.deepCopy=g;function b(P,D){if(P===D)return!0;if(P.length!==D.length)return!1;for(let K=0,L=P.length;K<L;++K)if(!m(P[K],D[K]))return!1;return!0}function v(P,D){if(P===D)return!0;for(let K in P)if(P[K]!==void 0&&!(K in D))return!1;for(let K in D)if(D[K]!==void 0&&!(K in P))return!1;for(let K in P){let L=P[K],B=D[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function k(P){let D=new Array(P.length);for(let K=0,L=P.length;K<L;++K)D[K]=g(P[K]);return D}function R(P){let D={};for(let K in P){let L=P[K];L!==void 0&&(D[K]=g(L))}return D}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(v=>{let k=this._services.get(v);return k?this._plugins.get(k).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(v){var k,R,P,D;this._activated=!1,this._promise=null,this._service=null,this.id=v.id,this.description=(k=v.description)!==null&&k!==void 0?k:"",this.activate=v.activate,this.deactivate=(R=v.deactivate)!==null&&R!==void 0?R:null,this.provides=(P=v.provides)!==null&&P!==void 0?P:null,this.autoStart=(D=v.autoStart)!==null&&D!==void 0?D:!1,this.requires=v.requires?v.requires.slice():[],this.optional=v.optional?v.optional.slice():[]}get activated(){return this._activated}set activated(v){this._activated=v}get service(){return this._service}set service(v){this._service=v}get promise(){return this._promise}set promise(v){this._promise=v}}function d(b){return new c(b)}u.createPluginData=d;function f(b,v,k){let R=[...b.requires,...b.optional],P=K=>{if(K===b.provides)return!0;let L=k.get(K);if(!L)return!1;let B=v.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(D.push(L),N.some(P)?!0:(D.pop(),!1))};if(!b.provides||R.length===0)return;let D=[b.id];if(R.some(P))throw new ReferenceError(`Cycle detected: ${D.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,v,k){let R=new Array,P=N=>{let O=v.get(N),h=[...O.requires,...O.optional];R.push(...h.reduce((y,w)=>{let T=k.get(w);return T&&y.push([N,T]),y},[]))};for(let N of v.keys())P(N);let D=R.filter(N=>N[1]===b),K=0;for(;D.length>K;){let N=D.length,O=new Set(D.map(h=>h[0]));for(let h of O)R.filter(y=>y[1]===h).forEach(y=>{D.includes(y)||D.push(y)});K=N}let L=e.topologicSort(D),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,v){let k=new Set;for(let R of b.keys())b.get(R).autoStart===!0&&k.add(R);if(v.startPlugins)for(let R of v.startPlugins)k.add(R);if(v.ignorePlugins)for(let R of v.ignorePlugins)k.delete(R);return Array.from(k)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var OY=re((c1,MY)=>{p();(function(r,e){typeof c1=="object"&&typeof MY!="undefined"?e(c1,z2(),l1()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(c1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let y=g.get(N.sender);if(y||(y=[],g.set(N.sender,y)),R(y,N,O,h))return!1;let w=h||O,T=b.get(w);T||(T=[],b.set(w,T));let H={signal:N,slot:O,thisArg:h};return y.push(H),T.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let y=g.get(N.sender);if(!y||y.length===0)return!1;let w=R(y,N,O,h);if(!w)return!1;let T=h||O,H=b.get(T);return w.signal=null,D(y),D(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let y=b.get(O);if(!(!y||y.length===0)){for(let w of y)w.signal&&w.signal.sender===N&&(w.signal=null);D(h),D(y)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.thisArg||h.slot;h.signal=null,D(b.get(y))}D(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.signal.sender;h.signal=null,D(g.get(y))}D(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let y=0,w=h.length;y<w;++y){let T=h[y];T.signal===N&&P(T,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,v=new Set,k=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function R(N,O,h,y){return e.find(N,w=>w.signal===O&&w.slot===h&&w.thisArg===y)}function P(N,O){let{signal:h,slot:y,thisArg:w}=N;try{y.call(w,h.sender,O)}catch(T){s.exceptionHandler(T)}}function D(N){v.size===0&&k(K),v.add(N)}function K(){v.forEach(L),v.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var KY=re(u1=>{"use strict";p();Object.defineProperty(u1,"__esModule",{value:!0});u1.ActivityMonitor=void 0;var LY=OY(),Q2=class{constructor(e){this._timer=-1,this._timeout=-1,this._isDisposed=!1,this._activityStopped=new LY.Signal(this),e.signal.connect(this._onSignalFired,this),this._timeout=e.timeout||1e3}get activityStopped(){return this._activityStopped}get timeout(){return this._timeout}set timeout(e){this._timeout=e}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,LY.Signal.clearData(this))}_onSignalFired(e,t){clearTimeout(this._timer),this._sender=e,this._args=t,this._timer=setTimeout(()=>{this._activityStopped.emit({sender:this._sender,args:this._args})},this._timeout)}};u1.ActivityMonitor=Q2});var UY=re(FY=>{"use strict";p();Object.defineProperty(FY,"__esModule",{value:!0})});var WY=re(d1=>{"use strict";p();Object.defineProperty(d1,"__esModule",{value:!0});d1.LruCache=void 0;var Tve=128,X2=class{constructor(e={}){this._map=new Map,this._maxSize=(e==null?void 0:e.maxSize)||Tve}get size(){return this._map.size}clear(){this._map.clear()}get(e){let t=this._map.get(e)||null;return t!=null&&(this._map.delete(e),this._map.set(e,t)),t}set(e,t){this._map.size>=this._maxSize&&this._map.delete(this._map.keys().next().value),this._map.set(e,t)}};d1.LruCache=X2});var jY=re(p1=>{"use strict";p();Object.defineProperty(p1,"__esModule",{value:!0});p1.MarkdownCodeBlocks=void 0;var VY;(function(r){r.CODE_BLOCK_MARKER="```";let e=[".markdown",".mdown",".mkdn",".md",".mkd",".mdwn",".mdtxt",".mdtext",".text",".txt",".Rmd"];class t{constructor(s){this.startLine=s,this.code="",this.endLine=-1}}r.MarkdownCodeBlock=t;function n(o){return e.indexOf(o)>-1}r.isMarkdown=n;function i(o){if(!o||o==="")return[];let s=o.split(`
`),a=[],l=null;for(let u=0;u<s.length;u++){let c=s[u],d=c.indexOf(r.CODE_BLOCK_MARKER)===0,f=l!=null;if(!(!d&&!f))if(f)l&&(d?(l.endLine=u-1,a.push(l),l=null):l.code+=c+`
`);else{l=new t(u);let m=c.indexOf(r.CODE_BLOCK_MARKER),g=c.lastIndexOf(r.CODE_BLOCK_MARKER);m!==g&&(l.code=c.substring(m+r.CODE_BLOCK_MARKER.length,g),l.endLine=u,a.push(l),l=null)}}return a}r.findMarkdownCodeBlocks=i})(VY||(p1.MarkdownCodeBlocks=VY={}))});var JY=re((Vqe,qY)=>{"use strict";p();function kve(r,e){var t=r;e.slice(0,-1).forEach(function(i){t=t[i]||{}});var n=e[e.length-1];return n in t}function BY(r){return typeof r=="number"||/^0x[0-9a-f]+$/i.test(r)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(r)}function HY(r,e){return e==="constructor"&&typeof r[e]=="function"||e==="__proto__"}qY.exports=function(r,e){e||(e={});var t={bools:{},strings:{},unknownFn:null};typeof e.unknown=="function"&&(t.unknownFn=e.unknown),typeof e.boolean=="boolean"&&e.boolean?t.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(D){t.bools[D]=!0});var n={};function i(D){return n[D].some(function(K){return t.bools[K]})}Object.keys(e.alias||{}).forEach(function(D){n[D]=[].concat(e.alias[D]),n[D].forEach(function(K){n[K]=[D].concat(n[D].filter(function(L){return K!==L}))})}),[].concat(e.string).filter(Boolean).forEach(function(D){t.strings[D]=!0,n[D]&&[].concat(n[D]).forEach(function(K){t.strings[K]=!0})});var o=e.default||{},s={_:[]};function a(D,K){return t.allBools&&/^--[^=]+$/.test(K)||t.strings[D]||t.bools[D]||n[D]}function l(D,K,L){for(var B=D,N=0;N<K.length-1;N++){var O=K[N];if(HY(B,O))return;B[O]===void 0&&(B[O]={}),(B[O]===Object.prototype||B[O]===Number.prototype||B[O]===String.prototype)&&(B[O]={}),B[O]===Array.prototype&&(B[O]=[]),B=B[O]}var h=K[K.length-1];HY(B,h)||((B===Object.prototype||B===Number.prototype||B===String.prototype)&&(B={}),B===Array.prototype&&(B=[]),B[h]===void 0||t.bools[h]||typeof B[h]=="boolean"?B[h]=L:Array.isArray(B[h])?B[h].push(L):B[h]=[B[h],L])}function u(D,K,L){if(!(L&&t.unknownFn&&!a(D,L)&&t.unknownFn(L)===!1)){var B=!t.strings[D]&&BY(K)?Number(K):K;l(s,D.split("."),B),(n[D]||[]).forEach(function(N){l(s,N.split("."),B)})}}Object.keys(t.bools).forEach(function(D){u(D,o[D]===void 0?!1:o[D])});var c=[];r.indexOf("--")!==-1&&(c=r.slice(r.indexOf("--")+1),r=r.slice(0,r.indexOf("--")));for(var d=0;d<r.length;d++){var f=r[d],m,g;if(/^--.+=/.test(f)){var b=f.match(/^--([^=]+)=([\s\S]*)$/);m=b[1];var v=b[2];t.bools[m]&&(v=v!=="false"),u(m,v,f)}else if(/^--no-.+/.test(f))m=f.match(/^--no-(.+)/)[1],u(m,!1,f);else if(/^--.+/.test(f))m=f.match(/^--(.+)/)[1],g=r[d+1],g!==void 0&&!/^(-|--)[^-]/.test(g)&&!t.bools[m]&&!t.allBools&&(!n[m]||!i(m))?(u(m,g,f),d+=1):/^(true|false)$/.test(g)?(u(m,g==="true",f),d+=1):u(m,t.strings[m]?"":!0,f);else if(/^-[^-]+/.test(f)){for(var k=f.slice(1,-1).split(""),R=!1,P=0;P<k.length;P++){if(g=f.slice(P+2),g==="-"){u(k[P],g,f);continue}if(/[A-Za-z]/.test(k[P])&&g[0]==="="){u(k[P],g.slice(1),f),R=!0;break}if(/[A-Za-z]/.test(k[P])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(g)){u(k[P],g,f),R=!0;break}if(k[P+1]&&k[P+1].match(/\W/)){u(k[P],f.slice(P+2),f),R=!0;break}else u(k[P],t.strings[k[P]]?"":!0,f)}m=f.slice(-1)[0],!R&&m!=="-"&&(r[d+1]&&!/^(-|--)[^-]/.test(r[d+1])&&!t.bools[m]&&(!n[m]||!i(m))?(u(m,r[d+1],f),d+=1):r[d+1]&&/^(true|false)$/.test(r[d+1])?(u(m,r[d+1]==="true",f),d+=1):u(m,t.strings[m]?"":!0,f))}else if((!t.unknownFn||t.unknownFn(f)!==!1)&&s._.push(t.strings._||!BY(f)?f:Number(f)),e.stopEarly){s._.push.apply(s._,r.slice(d+1));break}}return Object.keys(o).forEach(function(D){kve(s,D.split("."))||(l(s,D.split("."),o[D]),(n[D]||[]).forEach(function(K){l(s,K.split("."),o[D])}))}),e["--"]?s["--"]=c.slice():c.forEach(function(D){s._.push(D)}),s}});var f1=re((Bqe,YY)=>{"use strict";p();function Bc(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function GY(r,e){for(var t="",n=0,i=-1,o=0,s,a=0;a<=r.length;++a){if(a<r.length)s=r.charCodeAt(a);else{if(s===47)break;s=47}if(s===47){if(!(i===a-1||o===1))if(i!==a-1&&o===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",n=0):(t=t.slice(0,l),n=t.length-1-t.lastIndexOf("/")),i=a,o=0;continue}}else if(t.length===2||t.length===1){t="",n=0,i=a,o=0;continue}}e&&(t.length>0?t+="/..":t="..",n=2)}else t.length>0?t+="/"+r.slice(i+1,a):t=r.slice(i+1,a),n=a-i-1;i=a,o=0}else s===46&&o!==-1?++o:o=-1}return t}function Nve(r,e){var t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+n:t+r+n:n}var mI={resolve:function(){for(var e="",t=!1,n,i=arguments.length-1;i>=-1&&!t;i--){var o;i>=0?o=arguments[i]:(n===void 0&&(n=process.cwd()),o=n),Bc(o),o.length!==0&&(e=o+"/"+e,t=o.charCodeAt(0)===47)}return e=GY(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Bc(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=GY(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Bc(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];Bc(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":mI.normalize(e)},relative:function(e,t){if(Bc(e),Bc(t),e===t||(e=mI.resolve(e),t=mI.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,o=i-n,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var a=t.length,l=a-s,u=o<l?o:l,c=-1,d=0;d<=u;++d){if(d===u){if(l>u){if(t.charCodeAt(s+d)===47)return t.slice(s+d+1);if(d===0)return t.slice(s+d)}else o>u&&(e.charCodeAt(n+d)===47?c=d:d===0&&(c=0));break}var f=e.charCodeAt(n+d),m=t.charCodeAt(s+d);if(f!==m)break;f===47&&(c=d)}var g="";for(d=n+c+1;d<=i;++d)(d===i||e.charCodeAt(d)===47)&&(g.length===0?g+="..":g+="/..");return g.length>0?g+t.slice(s+c):(s+=c,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(Bc(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,i=-1,o=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!o){i=s;break}}else o=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Bc(e);var n=0,i=-1,o=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(s=e.length-1;s>=0;--s){var u=e.charCodeAt(s);if(u===47){if(!o){n=s+1;break}}else l===-1&&(o=!1,l=s+1),a>=0&&(u===t.charCodeAt(a)?--a===-1&&(i=s):(a=-1,i=l))}return n===i?i=l:i===-1&&(i=e.length),e.slice(n,i)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!o){n=s+1;break}}else i===-1&&(o=!1,i=s+1);return i===-1?"":e.slice(n,i)}},extname:function(e){Bc(e);for(var t=-1,n=0,i=-1,o=!0,s=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Nve("/",e)},parse:function(e){Bc(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),i=n===47,o;i?(t.root="/",o=1):o=0;for(var s=-1,a=0,l=-1,u=!0,c=e.length-1,d=0;c>=o;--c){if(n=e.charCodeAt(c),n===47){if(!u){a=c+1;break}continue}l===-1&&(u=!1,l=c+1),n===46?s===-1?s=c:d!==1&&(d=1):s!==-1&&(d=-1)}return s===-1||l===-1||d===0||d===1&&s===l-1&&s===a+1?l!==-1&&(a===0&&i?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(a,l)):(a===0&&i?(t.name=e.slice(1,s),t.base=e.slice(1,l)):(t.name=e.slice(a,s),t.base=e.slice(a,l)),t.ext=e.slice(s,l)),a>0?t.dir=e.slice(0,a-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};mI.posix=mI;YY.exports=mI});var zY=re((qqe,$Y)=>{"use strict";p();$Y.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var ZY=re(Z2=>{"use strict";p();var Rve=Object.prototype.hasOwnProperty,Ave;function QY(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch(e){return null}}function XY(r){try{return encodeURIComponent(r)}catch(e){return null}}function Mve(r){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},n;n=e.exec(r);){var i=QY(n[1]),o=QY(n[2]);i===null||o===null||i in t||(t[i]=o)}return t}function Ove(r,e){e=e||"";var t=[],n,i;typeof e!="string"&&(e="?");for(i in r)if(Rve.call(r,i)){if(n=r[i],!n&&(n===null||n===Ave||isNaN(n))&&(n=""),i=XY(i),n=XY(n),i===null||n===null)continue;t.push(i+"="+n)}return t.length?e+t.join("&"):""}Z2.stringify=Ove;Z2.parse=Mve});var rV=re(($qe,s$)=>{"use strict";p();var t$=zY(),m1=ZY(),Lve=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,r$=/[\n\r\t]/g,Kve=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,n$=/:\d+$/,Fve=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Uve=/^[a-zA-Z]:/;function tV(r){return(r||"").toString().replace(Lve,"")}var eV=[["#","hash"],["?","query"],function(e,t){return Hc(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],e$={hash:1,query:1};function i$(r){var e;typeof window!="undefined"?e=window:typeof this!="undefined"?e=this:typeof self!="undefined"?e=self:e={};var t=e.location||{};r=r||t;var n={},i=typeof r,o;if(r.protocol==="blob:")n=new qc(unescape(r.pathname),{});else if(i==="string"){n=new qc(r,{});for(o in e$)delete n[o]}else if(i==="object"){for(o in r)o in e$||(n[o]=r[o]);n.slashes===void 0&&(n.slashes=Kve.test(r.href))}return n}function Hc(r){return r==="file:"||r==="ftp:"||r==="http:"||r==="https:"||r==="ws:"||r==="wss:"}function o$(r,e){r=tV(r),r=r.replace(r$,""),e=e||{};var t=Fve.exec(r),n=t[1]?t[1].toLowerCase():"",i=!!t[2],o=!!t[3],s=0,a;return i?o?(a=t[2]+t[3]+t[4],s=t[2].length+t[3].length):(a=t[2]+t[4],s=t[2].length):o?(a=t[3]+t[4],s=t[3].length):a=t[4],n==="file:"?s>=2&&(a=a.slice(2)):Hc(n)?a=t[4]:n?i&&(a=a.slice(2)):s>=2&&Hc(e.protocol)&&(a=t[4]),{protocol:n,slashes:i||Hc(n),slashesCount:s,rest:a}}function Wve(r,e){if(r==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(r.split("/")),n=t.length,i=t[n-1],o=!1,s=0;n--;)t[n]==="."?t.splice(n,1):t[n]===".."?(t.splice(n,1),s++):s&&(n===0&&(o=!0),t.splice(n,1),s--);return o&&t.unshift(""),(i==="."||i==="..")&&t.push(""),t.join("/")}function qc(r,e,t){if(r=tV(r),r=r.replace(r$,""),!(this instanceof qc))return new qc(r,e,t);var n,i,o,s,a,l,u=eV.slice(),c=typeof e,d=this,f=0;for(c!=="object"&&c!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=m1.parse),e=i$(e),i=o$(r||"",e),n=!i.protocol&&!i.slashes,d.slashes=i.slashes||n&&e.slashes,d.protocol=i.protocol||e.protocol||"",r=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||Uve.test(r))||!i.slashes&&(i.protocol||i.slashesCount<2||!Hc(d.protocol)))&&(u[3]=[/(.*)/,"pathname"]);f<u.length;f++){if(s=u[f],typeof s=="function"){r=s(r,d);continue}o=s[0],l=s[1],o!==o?d[l]=r:typeof o=="string"?(a=o==="@"?r.lastIndexOf(o):r.indexOf(o),~a&&(typeof s[2]=="number"?(d[l]=r.slice(0,a),r=r.slice(a+s[2])):(d[l]=r.slice(a),r=r.slice(0,a)))):(a=o.exec(r))&&(d[l]=a[1],r=r.slice(0,a.index)),d[l]=d[l]||n&&s[3]&&e[l]||"",s[4]&&(d[l]=d[l].toLowerCase())}t&&(d.query=t(d.query)),n&&e.slashes&&d.pathname.charAt(0)!=="/"&&(d.pathname!==""||e.pathname!=="")&&(d.pathname=Wve(d.pathname,e.pathname)),d.pathname.charAt(0)!=="/"&&Hc(d.protocol)&&(d.pathname="/"+d.pathname),t$(d.port,d.protocol)||(d.host=d.hostname,d.port=""),d.username=d.password="",d.auth&&(a=d.auth.indexOf(":"),~a?(d.username=d.auth.slice(0,a),d.username=encodeURIComponent(decodeURIComponent(d.username)),d.password=d.auth.slice(a+1),d.password=encodeURIComponent(decodeURIComponent(d.password))):d.username=encodeURIComponent(decodeURIComponent(d.auth)),d.auth=d.password?d.username+":"+d.password:d.username),d.origin=d.protocol!=="file:"&&Hc(d.protocol)&&d.host?d.protocol+"//"+d.host:"null",d.href=d.toString()}function Vve(r,e,t){var n=this;switch(r){case"query":typeof e=="string"&&e.length&&(e=(t||m1.parse)(e)),n[r]=e;break;case"port":n[r]=e,t$(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[r]="");break;case"hostname":n[r]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[r]=e,n$.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!t;break;case"pathname":case"hash":if(e){var i=r==="pathname"?"/":"#";n[r]=e.charAt(0)!==i?i+e:e}else n[r]=e;break;case"username":case"password":n[r]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(n.username=e.slice(0,o),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=e.slice(o+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(e))}for(var s=0;s<eV.length;s++){var a=eV[s];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&Hc(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function jve(r){(!r||typeof r!="function")&&(r=m1.stringify);var e,t=this,n=t.host,i=t.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var o=i+(t.protocol&&t.slashes||Hc(t.protocol)?"//":"");return t.username?(o+=t.username,t.password&&(o+=":"+t.password),o+="@"):t.password?(o+=":"+t.password,o+="@"):t.protocol!=="file:"&&Hc(t.protocol)&&!n&&t.pathname!=="/"&&(o+="@"),(n[n.length-1]===":"||n$.test(t.hostname)&&!t.port)&&(n+=":"),o+=n+t.pathname,e=typeof t.query=="object"?r(t.query):t.query,e&&(o+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(o+=t.hash),o}qc.prototype={set:Vve,toString:jve};qc.extractProtocol=o$;qc.location=i$;qc.trimLeft=tV;qc.qs=m1;s$.exports=qc});var nV=re(hI=>{"use strict";p();var Bve=hI&&hI.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(hI,"__esModule",{value:!0});hI.URLExt=void 0;var Hve=f1(),h1=Bve(rV()),a$;(function(r){function e(u){if(typeof document!="undefined"&&document){let c=document.createElement("a");return c.href=u,c}return(0,h1.default)(u)}r.parse=e;function t(u){return(0,h1.default)(u).hostname}r.getHostName=t;function n(u){return u&&e(u).toString()}r.normalize=n;function i(...u){let c=(0,h1.default)(u[0],{}),d=c.protocol===""&&c.slashes;d&&(c=(0,h1.default)(u[0],"https:"+u[0]));let f=`${d?"":c.protocol}${c.slashes?"//":""}${c.auth}${c.auth?"@":""}${c.host}`,m=Hve.posix.join(`${f&&c.pathname[0]!=="/"?"/":""}${c.pathname}`,...u.slice(1));return`${f}${m==="."?"":m}`}r.join=i;function o(u){return i(...u.split("/").map(encodeURIComponent))}r.encodeParts=o;function s(u){let c=Object.keys(u).filter(d=>d.length>0);return c.length?"?"+c.map(d=>{let f=encodeURIComponent(String(u[d]));return d+(f?"="+f:"")}).join("&"):""}r.objectToQueryString=s;function a(u){return u.replace(/^\?/,"").split("&").reduce((c,d)=>{let[f,m]=d.split("=");return f.length>0&&(c[f]=decodeURIComponent(m||"")),c},{})}r.queryStringToObject=a;function l(u,c=!1){let{protocol:d}=e(u);return(!d||u.toLowerCase().indexOf(d)!==0)&&(c?u.indexOf("//")!==0:u.indexOf("/")!==0)}r.isLocal=l})(a$||(hI.URLExt=a$={}))});var l$=re((exports,module)=>{"use strict";p();var __importDefault=exports&&exports.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(exports,"__esModule",{value:!0});exports.PageConfig=void 0;var coreutils_1=l1(),minimist_1=__importDefault(JY()),url_1=nV(),PageConfig;(function(PageConfig){function getOption(name){if(configData)return configData[name]||getBodyData(name);configData=Object.create(null);let found=!1;if(typeof document!="undefined"&&document){let r=document.getElementById("jupyter-config-data");r&&(configData=JSON.parse(r.textContent||""),found=!0)}if(!found&&typeof process!="undefined"&&process.argv)try{let cli=(0,minimist_1.default)(process.argv.slice(2)),path=f1(),fullPath="";"jupyter-config-data"in cli?fullPath=path.resolve(cli["jupyter-config-data"]):"JUPYTER_CONFIG_DATA"in process.env&&(fullPath=path.resolve(process.env.JUPYTER_CONFIG_DATA)),fullPath&&(configData=eval("require")(fullPath))}catch(r){console.error(r)}if(!coreutils_1.JSONExt.isObject(configData))configData=Object.create(null);else for(let r in configData)typeof configData[r]!="string"&&(configData[r]=JSON.stringify(configData[r]));return configData[name]||getBodyData(name)}PageConfig.getOption=getOption;function setOption(r,e){let t=getOption(r);return configData[r]=e,t}PageConfig.setOption=setOption;function getBaseUrl(){return url_1.URLExt.normalize(getOption("baseUrl")||"/")}PageConfig.getBaseUrl=getBaseUrl;function getTreeUrl(){return url_1.URLExt.join(getBaseUrl(),getOption("treeUrl"))}PageConfig.getTreeUrl=getTreeUrl;function getShareUrl(){return url_1.URLExt.normalize(getOption("shareUrl")||getBaseUrl())}PageConfig.getShareUrl=getShareUrl;function getTreeShareUrl(){return url_1.URLExt.normalize(url_1.URLExt.join(getShareUrl(),getOption("treeUrl")))}PageConfig.getTreeShareUrl=getTreeShareUrl;function getUrl(r){var e,t,n,i;let o=r.toShare?getShareUrl():getBaseUrl(),s=(e=r.mode)!==null&&e!==void 0?e:getOption("mode"),a=(t=r.workspace)!==null&&t!==void 0?t:getOption("workspace"),l=s==="single-document"?"doc":"lab";o=url_1.URLExt.join(o,l),a!==PageConfig.defaultWorkspace&&(o=url_1.URLExt.join(o,"workspaces",encodeURIComponent((n=getOption("workspace"))!==null&&n!==void 0?n:PageConfig.defaultWorkspace)));let u=(i=r.treePath)!==null&&i!==void 0?i:getOption("treePath");return u&&(o=url_1.URLExt.join(o,"tree",url_1.URLExt.encodeParts(u))),o}PageConfig.getUrl=getUrl,PageConfig.defaultWorkspace="default";function getWsUrl(r){let e=getOption("wsUrl");if(!e){if(r=r?url_1.URLExt.normalize(r):getBaseUrl(),r.indexOf("http")!==0)return"";e="ws"+r.slice(4)}return url_1.URLExt.normalize(e)}PageConfig.getWsUrl=getWsUrl;function getNBConvertURL({path:r,format:e,download:t}){let n=url_1.URLExt.encodeParts(r),i=url_1.URLExt.join(getBaseUrl(),"nbconvert",e,n);return t?i+"?download=true":i}PageConfig.getNBConvertURL=getNBConvertURL;function getToken(){return getOption("token")||getBodyData("jupyterApiToken")}PageConfig.getToken=getToken;function getNotebookVersion(){let r=getOption("notebookVersion");return r===""?[0,0,0]:JSON.parse(r)}PageConfig.getNotebookVersion=getNotebookVersion;let configData=null;function getBodyData(r){if(typeof document=="undefined"||!document.body)return"";let e=document.body.dataset[r];return typeof e=="undefined"?"":decodeURIComponent(e)}let Extension;(function(r){function e(i){try{let o=getOption(i);if(o)return JSON.parse(o)}catch(o){console.warn(`Unable to parse ${i}.`,o)}return[]}r.deferred=e("deferredExtensions"),r.disabled=e("disabledExtensions");function t(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.deferred.some(a=>a===i||s&&a===s)}r.isDeferred=t;function n(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.disabled.some(a=>a===i||s&&a===s)}r.isDisabled=n})(Extension=PageConfig.Extension||(PageConfig.Extension={}))})(PageConfig||(exports.PageConfig=PageConfig={}))});var u$=re(g1=>{"use strict";p();Object.defineProperty(g1,"__esModule",{value:!0});g1.PathExt=void 0;var Kf=f1(),c$;(function(r){function e(...d){let f=Kf.posix.join(...d);return f==="."?"":c(f)}r.join=e;function t(...d){let f=Kf.posix.join(...d);return f==="."?"":f}r.joinWithLeadingSlash=t;function n(d,f){return Kf.posix.basename(d,f)}r.basename=n;function i(d){let f=c(Kf.posix.dirname(d));return f==="."?"":f}r.dirname=i;function o(d){return Kf.posix.extname(d)}r.extname=o;function s(d){return d===""?"":c(Kf.posix.normalize(d))}r.normalize=s;function a(...d){return c(Kf.posix.resolve(...d))}r.resolve=a;function l(d,f){return c(Kf.posix.relative(d,f))}r.relative=l;function u(d){return d.length>0&&d.indexOf(".")!==0&&(d=`.${d}`),d}r.normalizeExtension=u;function c(d){return d.indexOf("/")===0&&(d=d.slice(1)),d}r.removeSlash=c})(c$||(g1.PathExt=c$={}))});var d$=re(v1=>{"use strict";p();Object.defineProperty(v1,"__esModule",{value:!0});v1.signalToPromise=void 0;var qve=l1();function Jve(r,e){let t=new qve.PromiseDelegate;function n(){r.disconnect(i)}function i(o,s){n(),t.resolve([o,s])}return r.connect(i),(e!=null?e:0)>0&&setTimeout(()=>{n(),t.reject(`Signal not emitted within ${e} ms.`)},e),t.promise}v1.signalToPromise=Jve});var f$=re(y1=>{"use strict";p();Object.defineProperty(y1,"__esModule",{value:!0});y1.Text=void 0;var p$;(function(r){let e=2>1;function t(s,a){if(e)return s;let l=s;for(let u=0;u+1<a.length&&u<s;u++){let c=a.charCodeAt(u);if(c>=55296&&c<=56319){let d=a.charCodeAt(u+1);d>=56320&&d<=57343&&(l--,u++)}}return l}r.jsIndexToCharIndex=t;function n(s,a){if(e)return s;let l=s;for(let u=0;u+1<a.length&&u<l;u++){let c=a.charCodeAt(u);if(c>=55296&&c<=56319){let d=a.charCodeAt(u+1);d>=56320&&d<=57343&&(l++,u++)}}return l}r.charIndexToJsIndex=n;function i(s,a=!1){return s.replace(/^(\w)|[\s-_:]+(\w)/g,function(l,u,c){return c?c.toUpperCase():a?u.toUpperCase():u.toLowerCase()})}r.camelCase=i;function o(s){return(s||"").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}r.titleCase=o})(p$||(y1.Text=p$={}))});var h$=re(b1=>{"use strict";p();Object.defineProperty(b1,"__esModule",{value:!0});b1.Time=void 0;var Gve=[{name:"years",milliseconds:365*24*60*60*1e3},{name:"months",milliseconds:30*24*60*60*1e3},{name:"days",milliseconds:24*60*60*1e3},{name:"hours",milliseconds:60*60*1e3},{name:"minutes",milliseconds:60*1e3},{name:"seconds",milliseconds:1e3}],m$;(function(r){function e(n,i="long"){let o=document.documentElement.lang||"en",s=new Intl.RelativeTimeFormat(o,{numeric:"auto",style:i}),a=new Date(n).getTime()-Date.now();for(let l of Gve){let u=Math.ceil(a/l.milliseconds);if(u!==0)return s.format(u,l.name)}return s.format(0,"seconds")}r.formatHuman=e;function t(n){let i=document.documentElement.lang||"en";return new Intl.DateTimeFormat(i,{dateStyle:"short",timeStyle:"short"}).format(new Date(n))}r.format=t})(m$||(b1.Time=m$={}))});var to=re(eo=>{"use strict";p();var Yve=eo&&eo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Jc=eo&&eo.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Yve(e,r,t)};Object.defineProperty(eo,"__esModule",{value:!0});Jc(KY(),eo);Jc(UY(),eo);Jc(WY(),eo);Jc(jY(),eo);Jc(l$(),eo);Jc(u$(),eo);Jc(d$(),eo);Jc(f$(),eo);Jc(h$(),eo);Jc(nV(),eo)});var gI=re(xt=>{"use strict";p();Object.defineProperty(xt,"__esModule",{value:!0});xt.supportedKernelWebSocketProtocols=xt.isInputReplyMsg=xt.isInputRequestMsg=xt.isDebugReplyMsg=xt.isDebugRequestMsg=xt.isExecuteReplyMsg=xt.isInfoRequestMsg=xt.isCommMsgMsg=xt.isCommCloseMsg=xt.isCommOpenMsg=xt.isDebugEventMsg=xt.isClearOutputMsg=xt.isStatusMsg=xt.isErrorMsg=xt.isExecuteResultMsg=xt.isExecuteInputMsg=xt.isUpdateDisplayDataMsg=xt.isDisplayDataMsg=xt.isStreamMsg=xt.createMessage=void 0;var $ve=jc();function zve(r){var e,t,n,i,o;return{buffers:(e=r.buffers)!==null&&e!==void 0?e:[],channel:r.channel,content:r.content,header:{date:new Date().toISOString(),msg_id:(t=r.msgId)!==null&&t!==void 0?t:$ve.UUID.uuid4(),msg_type:r.msgType,session:r.session,username:(n=r.username)!==null&&n!==void 0?n:"",version:"5.2"},metadata:(i=r.metadata)!==null&&i!==void 0?i:{},parent_header:(o=r.parentHeader)!==null&&o!==void 0?o:{}}}xt.createMessage=zve;function Qve(r){return r.header.msg_type==="stream"}xt.isStreamMsg=Qve;function Xve(r){return r.header.msg_type==="display_data"}xt.isDisplayDataMsg=Xve;function Zve(r){return r.header.msg_type==="update_display_data"}xt.isUpdateDisplayDataMsg=Zve;function eye(r){return r.header.msg_type==="execute_input"}xt.isExecuteInputMsg=eye;function tye(r){return r.header.msg_type==="execute_result"}xt.isExecuteResultMsg=tye;function rye(r){return r.header.msg_type==="error"}xt.isErrorMsg=rye;function nye(r){return r.header.msg_type==="status"}xt.isStatusMsg=nye;function iye(r){return r.header.msg_type==="clear_output"}xt.isClearOutputMsg=iye;function oye(r){return r.header.msg_type==="debug_event"}xt.isDebugEventMsg=oye;function sye(r){return r.header.msg_type==="comm_open"}xt.isCommOpenMsg=sye;function aye(r){return r.header.msg_type==="comm_close"}xt.isCommCloseMsg=aye;function lye(r){return r.header.msg_type==="comm_msg"}xt.isCommMsgMsg=lye;function cye(r){return r.header.msg_type==="kernel_info_request"}xt.isInfoRequestMsg=cye;function uye(r){return r.header.msg_type==="execute_reply"}xt.isExecuteReplyMsg=uye;function dye(r){return r.header.msg_type==="debug_request"}xt.isDebugRequestMsg=dye;function pye(r){return r.header.msg_type==="debug_reply"}xt.isDebugReplyMsg=pye;function fye(r){return r.header.msg_type==="input_request"}xt.isInputRequestMsg=fye;function mye(r){return r.header.msg_type==="input_reply"}xt.isInputReplyMsg=mye;var g$;(function(r){r.v1KernelWebsocketJupyterOrg="v1.kernel.websocket.jupyter.org"})(g$||(xt.supportedKernelWebSocketProtocols=g$={}))});var iV=re(wa=>{"use strict";p();var hye=wa&&wa.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),gye=wa&&wa.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),vye=wa&&wa.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&hye(e,r,t);return gye(e,r),e};Object.defineProperty(wa,"__esModule",{value:!0});wa.deserialize=wa.serialize=void 0;var v$=vye(gI());function yye(r,e=""){switch(e){case v$.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg:return vI.serializeV1KernelWebsocketJupyterOrg(r);default:return vI.serializeDefault(r)}}wa.serialize=yye;function bye(r,e=""){switch(e){case v$.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg:return vI.deserializeV1KernelWebsocketJupyterOrg(r);default:return vI.deserializeDefault(r)}}wa.deserialize=bye;var vI;(function(r){function e(a){let l,u=new DataView(a),c=Number(u.getBigUint64(0,!0)),d=[];for(let P=0;P<c;P++)d.push(Number(u.getBigUint64(8*(P+1),!0)));let f=new TextDecoder("utf8"),m=f.decode(a.slice(d[0],d[1])),g=JSON.parse(f.decode(a.slice(d[1],d[2]))),b=JSON.parse(f.decode(a.slice(d[2],d[3]))),v=JSON.parse(f.decode(a.slice(d[3],d[4]))),k=JSON.parse(f.decode(a.slice(d[4],d[5]))),R=[];for(let P=5;P<d.length-1;P++)R.push(new DataView(a.slice(d[P],d[P+1])));return l={channel:m,header:g,parent_header:b,metadata:v,content:k,buffers:R},l}r.deserializeV1KernelWebsocketJupyterOrg=e;function t(a){let l=JSON.stringify(a.header),u=a.parent_header==null?"{}":JSON.stringify(a.parent_header),c=JSON.stringify(a.metadata),d=JSON.stringify(a.content),f=a.buffers!==void 0?a.buffers:[],m=1+4+f.length+1,g=[];g.push(8*(1+m)),g.push(a.channel.length+g[g.length-1]);let b=new TextEncoder,v=b.encode(a.channel),k=b.encode(l),R=b.encode(u),P=b.encode(c),D=b.encode(d),K=new Uint8Array(v.length+k.length+R.length+P.length+D.length);K.set(v),K.set(k,v.length),K.set(R,v.length+k.length),K.set(P,v.length+k.length+R.length),K.set(D,v.length+k.length+R.length+P.length);for(let h of[k.length,R.length,P.length,D.length])g.push(h+g[g.length-1]);let L=0;for(let h of f){let y=h.byteLength;g.push(y+g[g.length-1]),L+=y}let B=new Uint8Array(8*(1+m)+K.byteLength+L),N=new ArrayBuffer(8),O=new DataView(N);O.setBigUint64(0,BigInt(m),!0),B.set(new Uint8Array(N),0);for(let h=0;h<g.length;h++)O.setBigUint64(0,BigInt(g[h]),!0),B.set(new Uint8Array(N),8*(h+1));B.set(K,g[0]);for(let h=0;h<f.length;h++){let y=f[h];B.set(new Uint8Array(ArrayBuffer.isView(y)?y.buffer:y),g[5+h])}return B.buffer}r.serializeV1KernelWebsocketJupyterOrg=t;function n(a){let l;return typeof a=="string"?l=JSON.parse(a):l=o(a),l}r.deserializeDefault=n;function i(a){var l;let u;return!((l=a.buffers)===null||l===void 0)&&l.length?u=s(a):u=JSON.stringify(a),u}r.serializeDefault=i;function o(a){let l=new DataView(a),u=l.getUint32(0),c=[];if(u<2)throw new Error("Invalid incoming Kernel Message");for(let m=1;m<=u;m++)c.push(l.getUint32(m*4));let d=new Uint8Array(a.slice(c[0],c[1])),f=JSON.parse(new TextDecoder("utf8").decode(d));f.buffers=[];for(let m=1;m<u;m++){let g=c[m],b=c[m+1]||a.byteLength;f.buffers.push(new DataView(a.slice(g,b)))}return f}function s(a){let l=[],u=[],c=new TextEncoder,d=[];a.buffers!==void 0&&(d=a.buffers,delete a.buffers);let f=c.encode(JSON.stringify(a));u.push(f.buffer);for(let v=0;v<d.length;v++){let k=d[v];u.push(ArrayBuffer.isView(k)?k.buffer:k)}let m=u.length;l.push(4*(m+1));for(let v=0;v+1<u.length;v++)l.push(l[l.length-1]+u[v].byteLength);let g=new Uint8Array(l[l.length-1]+u[u.length-1].byteLength),b=new DataView(g.buffer);b.setUint32(0,m);for(let v=0;v<l.length;v++)b.setUint32(4*(v+1),l[v]);for(let v=0;v<u.length;v++)g.set(new Uint8Array(u[v]),l[v]);return g.buffer}})(vI||(vI={}))});var y$=re(oV=>{"use strict";p();Object.defineProperty(oV,"__esModule",{value:!0});oV.default=WebSocket});var Do=re(S1=>{"use strict";p();Object.defineProperty(S1,"__esModule",{value:!0});S1.ServerConnection=void 0;var Ff=to(),b$=iV(),sV;typeof window=="undefined"?sV=y$():sV=WebSocket;var aV;(function(r){function e(o){return I1.makeSettings(o)}r.makeSettings=e;function t(o,s,a){return I1.handleRequest(o,s,a)}r.makeRequest=t;class n extends Error{static async create(s){try{let a=await s.json(),{message:l,traceback:u}=a;return u&&console.error(u),new n(s,l!=null?l:n._defaultMessage(s),u!=null?u:"")}catch(a){return console.debug(a),new n(s)}}constructor(s,a=n._defaultMessage(s),l=""){super(a),this.response=s,this.traceback=l}static _defaultMessage(s){return`Invalid response: ${s.status} ${s.statusText}`}}r.ResponseError=n;class i extends TypeError{constructor(s){super(s.message),this.stack=s.stack}}r.NetworkError=i})(aV||(S1.ServerConnection=aV={}));var I1;(function(r){function e(i={}){var o;let s=Ff.PageConfig.getBaseUrl(),a=Ff.PageConfig.getWsUrl(),l=Ff.URLExt.normalize(i.baseUrl)||s,u=i.wsUrl;!u&&l===s&&(u=a),!u&&l.indexOf("http")===0&&(u="ws"+l.slice(4)),u=u!=null?u:a;let c=Ff.PageConfig.getOption("appendToken").toLowerCase(),d;return c===""?d=typeof window=="undefined"||typeof process!="undefined"&&((o=process===null||process===void 0?void 0:process.env)===null||o===void 0?void 0:o.JEST_WORKER_ID)!==void 0||Ff.URLExt.getHostName(s)!==Ff.URLExt.getHostName(u):d=c==="true",{init:{cache:"no-store",credentials:"same-origin"},fetch,Headers,Request,WebSocket:sV,token:Ff.PageConfig.getToken(),appUrl:Ff.PageConfig.getOption("appUrl"),appendToken:d,serializer:{serialize:b$.serialize,deserialize:b$.deserialize},...i,baseUrl:l,wsUrl:u}}r.makeSettings=e;function t(i,o,s){var a;if(i.indexOf(s.baseUrl)!==0)throw new Error("Can only be used for notebook server requests");((a=o.cache)!==null&&a!==void 0?a:s.init.cache)==="no-store"&&(i+=(/\?/.test(i)?"&":"?")+new Date().getTime());let u=new s.Request(i,{...s.init,...o}),c=!1;if(s.token&&(c=!0,u.headers.append("Authorization",`token ${s.token}`)),typeof document!="undefined"){let d=n("_xsrf");d!==void 0&&(c=!0,u.headers.append("X-XSRFToken",d))}return!u.headers.has("Content-Type")&&c&&u.headers.set("Content-Type","application/json"),s.fetch.call(null,u).catch(d=>{throw new aV.NetworkError(d)})}r.handleRequest=t;function n(i){let o="";try{o=document.cookie}catch(a){return}let s=o.match("\\b"+i+"=([^;]*)\\b");return s==null?void 0:s[1]}})(I1||(I1={}))});var Fg=re(_1=>{"use strict";p();Object.defineProperty(_1,"__esModule",{value:!0});_1.BaseManager=void 0;var I$=As(),Iye=Do(),lV=class{constructor(e){var t;this._isDisposed=!1,this._disposed=new I$.Signal(this),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Iye.ServerConnection.makeSettings()}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}get isActive(){return!0}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(void 0),I$.Signal.clearData(this))}};_1.BaseManager=lV});var _$=re(yI=>{"use strict";p();Object.defineProperty(yI,"__esModule",{value:!0});yI.ConfigWithDefaults=yI.ConfigSection=void 0;var Sye=to(),xx=Jn(),_ye="api/config",S$;(function(r){function e(t){let n=new cV(t);return n.load().then(()=>n)}r.create=e})(S$||(yI.ConfigSection=S$={}));var cV=class{constructor(e){var t;this._url="unknown";let n=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:xx.ServerConnection.makeSettings();this._url=Sye.URLExt.join(n.baseUrl,_ye,encodeURIComponent(e.name))}get data(){return this._data}async load(){let e=await xx.ServerConnection.makeRequest(this._url,{},this.serverSettings);if(e.status!==200)throw await xx.ServerConnection.ResponseError.create(e);this._data=await e.json()}async update(e){this._data={...this._data,...e};let t={method:"PATCH",body:JSON.stringify(e)},n=await xx.ServerConnection.makeRequest(this._url,t,this.serverSettings);if(n.status!==200)throw await xx.ServerConnection.ResponseError.create(n);return this._data=await n.json(),this._data}},uV=class{constructor(e){var t,n;this._className="",this._section=e.section,this._defaults=(t=e.defaults)!==null&&t!==void 0?t:{},this._className=(n=e.className)!==null&&n!==void 0?n:""}get(e){let t=this._classData();return e in t?t[e]:this._defaults[e]}set(e,t){let n={};if(n[e]=t,this._className){let i={};return i[this._className]=n,this._section.update(i)}else return this._section.update(n)}_classData(){let e=this._section.data;return this._className&&this._className in e?e[this._className]:e}};yI.ConfigWithDefaults=uV});var Px=re(E1=>{"use strict";p();Object.defineProperty(E1,"__esModule",{value:!0});E1.validateProperty=void 0;function Eye(r,e,t,n=[]){if(!r.hasOwnProperty(e))throw Error(`Missing property '${e}'`);let i=r[e];if(t!==void 0){let o=!0;switch(t){case"array":o=Array.isArray(i);break;case"object":o=typeof i!="undefined";break;default:o=typeof i===t}if(!o)throw new Error(`Property '${e}' is not of type '${t}'`);if(n.length>0){let s=!0;switch(t){case"string":case"number":case"boolean":s=n.includes(i);break;default:s=n.findIndex(a=>a===i)>=0;break}if(!s)throw new Error(`Property '${e}' is not one of the valid values ${JSON.stringify(n)}`)}}}E1.validateProperty=Eye});var E$=re(bI=>{"use strict";p();Object.defineProperty(bI,"__esModule",{value:!0});bI.validateCheckpointModel=bI.validateContentsModel=void 0;var Gc=Px();function Cye(r){(0,Gc.validateProperty)(r,"name","string"),(0,Gc.validateProperty)(r,"path","string"),(0,Gc.validateProperty)(r,"type","string"),(0,Gc.validateProperty)(r,"created","string"),(0,Gc.validateProperty)(r,"last_modified","string"),(0,Gc.validateProperty)(r,"mimetype","object"),(0,Gc.validateProperty)(r,"content","object"),(0,Gc.validateProperty)(r,"format","object")}bI.validateContentsModel=Cye;function wye(r){(0,Gc.validateProperty)(r,"id","string"),(0,Gc.validateProperty)(r,"last_modified","string")}bI.validateCheckpointModel=wye});var fV=re(is=>{"use strict";p();var xye=is&&is.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Pye=is&&is.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Dye=is&&is.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&xye(e,r,t);return Pye(e,r),e};Object.defineProperty(is,"__esModule",{value:!0});is.Drive=is.ContentsManager=is.Contents=void 0;var Ms=to(),C1=As(),In=Jn(),Ad=Dye(E$()),Tye="api/contents",kye="files",C$;(function(r){function e(n){Ad.validateContentsModel(n)}r.validateContentsModel=e;function t(n){Ad.validateCheckpointModel(n)}r.validateCheckpointModel=t})(C$||(is.Contents=C$={}));var dV=class{constructor(e={}){var t,n;this._isDisposed=!1,this._additionalDrives=new Map,this._fileChanged=new C1.Signal(this);let i=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:In.ServerConnection.makeSettings();this._defaultDrive=(n=e.defaultDrive)!==null&&n!==void 0?n:new w1({serverSettings:i}),this._defaultDrive.fileChanged.connect(this._onFileChanged,this)}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,C1.Signal.clearData(this))}addDrive(e){this._additionalDrives.set(e.name,e),e.fileChanged.connect(this._onFileChanged,this)}getSharedModelFactory(e){var t;let[n]=this._driveForPath(e);return(t=n==null?void 0:n.sharedModelFactory)!==null&&t!==void 0?t:null}localPath(e){let t=e.split("/"),n=t[0].split(":");return n.length===1||!this._additionalDrives.has(n[0])?Ms.PathExt.removeSlash(e):Ms.PathExt.join(n.slice(1).join(":"),...t.slice(1))}normalize(e){let t=e.split(":");return t.length===1?Ms.PathExt.normalize(e):`${t[0]}:${Ms.PathExt.normalize(t.slice(1).join(":"))}`}resolvePath(e,t){let n=this.driveName(e),i=this.localPath(e),o=Ms.PathExt.resolve("/",i,t);return n?`${n}:${o}`:o}driveName(e){let n=e.split("/")[0].split(":");return n.length===1?"":this._additionalDrives.has(n[0])?n[0]:""}get(e,t){let[n,i]=this._driveForPath(e);return n.get(i,t).then(o=>{let s=[];if(o.type==="directory"&&o.content){for(let a of o.content)s.push({...a,path:this._toGlobalPath(n,a.path)});return{...o,path:this._toGlobalPath(n,i),content:s,serverPath:o.path}}else return{...o,path:this._toGlobalPath(n,i),serverPath:o.path}})}getDownloadUrl(e){let[t,n]=this._driveForPath(e);return t.getDownloadUrl(n)}newUntitled(e={}){if(e.path){let t=this.normalize(e.path),[n,i]=this._driveForPath(t);return n.newUntitled({...e,path:i}).then(o=>({...o,path:Ms.PathExt.join(t,o.name),serverPath:o.path}))}else return this._defaultDrive.newUntitled(e)}delete(e){let[t,n]=this._driveForPath(e);return t.delete(n)}rename(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n!==o)throw Error("ContentsManager: renaming files must occur within a Drive");return n.rename(i,s).then(a=>({...a,path:this._toGlobalPath(n,s),serverPath:a.path}))}save(e,t={}){let n=this.normalize(e),[i,o]=this._driveForPath(e);return i.save(o,{...t,path:o}).then(s=>({...s,path:n,serverPath:s.path}))}copy(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n===o)return n.copy(i,s).then(a=>({...a,path:this._toGlobalPath(n,a.path),serverPath:a.path}));throw Error("Copying files between drives is not currently implemented")}createCheckpoint(e){let[t,n]=this._driveForPath(e);return t.createCheckpoint(n)}listCheckpoints(e){let[t,n]=this._driveForPath(e);return t.listCheckpoints(n)}restoreCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.restoreCheckpoint(i,t)}deleteCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.deleteCheckpoint(i,t)}_toGlobalPath(e,t){return e===this._defaultDrive?Ms.PathExt.removeSlash(t):`${e.name}:${Ms.PathExt.removeSlash(t)}`}_driveForPath(e){let t=this.driveName(e),n=this.localPath(e);return t?[this._additionalDrives.get(t),n]:[this._defaultDrive,n]}_onFileChanged(e,t){var n,i;if(e===this._defaultDrive)this._fileChanged.emit(t);else{let o=null,s=null;!((n=t.newValue)===null||n===void 0)&&n.path&&(o={...t.newValue,path:this._toGlobalPath(e,t.newValue.path)}),!((i=t.oldValue)===null||i===void 0)&&i.path&&(s={...t.oldValue,path:this._toGlobalPath(e,t.oldValue.path)}),this._fileChanged.emit({type:t.type,newValue:o,oldValue:s})}}};is.ContentsManager=dV;var w1=class{constructor(e={}){var t,n,i;this._isDisposed=!1,this._fileChanged=new C1.Signal(this),this.name=(t=e.name)!==null&&t!==void 0?t:"Default",this._apiEndpoint=(n=e.apiEndpoint)!==null&&n!==void 0?n:Tye,this.serverSettings=(i=e.serverSettings)!==null&&i!==void 0?i:In.ServerConnection.makeSettings()}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,C1.Signal.clearData(this))}async get(e,t){let n=this._getUrl(e);if(t){t.type==="notebook"&&delete t.format;let a=t.content?"1":"0",l=t.hash?"1":"0",u={...t,content:a,hash:l};n+=Ms.URLExt.objectToQueryString(u)}let i=this.serverSettings,o=await In.ServerConnection.makeRequest(n,{},i);if(o.status!==200)throw await In.ServerConnection.ResponseError.create(o);let s=await o.json();return Ad.validateContentsModel(s),s}getDownloadUrl(e){let t=this.serverSettings.baseUrl,n=Ms.URLExt.join(t,kye,Ms.URLExt.encodeParts(e)),i="";try{i=document.cookie}catch(s){}let o=i.match("\\b_xsrf=([^;]*)\\b");if(o){let s=new URL(n);s.searchParams.append("_xsrf",o[1]),n=s.toString()}return Promise.resolve(n)}async newUntitled(e={}){var t;let n="{}";e&&(e.ext&&(e.ext=pV.normalizeExtension(e.ext)),n=JSON.stringify(e));let i=this.serverSettings,o=this._getUrl((t=e.path)!==null&&t!==void 0?t:""),s={method:"POST",body:n},a=await In.ServerConnection.makeRequest(o,s,i);if(a.status!==201)throw await In.ServerConnection.ResponseError.create(a);let l=await a.json();return Ad.validateContentsModel(l),this._fileChanged.emit({type:"new",oldValue:null,newValue:l}),l}async delete(e){let t=this._getUrl(e),n=this.serverSettings,i={method:"DELETE"},o=await In.ServerConnection.makeRequest(t,i,n);if(o.status!==204)throw await In.ServerConnection.ResponseError.create(o);this._fileChanged.emit({type:"delete",oldValue:{path:e},newValue:null})}async rename(e,t){let n=this.serverSettings,i=this._getUrl(e),o={method:"PATCH",body:JSON.stringify({path:t})},s=await In.ServerConnection.makeRequest(i,o,n);if(s.status!==200)throw await In.ServerConnection.ResponseError.create(s);let a=await s.json();return Ad.validateContentsModel(a),this._fileChanged.emit({type:"rename",oldValue:{path:e},newValue:a}),a}async save(e,t={}){let n=this.serverSettings,i=this._getUrl(e),o={method:"PUT",body:JSON.stringify(t)},s=await In.ServerConnection.makeRequest(i,o,n);if(s.status!==200&&s.status!==201)throw await In.ServerConnection.ResponseError.create(s);let a=await s.json();return Ad.validateContentsModel(a),this._fileChanged.emit({type:"save",oldValue:null,newValue:a}),a}async copy(e,t){let n=this.serverSettings,i=this._getUrl(t),o={method:"POST",body:JSON.stringify({copy_from:e})},s=await In.ServerConnection.makeRequest(i,o,n);if(s.status!==201)throw await In.ServerConnection.ResponseError.create(s);let a=await s.json();return Ad.validateContentsModel(a),this._fileChanged.emit({type:"new",oldValue:null,newValue:a}),a}async createCheckpoint(e){let t=this._getUrl(e,"checkpoints"),n={method:"POST"},i=await In.ServerConnection.makeRequest(t,n,this.serverSettings);if(i.status!==201)throw await In.ServerConnection.ResponseError.create(i);let o=await i.json();return Ad.validateCheckpointModel(o),o}async listCheckpoints(e){let t=this._getUrl(e,"checkpoints"),n=await In.ServerConnection.makeRequest(t,{},this.serverSettings);if(n.status!==200)throw await In.ServerConnection.ResponseError.create(n);let i=await n.json();if(!Array.isArray(i))throw new Error("Invalid Checkpoint list");for(let o=0;o<i.length;o++)Ad.validateCheckpointModel(i[o]);return i}async restoreCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"POST"},o=await In.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await In.ServerConnection.ResponseError.create(o)}async deleteCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"DELETE"},o=await In.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await In.ServerConnection.ResponseError.create(o)}_getUrl(...e){let t=e.map(i=>Ms.URLExt.encodeParts(i)),n=this.serverSettings.baseUrl;return Ms.URLExt.join(n,this._apiEndpoint,...t)}};is.Drive=w1;var pV;(function(r){function e(t){return t.length>0&&t.indexOf(".")!==0&&(t=`.${t}`),t}r.normalizeExtension=e})(pV||(pV={}))});var mV=re((x1,w$)=>{p();(function(r,e){typeof x1=="object"&&typeof w$!="undefined"?e(x1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(x1,function(r){"use strict";r.ArrayExt=void 0,function(h){function y(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(A[me]===M)return me}return-1}h.firstIndexOf=y;function w(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(A[me]===M)return me}return-1}h.lastIndexOf=w;function T(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(M(A[me],me))return me}return-1}h.findFirstIndex=T;function H(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(M(A[me],me))return me}return-1}h.findLastIndex=H;function Y(A,M,I=0,S=-1){let _=T(A,M,I,S);return _!==-1?A[_]:void 0}h.findFirstValue=Y;function Z(A,M,I=-1,S=0){let _=H(A,M,I,S);return _!==-1?A[_]:void 0}h.findLastValue=Z;function ie(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function ce(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=ce;function be(A,M,I){if(A===M)return!0;if(A.length!==M.length)return!1;for(let S=0,_=A.length;S<_;++S)if(I?!I(A[S],M[S]):A[S]!==M[S])return!1;return!0}h.shallowEqual=be;function q(A,M={}){let{start:I,stop:S,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=A.length;I===void 0?I=_<0?F-1:0:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F),S===void 0?S=_<0?-1:F:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F);let j;_<0&&S>=I||_>0&&I>=S?j=0:_<0?j=Math.floor((S-I+1)/_+1):j=Math.floor((S-I-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=A[I+Fe*_];return me}h.slice=q;function $(A,M,I){let S=A.length;if(S<=1||(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1),M===I))return;let _=A[M],F=M<I?1:-1;for(let j=M;j!==I;j+=F)A[j]=A[j+F];A[I]=_}h.move=$;function de(A,M=0,I=-1){let S=A.length;if(!(S<=1))for(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1);M<I;){let _=A[M],F=A[I];A[M++]=F,A[I--]=_}}h.reverse=de;function pe(A,M,I=0,S=-1){let _=A.length;if(_<=1||(I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I>=S))return;let F=S-I+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=I+M;de(A,I,j-1),de(A,j,S),de(A,I,S)}h.rotate=pe;function ye(A,M,I=0,S=-1){let _=A.length;if(_===0)return;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j)A[(I+j)%_]=M}h.fill=ye;function z(A,M,I){let S=A.length;M<0?M=Math.max(0,M+S):M=Math.min(M,S);for(let _=S;_>M;--_)A[_]=A[_-1];A[M]=I}h.insert=z;function fe(A,M){let I=A.length;if(M<0&&(M+=I),M<0||M>=I)return;let S=A[M];for(let _=M+1;_<I;++_)A[_-1]=A[_];return A.length=I-1,S}h.removeAt=fe;function Se(A,M,I=0,S=-1){let _=y(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeFirstOf=Se;function Te(A,M,I=-1,S=0){let _=w(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeLastOf=Te;function Le(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&A[j]===M||S<I&&(j<=S||j>=I)&&A[j]===M?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllOf=Le;function $e(A,M,I=0,S=-1){let _,F=T(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeFirstWhere=$e;function Ge(A,M,I=-1,S=0){let _,F=H(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeLastWhere=Ge;function Bt(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&M(A[j],j)||S<I&&(j<=S||j>=I)&&M(A[j],j)?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let y of h)yield*y}function*t(){}function*n(h,y=0){for(let w of h)yield[y++,w]}function*i(h,y){let w=0;for(let T of h)y(T,w++)&&(yield T)}function o(h,y){let w=0;for(let T of h)if(y(T,w++))return T}function s(h,y){let w=0;for(let T of h)if(y(T,w++))return w-1;return-1}function a(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)<0&&(w=T)}return w}function l(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)>0&&(w=T)}return w}function u(h,y){let w=!0,T,H;for(let Y of h)w?(T=Y,H=Y,w=!1):y(Y,T)<0?T=Y:y(Y,H)>0&&(H=Y);return w?void 0:[T,H]}function c(h){return Array.from(h)}function d(h){let y={};for(let[w,T]of h)y[w]=T;return y}function f(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return}function m(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return!1;return!0}function g(h,y){let w=0;for(let T of h)if(y(T,w++))return!0;return!1}function*b(h,y){let w=0;for(let T of h)yield y(T,w++)}function*v(h,y,w){y===void 0?(y=h,h=0,w=1):w===void 0&&(w=1);let T=k.rangeLength(h,y,w);for(let H=0;H<T;H++)yield h+w*H}var k;(function(h){function y(w,T,H){return H===0?1/0:w>T&&H>0||w<T&&H<0?0:Math.ceil((T-w)/H)}h.rangeLength=y})(k||(k={}));function R(h,y,w){let T=h[Symbol.iterator](),H=0,Y=T.next();if(Y.done&&w===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return w;let Z=T.next();if(Z.done&&w===void 0)return Y.value;if(Z.done)return y(w,Y.value,H++);let ie;w===void 0?ie=y(Y.value,Z.value,H++):ie=y(y(w,Y.value,H++),Z.value,H++);let ce;for(;!(ce=T.next()).done;)ie=y(ie,ce.value,H++);return ie}function*P(h,y){for(;0<y--;)yield h}function*D(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let y=h.length-1;y>-1;y--)yield h[y]}function L(h){let y=[],w=new Set,T=new Map;for(let Z of h)H(Z);for(let[Z]of T)Y(Z);return y;function H(Z){let[ie,ce]=Z,be=T.get(ce);be?be.push(ie):T.set(ce,[ie])}function Y(Z){if(w.has(Z))return;w.add(Z);let ie=T.get(Z);if(ie)for(let ce of ie)Y(ce);y.push(Z)}}function*B(h,y){let w=0;for(let T of h)w++%y===0&&(yield T)}r.StringExt=void 0,function(h){function y(Z,ie,ce=0){let be=new Array(ie.length);for(let q=0,$=ce,de=ie.length;q<de;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=y;function w(Z,ie,ce=0){let be=y(Z,ie,ce);if(!be)return null;let q=0;for(let $=0,de=be.length;$<de;++$){let pe=be[$]-ce;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=w;function T(Z,ie,ce=0){let be=y(Z,ie,ce);if(!be)return null;let q=0,$=ce-1;for(let de=0,pe=be.length;de<pe;++de){let ye=be[de];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=T;function H(Z,ie,ce){let be=[],q=0,$=0,de=ie.length;for(;q<de;){let pe=ie[q],ye=ie[q];for(;++q<de&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(ce(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,y){if(y<1)return;let w=h[Symbol.iterator](),T;for(;0<y--&&!(T=w.next()).done;)yield T.value}function*O(...h){let y=h.map(T=>T[Symbol.iterator]()),w=y.map(T=>T.next());for(;m(w,T=>!T.done);w=y.map(T=>T.next()))yield w.map(T=>T.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=D,r.range=v,r.reduce=R,r.repeat=P,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var hV=re((P1,x$)=>{p();(function(r,e){typeof P1=="object"&&typeof x$!="undefined"?e(P1,mV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(P1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"}u.isPrimitive=c;function d(P){return Array.isArray(P)}u.isArray=d;function f(P){return!c(P)&&!d(P)}u.isObject=f;function m(P,D){if(P===D)return!0;if(c(P)||c(D))return!1;let K=d(P),L=d(D);return K!==L?!1:K&&L?b(P,D):v(P,D)}u.deepEqual=m;function g(P){return c(P)?P:d(P)?k(P):R(P)}u.deepCopy=g;function b(P,D){if(P===D)return!0;if(P.length!==D.length)return!1;for(let K=0,L=P.length;K<L;++K)if(!m(P[K],D[K]))return!1;return!0}function v(P,D){if(P===D)return!0;for(let K in P)if(P[K]!==void 0&&!(K in D))return!1;for(let K in D)if(D[K]!==void 0&&!(K in P))return!1;for(let K in P){let L=P[K],B=D[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function k(P){let D=new Array(P.length);for(let K=0,L=P.length;K<L;++K)D[K]=g(P[K]);return D}function R(P){let D={};for(let K in P){let L=P[K];L!==void 0&&(D[K]=g(L))}return D}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(v=>{let k=this._services.get(v);return k?this._plugins.get(k).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(v){var k,R,P,D;this._activated=!1,this._promise=null,this._service=null,this.id=v.id,this.description=(k=v.description)!==null&&k!==void 0?k:"",this.activate=v.activate,this.deactivate=(R=v.deactivate)!==null&&R!==void 0?R:null,this.provides=(P=v.provides)!==null&&P!==void 0?P:null,this.autoStart=(D=v.autoStart)!==null&&D!==void 0?D:!1,this.requires=v.requires?v.requires.slice():[],this.optional=v.optional?v.optional.slice():[]}get activated(){return this._activated}set activated(v){this._activated=v}get service(){return this._service}set service(v){this._service=v}get promise(){return this._promise}set promise(v){this._promise=v}}function d(b){return new c(b)}u.createPluginData=d;function f(b,v,k){let R=[...b.requires,...b.optional],P=K=>{if(K===b.provides)return!0;let L=k.get(K);if(!L)return!1;let B=v.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(D.push(L),N.some(P)?!0:(D.pop(),!1))};if(!b.provides||R.length===0)return;let D=[b.id];if(R.some(P))throw new ReferenceError(`Cycle detected: ${D.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,v,k){let R=new Array,P=N=>{let O=v.get(N),h=[...O.requires,...O.optional];R.push(...h.reduce((y,w)=>{let T=k.get(w);return T&&y.push([N,T]),y},[]))};for(let N of v.keys())P(N);let D=R.filter(N=>N[1]===b),K=0;for(;D.length>K;){let N=D.length,O=new Set(D.map(h=>h[0]));for(let h of O)R.filter(y=>y[1]===h).forEach(y=>{D.includes(y)||D.push(y)});K=N}let L=e.topologicSort(D),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,v){let k=new Set;for(let R of b.keys())b.get(R).autoStart===!0&&k.add(R);if(v.startPlugins)for(let R of v.startPlugins)k.add(R);if(v.ignorePlugins)for(let R of v.ignorePlugins)k.delete(R);return Array.from(k)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var D$=re((D1,P$)=>{p();(function(r,e){typeof D1=="object"&&typeof P$!="undefined"?e(D1,mV(),hV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(D1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let y=g.get(N.sender);if(y||(y=[],g.set(N.sender,y)),R(y,N,O,h))return!1;let w=h||O,T=b.get(w);T||(T=[],b.set(w,T));let H={signal:N,slot:O,thisArg:h};return y.push(H),T.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let y=g.get(N.sender);if(!y||y.length===0)return!1;let w=R(y,N,O,h);if(!w)return!1;let T=h||O,H=b.get(T);return w.signal=null,D(y),D(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let y=b.get(O);if(!(!y||y.length===0)){for(let w of y)w.signal&&w.signal.sender===N&&(w.signal=null);D(h),D(y)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.thisArg||h.slot;h.signal=null,D(b.get(y))}D(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.signal.sender;h.signal=null,D(g.get(y))}D(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let y=0,w=h.length;y<w;++y){let T=h[y];T.signal===N&&P(T,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,v=new Set,k=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function R(N,O,h,y){return e.find(N,w=>w.signal===O&&w.slot===h&&w.thisArg===y)}function P(N,O){let{signal:h,slot:y,thisArg:w}=N;try{y.call(w,h.sender,O)}catch(T){s.exceptionHandler(T)}}function D(N){v.size===0&&k(K),v.add(N)}function K(){v.forEach(L),v.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var Ug=re((T1,T$)=>{p();(function(r,e){typeof T1=="object"&&typeof T$!="undefined"?e(T1,hV(),D$()):typeof define=="function"&&define.amd?define(["exports","@lumino/coreutils","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_polling={},r.lumino_coreutils,r.lumino_signaling))})(T1,function(r,e,t){"use strict";class n{constructor(u){var c;this._disposed=new t.Signal(this),this._lingered=0,this._tick=new e.PromiseDelegate,this._ticked=new t.Signal(this),this._factory=u.factory,this._linger=(c=u.linger)!==null&&c!==void 0?c:i.DEFAULT_LINGER,this._standby=u.standby||i.DEFAULT_STANDBY,this._state={...i.DEFAULT_STATE,timestamp:new Date().getTime()};let d=u.frequency||{},f=Math.max(d.interval||0,d.max||0,i.DEFAULT_FREQUENCY.max);this.frequency={...i.DEFAULT_FREQUENCY,...d,max:f},this.name=u.name||i.DEFAULT_NAME,(!("auto"in u)||u.auto)&&setTimeout(()=>this.start())}get disposed(){return this._disposed}get frequency(){return this._frequency}set frequency(u){if(this.isDisposed||e.JSONExt.deepEqual(u,this.frequency||{}))return;let{backoff:c,interval:d,max:f}=u;if(d=Math.round(d),f=Math.round(f),typeof c=="number"&&c<1)throw new Error("Poll backoff growth factor must be at least 1");if((d<0||d>f)&&d!==n.NEVER)throw new Error("Poll interval must be between 0 and max");if(f>n.MAX_INTERVAL&&f!==n.NEVER)throw new Error(`Max interval must be less than ${n.MAX_INTERVAL}`);this._frequency={backoff:c,interval:d,max:f}}get isDisposed(){return this.state.phase==="disposed"}get standby(){return this._standby}set standby(u){this.isDisposed||this.standby===u||(this._standby=u)}get state(){return this._state}get tick(){return this._tick.promise}get ticked(){return this._ticked}async*[Symbol.asyncIterator](){for(;!this.isDisposed;)yield this.state,await this.tick.catch(()=>{})}dispose(){this.isDisposed||(this._state={...i.DISPOSED_STATE,timestamp:new Date().getTime()},this._tick.promise.catch(u=>{}),this._tick.reject(new Error(`Poll (${this.name}) is disposed.`)),this._disposed.emit(void 0),t.Signal.clearData(this))}refresh(){return this.schedule({cancel:({phase:u})=>u==="refreshed",interval:n.IMMEDIATE,phase:"refreshed"})}async schedule(u={}){if(this.isDisposed||u.cancel&&u.cancel(this.state))return;let c=this._tick,d=new e.PromiseDelegate,f={interval:this.frequency.interval,payload:null,phase:"standby",timestamp:new Date().getTime(),...u};if(this._state=f,this._tick=d,clearTimeout(this._timeout),this._ticked.emit(this.state),c.resolve(this),await c.promise,f.interval===n.NEVER){this._timeout=void 0;return}let m=()=>{this.isDisposed||this.tick!==d.promise||this._execute()};this._timeout=setTimeout(m,f.interval)}start(){return this.schedule({cancel:({phase:u})=>u!=="constructed"&&u!=="standby"&&u!=="stopped",interval:n.IMMEDIATE,phase:"started"})}stop(){return this.schedule({cancel:({phase:u})=>u==="stopped",interval:n.NEVER,phase:"stopped"})}get hidden(){return i.hidden}_execute(){let u=typeof this.standby=="function"?this.standby():this.standby;if(u==="never"?u=!1:u==="when-hidden"&&(this.hidden?u=++this._lingered>this._linger:(this._lingered=0,u=!1)),u){this.schedule();return}let c=this.tick;this._factory(this.state).then(d=>{this.isDisposed||this.tick!==c||this.schedule({payload:d,phase:this.state.phase==="rejected"?"reconnected":"resolved"})}).catch(d=>{this.isDisposed||this.tick!==c||this.schedule({interval:i.sleep(this.frequency,this.state),payload:d,phase:"rejected"})})}}(function(l){l.IMMEDIATE=0,l.MAX_INTERVAL=2147483647,l.NEVER=1/0})(n||(n={}));var i;(function(l){l.DEFAULT_BACKOFF=3,l.DEFAULT_FREQUENCY={backoff:!0,interval:1e3,max:30*1e3},l.DEFAULT_LINGER=1,l.DEFAULT_NAME="unknown",l.DEFAULT_STANDBY="when-hidden",l.DEFAULT_STATE={interval:n.NEVER,payload:null,phase:"constructed",timestamp:new Date(0).getTime()},l.DISPOSED_STATE={interval:n.NEVER,payload:null,phase:"disposed",timestamp:new Date(0).getTime()};function u(d,f){let{backoff:m,interval:g,max:b}=d;if(g===n.NEVER)return g;let v=m===!0?l.DEFAULT_BACKOFF:m===!1?1:m,k=c(g,f.interval*v);return Math.min(b,k)}l.sleep=u,l.hidden=(()=>typeof document=="undefined"?!1:(document.addEventListener("visibilitychange",()=>{l.hidden=document.visibilityState==="hidden"}),document.addEventListener("pagehide",()=>{l.hidden=document.visibilityState==="hidden"}),document.visibilityState==="hidden"))();function c(d,f){return d=Math.ceil(d),f=Math.floor(f),Math.floor(Math.random()*(f-d+1))+d}})(i||(i={}));class o{constructor(u,c=500){this.args=void 0,this.payload=null,this.limit=c,this.poll=new n({auto:!1,factory:async()=>{let{args:d}=this;return this.args=void 0,u(...d)},frequency:{backoff:!1,interval:n.NEVER,max:n.NEVER},standby:"never"}),this.payload=new e.PromiseDelegate,this.poll.ticked.connect((d,f)=>{let{payload:m}=this;if(f.phase==="resolved"){this.payload=new e.PromiseDelegate,m.resolve(f.payload);return}if(f.phase==="rejected"||f.phase==="stopped"){this.payload=new e.PromiseDelegate,m.promise.catch(g=>{}),m.reject(f.payload);return}},this)}get isDisposed(){return this.payload===null}dispose(){this.isDisposed||(this.args=void 0,this.payload=null,this.poll.dispose())}async stop(){return this.poll.stop()}}class s extends o{invoke(...u){return this.args=u,this.poll.schedule({interval:this.limit,phase:"invoked"}),this.payload.promise}}class a extends o{constructor(u,c){super(u,typeof c=="number"?c:c&&c.limit),this._trailing=!1,typeof c!="number"&&c&&c.edge==="trailing"&&(this._trailing=!0),this._interval=this._trailing?this.limit:n.IMMEDIATE}invoke(...u){let c=this.poll.state.phase!=="invoked";return(c||this._trailing)&&(this.args=u),c&&this.poll.schedule({interval:this._interval,phase:"invoked"}),this.payload.promise}}r.Debouncer=s,r.Poll=n,r.RateLimiter=o,r.Throttler=a})});var vV=re(k1=>{"use strict";p();Object.defineProperty(k1,"__esModule",{value:!0});k1.EventManager=void 0;var k$=to(),Nye=Ug(),N$=As(),R$=Do(),A$="api/events",gV=class{constructor(e={}){var t;this._socket=null,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:R$.ServerConnection.makeSettings(),this._poll=new Nye.Poll({factory:()=>this._subscribe()}),this._stream=new N$.Stream(this),this._poll.start()}get isDisposed(){return this._poll.isDisposed}get stream(){return this._stream}dispose(){if(this.isDisposed)return;this._poll.dispose();let e=this._socket;e&&(this._socket=null,e.onopen=()=>{},e.onerror=()=>{},e.onmessage=()=>{},e.onclose=()=>{},e.close()),N$.Signal.clearData(this),this._stream.stop()}async emit(e){let{serverSettings:t}=this,{baseUrl:n}=t,{makeRequest:i,ResponseError:o}=R$.ServerConnection,s=k$.URLExt.join(n,A$),a={body:JSON.stringify(e),method:"POST"},l=await i(s,a,t);if(l.status!==204)throw new o(l)}_subscribe(){return new Promise((e,t)=>{if(this.isDisposed)return;let{appendToken:n,token:i,WebSocket:o,wsUrl:s}=this.serverSettings,a=k$.URLExt.join(s,A$,"subscribe");n&&i!==""&&(a+=`?token=${encodeURIComponent(i)}`);let l=this._socket=new o(a),u=this._stream;l.onclose=()=>t(new Error("EventManager socket closed")),l.onmessage=c=>c.data&&u.emit(JSON.parse(c.data))})}};k1.EventManager=gV});var O$=re(M$=>{"use strict";p();Object.defineProperty(M$,"__esModule",{value:!0})});var N1=re(Uf=>{"use strict";p();Object.defineProperty(Uf,"__esModule",{value:!0});Uf.validateModels=Uf.validateModel=Uf.validateMessage=void 0;var Wg=Px(),L$=["username","version","session","msg_id","msg_type"],Rye={stream:{name:"string",text:"string"},display_data:{data:"object",metadata:"object"},execute_input:{code:"string",execution_count:"number"},execute_result:{execution_count:"number",data:"object",metadata:"object"},error:{ename:"string",evalue:"string",traceback:"object"},status:{execution_state:["string",["starting","idle","busy","restarting","dead"]]},clear_output:{wait:"boolean"},comm_open:{comm_id:"string",target_name:"string",data:"object"},comm_msg:{comm_id:"string",data:"object"},comm_close:{comm_id:"string"},shutdown_reply:{restart:"boolean"}};function Aye(r){for(let e=0;e<L$.length;e++)(0,Wg.validateProperty)(r,L$[e],"string")}function Mye(r){(0,Wg.validateProperty)(r,"metadata","object"),(0,Wg.validateProperty)(r,"content","object"),(0,Wg.validateProperty)(r,"channel","string"),Aye(r.header),r.channel==="iopub"&&Oye(r)}Uf.validateMessage=Mye;function Oye(r){if(r.channel==="iopub"){let e=Rye[r.header.msg_type];if(e===void 0)return;let t=Object.keys(e),n=r.content;for(let i=0;i<t.length;i++){let o=e[t[i]];Array.isArray(o)||(o=[o]),(0,Wg.validateProperty)(n,t[i],...o)}}}function K$(r){(0,Wg.validateProperty)(r,"name","string"),(0,Wg.validateProperty)(r,"id","string")}Uf.validateModel=K$;function Lye(r){if(!Array.isArray(r))throw new Error("Invalid kernel list");r.forEach(e=>K$(e))}Uf.validateModels=Lye});var A1=re(Sn=>{"use strict";p();Object.defineProperty(Sn,"__esModule",{value:!0});Sn.getKernelModel=Sn.shutdownKernel=Sn.interruptKernel=Sn.restartKernel=Sn.startNew=Sn.listRunning=Sn.KERNEL_SERVICE_URL=void 0;var bi=Do(),II=to(),R1=N1();Sn.KERNEL_SERVICE_URL="api/kernels";async function Kye(r=bi.ServerConnection.makeSettings()){let e=II.URLExt.join(r.baseUrl,Sn.KERNEL_SERVICE_URL),t=await bi.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await bi.ServerConnection.ResponseError.create(t);let n=await t.json();return(0,R1.validateModels)(n),n}Sn.listRunning=Kye;async function Fye(r={},e=bi.ServerConnection.makeSettings()){let t=II.URLExt.join(e.baseUrl,Sn.KERNEL_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await bi.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await bi.ServerConnection.ResponseError.create(i);let o=await i.json();return(0,R1.validateModel)(o),o}Sn.startNew=Fye;async function Uye(r,e=bi.ServerConnection.makeSettings()){let t=II.URLExt.join(e.baseUrl,Sn.KERNEL_SERVICE_URL,encodeURIComponent(r),"restart"),n={method:"POST"},i=await bi.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await bi.ServerConnection.ResponseError.create(i);let o=await i.json();(0,R1.validateModel)(o)}Sn.restartKernel=Uye;async function Wye(r,e=bi.ServerConnection.makeSettings()){let t=II.URLExt.join(e.baseUrl,Sn.KERNEL_SERVICE_URL,encodeURIComponent(r),"interrupt"),n={method:"POST"},i=await bi.ServerConnection.makeRequest(t,n,e);if(i.status!==204)throw await bi.ServerConnection.ResponseError.create(i)}Sn.interruptKernel=Wye;async function Vye(r,e=bi.ServerConnection.makeSettings()){let t=II.URLExt.join(e.baseUrl,Sn.KERNEL_SERVICE_URL,encodeURIComponent(r)),n={method:"DELETE"},i=await bi.ServerConnection.makeRequest(t,n,e);if(i.status===404){let o=`The kernel "${r}" does not exist on the server`;console.warn(o)}else if(i.status!==204)throw await bi.ServerConnection.ResponseError.create(i)}Sn.shutdownKernel=Vye;async function jye(r,e=bi.ServerConnection.makeSettings()){let t=II.URLExt.join(e.baseUrl,Sn.KERNEL_SERVICE_URL,encodeURIComponent(r)),n=await bi.ServerConnection.makeRequest(t,{},e);if(n.status===404)return;if(n.status!==200)throw await bi.ServerConnection.ResponseError.create(n);let i=await n.json();return(0,R1.validateModel)(i),i}Sn.getKernelModel=jye});var yV=re((M1,F$)=>{p();(function(r,e){typeof M1=="object"&&typeof F$!="undefined"?e(M1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(M1,function(r){"use strict";r.ArrayExt=void 0,function(h){function y(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(A[me]===M)return me}return-1}h.firstIndexOf=y;function w(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(A[me]===M)return me}return-1}h.lastIndexOf=w;function T(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(M(A[me],me))return me}return-1}h.findFirstIndex=T;function H(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(M(A[me],me))return me}return-1}h.findLastIndex=H;function Y(A,M,I=0,S=-1){let _=T(A,M,I,S);return _!==-1?A[_]:void 0}h.findFirstValue=Y;function Z(A,M,I=-1,S=0){let _=H(A,M,I,S);return _!==-1?A[_]:void 0}h.findLastValue=Z;function ie(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function ce(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=ce;function be(A,M,I){if(A===M)return!0;if(A.length!==M.length)return!1;for(let S=0,_=A.length;S<_;++S)if(I?!I(A[S],M[S]):A[S]!==M[S])return!1;return!0}h.shallowEqual=be;function q(A,M={}){let{start:I,stop:S,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=A.length;I===void 0?I=_<0?F-1:0:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F),S===void 0?S=_<0?-1:F:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F);let j;_<0&&S>=I||_>0&&I>=S?j=0:_<0?j=Math.floor((S-I+1)/_+1):j=Math.floor((S-I-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=A[I+Fe*_];return me}h.slice=q;function $(A,M,I){let S=A.length;if(S<=1||(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1),M===I))return;let _=A[M],F=M<I?1:-1;for(let j=M;j!==I;j+=F)A[j]=A[j+F];A[I]=_}h.move=$;function de(A,M=0,I=-1){let S=A.length;if(!(S<=1))for(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1);M<I;){let _=A[M],F=A[I];A[M++]=F,A[I--]=_}}h.reverse=de;function pe(A,M,I=0,S=-1){let _=A.length;if(_<=1||(I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I>=S))return;let F=S-I+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=I+M;de(A,I,j-1),de(A,j,S),de(A,I,S)}h.rotate=pe;function ye(A,M,I=0,S=-1){let _=A.length;if(_===0)return;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j)A[(I+j)%_]=M}h.fill=ye;function z(A,M,I){let S=A.length;M<0?M=Math.max(0,M+S):M=Math.min(M,S);for(let _=S;_>M;--_)A[_]=A[_-1];A[M]=I}h.insert=z;function fe(A,M){let I=A.length;if(M<0&&(M+=I),M<0||M>=I)return;let S=A[M];for(let _=M+1;_<I;++_)A[_-1]=A[_];return A.length=I-1,S}h.removeAt=fe;function Se(A,M,I=0,S=-1){let _=y(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeFirstOf=Se;function Te(A,M,I=-1,S=0){let _=w(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeLastOf=Te;function Le(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&A[j]===M||S<I&&(j<=S||j>=I)&&A[j]===M?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllOf=Le;function $e(A,M,I=0,S=-1){let _,F=T(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeFirstWhere=$e;function Ge(A,M,I=-1,S=0){let _,F=H(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeLastWhere=Ge;function Bt(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&M(A[j],j)||S<I&&(j<=S||j>=I)&&M(A[j],j)?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let y of h)yield*y}function*t(){}function*n(h,y=0){for(let w of h)yield[y++,w]}function*i(h,y){let w=0;for(let T of h)y(T,w++)&&(yield T)}function o(h,y){let w=0;for(let T of h)if(y(T,w++))return T}function s(h,y){let w=0;for(let T of h)if(y(T,w++))return w-1;return-1}function a(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)<0&&(w=T)}return w}function l(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)>0&&(w=T)}return w}function u(h,y){let w=!0,T,H;for(let Y of h)w?(T=Y,H=Y,w=!1):y(Y,T)<0?T=Y:y(Y,H)>0&&(H=Y);return w?void 0:[T,H]}function c(h){return Array.from(h)}function d(h){let y={};for(let[w,T]of h)y[w]=T;return y}function f(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return}function m(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return!1;return!0}function g(h,y){let w=0;for(let T of h)if(y(T,w++))return!0;return!1}function*b(h,y){let w=0;for(let T of h)yield y(T,w++)}function*v(h,y,w){y===void 0?(y=h,h=0,w=1):w===void 0&&(w=1);let T=k.rangeLength(h,y,w);for(let H=0;H<T;H++)yield h+w*H}var k;(function(h){function y(w,T,H){return H===0?1/0:w>T&&H>0||w<T&&H<0?0:Math.ceil((T-w)/H)}h.rangeLength=y})(k||(k={}));function R(h,y,w){let T=h[Symbol.iterator](),H=0,Y=T.next();if(Y.done&&w===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return w;let Z=T.next();if(Z.done&&w===void 0)return Y.value;if(Z.done)return y(w,Y.value,H++);let ie;w===void 0?ie=y(Y.value,Z.value,H++):ie=y(y(w,Y.value,H++),Z.value,H++);let ce;for(;!(ce=T.next()).done;)ie=y(ie,ce.value,H++);return ie}function*P(h,y){for(;0<y--;)yield h}function*D(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let y=h.length-1;y>-1;y--)yield h[y]}function L(h){let y=[],w=new Set,T=new Map;for(let Z of h)H(Z);for(let[Z]of T)Y(Z);return y;function H(Z){let[ie,ce]=Z,be=T.get(ce);be?be.push(ie):T.set(ce,[ie])}function Y(Z){if(w.has(Z))return;w.add(Z);let ie=T.get(Z);if(ie)for(let ce of ie)Y(ce);y.push(Z)}}function*B(h,y){let w=0;for(let T of h)w++%y===0&&(yield T)}r.StringExt=void 0,function(h){function y(Z,ie,ce=0){let be=new Array(ie.length);for(let q=0,$=ce,de=ie.length;q<de;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=y;function w(Z,ie,ce=0){let be=y(Z,ie,ce);if(!be)return null;let q=0;for(let $=0,de=be.length;$<de;++$){let pe=be[$]-ce;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=w;function T(Z,ie,ce=0){let be=y(Z,ie,ce);if(!be)return null;let q=0,$=ce-1;for(let de=0,pe=be.length;de<pe;++de){let ye=be[de];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=T;function H(Z,ie,ce){let be=[],q=0,$=0,de=ie.length;for(;q<de;){let pe=ie[q],ye=ie[q];for(;++q<de&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(ce(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,y){if(y<1)return;let w=h[Symbol.iterator](),T;for(;0<y--&&!(T=w.next()).done;)yield T.value}function*O(...h){let y=h.map(T=>T[Symbol.iterator]()),w=y.map(T=>T.next());for(;m(w,T=>!T.done);w=y.map(T=>T.next()))yield w.map(T=>T.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=D,r.range=v,r.reduce=R,r.repeat=P,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var W$=re((O1,U$)=>{p();(function(r,e){typeof O1=="object"&&typeof U$!="undefined"?e(O1,yV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(O1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"}u.isPrimitive=c;function d(P){return Array.isArray(P)}u.isArray=d;function f(P){return!c(P)&&!d(P)}u.isObject=f;function m(P,D){if(P===D)return!0;if(c(P)||c(D))return!1;let K=d(P),L=d(D);return K!==L?!1:K&&L?b(P,D):v(P,D)}u.deepEqual=m;function g(P){return c(P)?P:d(P)?k(P):R(P)}u.deepCopy=g;function b(P,D){if(P===D)return!0;if(P.length!==D.length)return!1;for(let K=0,L=P.length;K<L;++K)if(!m(P[K],D[K]))return!1;return!0}function v(P,D){if(P===D)return!0;for(let K in P)if(P[K]!==void 0&&!(K in D))return!1;for(let K in D)if(D[K]!==void 0&&!(K in P))return!1;for(let K in P){let L=P[K],B=D[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function k(P){let D=new Array(P.length);for(let K=0,L=P.length;K<L;++K)D[K]=g(P[K]);return D}function R(P){let D={};for(let K in P){let L=P[K];L!==void 0&&(D[K]=g(L))}return D}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(v=>{let k=this._services.get(v);return k?this._plugins.get(k).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(v){var k,R,P,D;this._activated=!1,this._promise=null,this._service=null,this.id=v.id,this.description=(k=v.description)!==null&&k!==void 0?k:"",this.activate=v.activate,this.deactivate=(R=v.deactivate)!==null&&R!==void 0?R:null,this.provides=(P=v.provides)!==null&&P!==void 0?P:null,this.autoStart=(D=v.autoStart)!==null&&D!==void 0?D:!1,this.requires=v.requires?v.requires.slice():[],this.optional=v.optional?v.optional.slice():[]}get activated(){return this._activated}set activated(v){this._activated=v}get service(){return this._service}set service(v){this._service=v}get promise(){return this._promise}set promise(v){this._promise=v}}function d(b){return new c(b)}u.createPluginData=d;function f(b,v,k){let R=[...b.requires,...b.optional],P=K=>{if(K===b.provides)return!0;let L=k.get(K);if(!L)return!1;let B=v.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(D.push(L),N.some(P)?!0:(D.pop(),!1))};if(!b.provides||R.length===0)return;let D=[b.id];if(R.some(P))throw new ReferenceError(`Cycle detected: ${D.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,v,k){let R=new Array,P=N=>{let O=v.get(N),h=[...O.requires,...O.optional];R.push(...h.reduce((y,w)=>{let T=k.get(w);return T&&y.push([N,T]),y},[]))};for(let N of v.keys())P(N);let D=R.filter(N=>N[1]===b),K=0;for(;D.length>K;){let N=D.length,O=new Set(D.map(h=>h[0]));for(let h of O)R.filter(y=>y[1]===h).forEach(y=>{D.includes(y)||D.push(y)});K=N}let L=e.topologicSort(D),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,v){let k=new Set;for(let R of b.keys())b.get(R).autoStart===!0&&k.add(R);if(v.startPlugins)for(let R of v.startPlugins)k.add(R);if(v.ignorePlugins)for(let R of v.ignorePlugins)k.delete(R);return Array.from(k)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var j$=re((L1,V$)=>{p();(function(r,e){typeof L1=="object"&&typeof V$!="undefined"?e(L1,yV(),W$()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(L1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let y=g.get(N.sender);if(y||(y=[],g.set(N.sender,y)),R(y,N,O,h))return!1;let w=h||O,T=b.get(w);T||(T=[],b.set(w,T));let H={signal:N,slot:O,thisArg:h};return y.push(H),T.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let y=g.get(N.sender);if(!y||y.length===0)return!1;let w=R(y,N,O,h);if(!w)return!1;let T=h||O,H=b.get(T);return w.signal=null,D(y),D(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let y=b.get(O);if(!(!y||y.length===0)){for(let w of y)w.signal&&w.signal.sender===N&&(w.signal=null);D(h),D(y)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.thisArg||h.slot;h.signal=null,D(b.get(y))}D(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.signal.sender;h.signal=null,D(g.get(y))}D(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let y=0,w=h.length;y<w;++y){let T=h[y];T.signal===N&&P(T,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,v=new Set,k=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function R(N,O,h,y){return e.find(N,w=>w.signal===O&&w.slot===h&&w.thisArg===y)}function P(N,O){let{signal:h,slot:y,thisArg:w}=N;try{y.call(w,h.sender,O)}catch(T){s.exceptionHandler(T)}}function D(N){v.size===0&&k(K),v.add(N)}function K(){v.forEach(L),v.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var bV=re((K1,B$)=>{p();(function(r,e){typeof K1=="object"&&typeof B$!="undefined"?e(K1,j$()):typeof define=="function"&&define.amd?define(["exports","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_disposable={},r.lumino_signaling))})(K1,function(r,e){"use strict";class t{constructor(a){this._fn=a}get isDisposed(){return!this._fn}dispose(){if(!this._fn)return;let a=this._fn;this._fn=null,a()}}class n extends t{constructor(){super(...arguments),this._disposed=new e.Signal(this)}get disposed(){return this._disposed}dispose(){this.isDisposed||(super.dispose(),this._disposed.emit(void 0),e.Signal.clearData(this))}}class i{constructor(){this._isDisposed=!1,this._items=new Set}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._items.forEach(a=>{a.dispose()}),this._items.clear())}contains(a){return this._items.has(a)}add(a){this._items.add(a)}remove(a){this._items.delete(a)}clear(){this._items.clear()}}(function(s){function a(l){let u=new s;for(let c of l)u.add(c);return u}s.from=a})(i||(i={}));class o extends i{constructor(){super(...arguments),this._disposed=new e.Signal(this)}get disposed(){return this._disposed}dispose(){this.isDisposed||(super.dispose(),this._disposed.emit(void 0),e.Signal.clearData(this))}}(function(s){function a(l){let u=new s;for(let c of l)u.add(c);return u}s.from=a})(o||(o={})),r.DisposableDelegate=t,r.DisposableSet=i,r.ObservableDisposableDelegate=n,r.ObservableDisposableSet=o})});var H$=re(Yc=>{"use strict";p();var Bye=Yc&&Yc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Hye=Yc&&Yc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),qye=Yc&&Yc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Bye(e,r,t);return Hye(e,r),e};Object.defineProperty(Yc,"__esModule",{value:!0});Yc.CommHandler=void 0;var Jye=bV(),F1=qye(gI()),IV=class extends Jye.DisposableDelegate{constructor(e,t,n,i){super(i),this._target="",this._id="",this._id=t,this._target=e,this._kernel=n}get commId(){return this._id}get targetName(){return this._target}get onClose(){return this._onClose}set onClose(e){this._onClose=e}get onMsg(){return this._onMsg}set onMsg(e){this._onMsg=e}open(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot open");let i=F1.createMessage({msgType:"comm_open",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,target_name:this._target,data:e!=null?e:{}},metadata:t,buffers:n});return this._kernel.sendShellMessage(i,!1,!0)}send(e,t,n=[],i=!0){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot send");let o=F1.createMessage({msgType:"comm_msg",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e},metadata:t,buffers:n});return this._kernel.sendShellMessage(o,!1,i)}close(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot close");let i=F1.createMessage({msgType:"comm_close",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n}),o=this._kernel.sendShellMessage(i,!1,!0),s=this._onClose;if(s){let a=F1.createMessage({msgType:"comm_close",channel:"iopub",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n});s(a)}return this.dispose(),o}};Yc.CommHandler=IV});var J$=re(os=>{"use strict";p();var Gye=os&&os.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yye=os&&os.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$ye=os&&os.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Gye(e,r,t);return Yye(e,r),e};Object.defineProperty(os,"__esModule",{value:!0});os.KernelShellFutureHandler=os.KernelControlFutureHandler=os.KernelFutureHandler=void 0;var q$=jc(),zye=bV(),Qye=$ye(gI()),Dx=class extends zye.DisposableDelegate{constructor(e,t,n,i,o){super(e),this._status=0,this._stdin=Ri.noOp,this._iopub=Ri.noOp,this._reply=Ri.noOp,this._done=new q$.PromiseDelegate,this._hooks=new Ri.HookList,this._disposeOnDone=!0,this._msg=t,n||this._setFlag(Ri.KernelFutureFlag.GotReply),this._disposeOnDone=i,this._kernel=o}get msg(){return this._msg}get done(){return this._done.promise}get onReply(){return this._reply}set onReply(e){this._reply=e}get onIOPub(){return this._iopub}set onIOPub(e){this._iopub=e}get onStdin(){return this._stdin}set onStdin(e){this._stdin=e}registerMessageHook(e){if(this.isDisposed)throw new Error("Kernel future is disposed");this._hooks.add(e)}removeMessageHook(e){this.isDisposed||this._hooks.remove(e)}sendInputReply(e,t){this._kernel.sendInputReply(e,t)}dispose(){this._stdin=Ri.noOp,this._iopub=Ri.noOp,this._reply=Ri.noOp,this._hooks=null,this._testFlag(Ri.KernelFutureFlag.IsDone)||(this._done.promise.catch(()=>{}),this._done.reject(new Error(`Canceled future for ${this.msg.header.msg_type} message before replies were done`))),super.dispose()}async handleMsg(e){switch(e.channel){case"control":case"shell":e.channel===this.msg.channel&&e.parent_header.msg_id===this.msg.header.msg_id&&await this._handleReply(e);break;case"stdin":await this._handleStdin(e);break;case"iopub":await this._handleIOPub(e);break;default:break}}async _handleReply(e){let t=this._reply;t&&await t(e),this._replyMsg=e,this._setFlag(Ri.KernelFutureFlag.GotReply),this._testFlag(Ri.KernelFutureFlag.GotIdle)&&this._handleDone()}async _handleStdin(e){this._kernel.hasPendingInput=!0;let t=this._stdin;t&&await t(e)}async _handleIOPub(e){let t=await this._hooks.process(e),n=this._iopub;t&&n&&await n(e),Qye.isStatusMsg(e)&&e.content.execution_state==="idle"&&(this._setFlag(Ri.KernelFutureFlag.GotIdle),this._testFlag(Ri.KernelFutureFlag.GotReply)&&this._handleDone())}_handleDone(){this._testFlag(Ri.KernelFutureFlag.IsDone)||(this._setFlag(Ri.KernelFutureFlag.IsDone),this._done.resolve(this._replyMsg),this._disposeOnDone&&this.dispose())}_testFlag(e){return(this._status&e)!==0}_setFlag(e){this._status|=e}};os.KernelFutureHandler=Dx;var SV=class extends Dx{};os.KernelControlFutureHandler=SV;var _V=class extends Dx{};os.KernelShellFutureHandler=_V;var Ri;(function(r){r.noOp=()=>{};let e=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();class t{constructor(){this._hooks=[]}add(o){this.remove(o),this._hooks.push(o)}remove(o){let s=this._hooks.indexOf(o);s>=0&&(this._hooks[s]=null,this._scheduleCompact())}async process(o){await this._processing;let s=new q$.PromiseDelegate;this._processing=s.promise;let a;for(let l=this._hooks.length-1;l>=0;l--){let u=this._hooks[l];if(u!==null){try{a=await u(o)}catch(c){a=!0,console.error(c)}if(a===!1)return s.resolve(void 0),!1}}return s.resolve(void 0),!0}_scheduleCompact(){this._compactScheduled||(this._compactScheduled=!0,e(()=>{this._processing=this._processing.then(()=>{this._compactScheduled=!1,this._compact()})}))}_compact(){let o=0;for(let s=0,a=this._hooks.length;s<a;s++){let l=this._hooks[s];this._hooks[s]===null?o++:this._hooks[s-o]=l}this._hooks.length-=o}}r.HookList=t;let n;(function(i){i[i.GotReply=1]="GotReply",i[i.GotIdle=2]="GotIdle",i[i.IsDone=4]="IsDone",i[i.DisposeOnDone=8]="DisposeOnDone"})(n=r.KernelFutureFlag||(r.KernelFutureFlag={}))})(Ri||(Ri={}))});var Y$=re(G$=>{"use strict";p();Object.defineProperty(G$,"__esModule",{value:!0})});var z$=re(SI=>{"use strict";p();Object.defineProperty(SI,"__esModule",{value:!0});SI.validateSpecModels=SI.validateSpecModel=void 0;var Vg=Px();function $$(r){let e=r.spec;if(!e)throw new Error("Invalid kernel spec");(0,Vg.validateProperty)(r,"name","string"),(0,Vg.validateProperty)(r,"resources","object"),(0,Vg.validateProperty)(e,"language","string"),(0,Vg.validateProperty)(e,"display_name","string"),(0,Vg.validateProperty)(e,"argv","array");let t=null;e.hasOwnProperty("metadata")&&((0,Vg.validateProperty)(e,"metadata","object"),t=e.metadata);let n=null;return e.hasOwnProperty("env")&&((0,Vg.validateProperty)(e,"env","object"),n=e.env),{name:r.name,resources:r.resources,language:e.language,display_name:e.display_name,argv:e.argv,metadata:t,env:n}}SI.validateSpecModel=$$;function Xye(r){if(!r.hasOwnProperty("kernelspecs"))throw new Error("No kernelspecs found");let e=Object.keys(r.kernelspecs),t=Object.create(null),n=r.default;for(let i=0;i<e.length;i++){let o=r.kernelspecs[e[i]];try{t[e[i]]=$$(o)}catch(s){console.warn(`Removing errant kernel spec: ${e[i]}`)}}if(e=Object.keys(t),!e.length)throw new Error("No valid kernelspecs found");return(!n||typeof n!="string"||!(n in t))&&(n=e[0],console.warn(`Default kernel not found, using '${e[0]}'`)),{default:n,kernelspecs:t}}SI.validateSpecModels=Xye});var CV=re(U1=>{"use strict";p();Object.defineProperty(U1,"__esModule",{value:!0});U1.getSpecs=void 0;var EV=Do(),Zye=z$(),ebe=to(),tbe="api/kernelspecs";async function rbe(r=EV.ServerConnection.makeSettings()){let e=ebe.URLExt.join(r.baseUrl,tbe),t=await EV.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await EV.ServerConnection.ResponseError.create(t);let n=await t.json();return(0,Zye.validateSpecModels)(n)}U1.getSpecs=rbe});var X$=re($c=>{"use strict";p();var nbe=$c&&$c.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ibe=$c&&$c.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),obe=$c&&$c.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&nbe(e,r,t);return ibe(e,r),e};Object.defineProperty($c,"__esModule",{value:!0});$c.KernelSpecManager=void 0;var sbe=jc(),abe=Ug(),Q$=As(),lbe=obe(CV()),cbe=Fg(),wV=class extends cbe.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._connectionFailure=new Q$.Signal(this),this._specs=null,this._specsChanged=new Q$.Signal(this),this._ready=Promise.all([this.requestSpecs()]).then(n=>{}).catch(n=>{}).then(()=>{this.isDisposed||(this._isReady=!0)}),this._pollSpecs=new abe.Poll({auto:!1,factory:()=>this.requestSpecs(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelSpecManager#specs",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get specs(){return this._specs}get specsChanged(){return this._specsChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshSpecs(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestSpecs(){let e=await lbe.getSpecs(this.serverSettings);this.isDisposed||sbe.JSONExt.deepEqual(e,this._specs)||(this._specs=e,this._specsChanged.emit(e))}};$c.KernelSpecManager=wV});var W1=re(To=>{"use strict";p();var Z$=To&&To.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ube=To&&To.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),ez=To&&To.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Z$(e,r,t);return ube(e,r),e},dbe=To&&To.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Z$(e,r,t)};Object.defineProperty(To,"__esModule",{value:!0});To.KernelSpecAPI=To.KernelSpec=void 0;var pbe=ez(Y$());To.KernelSpec=pbe;var fbe=ez(CV());To.KernelSpecAPI=fbe;dbe(X$(),To)});var DV=re(zc=>{"use strict";p();var mbe=zc&&zc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),hbe=zc&&zc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),PV=zc&&zc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&mbe(e,r,t);return hbe(e,r),e};Object.defineProperty(zc,"__esModule",{value:!0});zc.KernelConnection=void 0;var tz=to(),Wf=jc(),Vf=As(),rz=Jn(),nz=H$(),ss=PV(gI()),iz=J$(),gbe=PV(N1()),vbe=W1(),Tx=PV(A1()),ybe=3e3,_I="_RESTARTING_",bbe="",xV=class r{constructor(e){var t,n,i,o;this._createSocket=(s=!0)=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let a=this.serverSettings,l=tz.URLExt.join(a.wsUrl,Tx.KERNEL_SERVICE_URL,encodeURIComponent(this._id)),u=l.replace(/^((?:\w+:)?\/\/)(?:[^@\/]+@)/,"$1"),c=tz.URLExt.join(l,"channels?session_id="+encodeURIComponent(this._clientId)),d=a.token;a.appendToken&&d!==""&&(c=c+`&token=${encodeURIComponent(d)}`);let f=s?this._supportedProtocols:[];this._ws=new a.WebSocket(c,f),this._ws.binaryType="arraybuffer";let m=!1,g=async v=>{var k,R;if(!this._isDisposed){this._reason="",this._model=void 0;try{let P=await Tx.getKernelModel(this._id,a);this._model=P,(P==null?void 0:P.execution_state)==="dead"?this._updateStatus("dead"):this._onWSClose(v)}catch(P){if(P instanceof rz.ServerConnection.NetworkError||((k=P.response)===null||k===void 0?void 0:k.status)===503||((R=P.response)===null||R===void 0?void 0:R.status)===424){let D=xa.getRandomIntInclusive(10,30)*1e3;setTimeout(g,D,v)}else this._reason="Kernel died unexpectedly",this._updateStatus("dead")}}},b=async v=>{m||(m=!0,await g(v))};this._ws.onmessage=this._onWSMessage,this._ws.onopen=this._onWSOpen,this._ws.onclose=b,this._ws.onerror=b},this._onWSOpen=s=>{if(this._ws.protocol!==""&&!this._supportedProtocols.includes(this._ws.protocol))throw console.log("Server selected unknown kernel wire protocol:",this._ws.protocol),this._updateStatus("dead"),new Error(`Unknown kernel wire protocol:  ${this._ws.protocol}`);this._selectedProtocol=this._ws.protocol,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose,this._updateConnectionStatus("connected")},this._onWSMessage=s=>{let a;try{a=this.serverSettings.serializer.deserialize(s.data,this._ws.protocol),gbe.validateMessage(a)}catch(l){throw l.message=`Kernel message validation error: ${l.message}`,l}this._kernelSession=a.header.session,this._msgChain=this._msgChain.then(()=>this._handleMessage(a)).catch(l=>{l.message.startsWith("Canceled future for ")&&console.error(l)}),this._anyMessage.emit({msg:a,direction:"recv"})},this._onWSClose=s=>{this.isDisposed||this._reconnect()},this._id="",this._name="",this._status="unknown",this._connectionStatus="connecting",this._kernelSession="",this._isDisposed=!1,this._ws=null,this._username="",this._reconnectLimit=7,this._reconnectAttempt=0,this._reconnectTimeout=null,this._supportedProtocols=Object.values(ss.supportedKernelWebSocketProtocols),this._selectedProtocol="",this._futures=new Map,this._comms=new Map,this._targetRegistry=Object.create(null),this._info=new Wf.PromiseDelegate,this._pendingMessages=[],this._statusChanged=new Vf.Signal(this),this._connectionStatusChanged=new Vf.Signal(this),this._disposed=new Vf.Signal(this),this._iopubMessage=new Vf.Signal(this),this._anyMessage=new Vf.Signal(this),this._pendingInput=new Vf.Signal(this),this._unhandledMessage=new Vf.Signal(this),this._displayIdToParentIds=new Map,this._msgIdToDisplayIds=new Map,this._msgChain=Promise.resolve(),this._hasPendingInput=!1,this._reason="",this._noOp=()=>{},this._name=e.model.name,this._id=e.model.id,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:rz.ServerConnection.makeSettings(),this._clientId=(n=e.clientId)!==null&&n!==void 0?n:Wf.UUID.uuid4(),this._username=(i=e.username)!==null&&i!==void 0?i:"",this.handleComms=(o=e.handleComms)!==null&&o!==void 0?o:!0,this._createSocket()}get disposed(){return this._disposed}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get model(){return this._model||{id:this.id,name:this.name,reason:this._reason}}get anyMessage(){return this._anyMessage}get pendingInput(){return this._pendingInput}get id(){return this._id}get name(){return this._name}get username(){return this._username}get clientId(){return this._clientId}get status(){return this._status}get connectionStatus(){return this._connectionStatus}get isDisposed(){return this._isDisposed}get info(){return this._info.promise}get spec(){return this._specPromise?this._specPromise:(this._specPromise=vbe.KernelSpecAPI.getSpecs(this.serverSettings).then(e=>e.kernelspecs[this._name]),this._specPromise)}clone(e={}){return new r({model:this.model,username:this.username,serverSettings:this.serverSettings,handleComms:!1,...e})}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearKernelState(),this._pendingMessages=[],this._clearSocket(),Vf.Signal.clearData(this))}sendShellMessage(e,t=!1,n=!0){return this._sendKernelShellControl(iz.KernelShellFutureHandler,e,t,n)}sendControlMessage(e,t=!1,n=!0){return this._sendKernelShellControl(iz.KernelControlFutureHandler,e,t,n)}_sendKernelShellControl(e,t,n=!1,i=!0){this._sendMessage(t),this._anyMessage.emit({msg:t,direction:"send"});let o=new e(()=>{let s=t.header.msg_id;this._futures.delete(s);let a=this._msgIdToDisplayIds.get(s);a&&(a.forEach(l=>{let u=this._displayIdToParentIds.get(l);if(u){let c=u.indexOf(s);if(c===-1)return;u.length===1?this._displayIdToParentIds.delete(l):(u.splice(c,1),this._displayIdToParentIds.set(l,u))}}),this._msgIdToDisplayIds.delete(s))},t,n,i,this);return this._futures.set(t.header.msg_id,o),o}_sendMessage(e,t=!0){if(this.status==="dead")throw new Error("Kernel is dead");if((this._kernelSession===bbe||this._kernelSession===_I)&&ss.isInfoRequestMsg(e))if(this.connectionStatus==="connected"){this._ws.send(this.serverSettings.serializer.serialize(e,this._ws.protocol));return}else throw new Error("Could not send message: status is not connected");if(t&&this._pendingMessages.length>0){this._pendingMessages.push(e);return}if(this.connectionStatus==="connected"&&this._kernelSession!==_I)this._ws.send(this.serverSettings.serializer.serialize(e,this._ws.protocol));else if(t)this._pendingMessages.push(e);else throw new Error("Could not send message")}async interrupt(){if(this.hasPendingInput=!1,this.status==="dead")throw new Error("Kernel is dead");return Tx.interruptKernel(this.id,this.serverSettings)}async restart(){if(this.status==="dead")throw new Error("Kernel is dead");this._updateStatus("restarting"),this._clearKernelState(),this._kernelSession=_I,await Tx.restartKernel(this.id,this.serverSettings),await this.reconnect(),this.hasPendingInput=!1}reconnect(){this._errorIfDisposed();let e=new Wf.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Kernel connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}async shutdown(){this.status!=="dead"&&await Tx.shutdownKernel(this.id,this.serverSettings),this.handleShutdown()}handleShutdown(){this._updateStatus("dead"),this.dispose()}async requestKernelInfo(){let e=ss.createMessage({msgType:"kernel_info_request",channel:"shell",username:this._username,session:this._clientId,content:{}}),t;try{t=await xa.handleShellMessage(this,e)}catch(n){if(this.isDisposed)return;throw n}if(this._errorIfDisposed(),!!t)return t.content.status===void 0&&(t.content.status="ok"),t.content.status!=="ok"?(this._info.reject("Kernel info reply errored"),t):(this._info.resolve(t.content),this._kernelSession=t.header.session,t)}requestComplete(e){let t=ss.createMessage({msgType:"complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestInspect(e){let t=ss.createMessage({msgType:"inspect_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestHistory(e){let t=ss.createMessage({msgType:"history_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestExecute(e,t=!0,n){let i={silent:!1,store_history:!0,user_expressions:{},allow_stdin:!0,stop_on_error:!1},o=ss.createMessage({msgType:"execute_request",channel:"shell",username:this._username,session:this._clientId,content:{...i,...e},metadata:n});return this.sendShellMessage(o,!0,t)}requestDebug(e,t=!0){let n=ss.createMessage({msgType:"debug_request",channel:"control",username:this._username,session:this._clientId,content:e});return this.sendControlMessage(n,!0,t)}requestIsComplete(e){let t=ss.createMessage({msgType:"is_complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestCommInfo(e){let t=ss.createMessage({msgType:"comm_info_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}sendInputReply(e,t){let n=ss.createMessage({msgType:"input_reply",channel:"stdin",username:this._username,session:this._clientId,content:e});n.parent_header=t,this._sendMessage(n),this._anyMessage.emit({msg:n,direction:"send"}),this.hasPendingInput=!1}createComm(e,t=Wf.UUID.uuid4()){if(!this.handleComms)throw new Error("Comms are disabled on this kernel connection");if(this._comms.has(t))throw new Error("Comm is already created");let n=new nz.CommHandler(e,t,this,()=>{this._unregisterComm(t)});return this._comms.set(t,n),n}hasComm(e){return this._comms.has(e)}registerCommTarget(e,t){this.handleComms&&(this._targetRegistry[e]=t)}removeCommTarget(e,t){this.handleComms&&!this.isDisposed&&this._targetRegistry[e]===t&&delete this._targetRegistry[e]}registerMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.registerMessageHook(t)}removeMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.removeMessageHook(t)}removeInputGuard(){this.hasPendingInput=!1}async _handleDisplayId(e,t){var n,i;let o=t.parent_header.msg_id,s=this._displayIdToParentIds.get(e);if(s){let l={header:Wf.JSONExt.deepCopy(t.header),parent_header:Wf.JSONExt.deepCopy(t.parent_header),metadata:Wf.JSONExt.deepCopy(t.metadata),content:Wf.JSONExt.deepCopy(t.content),channel:t.channel,buffers:t.buffers?t.buffers.slice():[]};l.header.msg_type="update_display_data",await Promise.all(s.map(async u=>{let c=this._futures&&this._futures.get(u);c&&await c.handleMsg(l)}))}if(t.header.msg_type==="update_display_data")return!0;s=(n=this._displayIdToParentIds.get(e))!==null&&n!==void 0?n:[],s.indexOf(o)===-1&&s.push(o),this._displayIdToParentIds.set(e,s);let a=(i=this._msgIdToDisplayIds.get(o))!==null&&i!==void 0?i:[];return a.indexOf(o)===-1&&a.push(o),this._msgIdToDisplayIds.set(o,a),!1}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}_updateStatus(e){this._status===e||this._status==="dead"||(this._status=e,xa.logKernelStatus(this),this._statusChanged.emit(e),e==="dead"&&this.dispose())}_sendPending(){for(;this.connectionStatus==="connected"&&this._kernelSession!==_I&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}_clearKernelState(){this._kernelSession="",this._pendingMessages=[],this._futures.forEach(e=>{e.dispose()}),this._comms.forEach(e=>{e.dispose()}),this._msgChain=Promise.resolve(),this._futures=new Map,this._comms=new Map,this._displayIdToParentIds.clear(),this._msgIdToDisplayIds.clear()}_assertCurrentMessage(e){if(this._errorIfDisposed(),e.header.session!==this._kernelSession)throw new Error(`Canceling handling of old message: ${e.header.msg_type}`)}async _handleCommOpen(e){this._assertCurrentMessage(e);let t=e.content,n=new nz.CommHandler(t.target_name,t.comm_id,this,()=>{this._unregisterComm(t.comm_id)});this._comms.set(t.comm_id,n);try{await(await xa.loadObject(t.target_name,t.target_module,this._targetRegistry))(n,e)}catch(i){throw n.close(),console.error("Exception opening new comm"),i}}async _handleCommClose(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n){console.error("Comm not found for comm id "+t.comm_id);return}this._unregisterComm(n.commId);let i=n.onClose;i&&await i(e),n.dispose()}async _handleCommMsg(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n)return;let i=n.onMsg;i&&await i(e)}_unregisterComm(e){this._comms.delete(e)}_updateConnectionStatus(e){if(this._connectionStatus!==e){if(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),this.status!=="dead")if(e==="connected"){let t=this._kernelSession===_I,n=this.requestKernelInfo(),i=!1,o=()=>{i||(i=!0,t&&this._kernelSession===_I&&(this._kernelSession=""),clearTimeout(s),this._pendingMessages.length>0&&this._sendPending())};n.then(o);let s=setTimeout(o,ybe)}else this._updateStatus("unknown");this._connectionStatusChanged.emit(e)}}async _handleMessage(e){var t,n;let i=!1;if(e.parent_header&&e.channel==="iopub"&&(ss.isDisplayDataMsg(e)||ss.isUpdateDisplayDataMsg(e)||ss.isExecuteResultMsg(e))){let s=((t=e.content.transient)!==null&&t!==void 0?t:{}).display_id;s&&(i=await this._handleDisplayId(s,e),this._assertCurrentMessage(e))}if(!i&&e.parent_header){let o=e.parent_header,s=(n=this._futures)===null||n===void 0?void 0:n.get(o.msg_id);if(s)await s.handleMsg(e),this._assertCurrentMessage(e);else{let a=o.session===this.clientId;e.channel!=="iopub"&&a&&this._unhandledMessage.emit(e)}}if(e.channel==="iopub"){switch(e.header.msg_type){case"status":{let o=e.content.execution_state;o==="restarting"&&Promise.resolve().then(async()=>{this._updateStatus("autorestarting"),this._clearKernelState(),await this.reconnect()}),this._updateStatus(o);break}case"comm_open":this.handleComms&&await this._handleCommOpen(e);break;case"comm_msg":this.handleComms&&await this._handleCommMsg(e);break;case"comm_close":this.handleComms&&await this._handleCommClose(e);break;default:break}this.isDisposed||(this._assertCurrentMessage(e),this._iopubMessage.emit(e))}}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=xa.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.warn(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`);let t=this._selectedProtocol!=="";this._reconnectTimeout=setTimeout(this._createSocket,e,t),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_errorIfDisposed(){if(this.isDisposed)throw new Error("Kernel connection is disposed")}get hasPendingInput(){return this._hasPendingInput}set hasPendingInput(e){this._hasPendingInput=e,this._pendingInput.emit(e)}};zc.KernelConnection=xV;var xa;(function(r){function e(o){switch(o.status){case"idle":case"busy":case"unknown":return;default:console.debug(`Kernel: ${o.status} (${o.id})`);break}}r.logKernelStatus=e;async function t(o,s){return o.sendShellMessage(s,!0).done}r.handleShellMessage=t;function n(o,s,a){return new Promise((l,u)=>{if(s){if(typeof requirejs=="undefined")throw new Error("requirejs not found");requirejs([s],c=>{if(c[o]===void 0){let d=`Object '${o}' not found in module '${s}'`;u(new Error(d))}else l(c[o])},u)}else a!=null&&a[o]?l(a[o]):u(new Error(`Object '${o}' not found in registry`))})}r.loadObject=n;function i(o,s){return o=Math.ceil(o),s=Math.floor(s),Math.floor(Math.random()*(s-o+1))+o}r.getRandomIntInclusive=i})(xa||(xa={}))});var sz=re(Nx=>{"use strict";p();Object.defineProperty(Nx,"__esModule",{value:!0});Nx.KernelManager=void 0;var Ibe=Ug(),oz=As(),Sbe=Jn(),_be=Fg(),V1=A1(),Ebe=DV(),kx=class extends _be.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._kernelConnections=new Set,this._models=new Map,this._runningChanged=new oz.Signal(this),this._connectionFailure=new oz.Signal(this),this._pollModels=new Ibe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._kernelConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){var t;let{id:n}=e.model,i=(t=e.handleComms)!==null&&t!==void 0?t:!0;if(e.handleComms===void 0){for(let s of this._kernelConnections)if(s.id===n&&s.handleComms){i=!1;break}}let o=new Ebe.KernelConnection({handleComms:i,...e,serverSettings:this.serverSettings});return this._onStarted(o),this._models.has(n)||this.refreshRunning().catch(()=>{}),o}running(){return this._models.values()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e={},t={}){let n=await(0,V1.startNew)(e,this.serverSettings);return this.connectTo({...t,model:n})}async shutdown(e){await(0,V1.shutdownKernel)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>(0,V1.shutdownKernel)(e,this.serverSettings))),await this.refreshRunning()}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async requestRunning(){var e,t;let n;try{n=await(0,V1.listRunning)(this.serverSettings)}catch(i){throw(i instanceof Sbe.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&n.every(i=>{let o=this._models.get(i.id);return o?o.connections===i.connections&&o.execution_state===i.execution_state&&o.last_activity===i.last_activity&&o.name===i.name&&o.reason===i.reason&&o.traceback===i.traceback:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._kernelConnections.forEach(i=>{this._models.has(i.id)||i.handleShutdown()}),this._runningChanged.emit(n))}_onStarted(e){this._kernelConnections.add(e),e.statusChanged.connect(this._onStatusChanged,this),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._kernelConnections.delete(e),this.refreshRunning().catch(()=>{})}_onStatusChanged(e,t){t==="dead"&&this.refreshRunning().catch(()=>{})}};Nx.KernelManager=kx;(function(r){class e extends r{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}async startNew(n={},i={}){return Promise.reject(new Error("Not implemented in no-op Kernel Manager"))}connectTo(n){throw new Error("Not implemented in no-op Kernel Manager")}async shutdown(n){return Promise.reject(new Error("Not implemented in no-op Kernel Manager"))}get ready(){return this.parentReady.then(()=>this._readyPromise)}async requestRunning(){return Promise.resolve()}}r.NoopManager=e})(kx||(Nx.KernelManager=kx={}))});var kV=re(ri=>{"use strict";p();var az=ri&&ri.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Cbe=ri&&ri.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),TV=ri&&ri.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&az(e,r,t);return Cbe(e,r),e},wbe=ri&&ri.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&az(e,r,t)};Object.defineProperty(ri,"__esModule",{value:!0});ri.KernelConnection=ri.KernelAPI=ri.KernelMessage=ri.Kernel=void 0;var xbe=TV(O$());ri.Kernel=xbe;var Pbe=TV(gI());ri.KernelMessage=Pbe;var Dbe=TV(A1());ri.KernelAPI=Dbe;var Tbe=DV();Object.defineProperty(ri,"KernelConnection",{enumerable:!0,get:function(){return Tbe.KernelConnection}});wbe(sz(),ri)});var lz=re(j1=>{"use strict";p();Object.defineProperty(j1,"__esModule",{value:!0});j1.BuildManager=void 0;var NV=to(),jf=Do(),kbe="api/build",RV=class{constructor(e={}){var t;this._url="",this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:jf.ServerConnection.makeSettings();let{baseUrl:n,appUrl:i}=this.serverSettings;this._url=NV.URLExt.join(n,i,kbe)}get isAvailable(){return NV.PageConfig.getOption("buildAvailable").toLowerCase()==="true"}get shouldCheck(){return NV.PageConfig.getOption("buildCheck").toLowerCase()==="true"}getStatus(){let{_url:e,serverSettings:t}=this;return jf.ServerConnection.makeRequest(e,{},t).then(i=>{if(i.status!==200)throw new jf.ServerConnection.ResponseError(i);return i.json()}).then(i=>{if(typeof i.status!="string")throw new Error("Invalid data");if(typeof i.message!="string")throw new Error("Invalid data");return i})}build(){let{_url:e,serverSettings:t}=this,n={method:"POST"};return jf.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status===400)throw new jf.ServerConnection.ResponseError(o,"Build aborted");if(o.status!==200){let s=`Build failed with ${o.status}.

        If you are experiencing the build failure after installing an extension (or trying to include previously installed extension after updating JupyterLab) please check the extension repository for new installation instructions as many extensions migrated to the prebuilt extensions system which no longer requires rebuilding JupyterLab (but uses a different installation procedure, typically involving a package manager such as 'pip' or 'conda').

        If you specifically intended to install a source extension, please run 'jupyter lab build' on the server for full output.`;throw new jf.ServerConnection.ResponseError(o,s)}})}cancel(){let{_url:e,serverSettings:t}=this,n={method:"DELETE"};return jf.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status!==204)throw new jf.ServerConnection.ResponseError(o)})}};j1.BuildManager=RV});var OV=re(B1=>{"use strict";p();Object.defineProperty(B1,"__esModule",{value:!0});B1.NbConvertManager=void 0;var Nbe=to(),AV=Do(),Rbe=jc(),Abe="api/nbconvert",MV=class{constructor(e={}){var t;this._exportFormats=null,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:AV.ServerConnection.makeSettings()}async fetchExportFormats(){this._requestingFormats=new Rbe.PromiseDelegate,this._exportFormats=null;let e=this.serverSettings.baseUrl,t=Nbe.URLExt.join(e,Abe),{serverSettings:n}=this,i=await AV.ServerConnection.makeRequest(t,{},n);if(i.status!==200)throw await AV.ServerConnection.ResponseError.create(i);let o=await i.json(),s={};return Object.keys(o).forEach(function(l){let u=o[l].output_mimetype;s[l]={output_mimetype:u}}),this._exportFormats=s,this._requestingFormats.resolve(s),s}async getExportFormats(e=!0){return this._requestingFormats?this._requestingFormats.promise:e||!this._exportFormats?await this.fetchExportFormats():this._exportFormats}};B1.NbConvertManager=MV});var uz=re(cz=>{"use strict";p();Object.defineProperty(cz,"__esModule",{value:!0})});var pz=re(Bf=>{"use strict";p();Object.defineProperty(Bf,"__esModule",{value:!0});Bf.validateModels=Bf.updateLegacySessionModel=Bf.validateModel=void 0;var Mbe=N1(),Rx=Px();function dz(r){(0,Rx.validateProperty)(r,"id","string"),(0,Rx.validateProperty)(r,"type","string"),(0,Rx.validateProperty)(r,"name","string"),(0,Rx.validateProperty)(r,"path","string"),(0,Rx.validateProperty)(r,"kernel","object"),(0,Mbe.validateModel)(r.kernel)}Bf.validateModel=dz;function Obe(r){r.path===void 0&&r.notebook!==void 0&&(r.path=r.notebook.path,r.type="notebook",r.name="")}Bf.updateLegacySessionModel=Obe;function Lbe(r){if(!Array.isArray(r))throw new Error("Invalid session list");r.forEach(e=>dz(e))}Bf.validateModels=Lbe});var J1=re(ni=>{"use strict";p();Object.defineProperty(ni,"__esModule",{value:!0});ni.updateSession=ni.startSession=ni.getSessionModel=ni.shutdownSession=ni.getSessionUrl=ni.listRunning=ni.SESSION_SERVICE_URL=void 0;var ro=Do(),H1=to(),Hf=pz();ni.SESSION_SERVICE_URL="api/sessions";async function Kbe(r=ro.ServerConnection.makeSettings()){let e=H1.URLExt.join(r.baseUrl,ni.SESSION_SERVICE_URL),t=await ro.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await ro.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid Session list");return n.forEach(i=>{(0,Hf.updateLegacySessionModel)(i),(0,Hf.validateModel)(i)}),n}ni.listRunning=Kbe;function q1(r,e){let t=H1.URLExt.join(r,ni.SESSION_SERVICE_URL),n=H1.URLExt.join(t,e);if(!n.startsWith(t))throw new Error("Can only be used for services requests");return n}ni.getSessionUrl=q1;async function Fbe(r,e=ro.ServerConnection.makeSettings()){var t;let n=q1(e.baseUrl,r),i={method:"DELETE"},o=await ro.ServerConnection.makeRequest(n,i,e);if(o.status===404){let a=(t=(await o.json()).message)!==null&&t!==void 0?t:`The session "${r}"" does not exist on the server`;console.warn(a)}else{if(o.status===410)throw new ro.ServerConnection.ResponseError(o,"The kernel was deleted but the session was not");if(o.status!==204)throw await ro.ServerConnection.ResponseError.create(o)}}ni.shutdownSession=Fbe;async function Ube(r,e=ro.ServerConnection.makeSettings()){let t=q1(e.baseUrl,r),n=await ro.ServerConnection.makeRequest(t,{},e);if(n.status!==200)throw await ro.ServerConnection.ResponseError.create(n);let i=await n.json();return(0,Hf.updateLegacySessionModel)(i),(0,Hf.validateModel)(i),i}ni.getSessionModel=Ube;async function Wbe(r,e=ro.ServerConnection.makeSettings()){let t=H1.URLExt.join(e.baseUrl,ni.SESSION_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await ro.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await ro.ServerConnection.ResponseError.create(i);let o=await i.json();return(0,Hf.updateLegacySessionModel)(o),(0,Hf.validateModel)(o),o}ni.startSession=Wbe;async function Vbe(r,e=ro.ServerConnection.makeSettings()){let t=q1(e.baseUrl,r.id),n={method:"PATCH",body:JSON.stringify(r)},i=await ro.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await ro.ServerConnection.ResponseError.create(i);let o=await i.json();return(0,Hf.updateLegacySessionModel)(o),(0,Hf.validateModel)(o),o}ni.updateSession=Vbe});var mz=re(G1=>{"use strict";p();Object.defineProperty(G1,"__esModule",{value:!0});G1.SessionConnection=void 0;var Qc=As(),jbe=Jn(),fz=J1(),Bbe=jc(),LV=class{constructor(e){var t,n,i,o;this._id="",this._path="",this._name="",this._type="",this._kernel=null,this._isDisposed=!1,this._disposed=new Qc.Signal(this),this._kernelChanged=new Qc.Signal(this),this._statusChanged=new Qc.Signal(this),this._connectionStatusChanged=new Qc.Signal(this),this._pendingInput=new Qc.Signal(this),this._iopubMessage=new Qc.Signal(this),this._unhandledMessage=new Qc.Signal(this),this._anyMessage=new Qc.Signal(this),this._propertyChanged=new Qc.Signal(this),this._id=e.model.id,this._name=e.model.name,this._path=e.model.path,this._type=e.model.type,this._username=(t=e.username)!==null&&t!==void 0?t:"",this._clientId=(n=e.clientId)!==null&&n!==void 0?n:Bbe.UUID.uuid4(),this._connectToKernel=e.connectToKernel,this._kernelConnectionOptions=(i=e.kernelConnectionOptions)!==null&&i!==void 0?i:{},this.serverSettings=(o=e.serverSettings)!==null&&o!==void 0?o:jbe.ServerConnection.makeSettings(),this.setupKernel(e.model.kernel)}get disposed(){return this._disposed}get kernelChanged(){return this._kernelChanged}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get pendingInput(){return this._pendingInput}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get anyMessage(){return this._anyMessage}get propertyChanged(){return this._propertyChanged}get id(){return this._id}get kernel(){return this._kernel}get path(){return this._path}get type(){return this._type}get name(){return this._name}get model(){return{id:this.id,kernel:this.kernel&&{id:this.kernel.id,name:this.kernel.name},path:this._path,type:this._type,name:this._name}}get isDisposed(){return this._isDisposed}update(e){let t=this.model;if(this._path=e.path,this._name=e.name,this._type=e.type,this._kernel===null&&e.kernel!==null||this._kernel!==null&&e.kernel===null||this._kernel!==null&&e.kernel!==null&&this._kernel.id!==e.kernel.id){this._kernel!==null&&this._kernel.dispose();let n=this._kernel||null;this.setupKernel(e.kernel);let i=this._kernel||null;this._kernelChanged.emit({name:"kernel",oldValue:n,newValue:i})}this._handleModelChange(t)}dispose(){if(!this.isDisposed){if(this._isDisposed=!0,this._disposed.emit(),this._kernel){this._kernel.dispose();let e=this._kernel;this._kernel=null;let t=this._kernel;this._kernelChanged.emit({name:"kernel",oldValue:e,newValue:t})}Qc.Signal.clearData(this)}}async setPath(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({path:e})}async setName(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({name:e})}async setType(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({type:e})}async changeKernel(e){if(this.isDisposed)throw new Error("Session is disposed");return await this._patch({kernel:e}),this.kernel}async shutdown(){if(this.isDisposed)throw new Error("Session is disposed");await(0,fz.shutdownSession)(this.id,this.serverSettings),this.dispose()}setupKernel(e){if(e===null){this._kernel=null;return}let t=this._connectToKernel({...this._kernelConnectionOptions,model:e,username:this._username,clientId:this._clientId,serverSettings:this.serverSettings});this._kernel=t,t.statusChanged.connect(this.onKernelStatus,this),t.connectionStatusChanged.connect(this.onKernelConnectionStatus,this),t.pendingInput.connect(this.onPendingInput,this),t.unhandledMessage.connect(this.onUnhandledMessage,this),t.iopubMessage.connect(this.onIOPubMessage,this),t.anyMessage.connect(this.onAnyMessage,this)}onKernelStatus(e,t){this._statusChanged.emit(t)}onKernelConnectionStatus(e,t){this._connectionStatusChanged.emit(t)}onPendingInput(e,t){this._pendingInput.emit(t)}onIOPubMessage(e,t){this._iopubMessage.emit(t)}onUnhandledMessage(e,t){this._unhandledMessage.emit(t)}onAnyMessage(e,t){this._anyMessage.emit(t)}async _patch(e){let t=await(0,fz.updateSession)({...e,id:this._id},this.serverSettings);return this.update(t),t}_handleModelChange(e){e.name!==this._name&&this._propertyChanged.emit("name"),e.type!==this._type&&this._propertyChanged.emit("type"),e.path!==this._path&&this._propertyChanged.emit("path")}};G1.SessionConnection=LV});var gz=re(Ox=>{"use strict";p();Object.defineProperty(Ox,"__esModule",{value:!0});Ox.SessionManager=void 0;var Hbe=Ug(),hz=As(),qbe=Do(),Jbe=Fg(),Gbe=mz(),Ax=J1(),Mx=class extends Jbe.BaseManager{constructor(e){var t;super(e),this._isReady=!1,this._sessionConnections=new Set,this._models=new Map,this._runningChanged=new hz.Signal(this),this._connectionFailure=new hz.Signal(this),this._connectToKernel=n=>this._kernelManager.connectTo(n),this._kernelManager=e.kernelManager,this._pollModels=new Hbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:SessionManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._kernelManager.isActive&&await this._kernelManager.ready,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._sessionConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){let t=new Gbe.SessionConnection({...e,connectToKernel:this._connectToKernel,serverSettings:this.serverSettings});return this._onStarted(t),this._models.has(e.model.id)||this.refreshRunning().catch(()=>{}),t}running(){return this._models.values()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e,t={}){let n=await(0,Ax.startSession)(e,this.serverSettings);return await this.refreshRunning(),this.connectTo({...t,model:n})}async shutdown(e){await(0,Ax.shutdownSession)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>(0,Ax.shutdownSession)(e,this.serverSettings))),await this.refreshRunning()}async stopIfNeeded(e){try{let n=(await(0,Ax.listRunning)(this.serverSettings)).filter(i=>i.path===e);if(n.length===1){let i=n[0].id;await this.shutdown(i)}}catch(t){}}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async findByPath(e){for(let t of this._models.values())if(t.path===e)return t;await this.refreshRunning();for(let t of this._models.values())if(t.path===e)return t}async requestRunning(){var e,t;let n;try{n=await(0,Ax.listRunning)(this.serverSettings)}catch(i){throw(i instanceof qbe.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&n.every(i=>{var o,s,a,l;let u=this._models.get(i.id);return u?((o=u.kernel)===null||o===void 0?void 0:o.id)===((s=i.kernel)===null||s===void 0?void 0:s.id)&&((a=u.kernel)===null||a===void 0?void 0:a.name)===((l=i.kernel)===null||l===void 0?void 0:l.name)&&u.name===i.name&&u.path===i.path&&u.type===i.type:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._sessionConnections.forEach(i=>{this._models.has(i.id)?i.update(this._models.get(i.id)):i.dispose()}),this._runningChanged.emit(n))}_onStarted(e){this._sessionConnections.add(e),e.disposed.connect(this._onDisposed,this),e.propertyChanged.connect(this._onChanged,this),e.kernelChanged.connect(this._onChanged,this)}_onDisposed(e){this._sessionConnections.delete(e),this.refreshRunning().catch(()=>{})}_onChanged(){this.refreshRunning().catch(()=>{})}};Ox.SessionManager=Mx;(function(r){class e extends r{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}async startNew(n,i={}){return Promise.reject(new Error("Not implemented in no-op Session Manager"))}connectTo(n){throw Error("Not implemented in no-op Session Manager")}get ready(){return this.parentReady.then(()=>this._readyPromise)}async shutdown(n){return Promise.reject(new Error("Not implemented in no-op Session Manager"))}async requestRunning(){return Promise.resolve()}}r.NoopManager=e})(Mx||(Ox.SessionManager=Mx={}))});var KV=re(ko=>{"use strict";p();var vz=ko&&ko.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ybe=ko&&ko.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),yz=ko&&ko.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&vz(e,r,t);return Ybe(e,r),e},$be=ko&&ko.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&vz(e,r,t)};Object.defineProperty(ko,"__esModule",{value:!0});ko.SessionAPI=ko.Session=void 0;var zbe=yz(uz());ko.Session=zbe;var Qbe=yz(J1());ko.SessionAPI=Qbe;$be(gz(),ko)});var bz=re(Y1=>{"use strict";p();Object.defineProperty(Y1,"__esModule",{value:!0});Y1.DataConnector=void 0;var FV=class{async list(e){throw new Error("DataConnector#list method has not been implemented.")}async remove(e){throw new Error("DataConnector#remove method has not been implemented.")}async save(e,t){throw new Error("DataConnector#save method has not been implemented.")}};Y1.DataConnector=FV});var Sz=re(Iz=>{"use strict";p();Object.defineProperty(Iz,"__esModule",{value:!0})});var UV=re(($1,_z)=>{p();(function(r,e){typeof $1=="object"&&typeof _z!="undefined"?e($1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})($1,function(r){"use strict";r.ArrayExt=void 0,function(h){function y(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(A[me]===M)return me}return-1}h.firstIndexOf=y;function w(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(A[me]===M)return me}return-1}h.lastIndexOf=w;function T(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(M(A[me],me))return me}return-1}h.findFirstIndex=T;function H(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(M(A[me],me))return me}return-1}h.findLastIndex=H;function Y(A,M,I=0,S=-1){let _=T(A,M,I,S);return _!==-1?A[_]:void 0}h.findFirstValue=Y;function Z(A,M,I=-1,S=0){let _=H(A,M,I,S);return _!==-1?A[_]:void 0}h.findLastValue=Z;function ie(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function ce(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=ce;function be(A,M,I){if(A===M)return!0;if(A.length!==M.length)return!1;for(let S=0,_=A.length;S<_;++S)if(I?!I(A[S],M[S]):A[S]!==M[S])return!1;return!0}h.shallowEqual=be;function q(A,M={}){let{start:I,stop:S,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=A.length;I===void 0?I=_<0?F-1:0:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F),S===void 0?S=_<0?-1:F:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F);let j;_<0&&S>=I||_>0&&I>=S?j=0:_<0?j=Math.floor((S-I+1)/_+1):j=Math.floor((S-I-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=A[I+Fe*_];return me}h.slice=q;function $(A,M,I){let S=A.length;if(S<=1||(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1),M===I))return;let _=A[M],F=M<I?1:-1;for(let j=M;j!==I;j+=F)A[j]=A[j+F];A[I]=_}h.move=$;function de(A,M=0,I=-1){let S=A.length;if(!(S<=1))for(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1);M<I;){let _=A[M],F=A[I];A[M++]=F,A[I--]=_}}h.reverse=de;function pe(A,M,I=0,S=-1){let _=A.length;if(_<=1||(I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I>=S))return;let F=S-I+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=I+M;de(A,I,j-1),de(A,j,S),de(A,I,S)}h.rotate=pe;function ye(A,M,I=0,S=-1){let _=A.length;if(_===0)return;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j)A[(I+j)%_]=M}h.fill=ye;function z(A,M,I){let S=A.length;M<0?M=Math.max(0,M+S):M=Math.min(M,S);for(let _=S;_>M;--_)A[_]=A[_-1];A[M]=I}h.insert=z;function fe(A,M){let I=A.length;if(M<0&&(M+=I),M<0||M>=I)return;let S=A[M];for(let _=M+1;_<I;++_)A[_-1]=A[_];return A.length=I-1,S}h.removeAt=fe;function Se(A,M,I=0,S=-1){let _=y(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeFirstOf=Se;function Te(A,M,I=-1,S=0){let _=w(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeLastOf=Te;function Le(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&A[j]===M||S<I&&(j<=S||j>=I)&&A[j]===M?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllOf=Le;function $e(A,M,I=0,S=-1){let _,F=T(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeFirstWhere=$e;function Ge(A,M,I=-1,S=0){let _,F=H(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeLastWhere=Ge;function Bt(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&M(A[j],j)||S<I&&(j<=S||j>=I)&&M(A[j],j)?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let y of h)yield*y}function*t(){}function*n(h,y=0){for(let w of h)yield[y++,w]}function*i(h,y){let w=0;for(let T of h)y(T,w++)&&(yield T)}function o(h,y){let w=0;for(let T of h)if(y(T,w++))return T}function s(h,y){let w=0;for(let T of h)if(y(T,w++))return w-1;return-1}function a(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)<0&&(w=T)}return w}function l(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)>0&&(w=T)}return w}function u(h,y){let w=!0,T,H;for(let Y of h)w?(T=Y,H=Y,w=!1):y(Y,T)<0?T=Y:y(Y,H)>0&&(H=Y);return w?void 0:[T,H]}function c(h){return Array.from(h)}function d(h){let y={};for(let[w,T]of h)y[w]=T;return y}function f(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return}function m(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return!1;return!0}function g(h,y){let w=0;for(let T of h)if(y(T,w++))return!0;return!1}function*b(h,y){let w=0;for(let T of h)yield y(T,w++)}function*v(h,y,w){y===void 0?(y=h,h=0,w=1):w===void 0&&(w=1);let T=k.rangeLength(h,y,w);for(let H=0;H<T;H++)yield h+w*H}var k;(function(h){function y(w,T,H){return H===0?1/0:w>T&&H>0||w<T&&H<0?0:Math.ceil((T-w)/H)}h.rangeLength=y})(k||(k={}));function R(h,y,w){let T=h[Symbol.iterator](),H=0,Y=T.next();if(Y.done&&w===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return w;let Z=T.next();if(Z.done&&w===void 0)return Y.value;if(Z.done)return y(w,Y.value,H++);let ie;w===void 0?ie=y(Y.value,Z.value,H++):ie=y(y(w,Y.value,H++),Z.value,H++);let ce;for(;!(ce=T.next()).done;)ie=y(ie,ce.value,H++);return ie}function*P(h,y){for(;0<y--;)yield h}function*D(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let y=h.length-1;y>-1;y--)yield h[y]}function L(h){let y=[],w=new Set,T=new Map;for(let Z of h)H(Z);for(let[Z]of T)Y(Z);return y;function H(Z){let[ie,ce]=Z,be=T.get(ce);be?be.push(ie):T.set(ce,[ie])}function Y(Z){if(w.has(Z))return;w.add(Z);let ie=T.get(Z);if(ie)for(let ce of ie)Y(ce);y.push(Z)}}function*B(h,y){let w=0;for(let T of h)w++%y===0&&(yield T)}r.StringExt=void 0,function(h){function y(Z,ie,ce=0){let be=new Array(ie.length);for(let q=0,$=ce,de=ie.length;q<de;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=y;function w(Z,ie,ce=0){let be=y(Z,ie,ce);if(!be)return null;let q=0;for(let $=0,de=be.length;$<de;++$){let pe=be[$]-ce;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=w;function T(Z,ie,ce=0){let be=y(Z,ie,ce);if(!be)return null;let q=0,$=ce-1;for(let de=0,pe=be.length;de<pe;++de){let ye=be[de];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=T;function H(Z,ie,ce){let be=[],q=0,$=0,de=ie.length;for(;q<de;){let pe=ie[q],ye=ie[q];for(;++q<de&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(ce(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,y){if(y<1)return;let w=h[Symbol.iterator](),T;for(;0<y--&&!(T=w.next()).done;)yield T.value}function*O(...h){let y=h.map(T=>T[Symbol.iterator]()),w=y.map(T=>T.next());for(;m(w,T=>!T.done);w=y.map(T=>T.next()))yield w.map(T=>T.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=D,r.range=v,r.reduce=R,r.repeat=P,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var Q1=re((z1,Ez)=>{p();(function(r,e){typeof z1=="object"&&typeof Ez!="undefined"?e(z1,UV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(z1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"}u.isPrimitive=c;function d(P){return Array.isArray(P)}u.isArray=d;function f(P){return!c(P)&&!d(P)}u.isObject=f;function m(P,D){if(P===D)return!0;if(c(P)||c(D))return!1;let K=d(P),L=d(D);return K!==L?!1:K&&L?b(P,D):v(P,D)}u.deepEqual=m;function g(P){return c(P)?P:d(P)?k(P):R(P)}u.deepCopy=g;function b(P,D){if(P===D)return!0;if(P.length!==D.length)return!1;for(let K=0,L=P.length;K<L;++K)if(!m(P[K],D[K]))return!1;return!0}function v(P,D){if(P===D)return!0;for(let K in P)if(P[K]!==void 0&&!(K in D))return!1;for(let K in D)if(D[K]!==void 0&&!(K in P))return!1;for(let K in P){let L=P[K],B=D[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function k(P){let D=new Array(P.length);for(let K=0,L=P.length;K<L;++K)D[K]=g(P[K]);return D}function R(P){let D={};for(let K in P){let L=P[K];L!==void 0&&(D[K]=g(L))}return D}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(v=>{let k=this._services.get(v);return k?this._plugins.get(k).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(v){var k,R,P,D;this._activated=!1,this._promise=null,this._service=null,this.id=v.id,this.description=(k=v.description)!==null&&k!==void 0?k:"",this.activate=v.activate,this.deactivate=(R=v.deactivate)!==null&&R!==void 0?R:null,this.provides=(P=v.provides)!==null&&P!==void 0?P:null,this.autoStart=(D=v.autoStart)!==null&&D!==void 0?D:!1,this.requires=v.requires?v.requires.slice():[],this.optional=v.optional?v.optional.slice():[]}get activated(){return this._activated}set activated(v){this._activated=v}get service(){return this._service}set service(v){this._service=v}get promise(){return this._promise}set promise(v){this._promise=v}}function d(b){return new c(b)}u.createPluginData=d;function f(b,v,k){let R=[...b.requires,...b.optional],P=K=>{if(K===b.provides)return!0;let L=k.get(K);if(!L)return!1;let B=v.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(D.push(L),N.some(P)?!0:(D.pop(),!1))};if(!b.provides||R.length===0)return;let D=[b.id];if(R.some(P))throw new ReferenceError(`Cycle detected: ${D.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,v,k){let R=new Array,P=N=>{let O=v.get(N),h=[...O.requires,...O.optional];R.push(...h.reduce((y,w)=>{let T=k.get(w);return T&&y.push([N,T]),y},[]))};for(let N of v.keys())P(N);let D=R.filter(N=>N[1]===b),K=0;for(;D.length>K;){let N=D.length,O=new Set(D.map(h=>h[0]));for(let h of O)R.filter(y=>y[1]===h).forEach(y=>{D.includes(y)||D.push(y)});K=N}let L=e.topologicSort(D),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,v){let k=new Set;for(let R of b.keys())b.get(R).autoStart===!0&&k.add(R);if(v.startPlugins)for(let R of v.startPlugins)k.add(R);if(v.ignorePlugins)for(let R of v.ignorePlugins)k.delete(R);return Array.from(k)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var wz=re((X1,Cz)=>{p();(function(r,e){typeof X1=="object"&&typeof Cz!="undefined"?e(X1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_properties={}))})(X1,function(r){"use strict";class e{constructor(i){this._pid=t.nextPID(),this.name=i.name,this._create=i.create,this._coerce=i.coerce||null,this._compare=i.compare||null,this._changed=i.changed||null}get(i){let o,s=t.ensureMap(i);return this._pid in s?o=s[this._pid]:o=s[this._pid]=this._createValue(i),o}set(i,o){let s,a=t.ensureMap(i);this._pid in a?s=a[this._pid]:s=a[this._pid]=this._createValue(i);let l=this._coerceValue(i,o);this._maybeNotify(i,s,a[this._pid]=l)}coerce(i){let o,s=t.ensureMap(i);this._pid in s?o=s[this._pid]:o=s[this._pid]=this._createValue(i);let a=this._coerceValue(i,o);this._maybeNotify(i,o,s[this._pid]=a)}_createValue(i){let o=this._create;return o(i)}_coerceValue(i,o){let s=this._coerce;return s?s(i,o):o}_compareValue(i,o){let s=this._compare;return s?s(i,o):i===o}_maybeNotify(i,o,s){let a=this._changed;a&&!this._compareValue(o,s)&&a(i,o,s)}}(function(n){function i(o){t.ownerData.delete(o)}n.clearData=i})(e||(e={}));var t;(function(n){n.ownerData=new WeakMap,n.nextPID=(()=>{let o=0;return()=>`pid-${`${Math.random()}`.slice(2)}-${o++}`})();function i(o){let s=n.ownerData.get(o);return s||(s=Object.create(null),n.ownerData.set(o,s),s)}n.ensureMap=i})(t||(t={})),r.AttachedProperty=e})});var WV=re((Z1,xz)=>{p();(function(r,e){typeof Z1=="object"&&typeof xz!="undefined"?e(Z1,UV(),Q1()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(Z1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let y=g.get(N.sender);if(y||(y=[],g.set(N.sender,y)),R(y,N,O,h))return!1;let w=h||O,T=b.get(w);T||(T=[],b.set(w,T));let H={signal:N,slot:O,thisArg:h};return y.push(H),T.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let y=g.get(N.sender);if(!y||y.length===0)return!1;let w=R(y,N,O,h);if(!w)return!1;let T=h||O,H=b.get(T);return w.signal=null,D(y),D(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let y=b.get(O);if(!(!y||y.length===0)){for(let w of y)w.signal&&w.signal.sender===N&&(w.signal=null);D(h),D(y)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.thisArg||h.slot;h.signal=null,D(b.get(y))}D(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.signal.sender;h.signal=null,D(g.get(y))}D(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let y=0,w=h.length;y<w;++y){let T=h[y];T.signal===N&&P(T,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,v=new Set,k=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function R(N,O,h,y){return e.find(N,w=>w.signal===O&&w.slot===h&&w.thisArg===y)}function P(N,O){let{signal:h,slot:y,thisArg:w}=N;try{y.call(w,h.sender,O)}catch(T){s.exceptionHandler(T)}}function D(N){v.size===0&&k(K),v.add(N)}function K(){v.forEach(L),v.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var Dz=re(tR=>{"use strict";p();Object.defineProperty(tR,"__esModule",{value:!0});tR.RestorablePool=void 0;var Xbe=Q1(),Pz=wz(),eR=WV(),VV=class{constructor(e){this._added=new eR.Signal(this),this._current=null,this._currentChanged=new eR.Signal(this),this._hasRestored=!1,this._isDisposed=!1,this._objects=new Set,this._restore=null,this._restored=new Xbe.PromiseDelegate,this._updated=new eR.Signal(this),this.namespace=e.namespace}get added(){return this._added}get current(){return this._current}set current(e){this._current!==e&&e!==null&&this._objects.has(e)&&(this._current=e,this._currentChanged.emit(this._current))}get currentChanged(){return this._currentChanged}get isDisposed(){return this._isDisposed}get restored(){return this._restored.promise}get size(){return this._objects.size}get updated(){return this._updated}async add(e){var t,n;if(e.isDisposed){let i="A disposed object cannot be added.";throw console.warn(i,e),new Error(i)}if(this._objects.has(e)){let i="This object already exists in the pool.";throw console.warn(i,e),new Error(i)}if(this._objects.add(e),e.disposed.connect(this._onInstanceDisposed,this),!Xc.injectedProperty.get(e)){if(this._restore){let{connector:i}=this._restore,o=this._restore.name(e);if(o){let s=`${this.namespace}:${o}`,a=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);Xc.nameProperty.set(e,s),await i.save(s,{data:a})}}this._added.emit(e)}}dispose(){this.isDisposed||(this._current=null,this._isDisposed=!0,this._objects.clear(),eR.Signal.clearData(this))}find(e){let t=this._objects.values();for(let n of t)if(e(n))return n}forEach(e){this._objects.forEach(e)}filter(e){let t=[];return this.forEach(n=>{e(n)&&t.push(n)}),t}inject(e){return Xc.injectedProperty.set(e,!0),this.add(e)}has(e){return this._objects.has(e)}async restore(e){if(this._hasRestored)throw new Error("This pool has already been restored.");this._hasRestored=!0;let{command:t,connector:n,registry:i,when:o}=e,s=this.namespace,a=o?[n.list(s)].concat(o):[n.list(s)];this._restore=e;let[l]=await Promise.all(a),u=await Promise.all(l.ids.map(async(c,d)=>{let f=l.values[d],m=f&&f.data;return m===void 0?n.remove(c):i.execute(t,m).catch(()=>n.remove(c))}));return this._restored.resolve(),u}async save(e){var t,n;let i=Xc.injectedProperty.get(e);if(!this._restore||!this.has(e)||i)return;let{connector:o}=this._restore,s=this._restore.name(e),a=Xc.nameProperty.get(e),l=s?`${this.namespace}:${s}`:"";if(a&&a!==l&&await o.remove(a),Xc.nameProperty.set(e,l),l){let u=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);await o.save(l,{data:u})}a!==l&&this._updated.emit(e)}_onInstanceDisposed(e){if(this._objects.delete(e),e===this._current&&(this._current=null,this._currentChanged.emit(this._current)),Xc.injectedProperty.get(e)||!this._restore)return;let{connector:t}=this._restore,n=Xc.nameProperty.get(e);n&&t.remove(n)}};tR.RestorablePool=VV;var Xc;(function(r){r.injectedProperty=new Pz.AttachedProperty({name:"injected",create:()=>!1}),r.nameProperty=new Pz.AttachedProperty({name:"name",create:()=>""})})(Xc||(Xc={}))});var Tz=re(Kx=>{"use strict";p();Object.defineProperty(Kx,"__esModule",{value:!0});Kx.StateDB=void 0;var Zbe=WV(),Lx=class r{constructor(e={}){this._changed=new Zbe.Signal(this);let{connector:t,transform:n}=e;this._connector=t||new r.Connector,n?this._ready=n.then(i=>{let{contents:o,type:s}=i;switch(s){case"cancel":return;case"clear":return this._clear();case"merge":return this._merge(o||{});case"overwrite":return this._overwrite(o||{});default:return}}):this._ready=Promise.resolve(void 0)}get changed(){return this._changed}async clear(){await this._ready,await this._clear()}async fetch(e){return await this._ready,this._fetch(e)}async list(e){return await this._ready,this._list(e)}async remove(e){await this._ready,await this._remove(e),this._changed.emit({id:e,type:"remove"})}async save(e,t){await this._ready,await this._save(e,t),this._changed.emit({id:e,type:"save"})}async toJSON(){await this._ready;let{ids:e,values:t}=await this._list();return t.reduce((n,i,o)=>(n[e[o]]=i,n),{})}async _clear(){await Promise.all((await this._list()).ids.map(e=>this._remove(e)))}async _fetch(e){let t=await this._connector.fetch(e);if(t)return JSON.parse(t).v}async _list(e=""){let{ids:t,values:n}=await this._connector.list(e);return{ids:t,values:n.map(i=>JSON.parse(i).v)}}async _merge(e){await Promise.all(Object.keys(e).map(t=>e[t]&&this._save(t,e[t])))}async _overwrite(e){await this._clear(),await this._merge(e)}async _remove(e){return this._connector.remove(e)}async _save(e,t){return this._connector.save(e,JSON.stringify({v:t}))}};Kx.StateDB=Lx;(function(r){class e{constructor(){this._storage={}}async fetch(n){return this._storage[n]}async list(n=""){return Object.keys(this._storage).reduce((i,o)=>((n===""||n===o.split(":")[0])&&(i.ids.push(o),i.values.push(this._storage[o])),i),{ids:[],values:[]})}async remove(n){delete this._storage[n]}async save(n,i){this._storage[n]=i}}r.Connector=e})(Lx||(Kx.StateDB=Lx={}))});var kz=re(rR=>{"use strict";p();Object.defineProperty(rR,"__esModule",{value:!0});rR.IStateDB=void 0;var eIe=Q1();rR.IStateDB=new eIe.Token("@jupyterlab/coreutils:IStateDB",`A service for the JupyterLab state database.
  Use this if you want to store data that will persist across page loads.
  See "state database" for more information.`)});var jV=re(Ml=>{"use strict";p();var tIe=Ml&&Ml.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Fx=Ml&&Ml.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&tIe(e,r,t)};Object.defineProperty(Ml,"__esModule",{value:!0});Fx(bz(),Ml);Fx(Sz(),Ml);Fx(Dz(),Ml);Fx(Tz(),Ml);Fx(kz(),Ml)});var qV=re(iR=>{"use strict";p();Object.defineProperty(iR,"__esModule",{value:!0});iR.SettingManager=void 0;var BV=to(),rIe=jV(),nR=Do(),nIe="api/settings",HV=class extends rIe.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:nR.ServerConnection.makeSettings()}async fetch(e){if(!e)throw new Error("Plugin `id` parameter is required for settings fetch.");let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=nR.ServerConnection,a=n+i,l=Ux.url(a,e),u=await o(l,{},t);if(u.status!==200)throw await s.create(u);return u.json()}async list(e){var t,n,i,o;let{serverSettings:s}=this,{baseUrl:a,appUrl:l}=s,{makeRequest:u,ResponseError:c}=nR.ServerConnection,d=a+l,f=Ux.url(d,"",e==="ids"),m=await u(f,{},s);if(m.status!==200)throw new c(m);let g=await m.json(),b=(n=(t=g==null?void 0:g.settings)===null||t===void 0?void 0:t.map(k=>k.id))!==null&&n!==void 0?n:[],v=[];return e||(v=(o=(i=g==null?void 0:g.settings)===null||i===void 0?void 0:i.map(k=>(k.data={composite:{},user:{}},k)))!==null&&o!==void 0?o:[]),{ids:b,values:v}}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=nR.ServerConnection,l=i+o,u=Ux.url(l,e),c={body:JSON.stringify({raw:t}),method:"PUT"},d=await s(u,c,n);if(d.status!==204)throw new a(d)}};iR.SettingManager=HV;var Ux;(function(r){function e(t,n,i){let o=i?BV.URLExt.objectToQueryString({ids_only:!0}):"",s=BV.URLExt.join(t,nIe),a=BV.URLExt.join(s,n);if(!a.startsWith(s))throw new Error("Can only be used for workspaces requests");return`${a}${o}`}r.url=e})(Ux||(Ux={}))});var jx=re(No=>{"use strict";p();Object.defineProperty(No,"__esModule",{value:!0});No.shutdownTerminal=No.listRunning=No.startNew=No.isAvailable=No.TERMINAL_SERVICE_URL=void 0;var Wx=to(),Md=Do();No.TERMINAL_SERVICE_URL="api/terminals";function Nz(){return String(Wx.PageConfig.getOption("terminalsAvailable")).toLowerCase()==="true"}No.isAvailable=Nz;async function iIe(r=Md.ServerConnection.makeSettings(),e,t){Vx.errorIfNotAvailable();let n=Wx.URLExt.join(r.baseUrl,No.TERMINAL_SERVICE_URL),i={method:"POST",body:JSON.stringify({name:e,cwd:t})},o=await Md.ServerConnection.makeRequest(n,i,r);if(o.status!==200)throw await Md.ServerConnection.ResponseError.create(o);return await o.json()}No.startNew=iIe;async function oIe(r=Md.ServerConnection.makeSettings()){Vx.errorIfNotAvailable();let e=Wx.URLExt.join(r.baseUrl,No.TERMINAL_SERVICE_URL),t=await Md.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await Md.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid terminal list");return n}No.listRunning=oIe;async function sIe(r,e=Md.ServerConnection.makeSettings()){var t;Vx.errorIfNotAvailable();let n=Wx.URLExt.join(e.baseUrl,No.TERMINAL_SERVICE_URL),i=Wx.URLExt.join(n,r);if(!i.startsWith(n))throw new Error("Can only be used for terminal requests");let o={method:"DELETE"},s=await Md.ServerConnection.makeRequest(i,o,e);if(s.status===404){let l=(t=(await s.json()).message)!==null&&t!==void 0?t:`The terminal session "${r}"" does not exist on the server`;console.warn(l)}else if(s.status!==204)throw await Md.ServerConnection.ResponseError.create(s)}No.shutdownTerminal=sIe;var Vx;(function(r){function e(){if(!Nz())throw new Error("Terminals Unavailable")}r.errorIfNotAvailable=e})(Vx||(Vx={}))});var Rz=re(oR=>{"use strict";p();Object.defineProperty(oR,"__esModule",{value:!0});oR.isAvailable=void 0;var aIe=jx();Object.defineProperty(oR,"isAvailable",{enumerable:!0,get:function(){return aIe.isAvailable}})});var Oz=re(aR=>{"use strict";p();Object.defineProperty(aR,"__esModule",{value:!0});aR.TerminalConnection=void 0;var Az=to(),lIe=jc(),sR=As(),cIe=Jn(),Mz=jx(),JV=class r{constructor(e){var t;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let n=this._name,i=this.serverSettings,o=Az.URLExt.join(i.wsUrl,"terminals","websocket",encodeURIComponent(n)),s=i.token;i.appendToken&&s!==""&&(o=o+`?token=${encodeURIComponent(s)}`),this._ws=new i.WebSocket(o),this._ws.onmessage=this._onWSMessage,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSMessage=n=>{if(this._isDisposed)return;let i=JSON.parse(n.data);if(i[0]==="disconnect"&&this.dispose(),this._connectionStatus==="connecting"){i[0]==="setup"&&this._updateConnectionStatus("connected");return}this._messageReceived.emit({type:i[0],content:i.slice(1)})},this._onWSClose=n=>{console.warn(`Terminal websocket closed: ${n.code}`),this.isDisposed||this._reconnect()},this._connectionStatus="connecting",this._connectionStatusChanged=new sR.Signal(this),this._isDisposed=!1,this._disposed=new sR.Signal(this),this._messageReceived=new sR.Signal(this),this._reconnectTimeout=null,this._ws=null,this._noOp=()=>{},this._reconnectLimit=7,this._reconnectAttempt=0,this._pendingMessages=[],this._name=e.model.name,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:cIe.ServerConnection.makeSettings(),this._createSocket()}get disposed(){return this._disposed}get messageReceived(){return this._messageReceived}get name(){return this._name}get model(){return{name:this._name}}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearSocket(),sR.Signal.clearData(this))}send(e){this._sendMessage(e)}_sendMessage(e,t=!0){if(!(this._isDisposed||!e.content))if(this.connectionStatus==="connected"&&this._ws){let n=[e.type,...e.content];this._ws.send(JSON.stringify(n))}else if(t)this._pendingMessages.push(e);else throw new Error(`Could not send message: ${JSON.stringify(e)}`)}_sendPending(){for(;this.connectionStatus==="connected"&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}reconnect(){this._errorIfDisposed();let e=new lIe.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Terminal connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=GV.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.error(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}async shutdown(){await(0,Mz.shutdownTerminal)(this.name,this.serverSettings),this.dispose()}clone(){return new r(this)}_updateConnectionStatus(e){this._connectionStatus!==e&&(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),e==="connected"&&this._sendPending(),this._connectionStatusChanged.emit(e))}_errorIfDisposed(){if(this.isDisposed)throw new Error("Terminal connection is disposed")}get connectionStatusChanged(){return this._connectionStatusChanged}get connectionStatus(){return this._connectionStatus}};aR.TerminalConnection=JV;var GV;(function(r){function e(n,i){return Az.URLExt.join(n,Mz.TERMINAL_SERVICE_URL,encodeURIComponent(i))}r.getTermUrl=e;function t(n,i){return n=Math.ceil(n),i=Math.floor(i),Math.floor(Math.random()*(i-n+1))+n}r.getRandomIntInclusive=t})(GV||(GV={}))});var Kz=re(qx=>{"use strict";p();Object.defineProperty(qx,"__esModule",{value:!0});qx.TerminalManager=void 0;var uIe=Ug(),Lz=As(),dIe=Jn(),pIe=Fg(),Bx=jx(),fIe=Oz(),Hx=class extends pIe.BaseManager{constructor(e={}){var t;if(super(e),this._isReady=!1,this._names=[],this._terminalConnections=new Set,this._runningChanged=new Lz.Signal(this),this._connectionFailure=new Lz.Signal(this),!this.isAvailable()){this._ready=Promise.reject("Terminals unavailable"),this._ready.catch(n=>{});return}this._pollModels=new uIe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:TerminalManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._names.length=0,this._terminalConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}isAvailable(){return(0,Bx.isAvailable)()}connectTo(e){let t=new fIe.TerminalConnection({...e,serverSettings:this.serverSettings});return this._onStarted(t),this._names.includes(e.model.name)||this.refreshRunning().catch(()=>{}),t}running(){return this._models[Symbol.iterator]()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e){let t=await(0,Bx.startNew)(this.serverSettings,e==null?void 0:e.name,e==null?void 0:e.cwd);return await this.refreshRunning(),this.connectTo({model:t})}async shutdown(e){await(0,Bx.shutdownTerminal)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all(this._names.map(e=>(0,Bx.shutdownTerminal)(e,this.serverSettings))),await this.refreshRunning()}async requestRunning(){var e,t;let n;try{n=await(0,Bx.listRunning)(this.serverSettings)}catch(o){throw(o instanceof dIe.ServerConnection.NetworkError||((e=o.response)===null||e===void 0?void 0:e.status)===503||((t=o.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(o),o}if(this.isDisposed)return;let i=n.map(({name:o})=>o).sort();i!==this._names&&(this._names=i,this._terminalConnections.forEach(o=>{i.includes(o.name)||o.dispose()}),this._runningChanged.emit(this._models))}_onStarted(e){this._terminalConnections.add(e),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._terminalConnections.delete(e),this.refreshRunning().catch(()=>{})}get _models(){return this._names.map(e=>({name:e}))}};qx.TerminalManager=Hx;(function(r){class e extends r{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}get ready(){return this.parentReady.then(()=>this._readyPromise)}async startNew(n){return Promise.reject(new Error("Not implemented in no-op Terminal Manager"))}connectTo(n){throw Error("Not implemented in no-op Terminal Manager")}async shutdown(n){return Promise.reject(new Error("Not implemented in no-op Terminal Manager"))}async requestRunning(){return Promise.resolve()}}r.NoopManager=e})(Hx||(qx.TerminalManager=Hx={}))});var YV=re(Ro=>{"use strict";p();var Fz=Ro&&Ro.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),mIe=Ro&&Ro.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Uz=Ro&&Ro.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Fz(e,r,t);return mIe(e,r),e},hIe=Ro&&Ro.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Fz(e,r,t)};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.TerminalAPI=Ro.Terminal=void 0;var gIe=Uz(Rz());Ro.Terminal=gIe;var vIe=Uz(jx());Ro.TerminalAPI=vIe;hIe(Kz(),Ro)});var XV=re(lR=>{"use strict";p();Object.defineProperty(lR,"__esModule",{value:!0});lR.UserManager=void 0;var yIe=to(),bIe=jc(),IIe=Ug(),Wz=As(),SIe=Do(),_Ie=Fg(),EIe="api/me",$V="@jupyterlab/services:UserManager#user",zV=class extends _Ie.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._userChanged=new Wz.Signal(this),this._connectionFailure=new Wz.Signal(this),this._ready=this.requestUser().then(()=>{this.isDisposed||(this._isReady=!0)}).catch(n=>new Promise(()=>{})),this._pollSpecs=new IIe.Poll({auto:!1,factory:()=>this.requestUser(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:$V,standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get identity(){return this._identity}get permissions(){return this._permissions}get userChanged(){return this._userChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshUser(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestUser(){if(this.isDisposed)return;let{baseUrl:e}=this.serverSettings,{makeRequest:t,ResponseError:n}=SIe.ServerConnection,i=yIe.URLExt.join(e,EIe),o=await t(i,{},this.serverSettings);if(o.status!==200)throw await n.create(o);let s={identity:this._identity,permissions:this._permissions},a=await o.json(),l=a.identity,{localStorage:u}=window,c=u.getItem($V);if(c&&(!l.initials||!l.color)){let d=JSON.parse(c);l.initials=l.initials||d.initials||l.name.substring(0,1),l.color=l.color||d.color||QV.getRandomColor()}bIe.JSONExt.deepEqual(a,s)||(this._identity=l,this._permissions=a.permissions,u.setItem($V,JSON.stringify(l)),this._userChanged.emit(a))}};lR.UserManager=zV;var QV;(function(r){let e=["var(--jp-collaborator-color1)","var(--jp-collaborator-color2)","var(--jp-collaborator-color3)","var(--jp-collaborator-color4)","var(--jp-collaborator-color5)","var(--jp-collaborator-color6)","var(--jp-collaborator-color7)"];r.getRandomColor=()=>e[Math.floor(Math.random()*e.length)]})(QV||(QV={}))});var ej=re(cR=>{"use strict";p();Object.defineProperty(cR,"__esModule",{value:!0});cR.WorkspaceManager=void 0;var Vz=to(),CIe=jV(),Jx=Do(),wIe="api/workspaces",ZV=class extends CIe.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Jx.ServerConnection.makeSettings()}async fetch(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Jx.ServerConnection,a=n+i,l=EI.url(a,e),u=await o(l,{},t);if(u.status!==200)throw await s.create(u);return u.json()}async list(){let{serverSettings:e}=this,{baseUrl:t,appUrl:n}=e,{makeRequest:i,ResponseError:o}=Jx.ServerConnection,s=t+n,a=EI.url(s,""),l=await i(a,{},e);if(l.status!==200)throw await o.create(l);return(await l.json()).workspaces}async remove(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Jx.ServerConnection,a=n+i,l=EI.url(a,e),c=await o(l,{method:"DELETE"},t);if(c.status!==204)throw await s.create(c)}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=Jx.ServerConnection,l=i+o,u=EI.url(l,e),c={body:JSON.stringify(t),method:"PUT"},d=await s(u,c,n);if(d.status!==204)throw await a.create(d)}};cR.WorkspaceManager=ZV;var EI;(function(r){function e(t,n){let i=Vz.URLExt.join(t,wIe),o=Vz.URLExt.join(i,n);if(!o.startsWith(i))throw new Error("Can only be used for workspaces requests");return o}r.url=e})(EI||(EI={}))});var Bz=re(uR=>{"use strict";p();Object.defineProperty(uR,"__esModule",{value:!0});uR.ServiceManager=void 0;var jz=As(),xIe=lz(),PIe=fV(),DIe=vV(),TIe=kV(),kIe=W1(),NIe=OV(),RIe=Do(),AIe=KV(),MIe=qV(),OIe=YV(),LIe=XV(),KIe=ej(),tj=class{constructor(e={}){var t,n;this._isDisposed=!1,this._connectionFailure=new jz.Signal(this),this._isReady=!1;let i=e.defaultDrive,o=(t=e.serverSettings)!==null&&t!==void 0?t:RIe.ServerConnection.makeSettings(),s=(n=e.standby)!==null&&n!==void 0?n:"when-hidden",a={defaultDrive:i,serverSettings:o,standby:s};this.serverSettings=o,this.contents=e.contents||new PIe.ContentsManager(a),this.events=e.events||new DIe.EventManager(a),this.kernels=e.kernels||new TIe.KernelManager(a),this.sessions=e.sessions||new AIe.SessionManager({...a,kernelManager:this.kernels}),this.settings=e.settings||new MIe.SettingManager(a),this.terminals=e.terminals||new OIe.TerminalManager(a),this.builder=e.builder||new xIe.BuildManager(a),this.workspaces=e.workspaces||new KIe.WorkspaceManager(a),this.nbconvert=e.nbconvert||new NIe.NbConvertManager(a),this.kernelspecs=e.kernelspecs||new kIe.KernelSpecManager(a),this.user=e.user||new LIe.UserManager(a),this.kernelspecs.connectionFailure.connect(this._onConnectionFailure,this),this.sessions.connectionFailure.connect(this._onConnectionFailure,this),this.terminals.connectionFailure.connect(this._onConnectionFailure,this);let l=[this.sessions.ready,this.kernelspecs.ready];this.terminals.isAvailable()&&l.push(this.terminals.ready),this._readyPromise=Promise.all(l).then(()=>{this._isReady=!0})}get connectionFailure(){return this._connectionFailure}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,jz.Signal.clearData(this),this.contents.dispose(),this.events.dispose(),this.sessions.dispose(),this.terminals.dispose())}get isReady(){return this._isReady}get ready(){return this._readyPromise}_onConnectionFailure(e,t){this._connectionFailure.emit(t)}};uR.ServiceManager=tj});var Jn=re(Gn=>{"use strict";p();var FIe=Gn&&Gn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),as=Gn&&Gn.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&FIe(e,r,t)};Object.defineProperty(Gn,"__esModule",{value:!0});as(Fg(),Gn);as(_$(),Gn);as(fV(),Gn);as(vV(),Gn);as(kV(),Gn);as(W1(),Gn);as(Bz(),Gn);as(Do(),Gn);as(KV(),Gn);as(qV(),Gn);as(YV(),Gn);as(XV(),Gn);as(ej(),Gn);as(OV(),Gn)});var ij=re((MGe,Yz)=>{"use strict";p();var Jz=Array.isArray,Gz=Object.keys,WIe=Object.prototype.hasOwnProperty;Yz.exports=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Jz(e),i=Jz(t),o,s,a;if(n&&i){if(s=e.length,s!=t.length)return!1;for(o=s;o--!==0;)if(!r(e[o],t[o]))return!1;return!0}if(n!=i)return!1;var l=e instanceof Date,u=t instanceof Date;if(l!=u)return!1;if(l&&u)return e.getTime()==t.getTime();var c=e instanceof RegExp,d=t instanceof RegExp;if(c!=d)return!1;if(c&&d)return e.toString()==t.toString();var f=Gz(e);if(s=f.length,s!==Gz(t).length)return!1;for(o=s;o--!==0;)if(!WIe.call(t,f[o]))return!1;for(o=s;o--!==0;)if(a=f[o],!r(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}});var _j=re(em=>{"use strict";p();Object.defineProperty(em,"__esModule",{value:!0});em.TargetPopulation=em.Filters=em.VSCodeFilterProvider=void 0;var GR=require("vscode"),Sj=class r{constructor(e,t,n){this.extensionName=e,this.extensionVersion=t,this.targetPopulation=n}static trimVersionSuffix(e){let t=/\-[a-zA-Z0-9]+$/;return e.split(t)[0]}getFilterValue(e){switch(e){case au.ApplicationVersion:return r.trimVersionSuffix(GR.version);case au.Build:return GR.env.appName;case au.ClientId:return GR.env.machineId;case au.ExtensionName:return this.extensionName;case au.ExtensionVersion:return r.trimVersionSuffix(this.extensionVersion);case au.Language:return GR.env.language;case au.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,t=Object.values(au);for(let n of t)e.set(n,this.getFilterValue(n));return e}};em.VSCodeFilterProvider=Sj;var au;(function(r){r.Market="X-MSEdge-Market",r.CorpNet="X-FD-Corpnet",r.ApplicationVersion="X-VSCode-AppVersion",r.Build="X-VSCode-Build",r.ClientId="X-MSEdge-ClientId",r.ExtensionName="X-VSCode-ExtensionName",r.ExtensionVersion="X-VSCode-ExtensionVersion",r.Language="X-VSCode-Language",r.TargetPopulation="X-VSCode-TargetPopulation"})(au||(em.Filters=au={}));var $Q;(function(r){r.Team="team",r.Internal="internal",r.Insiders="insider",r.Public="public"})($Q||(em.TargetPopulation=$Q={}))});var zQ=re(YR=>{"use strict";p();Object.defineProperty(YR,"__esModule",{value:!0});YR.BaseFeatureProvider=void 0;var Ej=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}};YR.BaseFeatureProvider=Ej});var QQ=re($R=>{"use strict";p();Object.defineProperty($R,"__esModule",{value:!0});$R.FilteredFeatureProvider=void 0;var uSe=zQ(),Cj=class extends uSe.BaseFeatureProvider{constructor(e,t){super(e),this.telemetry=e,this.filterProviders=t,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let t of this.filterProviders){let n=t.getFilters();for(let i of n.keys()){let o=n.get(i);e.set(i,o)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;let t=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",t]])),this.cachedTelemetryEvents.push(e)}};$R.FilteredFeatureProvider=Cj});var XQ=re(tm=>{"use strict";p();Object.defineProperty(tm,"__esModule",{value:!0});tm.TasApiFeatureProvider=tm.TASAPI_FETCHERROR_EVENTNAME=void 0;var dSe=QQ();tm.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";var wj="ErrorType",xj=class extends dSe.FilteredFeatureProvider{constructor(e,t,n){super(t,n),this.httpClient=e,this.telemetry=t,this.filterProviders=n}async fetch(){let e=this.getFilters(),t={};for(let a of e.keys()){let l=e.get(a);t[a]=l}let n;try{n=await this.httpClient.get({headers:t})}catch(a){let l=a,u=new Map;l.responseReceived&&!l.responseOk?u.set(wj,"ServerError"):l.responseReceived===!1?u.set(wj,"NoResponse"):u.set(wj,"GenericError"),this.telemetry.postEvent(tm.TASAPI_FETCHERROR_EVENTNAME,u)}if(!n)throw Error(tm.TASAPI_FETCHERROR_EVENTNAME);e.keys.length>0&&this.PostEventToTelemetry(t);let i=n.data,o=i.Configs,s=[];for(let a of o)if(a.Parameters)for(let l of Object.keys(a.Parameters)){let u=l+(a.Parameters[l]?"":"cf");s.includes(u)||s.push(u)}return{features:s,assignmentContext:i.AssignmentContext,configs:o}}};tm.TasApiFeatureProvider=xj});var ZQ=re(BI=>{"use strict";p();Object.defineProperty(BI,"__esModule",{value:!0});BI.HttpClient=BI.FetchError=void 0;var jI=class extends Error{constructor(e,t,n){super(e),this.responseReceived=t,this.responseOk=n}};BI.FetchError=jI;var Pj=class{constructor(e){this.endpoint=e}async get(e){let t=await fetch(this.endpoint,{method:"GET",headers:e==null?void 0:e.headers});if(!t)throw new jI("No response received",!1);if(!t.ok)throw new jI("Response not ok",!0,!1);let n=await t.json();if(!n)throw new jI("No data received",!1);return{data:n}}};BI.HttpClient=Pj});var eX=re(zR=>{"use strict";p();Object.defineProperty(zR,"__esModule",{value:!0});zR.MemoryKeyValueStorage=void 0;var Dj=class{constructor(){this.storage=new Map}async getValue(e,t){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(t||void 0)}setValue(e,t){this.storage.set(e,t)}};zR.MemoryKeyValueStorage=Dj});var tX=re(QR=>{"use strict";p();Object.defineProperty(QR,"__esModule",{value:!0});QR.ExperimentationServiceBase=void 0;var pSe=eX(),Tj=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,t,n,i,o){this.telemetry=e,this.assignmentContextTelemetryPropertyName=t,this.telemetryEventName=n,this.storageKey=i,this.storage=o,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(o=new pSe.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((s,a)=>{this.resolveInitialFetchPromise=s})}async getFeaturesAsync(e=!1){if(this.fetchPromise!=null){try{await this.fetchPromise}catch(t){}return this.features}if(!this.featureProviders||this.featureProviders.length===0)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map(async n=>await n.getFeatures()));let t=await this.fetchPromise;this.updateFeatures(t,e)}catch(t){}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,t=!1){let n={features:[],assignmentContext:"",configs:[]};for(let i of e){for(let o of i.features)n.features.includes(o)||n.features.push(o);for(let o of i.configs){let s=n.configs.find(a=>a.Id===o.Id);s?s.Parameters=Object.assign(Object.assign({},s.Parameters),o.Parameters):n.configs.push(o)}n.assignmentContext+=i.assignmentContext}(t||!this.featuresConsumed)&&(this.features=n),this.storage&&this.storage.setValue(this.storageKey,n)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),e!==void 0&&e.configs===void 0&&(e.configs=[])),this.features.features.length===0&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){let t=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),t.features.includes(e)}getTreatmentVariable(e,t){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${t}`);let n=this.features.configs.find(i=>i.Id===e);return n==null?void 0:n.Parameters[t]}async getTreatmentVariableAsync(e,t,n){if(n){let i=this.featuresConsumed,o=this.getTreatmentVariable(e,t);if(o===void 0)this.featuresConsumed=i;else return o}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,t)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(!(e==null||this.featureProviders==null))for(let t of e)this.featureProviders.push(t)}};QR.ExperimentationServiceBase=Tj});var rX=re(XR=>{"use strict";p();Object.defineProperty(XR,"__esModule",{value:!0});XR.PollingService=void 0;var kj=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),this.onTick!=null&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}};XR.PollingService=kj});var nX=re(ZR=>{"use strict";p();Object.defineProperty(ZR,"__esModule",{value:!0});ZR.ExperimentationServiceAutoPolling=void 0;var fSe=tX(),mSe=rX(),Nj=class extends fSe.ExperimentationServiceBase{constructor(e,t,n,i,o,s,a){if(super(e,i,o,s,a),this.telemetry=e,this.filterProviders=t,this.refreshRateMs=n,this.assignmentContextTelemetryPropertyName=i,this.telemetryEventName=o,this.storageKey=s,this.storage=a,n<1e3&&n!==0)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");n>0&&(this.pollingService=new mSe.PollingService(n),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let t=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),t}else return await super.getFeaturesAsync(e)}};ZR.ExperimentationServiceAutoPolling=Nj});var iX=re(tA=>{"use strict";p();Object.defineProperty(tA,"__esModule",{value:!0});tA.ExperimentationService=void 0;var hSe=XQ(),gSe=ZQ(),vSe=nX(),eA=class extends vSe.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],e.refetchInterval!=null?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new hSe.TasApiFeatureProvider(new gSe.HttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}};tA.ExperimentationService=eA;eA.REFRESH_RATE_IN_MINUTES=30});var oX=re(rA=>{"use strict";p();Object.defineProperty(rA,"__esModule",{value:!0});rA.ExperimentationService=void 0;var ySe=iX();Object.defineProperty(rA,"ExperimentationService",{enumerable:!0,get:function(){return ySe.ExperimentationService}})});var sX=re(nA=>{"use strict";p();Object.defineProperty(nA,"__esModule",{value:!0});nA.MementoKeyValueStorage=void 0;var Rj=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,t){return await this.mementoGlobalStorage.get(e)||t}setValue(e,t){this.mementoGlobalStorage.update(e,t)}};nA.MementoKeyValueStorage=Rj});var aX=re(Mj=>{"use strict";p();Object.defineProperty(Mj,"__esModule",{value:!0});var Aj=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,t){}getTreatmentVariableAsync(e,t){return Promise.resolve(void 0)}};Mj.default=Aj});var cX=re(HI=>{"use strict";p();Object.defineProperty(HI,"__esModule",{value:!0});HI.getExperimentationServiceAsync=HI.getExperimentationService=void 0;var bSe=_j(),ISe=oX(),Oj=require("vscode"),SSe=sX(),_Se=aX(),ESe="https://default.exp-tas.com/vscode/ab",CSe="query-expfeature",wSe="abexp.assignmentcontext",xSe="VSCode.ABExp.FeatureData",PSe=1e3*60*30;function lX(r,e,t,n,i,...o){if(!i)throw new Error("Memento storage was not provided.");let s=Oj.workspace.getConfiguration("telemetry");if(!(Oj.env.isTelemetryEnabled===void 0?s.get("enableTelemetry",!0):Oj.env.isTelemetryEnabled))return new _Se.default;let u=[new bSe.VSCodeFilterProvider(r,e,t),...o],c=new SSe.MementoKeyValueStorage(i);return new ISe.ExperimentationService({filterProviders:u,telemetry:n,storageKey:xSe,keyValueStorage:c,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:wSe,telemetryEventName:CSe,endpoint:ESe,refetchInterval:PSe})}HI.getExperimentationService=lX;async function DSe(r,e,t,n,i,...o){let s=lX(r,e,t,n,i,...o);return await s.initializePromise,s}HI.getExperimentationServiceAsync=DSe});var dX=re(rm=>{"use strict";p();Object.defineProperty(rm,"__esModule",{value:!0});rm.TargetPopulation=rm.getExperimentationServiceAsync=rm.getExperimentationService=void 0;var uX=cX();Object.defineProperty(rm,"getExperimentationService",{enumerable:!0,get:function(){return uX.getExperimentationService}});Object.defineProperty(rm,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return uX.getExperimentationServiceAsync}});var TSe=_j();Object.defineProperty(rm,"TargetPopulation",{enumerable:!0,get:function(){return TSe.TargetPopulation}})});var uA=re((Mtt,Wj)=>{"use strict";p();function ASe(r){var e=void 0;typeof r=="string"?e=[r]:e=r.raw;for(var t="",n=0;n<e.length;n++)t+=e[n].replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`"),n<(arguments.length<=1?0:arguments.length-1)&&(t+=arguments.length<=n+1?void 0:arguments[n+1]);var i=t.split(`
`),o=null;return i.forEach(function(s){var a=s.match(/^(\s+)\S+/);if(a){var l=a[1].length;o?o=Math.min(o,l):o=l}}),o!==null&&(t=i.map(function(s){return s[0]===" "?s.slice(o):s}).join(`
`)),t=t.trim(),t.replace(/\\n/g,`
`)}typeof Wj!="undefined"&&(Wj.exports=ASe)});var KX=re((Hd,LX)=>{p();var OX=typeof self!="undefined"?self:Hd,gA=function(){function r(){this.fetch=!1,this.DOMException=OX.DOMException}return r.prototype=OX,new r}();(function(r){var e=function(t){var n={searchParams:"URLSearchParams"in r,iterable:"Symbol"in r&&"iterator"in Symbol,blob:"FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(h){return!1}}(),formData:"FormData"in r,arrayBuffer:"ArrayBuffer"in r};function i(h){return h&&DataView.prototype.isPrototypeOf(h)}if(n.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(h){return h&&o.indexOf(Object.prototype.toString.call(h))>-1};function a(h){if(typeof h!="string"&&(h=String(h)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(h))throw new TypeError("Invalid character in header field name");return h.toLowerCase()}function l(h){return typeof h!="string"&&(h=String(h)),h}function u(h){var y={next:function(){var w=h.shift();return{done:w===void 0,value:w}}};return n.iterable&&(y[Symbol.iterator]=function(){return y}),y}function c(h){this.map={},h instanceof c?h.forEach(function(y,w){this.append(w,y)},this):Array.isArray(h)?h.forEach(function(y){this.append(y[0],y[1])},this):h&&Object.getOwnPropertyNames(h).forEach(function(y){this.append(y,h[y])},this)}c.prototype.append=function(h,y){h=a(h),y=l(y);var w=this.map[h];this.map[h]=w?w+", "+y:y},c.prototype.delete=function(h){delete this.map[a(h)]},c.prototype.get=function(h){return h=a(h),this.has(h)?this.map[h]:null},c.prototype.has=function(h){return this.map.hasOwnProperty(a(h))},c.prototype.set=function(h,y){this.map[a(h)]=l(y)},c.prototype.forEach=function(h,y){for(var w in this.map)this.map.hasOwnProperty(w)&&h.call(y,this.map[w],w,this)},c.prototype.keys=function(){var h=[];return this.forEach(function(y,w){h.push(w)}),u(h)},c.prototype.values=function(){var h=[];return this.forEach(function(y){h.push(y)}),u(h)},c.prototype.entries=function(){var h=[];return this.forEach(function(y,w){h.push([w,y])}),u(h)},n.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);function d(h){if(h.bodyUsed)return Promise.reject(new TypeError("Already read"));h.bodyUsed=!0}function f(h){return new Promise(function(y,w){h.onload=function(){y(h.result)},h.onerror=function(){w(h.error)}})}function m(h){var y=new FileReader,w=f(y);return y.readAsArrayBuffer(h),w}function g(h){var y=new FileReader,w=f(y);return y.readAsText(h),w}function b(h){for(var y=new Uint8Array(h),w=new Array(y.length),T=0;T<y.length;T++)w[T]=String.fromCharCode(y[T]);return w.join("")}function v(h){if(h.slice)return h.slice(0);var y=new Uint8Array(h.byteLength);return y.set(new Uint8Array(h)),y.buffer}function k(){return this.bodyUsed=!1,this._initBody=function(h){this._bodyInit=h,h?typeof h=="string"?this._bodyText=h:n.blob&&Blob.prototype.isPrototypeOf(h)?this._bodyBlob=h:n.formData&&FormData.prototype.isPrototypeOf(h)?this._bodyFormData=h:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(h)?this._bodyText=h.toString():n.arrayBuffer&&n.blob&&i(h)?(this._bodyArrayBuffer=v(h.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(h)||s(h))?this._bodyArrayBuffer=v(h):this._bodyText=h=Object.prototype.toString.call(h):this._bodyText="",this.headers.get("content-type")||(typeof h=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(h)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var h=d(this);if(h)return h;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var h=d(this);if(h)return h;if(this._bodyBlob)return g(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(b(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(K)}),this.json=function(){return this.text().then(JSON.parse)},this}var R=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function P(h){var y=h.toUpperCase();return R.indexOf(y)>-1?y:h}function D(h,y){y=y||{};var w=y.body;if(h instanceof D){if(h.bodyUsed)throw new TypeError("Already read");this.url=h.url,this.credentials=h.credentials,y.headers||(this.headers=new c(h.headers)),this.method=h.method,this.mode=h.mode,this.signal=h.signal,!w&&h._bodyInit!=null&&(w=h._bodyInit,h.bodyUsed=!0)}else this.url=String(h);if(this.credentials=y.credentials||this.credentials||"same-origin",(y.headers||!this.headers)&&(this.headers=new c(y.headers)),this.method=P(y.method||this.method||"GET"),this.mode=y.mode||this.mode||null,this.signal=y.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&w)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(w)}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function K(h){var y=new FormData;return h.trim().split("&").forEach(function(w){if(w){var T=w.split("="),H=T.shift().replace(/\+/g," "),Y=T.join("=").replace(/\+/g," ");y.append(decodeURIComponent(H),decodeURIComponent(Y))}}),y}function L(h){var y=new c,w=h.replace(/\r?\n[\t ]+/g," ");return w.split(/\r?\n/).forEach(function(T){var H=T.split(":"),Y=H.shift().trim();if(Y){var Z=H.join(":").trim();y.append(Y,Z)}}),y}k.call(D.prototype);function B(h,y){y||(y={}),this.type="default",this.status=y.status===void 0?200:y.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in y?y.statusText:"OK",this.headers=new c(y.headers),this.url=y.url||"",this._initBody(h)}k.call(B.prototype),B.prototype.clone=function(){return new B(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},B.error=function(){var h=new B(null,{status:0,statusText:""});return h.type="error",h};var N=[301,302,303,307,308];B.redirect=function(h,y){if(N.indexOf(y)===-1)throw new RangeError("Invalid status code");return new B(null,{status:y,headers:{location:h}})},t.DOMException=r.DOMException;try{new t.DOMException}catch(h){t.DOMException=function(y,w){this.message=y,this.name=w;var T=Error(y);this.stack=T.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function O(h,y){return new Promise(function(w,T){var H=new D(h,y);if(H.signal&&H.signal.aborted)return T(new t.DOMException("Aborted","AbortError"));var Y=new XMLHttpRequest;function Z(){Y.abort()}Y.onload=function(){var ie={status:Y.status,statusText:Y.statusText,headers:L(Y.getAllResponseHeaders()||"")};ie.url="responseURL"in Y?Y.responseURL:ie.headers.get("X-Request-URL");var ce="response"in Y?Y.response:Y.responseText;w(new B(ce,ie))},Y.onerror=function(){T(new TypeError("Network request failed"))},Y.ontimeout=function(){T(new TypeError("Network request failed"))},Y.onabort=function(){T(new t.DOMException("Aborted","AbortError"))},Y.open(H.method,H.url,!0),H.credentials==="include"?Y.withCredentials=!0:H.credentials==="omit"&&(Y.withCredentials=!1),"responseType"in Y&&n.blob&&(Y.responseType="blob"),H.headers.forEach(function(ie,ce){Y.setRequestHeader(ce,ie)}),H.signal&&(H.signal.addEventListener("abort",Z),Y.onreadystatechange=function(){Y.readyState===4&&H.signal.removeEventListener("abort",Z)}),Y.send(typeof H._bodyInit=="undefined"?null:H._bodyInit)})}return O.polyfill=!0,r.fetch||(r.fetch=O,r.Headers=c,r.Request=D,r.Response=B),t.Headers=c,t.Request=D,t.Response=B,t.fetch=O,Object.defineProperty(t,"__esModule",{value:!0}),t}({})})(gA);gA.fetch.ponyfill=!0;delete gA.fetch.polyfill;var cS=gA;Hd=cS.fetch;Hd.default=cS.fetch;Hd.fetch=cS.fetch;Hd.Headers=cS.Headers;Hd.Request=cS.Request;Hd.Response=cS.Response;LX.exports=Hd});var rZ=re((DA,tZ)=>{p();var wS=null;typeof WebSocket!="undefined"?wS=WebSocket:typeof MozWebSocket!="undefined"?wS=MozWebSocket:typeof DA!="undefined"?wS=DA.WebSocket||DA.MozWebSocket:typeof window!="undefined"?wS=window.WebSocket||window.MozWebSocket:typeof self!="undefined"&&(wS=self.WebSocket||self.MozWebSocket);tZ.exports=wS});var lZ=re((Ect,e9)=>{p();var aZ=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);aZ?(Xj=new Uint8Array(16),e9.exports=function(){return aZ(Xj),Xj}):(Zj=new Array(16),e9.exports=function(){for(var e=0,t;e<16;e++)e&3||(t=Math.random()*4294967296),Zj[e]=t>>>((e&3)<<3)&255;return Zj});var Xj,Zj});var dZ=re((wct,uZ)=>{p();var cZ=[];for(yP=0;yP<256;++yP)cZ[yP]=(yP+256).toString(16).substr(1);var yP;function HSe(r,e){var t=e||0,n=cZ;return[n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]]].join("")}uZ.exports=HSe});var Zg=re((Pct,pZ)=>{p();var qSe=lZ(),JSe=dZ();function GSe(r,e,t){var n=e&&t||0;typeof r=="string"&&(e=r==="binary"?new Array(16):null,r=null),r=r||{};var i=r.random||(r.rng||qSe)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e)for(var o=0;o<16;++o)e[n+o]=i[o];return e||JSe(i)}pZ.exports=GSe});var KZ=re((nbt,LZ)=>{"use strict";p();LZ.exports=({onlyFirst:r=!1}={})=>{let e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,r?void 0:"g")}});var see=re((owt,oee)=>{"use strict";p();var p_e=(r,e={})=>{let t=e.safe===!0||e.keepProtected===!0,n=!1,i=(o,s)=>{let a="",l,u;for(let c of o.nodes)switch(c.type){case"block":if(e.first&&n===!0){a+=i(c,o);break}if(e.preserveNewlines===!0){l=i(c,o),u=l.split(`
`),a+=`
`.repeat(u.length-1);break}if(t===!0&&c.protected===!0){a+=i(c,o);break}n=!0;break;case"line":if(e.first&&n===!0){a+=c.value;break}t===!0&&c.protected===!0&&(a+=c.value),n=!0;break;case"open":case"close":case"text":case"newline":default:{a+=c.value||"";break}}return a};return i(r)};oee.exports=p_e});var lee=re((awt,aee)=>{"use strict";p();var EM=class{constructor(e){this.type=e.type,e.value&&(this.value=e.value),e.match&&(this.match=e.match),this.newline=e.newline||""}get protected(){return!!this.match&&this.match[1]==="!"}},_9=class extends EM{constructor(e){super(e),this.nodes=e.nodes||[]}push(e){this.nodes.push(e)}get protected(){return this.nodes.length>0&&this.nodes[0].protected===!0}};aee.exports={Node:EM,Block:_9}});var uee=re(cee=>{"use strict";p();cee.javascript={BLOCK_OPEN_REGEX:/^\/\*\*?(!?)/,BLOCK_CLOSE_REGEX:/^\*\/(\n?)/,LINE_REGEX:/^\/\/(!?).*/}});var fee=re((dwt,pee)=>{"use strict";p();var{Node:vm,Block:dee}=lee(),f_e=uee(),E9={ESCAPED_CHAR_REGEX:/^\\./,QUOTED_STRING_REGEX:/^(['"`])((?:\\.|[^\1])+?)(\1)/,NEWLINE_REGEX:/^\r*\n/},m_e=(r,e={})=>{if(typeof r!="string")throw new TypeError("Expected input to be a string");let t=new dee({type:"root",nodes:[]}),n=[t],i=(e.language||"javascript").toLowerCase(),o=f_e[i];if(typeof o=="undefined")throw new Error(`Language "${i}" is not supported by strip-comments`);let{LINE_REGEX:s,BLOCK_OPEN_REGEX:a,BLOCK_CLOSE_REGEX:l}=o,u=t,c=r,d,f,m=[a,l].filter(Boolean),g=!1;m.every(P=>P.source==='^"""')&&(g=!0);let b=(P=c[0]||"")=>(c=c.slice(P.length),P),v=(P,D="text")=>{let K=P.exec(c);if(K)return b(K[0]),{type:D,value:K[0],match:K}},k=P=>{if(f&&f.type==="text"&&P.type==="text"){f.value+=P.value;return}u.push(P),P.nodes&&(n.push(P),u=P),f=P},R=()=>{if(u.type==="root")throw new SyntaxError("Unclosed block comment");n.pop(),u=n[n.length-1]};for(;c!=="";){if(d=v(E9.ESCAPED_CHAR_REGEX,"text")){k(new vm(d));continue}if(u.type!=="block"&&(!f||!/\w$/.test(f.value))&&!(g&&c.startsWith('"""'))&&(d=v(E9.QUOTED_STRING_REGEX,"text"))){k(new vm(d));continue}if(d=v(E9.NEWLINE_REGEX,"newline")){k(new vm(d));continue}if(a&&e.block&&!(g&&u.type==="block")&&(d=v(a,"open"))){k(new dee({type:"block"})),k(new vm(d));continue}if(l&&u.type==="block"&&e.block&&(d=v(l,"close"))){d.newline=d.match[1]||"",k(new vm(d)),R();continue}if(s&&u.type!=="block"&&e.line&&(d=v(s,"line"))){k(new vm(d));continue}if(d=v(/^[a-zABD-Z0-9\t ]+/,"text")){k(new vm(d));continue}k(new vm({type:"text",value:b(c[0])}))}return t};pee.exports=m_e});var hee=re((fwt,mee)=>{"use strict";p();var CM=see(),NP=fee(),wM=mee.exports=(r,e)=>{let t={...e,block:!0,line:!0};return CM(NP(r,t),t)};wM.block=(r,e)=>{let t={...e,block:!0};return CM(NP(r,t),t)};wM.line=(r,e)=>{let t={...e,line:!0};return CM(NP(r,t),t)};wM.first=(r,e)=>{let t={...e,block:!0,line:!0,first:!0};return CM(NP(r,t),t)};wM.parse=NP});var ete=re((JP,Zee)=>{p();var V_e=typeof JP=="object"&&JP&&JP.Object===Object&&JP;Zee.exports=V_e});var rte=re((DFt,tte)=>{p();var j_e=ete(),B_e=typeof self=="object"&&self&&self.Object===Object&&self,H_e=j_e||B_e||Function("return this")();tte.exports=H_e});var pO=re((kFt,nte)=>{p();var q_e=rte(),J_e=q_e.Symbol;nte.exports=J_e});var ote=re((RFt,ite)=>{p();function G_e(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}ite.exports=G_e});var ate=re((MFt,ste)=>{p();var Y_e=Array.isArray;ste.exports=Y_e});var dte=re((LFt,ute)=>{p();var lte=pO(),cte=Object.prototype,$_e=cte.hasOwnProperty,z_e=cte.toString,GP=lte?lte.toStringTag:void 0;function Q_e(r){var e=$_e.call(r,GP),t=r[GP];try{r[GP]=void 0;var n=!0}catch(o){}var i=z_e.call(r);return n&&(e?r[GP]=t:delete r[GP]),i}ute.exports=Q_e});var fte=re((FFt,pte)=>{p();var X_e=Object.prototype,Z_e=X_e.toString;function eEe(r){return Z_e.call(r)}pte.exports=eEe});var vte=re((WFt,gte)=>{p();var mte=pO(),tEe=dte(),rEe=fte(),nEe="[object Null]",iEe="[object Undefined]",hte=mte?mte.toStringTag:void 0;function oEe(r){return r==null?r===void 0?iEe:nEe:hte&&hte in Object(r)?tEe(r):rEe(r)}gte.exports=oEe});var bte=re((jFt,yte)=>{p();function sEe(r){return r!=null&&typeof r=="object"}yte.exports=sEe});var Ste=re((HFt,Ite)=>{p();var aEe=vte(),lEe=bte(),cEe="[object Symbol]";function uEe(r){return typeof r=="symbol"||lEe(r)&&aEe(r)==cEe}Ite.exports=uEe});var Pte=re((JFt,xte)=>{p();var _te=pO(),dEe=ote(),pEe=ate(),fEe=Ste(),mEe=1/0,Ete=_te?_te.prototype:void 0,Cte=Ete?Ete.toString:void 0;function wte(r){if(typeof r=="string")return r;if(pEe(r))return dEe(r,wte)+"";if(fEe(r))return Cte?Cte.call(r):"";var e=r+"";return e=="0"&&1/r==-mEe?"-0":e}xte.exports=wte});var Tte=re((YFt,Dte)=>{p();var hEe=Pte();function gEe(r){return r==null?"":hEe(r)}Dte.exports=gEe});var Rte=re((zFt,Nte)=>{p();var vEe=Tte(),kte=/[\\^$.*+?()[\]{}|]/g,yEe=RegExp(kte.source);function bEe(r){return r=vEe(r),r&&yEe.test(r)?r.replace(kte,"\\$&"):r}Nte.exports=bEe});var CCe={};Vv(CCe,{activate:()=>ICe,deactivate:()=>SCe});module.exports=pL(CCe);p();p();Reflect.metadata===void 0&&aB();p();var mr=require("vscode");p();p();function jv(){try{return(cB(),pL(lB)).isPreRelesVersionOfJupyterExtension===!0}catch(r){return!0}}var FE={isExiting:!1},cD="_builtin.JupyterServerSelectorForTesting",UE="_builtin.jupyterServerUrlProvider";var uB=!1;function dB(r){uB=r}function pB(){return uB}var fB=!1;function mB(r){fB=r}function zr(){return fB}var Ye="python",jE="markdown",ec="vscode-notebook-cell";var dD={language:Ye};var Bv="vscode-interactive-input",St="jupyter-notebook",vr="interactive";var tc="GitHub.codespaces",Je="ms-toolsai.jupyter",pD="ms-toolsai.datawrangler",fD=["donjayamanne"],mD="ms-toolsai.vscode-jupyter-powertoys",Hv="ms-toolsai.jupyter-hub",hB="0c6ae279ed8443289764825290e4f9e2-1a736e7c-1324-4338-be46-fc2a58ae4d14-7255",qv="STANDARD_OUTPUT_CHANNEL",uD;(t=>(t.PythonInteractiveHelpLink="https://aka.ms/pyaiinstall",t.JupyterDataRateHelpLink="https://aka.ms/AA5ggm0"))(uD||(uD={}));var li;(o=>(o.JupyterServerRemoteLaunchNameSeparator=`
`,o.JupyterServerRemoteLaunchService=Je,o.JupyterServerUriListMax=10,o.IntellisenseTimeout=2e3,o.IntellisenseResolveTimeout=5e3))(li||(li={}));var ci=!1;var rne=!1;function hn(){return rne||BE()}var nne=!1;function BE(){return nne}var nt;(b=>(b.GeneratedThemeName="ipython-theme",b.MatplotLibDefaultParams="_VSCode_defaultMatplotlib_Params",b.MatplotLibFigureFormats="_VSCode_matplotLib_FigureFormats",b.DefaultCodeCellMarker="# %%",b.DefaultCommTarget="jupyter.widget",b.ALL_VARIABLES="ALL_VARIABLES",b.KERNEL_VARIABLES="KERNEL_VARIABLES",b.DEBUGGER_VARIABLES="DEBUGGER_VARIABLES",b.PYTHON_VARIABLES_REQUESTER="PYTHON_VARIABLES_REQUESTER",b.MULTIPLEXING_DEBUGSERVICE="MULTIPLEXING_DEBUGSERVICE",b.RUN_BY_LINE_DEBUGSERVICE="RUN_BY_LINE_DEBUGSERVICE",b.REMOTE_URI="https://remote/",b.REMOTE_URI_ID_PARAM="id",b.REMOTE_URI_HANDLE_PARAM="uriHandle",b.REMOTE_URI_EXTENSION_ID_PARAM="extensionId"))(nt||(nt={}));var WE;(n=>(n.ImportIPython=`{0}
from IPython import get_ipython

{1}`,n.MatplotLibInit=`import matplotlib
%matplotlib inline
${nt.MatplotLibDefaultParams} = dict(matplotlib.rcParams)
`,n.DisableJedi="%config Completer.use_jedi = False"))(WE||(WE={}));var gB="JUPYTER_OUTPUT_CHANNEL",fL="Default Light+",$s="ms-python.python",vp="ms-toolsai.jupyter-renderers",vB="ms-python.vscode-pylance",yB=["python","html","xml","javascript","markdown","latex","shellscript","bat","powershell","kusto","ruby","sql","perl","qsharp","raw"],bB=new Map([["bash","shellscript"],["c#","csharp"],["f#","fsharp"],["q#","qsharp"],["c++11","c++"],["c++12","c++"],["c++14","c++"]]),IB=["python","r","julia","c++","c#","f#","q#","powershell","java","scala","haskell","bash","cling","rust","sas","sos","ocaml"];var le;(Oe=>(Oe.RunAllCells="jupyter.runallcells",Oe.RunAllCellsAbove="jupyter.runallcellsabove",Oe.RunCellAndAllBelow="jupyter.runcellandallbelow",Oe.RunAllCellsAbovePalette="jupyter.runallcellsabove.palette",Oe.RunCellAndAllBelowPalette="jupyter.runcurrentcellandallbelow.palette",Oe.RunToLine="jupyter.runtoline",Oe.RunFromLine="jupyter.runfromline",Oe.RunCell="jupyter.runcell",Oe.RunCurrentCell="jupyter.runcurrentcell",Oe.RunCurrentCellAdvance="jupyter.runcurrentcelladvance",Oe.CreateNewInteractive="jupyter.createnewinteractive",Oe.ImportNotebook="jupyter.importnotebook",Oe.ImportNotebookFile="jupyter.importnotebookfile",Oe.ExportFileAsNotebook="jupyter.exportfileasnotebook",Oe.ExportFileAndOutputAsNotebook="jupyter.exportfileandoutputasnotebook",Oe.InterruptKernel="jupyter.interruptkernel",Oe.RestartKernel="jupyter.restartkernel",Oe.RestartKernelAndRunAllCells="jupyter.restartkernelandrunallcells",Oe.RestartKernelAndRunUpToSelectedCell="jupyter.restartkernelandrunuptoselectedcell",Oe.NotebookEditorRemoveAllCells="jupyter.notebookeditor.removeallcells",Oe.NotebookEditorRunAllCells="jupyter.notebookeditor.runallcells",Oe.NotebookEditorRunSelectedCell="jupyter.notebookeditor.runselectedcell",Oe.NotebookEditorAddCellBelow="jupyter.notebookeditor.addcellbelow",Oe.ExpandAllCells="jupyter.expandallcells",Oe.CollapseAllCells="jupyter.collapseallcells",Oe.ExportOutputAsNotebook="jupyter.exportoutputasnotebook",Oe.ExecSelectionInInteractiveWindow="jupyter.execSelectionInteractive",Oe.RunFileInInteractiveWindows="jupyter.runFileInteractive",Oe.DebugFileInInteractiveWindows="jupyter.debugFileInteractive",Oe.AddCellBelow="jupyter.addcellbelow",Oe.DebugCurrentCellPalette="jupyter.debugcurrentcell.palette",Oe.DebugCell="jupyter.debugcell",Oe.DebugStepOver="jupyter.debugstepover",Oe.DebugContinue="jupyter.debugcontinue",Oe.DebugStop="jupyter.debugstop",Oe.RunCurrentCellAndAddBelow="jupyter.runcurrentcellandaddbelow",Oe.InsertCellBelowPosition="jupyter.insertCellBelowPosition",Oe.InsertCellBelow="jupyter.insertCellBelow",Oe.InsertCellAbove="jupyter.insertCellAbove",Oe.DeleteCells="jupyter.deleteCells",Oe.SelectCell="jupyter.selectCell",Oe.SelectCellContents="jupyter.selectCellContents",Oe.ExtendSelectionByCellAbove="jupyter.extendSelectionByCellAbove",Oe.ExtendSelectionByCellBelow="jupyter.extendSelectionByCellBelow",Oe.MoveCellsUp="jupyter.moveCellsUp",Oe.MoveCellsDown="jupyter.moveCellsDown",Oe.ChangeCellToMarkdown="jupyter.changeCellToMarkdown",Oe.ChangeCellToCode="jupyter.changeCellToCode",Oe.GotoNextCellInFile="jupyter.gotoNextCellInFile",Oe.GotoPrevCellInFile="jupyter.gotoPrevCellInFile",Oe.ScrollToCell="jupyter.scrolltocell",Oe.CreateNewNotebook="jupyter.createnewnotebook",Oe.ViewJupyterOutput="jupyter.viewOutput",Oe.ExportAsPythonScript="jupyter.exportAsPythonScript",Oe.ExportToHTML="jupyter.exportToHTML",Oe.ExportToPDF="jupyter.exportToPDF",Oe.Export="jupyter.export",Oe.NativeNotebookExport="jupyter.notebookeditor.export",Oe.LatestExtension="jupyter.latestExtension",Oe.EnableLoadingWidgetsFrom3rdPartySource="jupyter.enableLoadingWidgetScriptsFromThirdPartySource",Oe.ShowDataViewer="jupyter.showDataViewer",Oe.ShowJupyterDataViewer="jupyter.showJupyterDataViewer",Oe.RefreshDataViewer="jupyter.refreshDataViewer",Oe.ClearSavedJupyterUris="jupyter.clearSavedJupyterUris",Oe.OpenVariableView="jupyter.openVariableView",Oe.OpenOutlineView="jupyter.openOutlineView",Oe.InteractiveClearAll="jupyter.interactive.clearAllCells",Oe.InteractiveGoToCode="jupyter.interactive.goToCode",Oe.InteractiveCopyCell="jupyter.interactive.copyCell",Oe.InteractiveExportAsNotebook="jupyter.interactive.exportasnotebook",Oe.InteractiveExportAs="jupyter.interactive.exportas",Oe.RunByLine="jupyter.runByLine",Oe.RunAndDebugCell="jupyter.runAndDebugCell",Oe.RunByLineNext="jupyter.runByLineNext",Oe.RunByLineStop="jupyter.runByLineStop",Oe.ReplayPylanceLog="jupyter.replayPylanceLog",Oe.ReplayPylanceLogStep="jupyter.replayPylanceLogStep",Oe.InstallPythonExtensionViaKernelPicker="jupyter.installPythonExtensionViaKernelPicker",Oe.InstallPythonViaKernelPicker="jupyter.installPythonViaKernelPicker",Oe.ContinueEditSessionInCodespace="jupyter.continueEditSessionInCodespace"))(le||(le={}));var Mu;(n=>(n.DefaultDesignLenses=[le.RunCurrentCell,le.RunAllCellsAbove,le.DebugCell],n.DefaultDebuggingLenses=[le.DebugContinue,le.DebugStop,le.DebugStepOver],n.DebuggerCommands=[le.DebugContinue,le.DebugStop,le.DebugStepOver]))(Mu||(Mu={}));var gr;(N=>(N.HasCodeCells="jupyter.hascodecells",N.IsInteractiveActive="jupyter.isinteractiveactive",N.OwnsSelection="jupyter.ownsSelection",N.HaveNativeCells="jupyter.havenativecells",N.HaveNative="jupyter.havenative",N.IsNativeActive="jupyter.isnativeactive",N.IsInteractiveOrNativeActive="jupyter.isinteractiveornativeactive",N.IsPythonOrNativeActive="jupyter.ispythonornativeactive",N.IsPythonOrInteractiveActive="jupyter.ispythonorinteractiveeactive",N.IsPythonOrInteractiveOrNativeActive="jupyter.ispythonorinteractiveornativeeactive",N.CanRestartNotebookKernel="jupyter.notebookeditor.canrestartNotebookkernel",N.CanInterruptNotebookKernel="jupyter.notebookeditor.canInterruptNotebookKernel",N.CanRestartInteractiveWindowKernel="jupyter.interactive.canRestartNotebookKernel",N.CanInterruptInteractiveWindowKernel="jupyter.interactive.canInterruptNotebookKernel",N.RunByLineCells="jupyter.notebookeditor.runByLineCells",N.RunByLineDocuments="jupyter.notebookeditor.runByLineDocuments",N.DebugDocuments="jupyter.notebookeditor.debugDocuments",N.IsPythonNotebook="jupyter.ispythonnotebook",N.IsJupyterKernelSelected="jupyter.kernel.isjupyter",N.IsDataViewerActive="jupyter.dataViewerActive",N.HasNativeNotebookOrInteractiveWindowOpen="jupyter.hasNativeNotebookOrInteractiveWindowOpen",N.ZmqAvailable="jupyter.zmqavailable",N.ReplayLogLoaded="jupyter.replayLogLoaded",N.KernelSource="jupyter.kernelSource"))(gr||(gr={}));var VE;(l=>(l.PythonCellMarker=/^(#\s*%%|#\s*\<codecell\>|#\s*In\[\d*?\]|#\s*In\[ \])/,l.PythonMarkdownCellMarker=/^(#\s*%%\s*\[markdown\]|#\s*\<markdowncell\>)/,l.UrlPatternRegEx="(?<PREFIX>https?:\\/\\/)((\\(.+\\s+or\\s+(?<IP>.+)\\))|(?<LOCAL>[^\\s]+))(?<REST>:.+)",l.HttpPattern=/https?:\/\//,l.ShapeSplitterRegEx=/.*,\s*(\d+).*/,l.SvgHeightRegex=/(\<svg.*height=\")(.*?)\"/,l.SvgWidthRegex=/(\<svg.*width=\")(.*?)\"/,l.SvgSizeTagRegex=/\<svg.*tag=\"sizeTag=\{(.*),\s*(.*)\}\"/))(VE||(VE={}));var cDe=Symbol("DataScienceStartupTime"),mL={major:4,minor:2},uo="application/vnd.jupyter.widget-view+json";var HE=7,hD="unknown";p();p();p();var ine=new Map;function SB(){return ine}p();p();p();var _B=Symbol("MicrotaskDelay");async function nc(r){return new Promise(e=>{setTimeout(()=>e(r),r)})}async function vD(r,e,t){return new Promise(n=>{let i,o=setTimeout(()=>i(!1),e),s=setInterval(()=>{r().then(a=>{a&&i(!0)}).catch(a=>i(!1))},t);i=a=>{clearTimeout(o),clearInterval(s),n(a)}})}function po(r,e,...t){let n=gD(e)?void 0:e;gD(e)&&t.push(e);let i,o=setTimeout(()=>i==null?void 0:i(n),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(o)),new Promise(s=>i=s)])}function Gv(r,e,...t){let n,i=setTimeout(()=>n==null?void 0:n(e),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(i)),new Promise((o,s)=>n=s)])}function Yv(r){return typeof(r==null?void 0:r.then)=="function"&&typeof(r==null?void 0:r.catch)=="function"}function gD(r){return typeof(r==null?void 0:r.then)=="function"}var hL=class{constructor(e=null){this.scope=e;this._resolved=!1;this._rejected=!1;this._promise=new Promise((t,n)=>{this._resolve=t,this._reject=n})}get value(){return this._value}resolve(e){this._value=e,this._resolve.apply(this.scope?this.scope:this,arguments),this._resolved=!0}reject(e){this._reject.apply(this.scope?this.scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}};function Re(r=null){return new hL(r)}function La(r){let e=Re();return r.then(e.resolve.bind(e)).catch(e.reject.bind(e)),e}var Jv=class{constructor(){this.currentPromise=Promise.resolve(void 0)}async chain(e){let t=Re(),n=this.currentPromise;return this.currentPromise=this.currentPromise.then(async()=>{try{let i=await e();t.resolve(i)}catch(i){throw t.reject(i),i}}),await n,t.promise}chainFinally(e){let t=Re();return this.currentPromise=this.currentPromise.finally(()=>e().then(n=>t.resolve(n)).catch(n=>t.reject(n))),t.promise}};var one=(r,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},r);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},sne=r=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,r())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},rc=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,o)=>{this.doResolve=i,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}),this.completionPromise.catch(E));let n=()=>{var i;this.deferred=null,(i=this.doResolve)==null||i.call(this,null)};return this.deferred=t===_B?sne(n):one(t,n),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new Error("Canceled")),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}};function E(){}function zs(r){try{let e=r();Yv(e)&&e.catch(E)}catch(e){}}function ui(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function CB(r){let e=ui(r)?r:r.uri;return e.scheme.includes(ec)||e.path.endsWith(".interactive")}function ic(){return process.platform.toString()==="web"}function EB(r,e){return ui(e)?e.toString():e}function wB(r,e){return r===e?!0:r&&!e||!r&&e?!1:JSON.stringify(r,EB)===JSON.stringify(e,EB)}p();var yt=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}};var KDe=SB();function gn(r){return function(e,t,n){let i=n.value,o=`Jupyter Extension (Error in ${r||t}, method:${t}):`;n.value=function(...s){try{let a=i.apply(this,s);if(a&&typeof a.then=="function"&&typeof a.catch=="function")return a.catch(l=>{hn()||C.error(o,l)})}catch(a){if(hn())return;C.error(o,a)}}}}function ane(r,e,t){let n=new yt;try{t&&r(void 0);let i=e();return Yv(i)?i.then(o=>(r({elapsed:n.elapsedTime,returnValue:o}),o)).catch(o=>{r({elapsed:n.elapsedTime,err:o})}):r({elapsed:n.elapsedTime,returnValue:i}),i}catch(i){throw r({elapsed:n.elapsedTime,err:i}),i}}function xB(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a={kind:"Class",name:t&&t.constructor?t.constructor.name:"",args:s,methodName:n,target:t},l=this;return ane(u=>r(a,u),()=>o.apply(l,s),e)},i}}function $v(){return function(r,e,t){let n=t.value;return t.value=function(...i){if(!hn())throw new Error(`Function: ${e} can only be called from test code`);return n.apply(this,i)},t}}function gL(){return function(r,e,t){let n=t.value,i=`chainedPromiseFor_${e}`;return t.value=async function(...o){let s=this[i];s?s=s.then(()=>n.apply(this,o)):s=n.apply(this,o),this[i]=s;let a=s.then(l=>l).catch(l=>{throw this[i]=void 0,l});return a.catch(E),a},t}}p();function vL(r,e){if(Array.isArray(r))return r.map(t=>vL(t,e)).join(", ");if(r===void 0)return"undefined";if(r===null)return"null";try{return r&&r.path?`<Uri:${r.path}>`:JSON.stringify(r)}catch(t){return`<${e} cannot be serialized for logging>`}}function yL(r){if(!r)return"";try{return r.map((t,n)=>{let i=vL(t,"argument");return`Arg ${n+1}: ${i}`}).join(", ")}catch(e){return""}}function PB(r){return`Return Value: ${vL(r,"Return value")}`}function yD(){let r=new Date,e=String(r.getHours()).padStart(2,"0"),t=String(r.getMinutes()).padStart(2,"0"),n=String(r.getSeconds()).padStart(2,"0"),i=String(r.getMilliseconds()).padStart(3,"0");return`${e}:${t}:${n}.${i}`}p();function lt(r,e={removeEmptyEntries:!0,trim:!0}){r=r||"";let t=r.split(/\r?\n/g);return e&&e.trim&&(t=t.map(n=>n.trim())),e&&e.removeEmptyEntries&&(t=t.filter(n=>n.length>0)),t}function lne(r){return r&&(r.indexOf(" ")>=0&&!r.startsWith('"')&&!r.endsWith('"')?`"${r}"`:r.toString())}function bL(r){return r&&lne(r).replace(/\\/g,"/")}function qE(r){return r&&r.replace(/(^['"])|(['"]$)/g,"")}function zv(r){return r?r.replace(/\$\([a-z0-9\-]+?\)/gi,"").trim():r||""}function Qv(r){let e=r.split(`
`),t=e.find(n=>n.trim().length>0&&!n.trim().startsWith("#"));if(t){let n=t.match(/^\s*/)[0];return e.map(i=>i.startsWith(n)?i.replace(n,""):i).join(`
`)}return r}p();var DL=require("vscode");p();p();p();var ID="en",_D=!1,ED=!1,JE=!1,cne=!1,une=!1,SL=!1,dne=!1,pne=!1,fne=!1,bD,SD=ID,mne,bp,Qs=typeof self=="object"?self:{},Rn;typeof Qs.vscode!="undefined"&&typeof Qs.vscode.process!="undefined"?Rn=Qs.vscode.process:typeof process!="undefined"&&(Rn=process);var TB,kB=typeof((TB=Rn==null?void 0:Rn.versions)==null?void 0:TB.electron)=="string",NB=kB&&(Rn==null?void 0:Rn.type)==="renderer",HDe=NB&&(Rn==null?void 0:Rn.sandboxed);if(typeof navigator=="object"&&!NB)bp=navigator.userAgent,_D=bp.indexOf("Windows")>=0,ED=bp.indexOf("Macintosh")>=0,pne=(bp.indexOf("Macintosh")>=0||bp.indexOf("iPad")>=0||bp.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,JE=bp.indexOf("Linux")>=0,SL=!0,bD=navigator.language,SD=bD;else if(typeof Rn=="object"){_D=Rn.platform==="win32",ED=Rn.platform==="darwin",JE=Rn.platform==="linux",cne=JE&&!!Rn.env.SNAP&&!!Rn.env.SNAP_REVISION,dne=kB,fne=!!Rn.env.CI||!!Rn.env.BUILD_ARTIFACTSTAGINGDIRECTORY,bD=ID,SD=ID;let r=Rn.env.VSCODE_NLS_CONFIG;if(r)try{let e=JSON.parse(r),t=e.availableLanguages["*"];bD=e.locale,SD=t||ID,mne=e._translationsConfigFile}catch(e){}une=!0}else console.error("Unable to resolve platform.");var IL=0;ED?IL=1:_D?IL=3:JE&&(IL=2);var GE=_D,RB=ED,AB=JE;var CD=SL,qDe=SL&&typeof Qs.importScripts=="function";var oc=bp,yp=SD,DB;(n=>{function r(){return yp}n.value=r;function e(){return yp.length===2?yp==="en":yp.length>=3?yp[0]==="e"&&yp[1]==="n"&&yp[2]==="-":!1}n.isDefaultVariant=e;function t(){return yp==="en"}n.isDefault=t})(DB||(DB={}));var JDe=(()=>{if(typeof Qs.postMessage=="function"&&!Qs.importScripts){let r=[];Qs.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=r.length;n<i;n++){let o=r[n];if(o.id===t.data.vscodeScheduleAsyncWork){r.splice(n,1),o.callback();return}}});let e=0;return t=>{let n=++e;r.push({id:n,callback:t}),Qs.postMessage({vscodeScheduleAsyncWork:n},"*")}}return r=>setTimeout(r)})();var hne=!!(oc&&oc.indexOf("Chrome")>=0),GDe=!!(oc&&oc.indexOf("Firefox")>=0),YDe=!!(!hne&&oc&&oc.indexOf("Safari")>=0),$De=!!(oc&&oc.indexOf("Edg/")>=0),zDe=!!(oc&&oc.indexOf("Android")>=0);var Lm;if(typeof Qs.vscode!="undefined"&&typeof Qs.vscode.process!="undefined"){let r=Qs.vscode.process;Lm={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process!="undefined"?Lm={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Lm={get platform(){return GE?"win32":RB?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var wD=Lm.cwd,MB=Lm.env,Ko=Lm.platform,tTe=Lm.arch;var vne=65,yne=97,bne=90,Ine=122,_p=46,di=47,Fo=92,Ip=58,Sne=63,xD=class extends Error{constructor(t,n,i){let o;typeof n=="string"&&n.indexOf("not ")===0?(o="must not be",n=n.replace(/^not /,"")):o="must be";let s=t.indexOf(".")!==-1?"property":"argument",a=`The "${t}" ${s} ${o} of type ${n}`;a+=`. Received type ${typeof i}`;super(a);this.code="ERR_INVALID_ARG_TYPE"}};function vn(r,e){if(typeof r!="string")throw new xD(e,"string",r)}function Dt(r){return r===di||r===Fo}function _L(r){return r===di}function Sp(r){return r>=vne&&r<=bne||r>=yne&&r<=Ine}function PD(r,e,t,n){let i="",o=0,s=-1,a=0,l=0;for(let u=0;u<=r.length;++u){if(u<r.length)l=r.charCodeAt(u);else{if(n(l))break;l=di}if(n(l)){if(!(s===u-1||a===1))if(a===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==_p||i.charCodeAt(i.length-2)!==_p){if(i.length>2){let c=i.lastIndexOf(t);c===-1?(i="",o=0):(i=i.slice(0,c),o=i.length-1-i.lastIndexOf(t)),s=u,a=0;continue}else if(i.length!==0){i="",o=0,s=u,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",o=2)}else i.length>0?i+=`${t}${r.slice(s+1,u)}`:i=r.slice(s+1,u),o=u-s-1;s=u,a=0}else l===_p&&a!==-1?++a:a=-1}return i}function OB(r,e){if(e===null||typeof e!="object")throw new xD("pathObject","Object",e);let t=e.dir||e.root,n=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${n}`:`${t}${r}${n}`:n}var An={resolve(...r){let e="",t="",n=!1;for(let i=r.length-1;i>=-1;i--){let o;if(i>=0){if(o=r[i],vn(o,"path"),o.length===0)continue}else e.length===0?o=wD():(o=MB[`=${e}`]||wD(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Fo)&&(o=`${e}\\`));let s=o.length,a=0,l="",u=!1,c=o.charCodeAt(0);if(s===1)Dt(c)&&(a=1,u=!0);else if(Dt(c))if(u=!0,Dt(o.charCodeAt(1))){let d=2,f=d;for(;d<s&&!Dt(o.charCodeAt(d));)d++;if(d<s&&d!==f){let m=o.slice(f,d);for(f=d;d<s&&Dt(o.charCodeAt(d));)d++;if(d<s&&d!==f){for(f=d;d<s&&!Dt(o.charCodeAt(d));)d++;(d===s||d!==f)&&(l=`\\\\${m}\\${o.slice(f,d)}`,a=d)}}}else a=1;else Sp(c)&&o.charCodeAt(1)===Ip&&(l=o.slice(0,2),a=2,s>2&&Dt(o.charCodeAt(2))&&(u=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,n=u,u&&e.length>0)break}return t=PD(t,!n,"\\",Dt),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){vn(r,"path");let e=r.length;if(e===0)return".";let t=0,n,i=!1,o=r.charCodeAt(0);if(e===1)return _L(o)?"\\":r;if(Dt(o))if(i=!0,Dt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){let u=r.slice(l,a);for(l=a;a<e&&Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Dt(r.charCodeAt(a));)a++;if(a===e)return`\\\\${u}\\${r.slice(l)}\\`;a!==l&&(n=`\\\\${u}\\${r.slice(l,a)}`,t=a)}}}else t=1;else Sp(o)&&r.charCodeAt(1)===Ip&&(n=r.slice(0,2),t=2,e>2&&Dt(r.charCodeAt(2))&&(i=!0,t=3));let s=t<e?PD(r.slice(t),!i,"\\",Dt):"";return s.length===0&&!i&&(s="."),s.length>0&&Dt(r.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(r){vn(r,"path");let e=r.length;if(e===0)return!1;let t=r.charCodeAt(0);return Dt(t)||e>2&&Sp(t)&&r.charCodeAt(1)===Ip&&Dt(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let o=0;o<r.length;++o){let s=r[o];vn(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&Dt(t.charCodeAt(0))){++i;let o=t.length;o>1&&Dt(t.charCodeAt(1))&&(++i,o>2&&(Dt(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&Dt(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return An.normalize(e)},relative(r,e){if(vn(r,"from"),vn(e,"to"),r===e)return"";let t=An.resolve(r),n=An.resolve(e);if(t===n||(r=t.toLowerCase(),e=n.toLowerCase(),r===e))return"";let i=0;for(;i<r.length&&r.charCodeAt(i)===Fo;)i++;let o=r.length;for(;o-1>i&&r.charCodeAt(o-1)===Fo;)o--;let s=o-i,a=0;for(;a<e.length&&e.charCodeAt(a)===Fo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Fo;)l--;let u=l-a,c=s<u?s:u,d=-1,f=0;for(;f<c;f++){let g=r.charCodeAt(i+f);if(g!==e.charCodeAt(a+f))break;g===Fo&&(d=f)}if(f!==c){if(d===-1)return n}else{if(u>c){if(e.charCodeAt(a+f)===Fo)return n.slice(a+f+1);if(f===2)return n.slice(a+f)}s>c&&(r.charCodeAt(i+f)===Fo?d=f:f===2&&(d=3)),d===-1&&(d=0)}let m="";for(f=i+d+1;f<=o;++f)(f===o||r.charCodeAt(f)===Fo)&&(m+=m.length===0?"..":"\\..");return a+=d,m.length>0?`${m}${n.slice(a,l)}`:(n.charCodeAt(a)===Fo&&++a,n.slice(a,l))},toNamespacedPath(r){if(typeof r!="string")return r;if(r.length===0)return"";let e=An.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===Fo){if(e.charCodeAt(1)===Fo){let t=e.charCodeAt(2);if(t!==Sne&&t!==_p)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Sp(e.charCodeAt(0))&&e.charCodeAt(1)===Ip&&e.charCodeAt(2)===Fo)return`\\\\?\\${e}`;return r},dirname(r){vn(r,"path");let e=r.length;if(e===0)return".";let t=-1,n=0,i=r.charCodeAt(0);if(e===1)return Dt(i)?r:".";if(Dt(i)){if(t=n=1,Dt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Dt(r.charCodeAt(a));)a++;if(a===e)return r;a!==l&&(t=n=a+1)}}}}else Sp(i)&&r.charCodeAt(1)===Ip&&(t=e>2&&Dt(r.charCodeAt(2))?3:2,n=t);let o=-1,s=!0;for(let a=e-1;a>=n;--a)if(Dt(r.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(t===-1)return".";o=t}return r.slice(0,o)},basename(r,e){e!==void 0&&vn(e,"ext"),vn(r,"path");let t=0,n=-1,i=!0,o;if(r.length>=2&&Sp(r.charCodeAt(0))&&r.charCodeAt(1)===Ip&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=t;--o){let l=r.charCodeAt(o);if(Dt(l)){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=t;--o)if(Dt(r.charCodeAt(o))){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){vn(r,"path");let e=0,t=-1,n=0,i=-1,o=!0,s=0;r.length>=2&&r.charCodeAt(1)===Ip&&Sp(r.charCodeAt(0))&&(e=n=2);for(let a=r.length-1;a>=e;--a){let l=r.charCodeAt(a);if(Dt(l)){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===_p?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":r.slice(t,i)},format:OB.bind(null,"\\"),parse(r){vn(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.length,n=0,i=r.charCodeAt(0);if(t===1)return Dt(i)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(Dt(i)){if(n=1,Dt(r.charCodeAt(1))){let d=2,f=d;for(;d<t&&!Dt(r.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&Dt(r.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&!Dt(r.charCodeAt(d));)d++;d===t?n=d:d!==f&&(n=d+1)}}}}else if(Sp(i)&&r.charCodeAt(1)===Ip){if(t<=2)return e.root=e.dir=r,e;if(n=2,Dt(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;n=3}}n>0&&(e.root=r.slice(0,n));let o=-1,s=n,a=-1,l=!0,u=r.length-1,c=0;for(;u>=n;--u){if(i=r.charCodeAt(u),Dt(i)){if(!l){s=u+1;break}continue}a===-1&&(l=!1,a=u+1),i===_p?o===-1?o=u:c!==1&&(c=1):o!==-1&&(c=-1)}return a!==-1&&(o===-1||c===0||c===1&&o===a-1&&o===s+1?e.base=e.name=r.slice(s,a):(e.name=r.slice(s,o),e.base=r.slice(s,a),e.ext=r.slice(o,a))),s>0&&s!==n?e.dir=r.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},Sr={resolve(...r){let e="",t=!1;for(let n=r.length-1;n>=-1&&!t;n--){let i=n>=0?r[n]:wD();vn(i,"path"),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===di)}return e=PD(e,!t,"/",_L),t?`/${e}`:e.length>0?e:"."},normalize(r){if(vn(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===di,t=r.charCodeAt(r.length-1)===di;return r=PD(r,!e,"/",_L),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return vn(r,"path"),r.length>0&&r.charCodeAt(0)===di},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){let n=r[t];vn(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":Sr.normalize(e)},relative(r,e){if(vn(r,"from"),vn(e,"to"),r===e||(r=Sr.resolve(r),e=Sr.resolve(e),r===e))return"";let t=1,n=r.length,i=n-t,o=1,s=e.length-o,a=i<s?i:s,l=-1,u=0;for(;u<a;u++){let d=r.charCodeAt(t+u);if(d!==e.charCodeAt(o+u))break;d===di&&(l=u)}if(u===a)if(s>a){if(e.charCodeAt(o+u)===di)return e.slice(o+u+1);if(u===0)return e.slice(o+u)}else i>a&&(r.charCodeAt(t+u)===di?l=u:u===0&&(l=0));let c="";for(u=t+l+1;u<=n;++u)(u===n||r.charCodeAt(u)===di)&&(c+=c.length===0?"..":"/..");return`${c}${e.slice(o+l)}`},toNamespacedPath(r){return r},dirname(r){if(vn(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===di,t=-1,n=!0;for(let i=r.length-1;i>=1;--i)if(r.charCodeAt(i)===di){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&vn(e,"ext"),vn(r,"path");let t=0,n=-1,i=!0,o;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===di){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===di){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){vn(r,"path");let e=-1,t=0,n=-1,i=!0,o=0;for(let s=r.length-1;s>=0;--s){let a=r.charCodeAt(s);if(a===di){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===_p?e===-1?e=s:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===t+1?"":r.slice(e,n)},format:OB.bind(null,"/"),parse(r){vn(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.charCodeAt(0)===di,n;t?(e.root="/",n=1):n=0;let i=-1,o=0,s=-1,a=!0,l=r.length-1,u=0;for(;l>=n;--l){let c=r.charCodeAt(l);if(c===di){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===_p?i===-1?i=l:u!==1&&(u=1):i!==-1&&(u=-1)}if(s!==-1){let c=o===0&&t?1:o;i===-1||u===0||u===1&&i===s-1&&i===o+1?e.base=e.name=r.slice(c,s):(e.name=r.slice(c,i),e.base=r.slice(c,s),e.ext=r.slice(i,s))}return o>0?e.dir=r.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Sr.win32=An.win32=An;Sr.posix=An.posix=Sr;var Is=Ko==="win32"?An.normalize:Sr.normalize,nTe=Ko==="win32"?An.isAbsolute:Sr.isAbsolute,YE=Ko==="win32"?An.join:Sr.join,LB=Ko==="win32"?An.resolve:Sr.resolve,KB=Ko==="win32"?An.relative:Sr.relative,Ci=Ko==="win32"?An.dirname:Sr.dirname,Ht=Ko==="win32"?An.basename:Sr.basename,Ep=Ko==="win32"?An.extname:Sr.extname,iTe=Ko==="win32"?An.format:Sr.format,oTe=Ko==="win32"?An.parse:Sr.parse,sTe=Ko==="win32"?An.toNamespacedPath:Sr.toNamespacedPath,Ki=Ko==="win32"?An.sep:Sr.sep,aTe=Ko==="win32"?An.delimiter:Sr.delimiter;p();var zE=require("vscode");p();p();p();p();var _ne=require("vscode");var DD=class{constructor(e){this.computeFn=e;this.lastCache=void 0;this.lastArgKey=void 0}get(e){let t=JSON.stringify(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this.computeFn(e)),this.lastCache}};p();var $E=class r{constructor(e){this.executor=e;this._didRun=!1}hasValue(){return this._didRun}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}map(e){return new r(()=>e(this.getValue()))}};function jB(r,e){return r<e?-1:r>e?1:0}function Ene(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),u=e.charCodeAt(i);if(l<u)return-1;if(l>u)return 1}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function BB(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),u=e.charCodeAt(i);if(l===u)continue;if(l>=128||u>=128)return Ene(r.toLowerCase(),e.toLowerCase(),t,n,i,o);FB(l)&&(l-=32),FB(u)&&(u-=32);let c=l-u;if(c!==0)return c}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function FB(r){return r>=97&&r<=122}function HB(r,e){return r.length===e.length&&BB(r,e)===0}function qB(r,e){let t=e.length;return e.length>r.length?!1:BB(r,e,0,t)===0}var sc=class sc{constructor(e){this.confusableDictionary=e}static getInstance(e){return sc.cache.get(Array.from(e))}static getLocales(){return sc._locales.getValue()}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};sc.ambiguousCharacterData=new $E(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')),sc.cache=new DD(e=>{function t(c){let d=new Map;for(let f=0;f<c.length;f+=2)d.set(c[f],c[f+1]);return d}function n(c,d){let f=new Map(c);for(let[m,g]of d)f.set(m,g);return f}function i(c,d){if(!c)return d;let f=new Map;for(let[m,g]of c)d.has(m)&&f.set(m,g);return f}let o=sc.ambiguousCharacterData.getValue(),s=e.filter(c=>!c.startsWith("_")&&c in o);s.length===0&&(s=["_default"]);let a;for(let c of s){let d=t(o[c]);a=i(a,d)}let l=t(o._common),u=n(l,a);return new sc(u)}),sc._locales=new $E(()=>Object.keys(sc.ambiguousCharacterData.getValue()).filter(e=>!e.startsWith("_")));var UB=sc,Xv=class Xv{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(Xv.getRawData())),this._data}static isInvisibleCharacter(e){return Xv.getData().has(e)}static get codePoints(){return Xv.getData()}};Xv._data=void 0;var WB=Xv;function Cp(r){return r===47||r===92}function EL(r){return r.replace(/[\\/]/g,Sr.sep)}function JB(r){return r.indexOf("/")===-1&&(r=EL(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function CL(r,e=Sr.sep){if(!r)return"";let t=r.length,n=r.charCodeAt(0);if(Cp(n)){if(Cp(r.charCodeAt(1))&&!Cp(r.charCodeAt(2))){let o=3,s=o;for(;o<t&&!Cp(r.charCodeAt(o));o++);if(s!==o&&!Cp(r.charCodeAt(o+1))){for(o+=1;o<t;o++)if(Cp(r.charCodeAt(o)))return r.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(Cne(n)&&r.charCodeAt(1)===58)return Cp(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let i=r.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(Cp(r.charCodeAt(i)))return r.slice(0,i+1)}return""}function wL(r,e,t,n=Ki){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!qB(r,e))return!1;if(e.length===r.length)return!0;let o=e.length;return e.charAt(e.length-1)===n&&o--,r.charAt(o)===n}return e.charAt(e.length-1)!==n&&(e+=n),r.indexOf(e)===0}function Cne(r){return r>=65&&r<=90||r>=97&&r<=122}p();var Ka;(Y=>(Y.inMemory="inmemory",Y.vscode="vscode",Y.internal="private",Y.walkThrough="walkThrough",Y.walkThroughSnippet="walkThroughSnippet",Y.http="http",Y.https="https",Y.file="file",Y.mailto="mailto",Y.untitled="untitled",Y.data="data",Y.command="command",Y.vscodeRemote="vscode-remote",Y.vscodeRemoteResource="vscode-remote-resource",Y.vscodeUserData="vscode-userdata",Y.vscodeCustomEditor="vscode-custom-editor",Y.vscodeNotebook="vscode-notebook",Y.vscodeNotebookCell="vscode-notebook-cell",Y.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",Y.vscodeNotebookCellOutput="vscode-notebook-cell-output",Y.vscodeInteractive="vscode-interactive",Y.vscodeInteractiveInput="vscode-interactive-input",Y.vscodeSettings="vscode-settings",Y.vscodeWorkspaceTrust="vscode-workspace-trust",Y.vscodeTerminal="vscode-terminal",Y.webviewPanel="webview-panel",Y.vscodeWebview="vscode-webview",Y.extension="extension",Y.vscodeFileResource="vscode-file",Y.tmp="tmp",Y.vsls="vsls"))(Ka||(Ka={}));function Fa(r){return CD?(r==null?void 0:r.path)||"":(r==null?void 0:r.fsPath)||""}var QE=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:jB(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1,i=GE?"\\":"/"){if(e.scheme===t.scheme){if(e.scheme===Ka.file)return wL(Fa(e),Fa(t),this._ignorePathCasing(e),i)&&e.query===t.query&&(n||e.fragment===t.fragment);if(GB(e.authority,t.authority))return wL(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return zE.Uri.joinPath(e,...t)}basenameOrAuthority(e){return pi(e)||e.authority}basename(e,t){return Sr.basename(e.path,t)}extname(e){return Sr.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Ka.file?t=zE.Uri.file(Ci(Fa(e))).path:(t=Sr.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Ka.file?t=zE.Uri.file(Is(Fa(e))).path:t=Sr.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!GB(e.authority,t.authority))return;if(e.scheme===Ka.file){let o=KB(Fa(e),Fa(t));return GE?EL(o):o}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(let s=Math.min(n.length,i.length);o<s&&!(n.charCodeAt(o)!==i.charCodeAt(o)&&n.charAt(o).toLowerCase()!==i.charAt(o).toLowerCase());o++);n=i.substr(0,o)+n.substr(o)}return Sr.relative(n,i)}resolvePath(e,t){if(e.scheme===Ka.file){let n=zE.Uri.file(LB(Fa(e),t));return e.with({authority:n.authority,path:n.path})}return t=JB(t),e.with({path:Sr.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&HB(e,t)}hasTrailingPathSeparator(e,t=Ki){if(e.scheme===Ka.file){let n=Fa(e);return n.length>CL(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Ki){return YB(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Ki){let n=!1;if(e.scheme===Ka.file){let i=Fa(e);n=i!==void 0&&i.length===CL(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!YB(e,t)?e.with({path:e.path+"/"}):e}},ar=new QE(()=>!1),RTe=new QE(r=>r.scheme===Ka.file?!AB:!0),ATe=new QE(r=>!0),Xs=ar.isEqual.bind(ar),TD=ar.isEqualOrParent.bind(ar),Ua=ar.getComparisonKey.bind(ar),MTe=ar.basenameOrAuthority.bind(ar),pi=ar.basename.bind(ar),Zv=ar.extname.bind(ar),Km=ar.dirname.bind(ar),Fi=ar.joinPath.bind(ar),OTe=ar.normalizePath.bind(ar),xL=ar.relativePath.bind(ar),LTe=ar.resolvePath.bind(ar),KTe=ar.isAbsolutePath.bind(ar),GB=ar.isEqualAuthority.bind(ar),YB=ar.hasTrailingPathSeparator.bind(ar),FTe=ar.removeTrailingPathSeparator.bind(ar),UTe=ar.addTrailingPathSeparator.bind(ar),$B;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[d,f]=c.split(":");d&&f&&a.set(d,f)});let u=s.path.substring(0,s.path.indexOf(";"));return u&&a.set(o.META_DATA_MIME,u),a}o.parseMetaData=i})($B||($B={}));p();function xi(r=process.platform){return/^win/.test(r)?"Windows":/^darwin/.test(r)?"OSX":/^linux/.test(r)?"Linux":"Unknown"}function kD(r,e){return r.replace(/^~(?=$|\/|\\)/,e)}function xne(){if(!ic())return DL.Uri.file(require("os").homedir())}function ct(r){let e=xi()==="Windows";if(r){let t=Fa(r);return t&&t.startsWith(Ki)&&t.length>1&&t[1]!==Ki&&e?t.slice(1):t||""}return""}function Ee(r,e=[],t){t=t||xne();let n;typeof r=="string"&&(n=DL.Uri.file(r)),typeof r!="string"&&(n=r);let i=PL(n,void 0,t),o=e.find(l=>n&&TD(n,l.uri,!0));if(e.length>1&&o)return`${o.name}${Ki}${PL(n,o.uri,t)}`;let s=o?[PL(n,o.uri,t)]:[],a=i;return[i,...s].forEach(l=>{l.length<a.length&&(a=l)}),a}function PL(r,e,t){let n=xi()==="Windows";if(r&&e&&TD(r,e,!0)){let i=xL(e,r);if(i)return n?i.replace(/\//g,"\\"):i}if(r&&t&&TD(r,t,!0)){let i=xL(t,r);if(i)return i=n?i.replace(/\//g,"\\"):i,`~${Ki}${i}`}return ct(r)}p();p();var ND=class{constructor(){this.event=(e,t,n)=>{let i=this.add(t?e.bind(t):e);return n==null||n.push(i),i}}get size(){return this.listeners?typeof this.listeners=="function"?1:this.listeners.length:0}fire(e){if(this.listeners)if(typeof this.listeners=="function")this.listeners(e);else for(let t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?typeof this.listeners=="function"?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if(typeof this.listeners=="function"){this.listeners===e&&(this.listeners=void 0);return}let t=this.listeners.indexOf(e);t!==-1&&(this.listeners.length===2?this.listeners=t===0?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}};p();function lr(r){let e=this,t=!1,n;return function(){return t||(t=!0,n=r.apply(e,arguments)),n}}p();var RD;(v=>{function r(k){return k&&typeof k=="object"&&typeof k[Symbol.iterator]=="function"}v.is=r;let e=Object.freeze([]);function t(){return e}v.empty=t;function*n(k){yield k}v.single=n;function i(k){return r(k)?k:n(k)}v.wrap=i;function o(k){return k||e}v.from=o;function s(k){return!k||k[Symbol.iterator]().next().done===!0}v.isEmpty=s;function a(k){return k[Symbol.iterator]().next().value}v.first=a;function l(k,R){for(let P of k)if(R(P))return!0;return!1}v.some=l;function u(k,R){for(let P of k)if(R(P))return P}v.find=u;function*c(k,R){for(let P of k)R(P)&&(yield P)}v.filter=c;function*d(k,R){let P=0;for(let D of k)yield R(D,P++)}v.map=d;function*f(...k){for(let R of k)for(let P of R)yield P}v.concat=f;function m(k,R,P){let D=P;for(let K of k)D=R(D,K);return D}v.reduce=m;function*g(k,R,P=k.length){for(R<0&&(R+=k.length),P<0?P+=k.length:P>k.length&&(P=k.length);R<P;R++)yield k[R]}v.slice=g;function b(k,R=Number.POSITIVE_INFINITY){let P=[];if(R===0)return[P,k];let D=k[Symbol.iterator]();for(let K=0;K<R;K++){let L=D.next();if(L.done)return[P,v.empty()];P.push(L.value)}return[P,{[Symbol.iterator](){return D}}]}v.consume=b})(RD||(RD={}));var AD;function QB(r){AD=r}function Ou(r){return AD==null||AD.push(r),r}function Ce(r){if(RD.is(r)){for(let e of r)if(e)try{e.dispose()}catch(t){console.warn(`dispose() failed for ${e}`,t)}return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}var OD=class OD{constructor(...e){this._toDispose=new Set;this._isDisposed=!1;e.forEach(t=>this.add(t)),Ou(this)}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Ce(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?OD.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}};OD.DISABLE_DISPOSED_WARNING=!1;var En=OD,Pr=class{constructor(...e){this._store=new En;this._isDisposed=!1;e.forEach(t=>this._store.add(t)),Ou(this)}get isDisposed(){return this._isDisposed}dispose(){this._store.dispose(),this._isDisposed=!0}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},ac=class extends Pr{constructor(){super();this._onDidDispose=new ND,this.onDidDispose=this._onDidDispose.event}dispose(){super.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose()}};var zB=class{constructor(){this._store=new Map;this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Ce(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get(e){return this._store.get(e)}set(e,t,n=!1){var i;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||(i=this._store.get(e))==null||i.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var MD=class{constructor(){this.references=new Map}acquire(e,...t){let n=this.references.get(e);n||(n={counter:0,object:this.createReferencedObject(e,...t)},this.references.set(e,n));let{object:i}=n,o=lr(()=>{n&&--n.counter===0&&(this.destroyReferencedObject(e,n.object),this.references.delete(e))});return n.counter++,{object:i,dispose:o}}};p();var V=require("vscode");p();var et=require("vscode"),TL=60,kL=TL*60,XE=kL*24,XB=XE*7,ZB=XE*30,eH=XE*365;function ey(r,e,t,n){typeof r!="number"&&(r=r.getTime());let i=Math.round((new Date().getTime()-r)/1e3);if(i<-30)return et.l10n.t("in {0}",ey(new Date().getTime()+i*1e3,!1));if(!n&&i<30)return et.l10n.t("now");let o;return i<TL?(o=i,e?o===1?t?et.l10n.t("{0} second ago",o):et.l10n.t("{0} sec ago",o):t?et.l10n.t("{0} seconds ago",o):et.l10n.t("{0} secs ago",o):o===1?t?et.l10n.t("{0} second",o):et.l10n.t("{0} sec",o):t?et.l10n.t("{0} seconds",o):et.l10n.t("{0} secs",o)):i<kL?(o=Math.floor(i/TL),e?o===1?t?et.l10n.t("{0} minute ago",o):et.l10n.t("{0} min ago",o):t?et.l10n.t("{0} minutes ago",o):et.l10n.t("{0} mins ago",o):o===1?t?et.l10n.t("{0} minute",o):et.l10n.t("{0} min",o):t?et.l10n.t("{0} minutes",o):et.l10n.t("{0} mins",o)):i<XE?(o=Math.floor(i/kL),e?o===1?t?et.l10n.t("{0} hour ago",o):et.l10n.t("{0} hr ago",o):t?et.l10n.t("{0} hours ago",o):et.l10n.t("{0} hrs ago",o):o===1?t?et.l10n.t("{0} hour",o):et.l10n.t("{0} hr",o):t?et.l10n.t("{0} hours",o):et.l10n.t("{0} hrs",o)):i<XB?(o=Math.floor(i/XE),e?o===1?et.l10n.t("{0} day ago",o):et.l10n.t("{0} days ago",o):o===1?et.l10n.t("{0} day",o):et.l10n.t("{0} days",o)):i<ZB?(o=Math.floor(i/XB),e?o===1?t?et.l10n.t("{0} week ago",o):et.l10n.t("{0} wk ago",o):t?et.l10n.t("{0} weeks ago",o):et.l10n.t("{0} wks ago",o):o===1?t?et.l10n.t("{0} week",o):et.l10n.t("{0} wk",o):t?et.l10n.t("{0} weeks",o):et.l10n.t("{0} wks",o)):i<eH?(o=Math.floor(i/ZB),e?o===1?t?et.l10n.t("{0} month ago",o):et.l10n.t("{0} mo ago",o):t?et.l10n.t("{0} months ago",o):et.l10n.t("{0} mos ago",o):o===1?t?et.l10n.t("{0} month",o):et.l10n.t("{0} mo",o):t?et.l10n.t("{0} months",o):et.l10n.t("{0} mos",o)):(o=Math.floor(i/eH),e?o===1?t?et.l10n.t("{0} year ago",o):et.l10n.t("{0} yr ago",o):t?et.l10n.t("{0} years ago",o):et.l10n.t("{0} yrs ago",o):o===1?t?et.l10n.t("{0} year",o):et.l10n.t("{0} yr",o):t?et.l10n.t("{0} years",o):et.l10n.t("{0} yrs",o))}p();p();p();p();var P7=oe(he());var ly=class{async createHash(e,t="SHA-256"){return Ba(e,t)}};ly=U([(0,P7.injectable)()],ly);var fT={},x7=!1,mT;typeof window=="object"?mT=window.crypto:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?mT=self.crypto:mT=require("node:crypto").webcrypto;async function Ba(r,e){let t=r.includes("/")||r.includes("\\")||r.endsWith(".interactive");if(t&&fT[r])return fT[r];let n=await ple(r,e);return t&&!x7&&(Object.keys(fT).length>1e4&&(x7=!0),fT[r]=n),n}async function ple(r,e){let t=new TextEncoder().encode(r),n=await mT.subtle.digest({name:e},t);return Array.from(new Uint8Array(n)).map(o=>o.toString(16).padStart(2,"0")).join("")}function cy(r){if(typeof r=="string")try{let[e,t,n]=`${r.trim()}...`.split(".").map(i=>parseInt(i,10));return isNaN(e)?"":isNaN(t)?e.toString():isNaN(n)?`${e}.${t}`:`${e}.${t}.${n}`}catch(e){return C.error(`Failed to parse version ${r}`,e),""}return r?`${r.major}.${r.minor}.${r.micro}`:""}async function Rt(r){return Ba(r,"SHA-256")}var cK=oe(D7());var iC=require("vscode");function Fu(r){var l,u,c;let e=Bi(r);if(ci&&C.ci(`Python Env Info for ${JSON.stringify(r)} is ${JSON.stringify(e)}`),e){let d=[];typeof((l=e.version)==null?void 0:l.major)=="number"&&(d.push(e.version.major.toString()),typeof e.version.minor=="number"&&(d.push(e.version.minor.toString()),typeof e.version.micro=="number"&&d.push(e.version.micro.toString())));let f=d.length?d.join("."):"",m=((u=e.environment)==null?void 0:u.name)||(e.environment?pi((c=e.environment)==null?void 0:c.folderUri):""),g=f?`Python ${f}`:"Python";return Tp(r)&&m?m:m?`${m} (${g})`:g}if(Object.keys(r).length===1&&r.id)return r.id;let t=cy(Uu(r)||"").trim(),n=Tp(r),i=t?`Python ${t}`:"Python",o=Ss(r);if(n&&o)return o;let s=[];o&&s.push(o);let a=_r(r);return a&&a!=="Unknown"&&s.push(a),[i,s.length?`(${s.join(": ")})`:""].join(" ").trim()}function Ss(r){var n,i,o;let e=Bi(r),t=(n=e==null?void 0:e.environment)==null?void 0:n.name;return!t&&((i=e==null?void 0:e.environment)!=null&&i.folderUri)&&_r(r)==="Conda"&&(t=pi((o=e==null?void 0:e.environment)==null?void 0:o.folderUri)),t}var hle=["Unknown","Conda","PipEnv","Poetry","Pyenv","Venv","VirtualEnv","VirtualEnvWrapper"];function _r(r){let e=Bi(r);return e?gle(e):"Unknown"}function gle(r){var t,n;if(((t=r.environment)==null?void 0:t.type)==="Conda")return"Conda";let e=[["Conda","Conda"],["Pyenv","Pyenv"],["Pipenv","PipEnv"],["Poetry","Poetry"],["VirtualEnvWrapper","VirtualEnvWrapper"],["VirtualEnv","VirtualEnv"],["Venv","Venv"]];for(let[i,o]of e)if(r.tools.includes(i))return o;if(((n=r.environment)==null?void 0:n.type)==="VirtualEnvironment")return"VirtualEnv";for(let i of hle)if(r.tools.some(o=>o.toLowerCase()===i.toLowerCase()))return i;return"Unknown"}var ho;function T7(r){ho=r}function Tp(r){if(!r||!ho)return!1;let e=Bi(r);return e&&_r(e)==="Conda"&&!e.executable.uri}function Bi(r){if(r){if(!ho)throw new Error("Python API not initialized");return typeof r=="string"?ho.environments.known.find(e=>{var t;return e.id===r||e.path===r||((t=e.executable.uri)==null?void 0:t.fsPath)===r}):ho.environments.known.find(e=>e.id===r.id)}}async function uK(r){var n;if(!(r!=null&&r.id))return;if(ho){let i=ho.environments.known.find(o=>o.id===r.id);if((n=i==null?void 0:i.executable)!=null&&n.sysPrefix)return i.executable.sysPrefix}let t=await(await cK.PythonExtension.api()).environments.resolveEnvironment(r.id).then(i=>{var o;return(o=i==null?void 0:i.executable)==null?void 0:o.sysPrefix});return t||C.warn(`Unable to find sysPrefix for interpreter ${Ee(r.id)}`),t}function k7(r){var t;if(!(r!=null&&r.id))return;if(!ho)throw new Error("Python API not initialized");let e=ho.environments.known.find(n=>n.id===r.id);return(t=e==null?void 0:e.executable)==null?void 0:t.sysPrefix}async function kp(r,e=!1){if(!(r!=null&&r.id))return;if(ho&&!e){let i=ho.environments.known.find(o=>o.id===r.id);if(i!=null&&i.version)return i.version}let n=await(await cK.PythonExtension.api()).environments.resolveEnvironment(r.id);return n!=null&&n.version||C.warn(`Unable to find Version for interpreter ${Ee(r.id)}`),n==null?void 0:n.version}function Uu(r){if(!(r!=null&&r.id))return;if(!ho)throw new Error("Python API not initialized");let e=ho.environments.known.find(t=>t.id===r.id);return e==null?void 0:e.version}function N7(){return ho?ho.environments.known:[]}function hT(r){var n,i;if(!r)return;let e,t=r.id;if(r.executable.uri)e=r.executable.uri;else if(_r(r)==="Conda")e=xi()==="Windows"?iC.Uri.joinPath(((n=r.environment)==null?void 0:n.folderUri)||iC.Uri.file(r.path),"python.exe"):iC.Uri.joinPath(((i=r.environment)==null?void 0:i.folderUri)||iC.Uri.file(r.path),"bin","python");else{C.warn(`Python environment ${Ee(r.id)} excluded as Uri is undefined`);return}return{id:t,uri:e}}function vle(r){return Fu(r)}var Ue;(R=>(R.bannerLabelYes=V.l10n.t("Yes"),R.bannerLabelNo=V.l10n.t("No"),R.canceled=V.l10n.t("Canceled"),R.cancel=V.l10n.t("Cancel"),R.ok=V.l10n.t("Ok"),R.refresh=V.l10n.t("Refresh"),R.refreshing=V.l10n.t("Refreshing..."),R.install=V.l10n.t("Install"),R.downloadAndInstall=V.l10n.t("Download and Install"),R.loadingExtension=V.l10n.t("Jupyter Extension loading..."),R.handleExtensionActivationError=V.l10n.t("Extension activation failed, run the 'Developer: Toggle Developer Tools' command for more information."),R.doNotShowAgain=V.l10n.t("Do not show again"),R.reload=V.l10n.t("Reload"),R.moreInfo=V.l10n.t("More Info"),R.learnMore=V.l10n.t("Learn more"),R.and=V.l10n.t("and"),R.reportThisIssue=V.l10n.t("Report this issue"),R.clickHereForMoreInfoWithHtml=P=>V.l10n.t("Click <a href='{0}'>here</a> for more info.",P)))(Ue||(Ue={}));var Np;(t=>(t.notInGroup=n=>V.l10n.t("User does not belong to experiment group '{0}'",n),t.inGroup=n=>V.l10n.t("User belongs to experiment group '{0}'",n)))(Np||(Np={}));var gT;(e=>e.jupyter=V.l10n.t("Jupyter"))(gT||(gT={}));var R7;(e=>e.currentWorkingDirectory="cwd:")(R7||(R7={}));var A7;(e=>e.bannerMessage=V.l10n.t("Would you like shift-enter to send code to the new Interactive Window experience?"))(A7||(A7={}));var M7;(e=>e.bannerMessage=V.l10n.t("Can you please take a minute to tell us about your notebooks experience in VS Code?"))(M7||(M7={}));var O7;(t=>(t.bannerLabelYes=V.l10n.t("Yes, take survey now"),t.bannerLabelNo=V.l10n.t("No, thanks")))(O7||(O7={}));var W;(J=>(J.warnWhenSelectingKernelWithUnSupportedPythonVersion=V.l10n.t("The version of Python associated with the selected kernel is no longer supported. Please consider selecting a different kernel."),J.installingPythonExtension=V.l10n.t("Installing Python extension and locating kernels."),J.pythonExtensionRequired=V.l10n.t("The Python Extension is required to perform that task. Click Yes to open Python Extension installation page."),J.rendererExtensionRequired=V.l10n.t("The Renderer Extension is required to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),J.rendererExtension1015Required=V.l10n.t("The installed version of the Renderer Extension is outdated and requires and update to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),J.pythonExtensionInstalled=V.l10n.t("Python Extension is now installed. Some features might not be available until a notebook or interactive window session is restarted."),J.unknownPackage=V.l10n.t("unknown"),J.interactiveWindowTitleFormat=te=>V.l10n.t("Interactive - {0}",te),J.interactiveWindowModeBannerTitle=V.l10n.t({message:"Do you want to open a new Interactive Window for this file? [More Information](command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D).",args:[],comment:'The string "command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D" should not be translated. It is a command that opens the settings page with the "jupyter.interactiveWindowMode" setting selected.'}),J.interactiveWindowModeBannerSwitchYes=V.l10n.t("Yes"),J.interactiveWindowModeBannerSwitchNo=V.l10n.t("No"),J.dataExplorerTitle=V.l10n.t("Data Viewer"),J.badWebPanelFormatString=te=>V.l10n.t({message:"<html><body><h1>{0} is not a valid file name</h1></body></html>",args:[te],comment:["Only translate the text within the HTML tags"]}),J.installingMissingDependencies=V.l10n.t("Installing missing dependencies"),J.validatingKernelDependencies=V.l10n.t("Validating kernel dependencies"),J.performingExport=V.l10n.t("Performing Export"),J.exportNotebookToPython=V.l10n.t("Exporting Notebook to Python"),J.sessionDisposed=V.l10n.t("Cannot execute code, session has been disposed. Please try restarting the Kernel."),J.passwordFailure=V.l10n.t("Failed to connect to password protected server. Check that password is correct."),J.incorrectPassword=V.l10n.t("Incorrect Password."),J.exportDialogFilter=V.l10n.t("Jupyter Notebooks"),J.exportDialogComplete=te=>V.l10n.t("Notebook written to {0}",te),J.exportDialogFailed=te=>V.l10n.t("Failed to export notebook. {0}",te),J.exportOpenQuestion1=V.l10n.t("Open in editor"),J.runCellLensCommandTitle=V.l10n.t("Run Cell"),J.importDialogTitle=V.l10n.t("Import Jupyter Notebook"),J.importDialogFilter="Jupyter Notebooks",J.notebookCheckForImportNo=V.l10n.t("Later"),J.libraryRequiredToLaunchJupyterNotInstalled=te=>V.l10n.t("Running cells requires {0} package.",te),J.librariesRequiredToLaunchJupyterNotInstalled=te=>V.l10n.t("Running cells requires {0} package.",te),J.libraryRequiredToLaunchJupyterNotInstalledInterpreter=(te,Qe)=>V.l10n.t("Running cells with '{0}' requires the {1} package.",te,Qe),J.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter=(te,Qe)=>V.l10n.t("Running cells with '{0}' requires the {1} package.",te,Qe),J.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreterAndRequiresUpdate=(te,Qe)=>V.l10n.t("Running cells with '{0}' requires the {1} package to be installed or requires an update.",te,Qe),J.librariesRequiredToLaunchJupyterNotInstalledInterpreter=(te,Qe)=>V.l10n.t("Running cells with '{0}' requires the {1} package.",te,Qe),J.createANewPythonEnvironment=()=>V.l10n.t("[Create a Python Environment](command:jupyter.createPythonEnvAndSelectController) with the required packages."),J.installPackageInstructions=(te,Qe)=>V.l10n.t(`Install '{0}' into the Python environment. 
Command: '{1}'`,te,Qe),J.OrInstallPackageInstructions=(te,Qe)=>V.l10n.t("Or install '{0}' using the command: '{1}'",te,Qe),J.pythonCondaKernelsWithoutPython=V.l10n.t("The Python Runtime and IPyKernel will be automatically installed upon selecting this environment."),J.selectJupyterInterpreter=V.l10n.t("Select an Interpreter to start Jupyter"),J.jupyterInstall=V.l10n.t("Install"),J.currentlySelectedJupyterInterpreterForPlaceholder=te=>V.l10n.t("Selected Environment {0}",te),J.jupyterNotSupported=te=>V.l10n.t("Jupyter cannot be started. Error attempting to locate Jupyter: {0}",te),J.jupyterNotebookNotInstalledOrNotFound=te=>{if(te){let Qe=vle(te);return V.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment '{0}'.",Qe)}else return V.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment.")},J.jupyterNotSupportedBecauseOfEnvironment=(te,Qe)=>V.l10n.t("Activating {0} to run Jupyter failed with {1}",te,Qe),J.jupyterNbConvertNotSupported=V.l10n.t("Jupyter nbconvert is not installed"),J.jupyterLaunchTimedOut=V.l10n.t("The Jupyter notebook server failed to launch in time"),J.jupyterLaunchNoURL=V.l10n.t("Failed to find the URL of the launched Jupyter notebook server"),J.jupyterSelfCertFail=te=>V.l10n.t(`The security certificate used by server {0} was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,te),J.jupyterExpiredCertFail=te=>V.l10n.t(`The security certificate used by server {0} has expired.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,te),J.jupyterSelfCertFailErrorMessageOnly=V.l10n.t(`The security certificate used by server was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.`),J.jupyterSelfCertExpiredErrorMessageOnly=V.l10n.t(`The security certificate used by server has expired.\r
This may indicate an attempt to steal your information.`),J.jupyterSelfCertEnable=V.l10n.t("Yes, connect anyways"),J.jupyterSelfCertClose=V.l10n.t("No, close the connection"),J.pythonInteractiveHelpLink=V.l10n.t("See <https://aka.ms/pyaiinstall> for help on installing Jupyter."),J.importingFormat=te=>V.l10n.t("Importing {0}",te),J.startingJupyter=V.l10n.t("Starting Jupyter Server"),J.connectingToKernel=te=>V.l10n.t("Connecting to kernel: {0}",te),J.connectingToJupyter=V.l10n.t("Connecting to Jupyter Server"),J.exportingFormat=te=>V.l10n.t("Exporting {0}",te),J.runAllCellsLensCommandTitle=V.l10n.t("Run All Cells"),J.runAllCellsAboveLensCommandTitle=V.l10n.t("Run Above"),J.runCellAndAllBelowLensCommandTitle=V.l10n.t("Run Below"),J.restartKernelMessage=V.l10n.t("Do you want to restart the Jupyter kernel? All variables will be lost."),J.restartKernelMessageYes=V.l10n.t("Restart"),J.restartKernelMessageDontAskAgain=V.l10n.t("Don't Ask Again"),J.automaticallyReconnectingToAKernelProgressMessage=te=>V.l10n.t("Reconnecting to the kernel {0}",te),J.restartingKernelStatus=te=>V.l10n.t("Restarting Kernel {0}",te),J.interruptingKernelFailed=V.l10n.t("Kernel interrupt failed. Jupyter Server is hung. Please reload VS Code."),J.sessionStartFailedWithKernel=te=>V.l10n.t({message:`Failed to start the Kernel '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.failedToStartJupyter=te=>V.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.failedToStartJupyterWithErrorInfo=(te,Qe)=>V.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
{1} 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te,Qe],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.failedToStartJupyterDueToOutdatedTraitlets=(te,Qe)=>V.l10n.t({message:`Failed to start Jupyter in the environment '{0}' possibly due to an outdated version of 'traitlets'. 
{1} 
Consider updating the 'traitlets' module to '5.1.1' or later. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te,Qe],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the text 'traitlets', that is a Python module name"]}),J.failedToStartKernel=V.l10n.t("Failed to start the Kernel."),J.failedToRestartKernel=V.l10n.t("Failed to restart the Kernel."),J.failedToInterruptKernel=V.l10n.t("Failed to interrupt the Kernel."),J.rawKernelStartFailedDueToTimeout=te=>V.l10n.t({message:`Unable to start Kernel '{0}' due to a connection timeout. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.rawKernelStartFailedDueToTimeoutWaitingForPort=te=>V.l10n.t({message:`Unable to start Kernel '{0}' due to a timeout waiting for the ports to get used. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.viewJupyterLogForFurtherInfo=V.l10n.t({message:"View Jupyter [log](command:jupyter.viewOutput) for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.kernelDied=te=>V.l10n.t({message:"The kernel died. Error: {0}... View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.kernelDiedWithoutError=te=>V.l10n.t({message:"The kernel '{0}' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),J.failedToStartAnUntrustedKernelSpec=(te,Qe)=>V.l10n.t({message:`The kernel '{0}' was not started as it is located in an insecure location '{1}'.  
Click [here](https://aka.ms/JupyterTrustedKernelPaths) for further details, optionally update the setting [jupyter.kernels.trusted](command:workbench.action.openSettings?["jupyter.kernels.trusted"]) to trust the kernel.`,args:[te,Qe],comment:['Do not translate the text "jupyter.kernels.trusted", that is a setting in VS Code','Do not translate the text command:workbench.action.openSettings?["jupyter.kernels.trusted"], that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/JupyterTrustedKernelPaths"]}),J.kernelDiedWithoutErrorAndAutoRestarting=te=>V.l10n.t({message:"The kernel '{0}' died and is being automatically restarted by Jupyter. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),J.kernelCrashedDueToCodeInCurrentOrPreviousCell=V.l10n.t({message:`The Kernel crashed while executing code in the current cell or a previous cell. 
Please review the code in the cell(s) to identify a possible cause of the failure. 
Click <a href='https://aka.ms/vscodeJupyterKernelCrash'>here</a> for more info. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),J.kernelDisconnected=te=>V.l10n.t("Unable to connect to the kernel '{0}', please verify the Jupyter Server connection. View Jupyter [log](command:jupyter.viewOutput) for further details.",te),J.cannotRunCellKernelIsDead=te=>V.l10n.t("Cannot run cells, as the kernel '{0}' is dead.",te),J.showJupyterLogs=V.l10n.t("Show Jupyter Logs."),J.restartKernel=V.l10n.t("Restart Kernel"),J.reloadRequired=V.l10n.t("Please reload the window for new settings to take effect."),J.restartedKernelHeader=te=>V.l10n.t("Restarted {0}",te),J.connectedKernelHeader=te=>V.l10n.t("Connected to {0}",te),J.restartingKernelCustomHeader=te=>V.l10n.t("_Restarting {0}..._",te),J.restartingKernelHeader=V.l10n.t("_Restarting kernel..._"),J.startingNewKernelHeader=V.l10n.t("_Connecting to kernel..._"),J.startingNewKernelCustomHeader=te=>V.l10n.t("_Connecting to {0}..._",te),J.noKernelConnected=V.l10n.t("No kernel connected"),J.jupyterSelectUriCommandLabel=V.l10n.t("Enter the URL of the running Jupyter Server..."),J.jupyterSelectUriInputTitle=V.l10n.t("Enter the URL of the running Jupyter Server"),J.jupyterSelectUriInputPlaceholder=V.l10n.t("Enter the URL of the running Jupyter Server"),J.connectToToTheJupyterServer=te=>V.l10n.t("Connect to the Jupyter Server {0}",te),J.enterOrSelectRemoteJupyterPlaceholder=V.l10n.t("Enter a remote URL, or select a remote server"),J.selectRemoteJupyterPlaceholder=V.l10n.t("Select a remote server"),J.jupyterServerLastConnectionForQuickPickDescription=te=>V.l10n.t("Last connected {0}",ey(te,!0,!1,!1)),J.jupyterServerNotUsedBeforeQuickPickSeparatorTitle=V.l10n.t("Jupyter Servers"),J.jupyterSelectURIInvalidURI=V.l10n.t("Invalid URL specified"),J.jupyterSelectURIMustBeHttpOrHttps=V.l10n.t("Invalid protocol in URL specified, only HTTP or HTTPS are supported."),J.jupyterSelectLiveRemoteKernelDescription=(te,Qe)=>te?Qe===0?V.l10n.t("Last activity {0}",ey(te,!0,!1,!1)):Qe===1?V.l10n.t("Last activity {0}, 1 connection",ey(te,!0,!1,!1)):V.l10n.t("Last activity {0}, {1} connections",ey(te,!0,!1,!1),Qe.toString()):Qe===0?"":Qe===1?V.l10n.t("1 connection"):V.l10n.t("{0} connections",Qe.toString()),J.installJupyterHub=V.l10n.t("Install the JupyterHub extension to connect to JupyterHub servers."),J.useJupyterHubExtension=V.l10n.t("Select 'Existing JupyterHub Server...' from the Kernel Picker"),J.useJupyterHubExtensionDetail=V.l10n.t("Use this option when connecting to JupyterHub servers"),J.installJupyterHubDetail=V.l10n.t("Once installed, open the Kernel Picker and select 'Existing JupyterHub Server...'"),J.jupyterSelectUserAndPasswordTitle=V.l10n.t("Enter your user name and password to connect to Jupyter Hub"),J.jupyterRenameServer=V.l10n.t("Change Server Display Name (Leave Blank To Use URL)"),J.jupyterServerUriDisplayNameInputPlaceholder=V.l10n.t("Enter a display name"),J.jupyterSelectUserPrompt=V.l10n.t("Enter your user name"),J.jupyterSelectPasswordPrompt=V.l10n.t("Enter your password"),J.jupyterSelectPasswordTitle=V.l10n.t("Enter your password for the Jupyter Server"),J.pythonNotInstalled=V.l10n.t(`Python is not installed. 
Please download and install Python in order to execute cells in this notebook. 
Once installed please reload VS Code.`),J.pleaseReloadVSCodeOncePythonHasBeenInstalled=V.l10n.t("Upon installing Python please reload VS Code."),J.jupyterNotebookFailure=te=>V.l10n.t(`Jupyter notebook failed to launch. \r
{0}`,te),J.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid=te=>V.l10n.t("The remote Jupyter Server contributed by the extension '{0}' is no longer available.",te),J.remoteJupyterConnectionFailedWithServerWithError=(te,Qe)=>V.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable. ({1}).",te,Qe),J.remoteJupyterConnectionFailedWithServer=te=>V.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable.",te),J.remoteJupyterConnectionFailedWithoutServerWithError=te=>V.l10n.t("Connection failure. Verify the server is running and reachable. ({0}).",te),J.remoteJupyterConnectionFailedWithoutServerWithErrorWeb=te=>V.l10n.t(`Connection failure. Verify the server is running and reachable from a browser. ({0}). 
When connecting from vscode.dev Jupyter servers must be started with specific options to connect. 
Click [here](https://aka.ms/vscjremoteweb) for more information.`,te),J.removeRemoteJupyterConnectionButtonText=V.l10n.t("Forget Connection"),J.jupyterNotebookRemoteConnectFailedWeb=te=>V.l10n.t(`Failed to connect to remote Jupyter Server.\r
Check that the Jupyter Server URL can be reached from a browser.\r
{0}. Click [here](https://aka.ms/vscjremoteweb) for more information.`,te),J.packageNotInstalledWindowsLongPathNotEnabledError=(te,Qe)=>V.l10n.t(`Support for Windows Long Path has not been enabled, hence the package {0} could not be installed into the Python Environment '{1}'.
Please ensure that support for Windows Long Path is enabled.
See [here](https://pip.pypa.io/warnings/enable-long-paths) for more information.`,te,Qe),J.changeRemoteJupyterConnectionButtonText=V.l10n.t("Manage Connections"),J.rawConnectionBrokenError=V.l10n.t("Direct kernel connection broken"),J.jupyterServerCrashed=te=>V.l10n.t(`Jupyter Server crashed. Unable to connect. \r
Error code from Jupyter: {0}`,te.toString()),J.jupyterKernelSpecModuleNotFound=te=>V.l10n.t(`'Kernelspec' module not installed in the selected interpreter ({0}).
 Please re-install or update 'jupyter'.`,te),J.interruptKernelStatus=te=>V.l10n.t("Interrupting Kernel {0}",te),J.exportPythonQuickPickLabel=V.l10n.t("Python Script"),J.exportHTMLQuickPickLabel=V.l10n.t("HTML"),J.exportPDFQuickPickLabel=V.l10n.t("PDF"),J.restartKernelAfterInterruptMessage=te=>V.l10n.t("Interrupting the kernel '{0}' timed out. Do you want to restart the kernel instead? All variables will be lost.",te),J.documentMismatch=te=>V.l10n.t("Cannot run cells, duplicate documents for {0} found.",te),J.jupyterGetVariablesBadResults=V.l10n.t("Failed to fetch variable info from the Jupyter Server."),V.l10n.t("Failure to create an 'Interactive' window. Try reinstalling the Python Extension."),J.jupyterGetVariablesExecutionError=te=>V.l10n.t(`Failure during variable extraction: \r
{0}`,te),J.selectKernel=V.l10n.t("Change Kernel"),J.selectDifferentKernel=V.l10n.t("Select a different Kernel"),J.kernelFilterPlaceholder=V.l10n.t("Choose the kernels that are available in the kernel picker."),J.recommendedItemCategoryInQuickPick=V.l10n.t("Recommended"),J.selectedKernelCategoryInQuickPick=V.l10n.t("Selected"),J.createPythonEnvironmentInQuickPick=V.l10n.t("Create Python Environment"),J.createPythonEnvironmentInQuickPickTooltip=V.l10n.t("Create an isolated Python Environment per workspace folder"),J.selectDifferentJupyterInterpreter=V.l10n.t("Change Interpreter"),J.pandasTooOldForViewingFormat=(te,Qe)=>V.l10n.t({message:"Python package 'pandas' is version {0}. Version {1} or greater is required for viewing data.",args:[te,Qe],comment:["Do not translate 'pandas' as that is a Python module name"]}),J.pandasRequiredForViewing=te=>V.l10n.t({message:"Python package 'pandas' version {0} (or above) is required for viewing data.",args:[te],comment:["Do not translate 'pandas' as that is a Python module name"]}),J.tooManyColumnsMessage=V.l10n.t("Variables with over a 1000 columns may take a long time to display. Are you sure you wish to continue?"),J.tooManyColumnsYes=V.l10n.t("Yes"),J.tooManyColumnsNo=V.l10n.t("No"),J.tooManyColumnsDontAskAgain=V.l10n.t("Don't Ask Again"),J.plotViewerTitle=V.l10n.t("Plots"),J.exportPlotTitle=V.l10n.t("Save plot image"),J.pdfFilter="PDF",J.pngFilter="PNG",J.svgFilter="SVG",J.exportImageFailed=te=>V.l10n.t("Error exporting image: {0}",te),J.jupyterDataRateExceeded=V.l10n.t({message:"Cannot view variable because data rate exceeded. Please restart your server with a higher data rate limit. For example, --NotebookApp.iopub_data_rate_limit=10000000000.0",comment:["Do not translate the text --NotebookApp.iopub_data_rate_limit=10000000000.0 as that is a command argument."]}),J.addCellBelowCommandTitle=V.l10n.t("Add cell"),J.debugCellCommandTitle=V.l10n.t("Debug Cell"),J.debugStepOverCommandTitle=V.l10n.t("Step over"),J.debugContinueCommandTitle=V.l10n.t("Continue"),J.debugStopCommandTitle=V.l10n.t("Stop"),J.runCurrentCellAndAddBelow=V.l10n.t("Run current cell and add empty cell below"),J.jupyterDebuggerNotInstalledError=te=>V.l10n.t("Pip module {0} is required for debugging cells. You will need to install it to debug cells.",te),J.jupyterDebuggerOutputParseError=te=>V.l10n.t("Unable to parse {0} output, please log an issue with https://github.com/microsoft/vscode-jupyter",te),J.cellStopOnErrorMessage=V.l10n.t("Cell was canceled due to an error in a previous cell."),J.scrollToCellTitleFormatMessage=te=>V.l10n.t("Go to [{0}]",te.toString()),J.instructionComments=te=>V.l10n.t(`# To add a new cell, type '{0}'
# To add a new markdown cell, type '{0} [markdown]'
`,te),J.exportButtonTitle=V.l10n.t("Export"),J.exportAsQuickPickPlaceholder=V.l10n.t("Export As..."),J.openExportedFileMessage=V.l10n.t("Would you like to open the exported file?"),J.openExportFileYes=V.l10n.t("Yes"),J.openExportFileNo=V.l10n.t("No"),J.exportFailedGeneralMessage=V.l10n.t({message:"Please check the 'Jupyter' [output](command:jupyter.viewOutput) panel for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.exportToPDFDependencyMessage=V.l10n.t(`If you have not installed xelatex (TeX), you will need to do so before you can export to PDF. For further instructions, please see https://nbconvert.readthedocs.io/en/latest/install.html#installing-tex. \r
To avoid installing xelatex (TeX), you might want to try exporting to HTML and using your browser's "Print to PDF" feature.`),J.failedExportMessage=V.l10n.t("Export failed."),J.startingJupyterLogMessage=(te,Qe)=>V.l10n.t("Starting Jupyter from {0} with arguments {1}",te,Qe),J.waitingForJupyterSessionToBeIdle=V.l10n.t("Waiting for Jupyter Session to be idle"),J.gettingListOfKernelsForRemoteConnection=V.l10n.t("Fetching Kernels"),J.gettingListOfKernelSpecs=V.l10n.t("Fetching Kernel specs"),J.startingJupyterNotebook=V.l10n.t("Starting Jupyter Notebook"),J.registeringKernel=V.l10n.t("Registering Kernel"),J.jupyterCommandLineReloadQuestion=V.l10n.t("Please reload the window when changing the Jupyter command line."),J.jupyterCommandLineReloadAnswer=V.l10n.t("Reload"),J.createdNewKernel=(te,Qe)=>V.l10n.t("{0}: Kernel started: {1}",te,Qe),J.kernelInvalid=te=>V.l10n.t("Kernel {0} is not usable. Check the Jupyter output tab for more information.",te),J.removeRemoteJupyterServerEntryInQuickPick=V.l10n.t("Remove"),J.loadClassFailedWithNoInternet=(te,Qe)=>V.l10n.t("Error loading {0}:{1}. Internet connection required for loading 3rd party widgets.",te,Qe),J.useCDNForWidgetsNoInformation=V.l10n.t("Widgets require us to download supporting files from a 3rd party website."),J.enableCDNForWidgetsSetting=(te,Qe)=>V.l10n.t("Widgets require us to download supporting files from a 3rd party website. (Error loading {0}:{1}).",te,Qe),J.enableCDNForWidgetsButton=V.l10n.t("Enable Downloads"),J.unhandledMessage=(te,Qe)=>V.l10n.t("Unhandled kernel message from a widget: {0} : {1}",te,Qe),J.cdnWidgetScriptNotAccessibleWarningMessage=(te,Qe)=>V.l10n.t("Unable to download widget '{0}' from 3rd party website {1}, due to network access. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",te,Qe),J.widgetScriptNotFoundOnCDNWidgetMightNotWork=(te,Qe,zre)=>V.l10n.t("Unable to find widget '{0}' version '{1}' from configured widget sources {2}. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",te,Qe,zre),J.insecureSessionMessage=V.l10n.t("Connecting over HTTP without a token may be an insecure connection. Do you want to connect to a possibly insecure server?"),J.insecureSessionDenied=V.l10n.t("Denied connection to insecure server."),J.selectKernelForEditor=V.l10n.t("[Select a kernel](command:_notebook.selectKernel) to run cells."),J.needIpykernel6=V.l10n.t("Ipykernel setup required for this feature"),J.setup=V.l10n.t("Setup"),J.showDataViewerFail=V.l10n.t("Failed to create the Data Viewer. Check the Jupyter tab of the Output window for more info."),J.defaultNotebookName=V.l10n.t("default"),J.recommendExtensionForNotebookLanguage=(te,Qe)=>V.l10n.t("The {0} extension is recommended for notebooks targeting the language '{1}'",te,Qe),J.kernelWasNotStarted=V.l10n.t("Kernel was not started. A kernel session is needed to start debugging."),J.noNotebookToDebug=V.l10n.t("No active notebook document to debug."),J.cantStartDebugging=V.l10n.t("Can't start debugging."),J.restartNotSupported=V.l10n.t("Restarting is not supported in the interactive window."),J.importingIpynb=V.l10n.t("Importing notebook file"),J.exportingToFormat=te=>V.l10n.t("Exporting to {0}",te),J.kernelCategoryForJupyterSession=V.l10n.t("Jupyter Session"),J.kernelDefaultRemoteDisplayName=V.l10n.t("Remote"),J.kernelCategoryForJupyterKernel=V.l10n.t("Jupyter Kernel"),J.kernelCategoryForRemoteJupyterKernel=V.l10n.t("Jupyter Kernel"),J.kernelCategoryForConda=V.l10n.t("Conda Env"),J.kernelCategoryForCondaWithoutPython=V.l10n.t("Conda Env Without Python"),J.kernelCategoryForPoetry=V.l10n.t("Poetry Env"),J.kernelCategoryForPipEnv=V.l10n.t("Pipenv Env"),J.kernelCategoryForPyEnv=V.l10n.t("PyEnv Env"),J.kernelCategoryForGlobal=V.l10n.t("Global Env"),J.kernelCategoryForVirtual=V.l10n.t("Virtual Env"),J.fileSeemsToBeInterferingWithKernelStartup=te=>V.l10n.t("The file '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the file and starting the kernel again.",te),J.moduleSeemsToBeInterferingWithKernelStartup=te=>V.l10n.t("The module '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the folder and starting the kernel again.",te),J.pipCondaInstallHoverWarning=(te,Qe)=>V.l10n.t("'!{0} install' could install packages into the wrong environment. [More info]({1})",te,Qe),J.percentPipCondaInstallInsteadOfBang=te=>V.l10n.t({message:"Use '%{0} install' instead of '!{0} install'",args:[te],comment:['Do not translate the string within quotes, such as "%{0} install" and "!{0} install" as that is a Jupyter Shell Magic command']}),J.replacePipCondaInstallCodeAction=te=>V.l10n.t("Replace with '%{0} install'",te),J.failedToStartKernelDueToMissingModule=te=>V.l10n.t("The kernel failed to start due to the missing module '{0}'. Consider installing this module.",te),J.failedToStartKernelDueToImportFailure=te=>V.l10n.t("The kernel failed to start as the module '{0}' could not be imported.",te),J.failedToStartKernelDueToImportFailureFromFile=(te,Qe)=>V.l10n.t("The kernel failed to start as '{0}' could not be imported from '{1}'.",te,Qe),J.failedToStartKernelDueToUnknownDllLoadFailure=V.l10n.t("The kernel failed to start as a dll could not be loaded."),J.failedToStartKernelDueToDllLoadFailure=te=>V.l10n.t("The kernel failed to start as the dll '{0}' could not be loaded.",te),J.failedToStartKernelDueToWin32APIFailure=V.l10n.t("The kernel failed to start due to an error with the Win32api module. Consider (re) installing this module."),J.failedToStartKernelDueToPyZmqFailure=V.l10n.t({message:"The kernel failed to start due to an error with the 'pyzmq' module. Consider re-installing this module.",comment:['Do not translate the string "pyzmq" as that is a Python module.']}),J.failedToStartKernelDueToOldIPython=V.l10n.t("The kernel failed to start due to an outdated version of IPython. Consider updating this module to the latest version."),J.failedToStartKernelDueToOldIPyKernel=V.l10n.t("The kernel failed to start due to an outdated version of IPyKernel. Consider updating this module to the latest version."),J.failedToStartKernelDueToMissingPythonEnv=te=>V.l10n.t("The kernel failed to start as the Python Environment '{0}' is no longer available. Consider selecting another kernel or refreshing the list of Python Environments.",te),J.matplotlibWidgetInsteadOfOther=V.l10n.t("'%matplotlib' widget works best inside of VS Code"),J.matplotlibWidgetCodeActionTitle=V.l10n.t("More info"),J.allowExtensionToUseJupyterKernelApi=(te,Qe)=>V.l10n.t("Do you want to give the extension '{0}' access to the Jupyter Kernels? Clicking '{1}' would allow this extension to execute code against the Jupyter Kernels.",te,Qe),J.thanksForUsingJupyterKernelApiPleaseRegisterWithUs=te=>V.l10n.t("Thank you for trying the Jupyter API. Please file an issue on our repo to allow the extension {0} to use this API in production. This would prevent us from breaking your extension when updating the API (as it is still a work in progress).",te),J.activatingPythonEnvironment=te=>V.l10n.t("Activating Python Environment '{0}'",te),J.runningKernelStartupHooksFor=te=>V.l10n.t("Running Kernel startup hooks in '{0}'",te),J.cellAtFormat=(te,Qe)=>V.l10n.t("{0} Cell {1}",te,Qe),J.jupyterServerConsoleOutputChannel=V.l10n.t("Jupyter Server Console"),J.kernelConsoleOutputChannel=te=>V.l10n.t("{0} Kernel Console Output",te),J.webNotSupported=V.l10n.t("Operation not supported in web version of Jupyter Extension."),J.failedToInstallPythonExtension=V.l10n.t("Failed to install the Python Extension."),J.filesPossiblyOverridingPythonModulesMayHavePreventedKernelFromStarting=te=>V.l10n.t("Some of the following files found in the working directory may have prevented the Kernel from starting. Consider renaming them.",te),J.listOfFilesWithLinksThatMightNeedToBeRenamed=te=>V.l10n.t("File(s): {0} might need to be renamed.",te),J.failedToGetVersionOfPandas=V.l10n.t("Failed to get version of Pandas to use the Data Viewer."),J.failedToInstallPandas=V.l10n.t("Failed to install Pandas to use the Data Viewer."),J.localKernelSpecs=V.l10n.t("Jupyter Kernel..."),J.localPythonEnvironments=V.l10n.t("Python Environments..."),J.quickPickTitleForSelectionOfJupyterServer=V.l10n.t("Select a Jupyter Server"),J.UserJupyterServerUrlProviderDisplayName=V.l10n.t("Existing Jupyter Server..."),J.UserJupyterServerUrlProviderDetail=V.l10n.t("Connect to an existing Jupyter Server"),J.kernelPickerSelectKernelTitle=V.l10n.t("Select Kernel"),J.kernelPickerSelectLocalKernelSpecTitle=V.l10n.t("Select a Jupyter Kernel"),J.quickPickSelectPythonEnvironmentTitle=V.l10n.t("Select a Python Environment"),J.kernelPickerSelectKernelFromRemoteTitle=te=>V.l10n.t("Select a Kernel from {0}",te),J.kernelPickerSelectKernelFromRemoteTitleWithoutName=V.l10n.t("Select a Jupyter Kernel"),J.installPythonExtensionViaKernelPickerTitle=V.l10n.t("Install Python Extension"),J.installPythonExtensionViaKernelPickerToolTip=V.l10n.t("Python Extension is required to detect and use Python environments for the execution of code cells."),J.installPythonQuickPickTitle=V.l10n.t("Install Python"),J.installPythonQuickPickToolTip=V.l10n.t("Python Environments not detected. Upon installation reload VS Code or refresh the list of Kernels."),J.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel=V.l10n.t({message:"$(error) Unable to connect to the remote server",comment:"Do not translate the string $(error) as that is a VS Code icon."}),J.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail=V.l10n.t("Ensure the server is running and reachable."),J.dataViewerDeprecationMessage=V.l10n.t("The built-in data viewer will be deprecated soon. Please install other data viewing extensions to keep the ability to inspect data."),J.dataViewerDeprecationRecommendationActionMessage=V.l10n.t("See Recommended Extensions"),J.dataViewerExtensionRequired=V.l10n.t("A Data Viewer Extension is required to view data frames. Click Yes to see recommended extensions."),J.selectExternalDataViewer=V.l10n.t("Select DataFrame Viewer")))(W||(W={}));var Ft;(ce=>(ce.collapseSingle=V.l10n.t("Collapse"),ce.expandSingle=V.l10n.t("Expand"),ce.noRowsInDataViewer=V.l10n.t("No rows match current filter"),ce.sliceIndexError=V.l10n.t({message:"Index {0} out of range for axis {1} with {2} elements",comment:["Do not translate the strings {0}, {1} and {2} as they are variable names and will be replaced later"]}),ce.sliceMismatchedAxesError=V.l10n.t({message:"Expected {0} axes, got {1} in slice expression",comment:["Do not translate the strings {0} and {2} as they are variable names and will be replaced later"]}),ce.fetchingDataViewer=V.l10n.t("Fetching data ..."),ce.dataViewerHideFilters=V.l10n.t("Hide filters"),ce.dataViewerShowFilters=V.l10n.t("Show filters"),ce.refreshDataViewer=V.l10n.t("Refresh data viewer"),ce.sliceSummaryTitle=V.l10n.t("SLICING"),ce.sliceData=V.l10n.t("Slice Data"),ce.sliceSubmitButton=V.l10n.t("Apply"),ce.sliceDropdownAxisLabel=V.l10n.t("Axis"),ce.sliceDropdownIndexLabel=V.l10n.t("Index"),ce.variableExplorerNameColumn=V.l10n.t("Name"),ce.variableExplorerTypeColumn=V.l10n.t("Type"),ce.variableExplorerCountColumn=V.l10n.t("Size"),ce.variableExplorerValueColumn=V.l10n.t("Value"),ce.collapseVariableExplorerLabel=V.l10n.t("Variables"),ce.variableLoadingValue=V.l10n.t("Loading..."),ce.showDataExplorerTooltip=V.l10n.t("Show variable snapshot in data viewer"),ce.noRowsInVariableExplorer=V.l10n.t("No variables defined"),ce.loadingRowsInVariableExplorer=V.l10n.t("Loading variables"),ce.previousPlot=V.l10n.t("Previous"),ce.nextPlot=V.l10n.t("Next"),ce.panPlot=V.l10n.t("Pan"),ce.zoomInPlot=V.l10n.t("Zoom in"),ce.zoomOutPlot=V.l10n.t("Zoom out"),ce.exportPlot=V.l10n.t("Export to different formats"),ce.deletePlot=V.l10n.t("Remove"),ce.selectedImageListLabel=V.l10n.t("Selected Image"),ce.selectedImageLabel=V.l10n.t("Image"),ce.errorOutputExceedsLinkToOpenFormatString=V.l10n.t({message:"Output exceeds the <a href={0}>size limit</a>. Open the full output data <a href={1}>in a text editor</a>",comment:['Do not translate the the Hyperlink text "<a href={0}>size limit</a>" and "<a href={1}>in a text editor</a>". However the text inside those tags can be translated']}),ce.dvDeprecationWarning=V.l10n.t('The built-in data viewer will be deprecated and no longer usable starting with Visual Studio Code 1.92. Please <a href="command:workbench.extensions.search?%22@tag:jupyterVariableViewers%22">install other data viewing extensions</a> to continue inspecting data')))(Ft||(Ft={}));var uy;(n=>(n.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE=V.l10n.t({message:"The setting 'python.formatting.formatOnSave' is deprecated, please use 'editor.formatOnSave'.",comment:['Do not translate the string "python.formatting.formatOnSave" as that is a setting in VS Code','Do not translate the string "editor.formatOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE=V.l10n.t({message:"The setting 'python.linting.lintOnTextChange' is deprecated, please enable 'python.linting.lintOnSave' and 'files.autoSave'.",comment:['Do not translate the string "python.linting.lintOnTextChange" as that is a setting in VS Code','Do not translate the string "python.linting.lintOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES=V.l10n.t({message:"The setting 'python.autoComplete.preloadModules' is deprecated, please consider using Pylance Language Server ('python.languageServer' setting).",comment:['Do not translate the string "python.autoComplete.preloadModules" as that is a setting in VS Code','Do not translate the string "python.languageServer" as that is a setting in VS Code']})))(uy||(uy={}));var L7;(n=>(n.noCondaOrPipInstaller=V.l10n.t("There is no Conda or Pip installer available in the selected environment."),n.noPipInstaller=V.l10n.t("There is no Pip installer available in the selected environment."),n.searchForHelp=V.l10n.t("Search for help")))(L7||(L7={}));var K7;(e=>e.installingModule=t=>V.l10n.t("Installing {0}",t))(K7||(K7={}));p();var U7=dK(),vT=class{constructor(e,t,n){this.channel=e;this.homeReplaceRegEx=t,this.userNameReplaceRegEx=n}format(e,t,...n){let i=e?`${yD()} [${e}] ${U7(t,...n)}`:U7(t,...n);return this.homeReplaceRegEx&&(i=i.replace(this.homeReplaceRegEx,"~")),this.userNameReplaceRegEx&&(i=i.replace(this.userNameReplaceRegEx,"<username>")),i}error(e,...t){this.channel.appendLine(this.format("error",e,...t))}warn(e,...t){this.channel.appendLine(this.format("warn",e,...t))}info(e,...t){this.channel.appendLine(this.format("info",e,...t))}debug(e,...t){this.channel.appendLine(this.format("debug",e,...t))}trace(e,...t){this.channel.appendLine(this.format("trace",e,...t))}ci(e,...t){}};p();var W7=dK();function oC(r,e,...t){let i=[...t].length===0?W7(e):W7(e,...t);return r?`${r} ${yD()}: ${i}`:i}var yT=class{constructor(e){this.prefix=e}error(e,...t){console.error(oC("error",`${this.prefix||""} ${e}`,...t))}warn(e,...t){console.warn(oC("warn",`${this.prefix||""} ${e}`,...t))}info(e,...t){console.info(oC("info",`${this.prefix||""} ${e}`,...t))}debug(e,...t){console.log(oC("debug",`${this.prefix||""} ${e}`,...t))}trace(e,...t){console.trace(oC("trace",`${this.prefix||""} ${e}`,...t))}ci(e,...t){}};var pK="",Ile=3,Rp=[],Ap=mr.LogLevel.Info,C={error:(r,...e)=>Sle(r,...e),warn:(r,...e)=>J7(r,...e),info:(r,...e)=>_le(r,...e),debug:(r,...e)=>Ele(r,...e),trace:(r,...e)=>Cle(r,...e),ci:(r,...e)=>{e&&Array.isArray(e)?B7(r,...e):B7(r)}};function H7(r){Ap=j7(),Ou(mr.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.logging")&&(Ap=j7())}));let e=mr.window.createOutputChannel(gT.jupyter,"log");return V7(new vT(e,r==null?void 0:r.userNameRegEx,r==null?void 0:r.homePathRegEx)),r.addConsoleLogger&&V7(new yT(ci?void 0:"Jupyter Extension:")),e}function V7(r){return Rp.push(r),{dispose:()=>{Rp=Rp.filter(e=>e!==r)}}}function j7(){try{let{level:r}=mr.workspace.getConfiguration("jupyter").get("logging",{level:"Info"});switch(r){case"debug":case"Debug":return mr.LogLevel.Debug;case"warn":case"Warn":case"warning":case"Warning":return mr.LogLevel.Warning;case"Off":case"off":return mr.LogLevel.Off;case"Error":case"error":return mr.LogLevel.Error;case"Trace":case"trace":return mr.LogLevel.Trace;default:return mr.LogLevel.Info}}catch(r){return console.error("Failed to get logging level from configuration",r),mr.LogLevel.Info}}function q7(...r){return Ap<=mr.LogLevel.Debug?r:r.map(t=>{if(!(t instanceof Error)||!("isJupyterError"in t))return t;let n=[`${t.name}: ${t.message}`.trim()];if("kernelConnectionMetadata"in t&&t.kernelConnectionMetadata&&typeof t.kernelConnectionMetadata=="object"&&"id"in t.kernelConnectionMetadata&&(n.push(`Kernel Id = ${t.kernelConnectionMetadata.id}`),"interpreter"in t.kernelConnectionMetadata&&t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter=="object"&&"id"in t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter.id=="string"&&n.push(`Interpreter Id = ${Ee(t.kernelConnectionMetadata.interpreter.id)}`)),t.stack){let o=lt(t.stack),s=o.find(a=>a.indexOf("at ")===0);o.length===1||(o.length===1?n.push(o[0]):o.length>1&&(s!=null&&s.length)?n.push(s):n.push(o[0]))}let i=["stack","message","name","kernelConnectionMetadata","category","exitCode","isJupyterError"];return Object.keys(t).filter(o=>i.indexOf(o)===-1).forEach(o=>n.push(`${o} = ${String(t[o]).trim()}`)),n.filter(o=>o.trim().length).map((o,s)=>s===0?o:`    > ${o}`).join(`
`)})}function Sle(r,...e){Ap<=mr.LogLevel.Error&&(e=q7(...e),Rp.forEach(t=>t.error(r,...e)))}function J7(r,...e){Ap<=mr.LogLevel.Warning&&(e=q7(...e),Rp.forEach(t=>t.warn(r,...e)))}function _le(r,...e){Ap<=mr.LogLevel.Info&&Rp.forEach(t=>t.info(r,...e))}function Ele(r,...e){Ap<=mr.LogLevel.Debug&&Rp.forEach(t=>t.debug(r,...e))}function Cle(r,...e){Ap<=mr.LogLevel.Trace&&Rp.forEach(t=>t.trace(r,...e))}function B7(r,...e){if(ci)if(typeof r=="function"){let n=r(),i="",o=[];typeof n=="string"?i=n:(i=n.shift(),o=n),C.info(i,...o)}else C.info(r,...e)}function G7(r,e=Ile){return wle({message:r,opts:e,level:mr.LogLevel.Debug})}var Wu=new WeakMap;function mK(r){return(e,t,n)=>{Wu.has(e)||Wu.set(e,new Map);let i=Wu.get(e);i||Wu.set(e,i=new Map),i.has(t)||i.set(t,[]),i.get(t).push({parameterIndex:n,propertyOfParameterToLog:r})}}function Y7(){return(r,e,t)=>{Wu.has(r)||Wu.set(r,new Map);let n=Wu.get(r);n||Wu.set(r,n=new Map),n.has(e)||n.set(e,[]),n.get(e).push({parameterIndex:t,ignore:!0})}}function wle(r){return xB((e,t)=>kle(r,t,e),(r.opts&4)>0)}function xle(r){let{kind:e,name:t,args:n}=r;return(!e||e==="")&&(e="Function"),(!t||t==="")&&(t="<anon>"),n||(n=[]),{kind:e,name:t,args:n,methodName:r.methodName||"",target:r.target||void 0}}function Ple(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function fK(r){let e=pK?r.toLowerCase().indexOf(pK):-1;return e===-1?r:`~${r.substring(e+pK.length)}`}function Dle(r,e,t,n){var a;if(Ple(t))return fK(t.path);if(!t)return t;let i=(a=Wu.get(r))==null?void 0:a.get(e),o=i==null?void 0:i.find(l=>l.parameterIndex===n);if(!o)return typeof t=="string"?fK(t):t;if("ignore"in o&&o.ignore)return"";let s=t;return"propertyOfParameterToLog"in o&&o.propertyOfParameterToLog&&(s=t[o.propertyOfParameterToLog]),typeof s=="string"?fK(s):s}function Tle(r,e,t){t=xle(t);let n=[r.message];return n.push(`${t.kind} name = ${t.name}`.trim()),e?(n.push(`completed in ${e.elapsed}ms`),n.push(`has a ${e.returnValue?"truthy":"falsy"} return value`)):n[n.length-1]=`${n[n.length-1]} (started execution)`,(r.opts&1)===1&&(r.level===mr.LogLevel.Debug?n.push(yL(t.args.map((i,o)=>t?Dle(t.target,t.methodName,i,o):i))):n.push(yL(t.args))),e&&(r.opts&2)===2&&n.push(PB(e.returnValue)),n.join(", ")}function kle(r,e,t){let n=Tle(r,e,t);e?e.err===void 0?r.level&&r.level===mr.LogLevel.Error||(r.level?bT(r.level,n):bT(mr.LogLevel.Info,n)):bT(mr.LogLevel.Error,n,e.err):r.level&&r.level!==mr.LogLevel.Error&&bT(r.level,n)}function bT(r,e,...t){switch(r){case mr.LogLevel.Error:C.error(e,...t);break;case mr.LogLevel.Warning:J7(e,...t);break;case mr.LogLevel.Info:C.info(e,...t);break;case mr.LogLevel.Debug:case mr.LogLevel.Trace:C.debug(e,...t);break;default:break}}var Zl=require("vscode");p();var vj=require("vscode");p();var $7=Symbol("IsDevMode"),jm=Symbol("IOutputChannel"),z7=Symbol("IS_WINDOWS"),ve=Symbol("IDisposableRegistry"),Et=Symbol("IGlobalMemento"),rr=Symbol("IGlobalMemento"),_s=Symbol("IWorkspaceMemento");var IT=Symbol("IPersistentStateFactory"),o1e=Symbol("IRandom"),Ke=Symbol("IConfigurationService"),st=Symbol("ExtensionContext"),Ha=Symbol("IExtensions"),s1e=Symbol("IJupyterExtensionBanner"),ST=Symbol("IFeaturesManager"),dy=Symbol("ICryptoUtils"),Vu=Symbol("IAsyncDisposableRegistry");var py=Symbol("IExperimentService"),fy=Symbol("IDataScienceCommandListener"),my=Symbol("IVariableScriptGenerator"),hy=Symbol("IDataFrameScriptGenerator");p();var NR=require("vscode");p();var l8=oe(a8()),sC=oe(he());try{(0,sC.decorate)((0,sC.injectable)(),l8.EventEmitter)}catch(r){C.warn("Failed to decorate EventEmitter for DI (possibly already decorated by another Extension)",r)}var tt=class{constructor(e){this.container=e;tt._instance=this}static get instance(){return tt._instance}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}};tt=U([(0,sC.injectable)()],tt);p();p();var It=require("vscode");p();var vy=Symbol("IPythonApi"),vo=Symbol("IPythonExtensionChecker");var Ca=oe(he());p();p();p();var gK="Python Kernel Debug Adapter",vK="Python Interactive Window Debug Adapter";p();p();var CT=oe(u8()),cC=oe(d8());p();p();var by=require("vscode");p();p();var ot=class extends Error{constructor(t,n){super(n);this.category=t;this.isJupyterError=!0}},Ln=class r extends ot{constructor(t,n,i){super(i||yK(n),t);this.originalException=n;n&&(this.stack=`${new Error("").stack}

${n.stack}`)}static from(t,n){return n instanceof ot?n:new r(t,n)}static unwrap(t){return t&&(t instanceof r&&t.originalException&&t.originalException instanceof ot&&(t=t.originalException),t)}};function yK(r){return r&&r instanceof ot?r.category:"unknown"}var Mp=class extends ot{constructor(t,n,i){super("jupyterconnection",t+(n?`
${n}`:""));this.interpreter=i}};p();var Qr=class extends ot{constructor(){super("sessionDisposed",W.sessionDisposed)}};function f8(r=""){let e=m8(r);return e?e[1]:void 0}function m8(r=""){if(!r)return;let e=r.trim().split(`
`).map(t=>t.trim()).filter(t=>t.trim().length).reverse();if(e.length!==0&&e[0].includes("Error"))return[e.length>1?e[1]:"",e[0]]}function h8(r){if(!r)return;let t=(Array.isArray(r)?r[0]:r).split(`
`).map(l=>l.trim().toLowerCase()).filter(l=>l.length).reverse().find(l=>l.startsWith("file ")&&l.includes(", line ")&&l.includes(".py")&&l.includes(".py"));if(!t)return;let i=(t.substring(0,t.lastIndexOf(".py"))+".py").replace(/\\/g,"/").split("/"),o=i.indexOf("site-packages"),s=o>=0&&i.length>o+1?i[o+1]:"",a=i.reverse();if(!(a.length<2))return{fileName:a[0],folderName:a[1],packageName:s}}function Bm(r,e,t,n="",i=[]){let o=e instanceof ot?e.stdErr||e.stack||"":e.toString(),s=m8(o),a=o.toLowerCase();if(e instanceof Qr)return{reason:"sessionDisposed",message:W.sessionDisposed,moreInfoLink:"https://aka.ms/kernelDisposedCannotRunCell",telemetrySafeTags:["deadSession"]};if(a.includes("ImportError: No module named 'win32api'".toLowerCase()))return{reason:"importWin32apiFailure",message:W.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())&&a.includes("win32api"))return{reason:"importWin32apiFailure",message:W.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["dll.load.failed","win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())){let c=s&&s[0].toLowerCase().startsWith("import")?s[0].substring(6).trim():void 0;return{reason:"dllLoadFailure",moduleName:c,message:c?W.failedToStartKernelDueToDllLoadFailure(c):W.failedToStartKernelDueToUnknownDllLoadFailure,moreInfoLink:"https://aka.ms/kernelFailuresDllLoad",telemetrySafeTags:["dll.load.failed"]}}if(a.includes("AssertionError: Couldn't find Class NSProcessInfo".toLowerCase()))return{reason:"oldIPythonFailure",message:W.failedToStartKernelDueToOldIPython,moreInfoLink:"https://aka.ms/kernelFailuresOldIPython",telemetrySafeTags:["oldipython"]};if(a.includes("NotImplementedError".toLowerCase())&&a.includes("asyncio".toLowerCase())&&a.includes("events.py".toLowerCase()))return{reason:"oldIPyKernelFailure",message:W.failedToStartKernelDueToOldIPyKernel,moreInfoLink:"https://aka.ms/kernelFailuresOldIPyKernel",telemetrySafeTags:["oldipykernel"]};{let c=[];if(a.includes("ImportError: cannot import name".toLowerCase())&&a.includes("from partially initialized module".toLowerCase())&&a.includes("zmq.backend.cython".toLowerCase())&&c.push("zmq.backend.cython"),a.includes("zmq".toLowerCase())&&a.includes("cython".toLowerCase())&&a.includes("__init__.py".toLowerCase())&&c.push("zmq.cython"),a.includes("zmq.error.ZMQError")&&c.push("zmq.error"),c.length)return{reason:"zmqModuleFailure",message:W.failedToStartKernelDueToPyZmqFailure,moreInfoLink:"https://aka.ms/kernelFailuresPyzmq",telemetrySafeTags:c}}if(s&&s[1].toLowerCase().startsWith("importerror")){let c=p8(s[1]);if(c&&n){let d=Wle(c.moduleName,c.fileName,r,n);return d||{reason:"importFailure",moduleName:c.moduleName,fileName:c.fileName,message:c.fileName?W.failedToStartKernelDueToImportFailureFromFile(c.moduleName,c.fileName):W.failedToStartKernelDueToImportFailure(c.moduleName),moreInfoLink:c.fileName?"https://aka.ms/kernelFailuresModuleImportErrFromFile":"https://aka.ms/kernelFailuresModuleImportErr",telemetrySafeTags:["import.error"]}}}let l="No module named".toLowerCase(),u="is not a package".toLowerCase();if(a.includes(l)&&!u){let c=lt(o).map(f=>f.trim()).filter(f=>f.length).find(f=>f.toLowerCase().includes(l)),d=c?c.substring(c.toLowerCase().indexOf(l)+l.length).trim():"";if(c)return{reason:"moduleNotFound",moduleName:d,message:W.failedToStartKernelDueToMissingModule(d),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(a.includes(l)&&u){let c=lt(o).map(b=>b.trim()).filter(b=>b.length).find(b=>b.toLowerCase().includes(l)),d=c?c.substring(c.toLowerCase().indexOf(l)+l.length).trim():"",f="",m="";d.split("'").length>2&&(f=d.split("'").slice(-2)[0]||"",f=f?`${f}.py`:"",m=f||"",d=d.split("'")[1]||d);let g=i.filter(b=>pi(b).toLowerCase()==="__init__.py").map(b=>pi(Km(b)));return d&&f&&d!==f&&i.some(b=>pi(b).toLowerCase()===f.toLowerCase())?{reason:"overridingBuiltinModules",fileName:f,moduleName:d,message:W.fileSeemsToBeInterferingWithKernelStartup(f),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:d&&g&&d!==m&&g.some(b=>b.toLowerCase()===m.toLowerCase())?{reason:"overridingBuiltinModules",folderName:m,moduleName:d,message:W.moduleSeemsToBeInterferingWithKernelStartup(m),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:{reason:"moduleNotFound",moduleName:d,message:W.failedToStartKernelDueToMissingModule(d),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(e instanceof ot&&e.category==="invalidkernel"&&i.length){let c=pi(i[0]);return{reason:"overridingBuiltinModules",fileName:c,moduleName:pi(i[0],".py"),message:W.fileSeemsToBeInterferingWithKernelStartup(c),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}else if(s&&s[1].toLowerCase().startsWith("ModuleNotFoundError".toLowerCase())){let c=p8(s[1]);if(c)return{reason:"moduleNotFound",moduleName:c.moduleName,message:W.failedToStartKernelDueToMissingModule(c.moduleName),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}if(e instanceof Mp){let c=lt(o).map(v=>v.trim()).reverse().find(v=>v.toLowerCase().includes("error: ")),d="AttributeError: 'Namespace' object has no attribute '_flags'",f=["jupyter.startup.failure"],m,g="jupyterStartFailure",b=lt(e.message,{removeEmptyEntries:!0,trim:!0}).reverse().find(v=>v.toLowerCase().includes("error: "));if(b=b||lt(e.stdErr||"",{removeEmptyEntries:!0,trim:!0}).reverse().find(v=>v.toLowerCase().includes("error: ")),a.includes(d.toLowerCase())?(g="jupyterStartFailureOutdatedTraitlets",c=W.failedToStartJupyterDueToOutdatedTraitlets(t||"",b||""),f.push("outdated.traitlets"),m="https://aka.ms/kernelFailuresJupyterTrailtletsOutdated"):(c=b?W.failedToStartJupyterWithErrorInfo(t||"",b):W.failedToStartJupyter(t||""),m=void 0),c)return{reason:g,message:c,pythonError:b,moreInfoLink:m,telemetrySafeTags:f}}}function p8(r){r=r.replace(/"/g,"'");let e=r.match(/'[^\\']*(\\'[^\\']*)*'/g),t=r.match(/\((.*?)\)/g),n,i;return e&&e[0].length>2&&(n=e[0],n=n.substring(1,n.length-1)),t&&t[0].length>2&&(i=t[0],i=i.substring(1,i.length-1)),n?{moduleName:n,fileName:i}:void 0}function Wle(r,e,t,n){if(n&&t.length!==0&&e&&!e.toLowerCase().startsWith(n)&&t.some(i=>e.toLowerCase().startsWith(i.uri.fsPath.toLowerCase())))return{reason:"overridingBuiltinModules",fileName:e,moduleName:r,message:W.fileSeemsToBeInterferingWithKernelStartup(Ee(by.Uri.file(e),t||[])),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}function Iy(r){if(!r)return;let e=/\[([^\[\]]*)\]\((.*?)\)/gm,t;for(;(t=e.exec(r))!==null;)t.length===3&&(r=r.replace(t[0],`<a href='${t[2]}'>${t[1]}</a>`));let n=lt(r,{removeEmptyEntries:!1,trim:!1}).map(i=>`\x1B[1;31m${i}`).join(`
`);return new by.NotebookCellOutput([by.NotebookCellOutputItem.error({message:"",name:"",stack:n})])}var Vle=[jle,Ble];function g8(r){let e=[],t=Array.isArray(r)?r[0].toLowerCase():r.toLowerCase();Vle.forEach(i=>i(t,e));let n=Bm([],t,void 0);return n!=null&&n.telemetrySafeTags.length&&e.push(...n.telemetrySafeTags),Array.from(new Set(e)).join(",")}function jle(r,e=[]){r.includes("ChildProcess.exithandler".toLowerCase())&&e.push("childproc.exit")}function Ble(r,e=[]){r.includes("KernelRestarter: restart failed".toLowerCase())&&e.push("KernelRestarter.failed")}function v8(){return(new Error().stack||"").split(`
`).filter(r=>r.includes(Je))}async function y8(r,e){r.failed=!0,r.failureCategory=r.failureCategory||yK(e);let t=!CT.FetchError&&(e==null?void 0:e.name)==="TypeError"&&(e==null?void 0:e.message)==="Failed to fetch",i=(t||CT.FetchError!==void 0)&&Jle(e,t?TypeError:CT.FetchError);r.failureCategory==="unknown"&&i&&(r.failureCategory="fetcherror"),r.stackTrace=Hle(e),typeof e=="string"&&(r.failureSubCategory="errorisstring");let o=e.stdErr?e.stdErr:e.stack||"";if(!o)return;r.failureSubCategory=r.failureSubCategory||g8(o);let s=h8(o);s&&([r.pythonErrorFile,r.pythonErrorFolder,r.pythonErrorPackage]=await Promise.all([Promise.resolve(r.pythonErrorFile||Rt(s.fileName)),Promise.resolve(r.pythonErrorFolder||Rt(s.folderName)),Promise.resolve(r.pythonErrorPackage||Rt(s.packageName))]))}function bK(r){if(r.stack&&Array.isArray(r.stack)){let e={...r,stack:r.stack.join(`
`)};return cC.parse.call(cC,e)}return cC.parse.call(cC,r)}function Hle(r){let e="";for(let t of bK(r)){let n=t.getFileName();if(n){let i=t.getLineNumber(),o=t.getColumnNumber();e+=`
	at ${qle(t)} ${n}:${i}:${o}`}else e+=`
	at <anonymous>`}return e.trim().replace(/\\/g,"/")}function qle(r){let e=[];return typeof r.getTypeName()=="string"&&r.getTypeName().length>0&&e.push(r.getTypeName()),typeof r.getMethodName()=="string"&&r.getMethodName().length>0&&e.push(r.getMethodName()),typeof r.getFunctionName()=="string"&&r.getFunctionName().length>0&&(e.length!==2||e.join(".")!==r.getFunctionName())&&e.push(r.getFunctionName()),e.join(".")}function Jle(r,e){return e?r instanceof e||r instanceof Ln&&r.originalException instanceof e:(console.error("Error type is not defined",r),!1)}var RN=require("vscode");function Tfe(){try{return require("vscode")===void 0?!1:jG()!==void 0}catch(r){return!1}}function MN(){return RN.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1}function ON(r){return RN.workspace.onDidChangeConfiguration(e=>{if(!e.affectsConfiguration("telemetry"))return;let n=RN.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1;r(n)})}var AN={};function Xb(r,e){let t=r;BE()&&t.startsWith("ds_")||(e===void 0?delete AN[t]:AN[t]=e)}var E2;function jG(){if(E2)return E2;let r=(UG(),pL(FG)).default;return E2=new r(hB)}function WG(r,e){let t={};return Object.getOwnPropertyNames(e).forEach(n=>{if(!(e[n]===void 0||e[n]===null))try{t[n]=typeof e[n]=="string"?e[n]:typeof e[n]=="object"?"object":e[n].toString()}catch(i){C.error(`Failed to serialize ${n} for ${r}`,i)}}),t}function ne(r,e,t,n){!BG(r.toString())&&(hn()||!Tfe())||kfe(r,e,t,n)}function BG(r){return r==="DATASCIENCE.JUPYTER_NOTEBOOK_EDIT_PERFORMANCE"||r==="DATASCIENCE.JUPYTER_JUPYTER_NOTEBOOK_EXEC_PERFORMANCE"||r==="DATASCIENCE.JUPYTER_NOTEBOOK_EXEC_PERFORMANCE"}function kfe(r,e,t,n){let i=jG(),o={},s=r;n?(o={},Object.assign(o,AN),Object.assign(o,t||{}),y8(o,n).then(()=>{o=WG(s,o),i.sendTelemetryEvent(s,o,e)}).catch(E)):(t&&(o=WG(s,t)),Object.assign(o,AN),BG(s)?i.sendDangerousTelemetryEvent(s,o,e):i.sendTelemetryEvent(s,o,e))}var VG=new Set;function Nr(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a=e||{},l=new yt,u=`${r.toString()}${JSON.stringify(a)}`,c=!VG.has(u);VG.add(u);let d=o.apply(this,s);return d&&typeof d.then=="function"&&typeof d.catch=="function"?d.then(f=>{let m={...a};return c&&(m.firstTime=c),ne(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,m),f}).catch(f=>{let m={...a};m.failed=!0,ne(r,l?{duration:l==null?void 0:l.elapsedTime}:{},m,f)}):ne(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,a),d},i}}function Tn(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){return ne(r,void 0,e),o.apply(this,s)},i}}function Nfe(){return{isInsiderExtension:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether this is the Insider version of the Jupyter extension or not. Common to all events."},isPythonExtensionInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether Python extension is installed or not. Common to all events."},rawKernelSupported:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether the raw kernel is supported or not. Common to all events."}}}function at(){return{duration:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth",isMeasurement:!0}}}function ns(){return{resourceType:{classification:"PublicNonPersonalData",comment:"",purpose:"FeatureInsight"}}}function Nd(){return{failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureSubCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFile:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFolder:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorPackage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},stackTrace:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}}function Zi(){return{properties:{actionSource:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},disableUI:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},userExecutedCell:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},resourceHash:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},pythonEnvironmentVersion:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPath:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPackages:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSessionId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelLanguage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelConnectionType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},isUsingActiveInterpreter:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},capturedEnvVars:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},newKernelPicker:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},...ns()}}}var k5e={...at(),...Nd(),...Nfe()};var Rfe,Afe,Mfe,Ofe,Lfe,Kfe,Ffe,Ufe,Wfe,Vfe,jfe,Bfe,Hfe,qfe,Jfe,Gfe,Yfe,$fe,zfe,Qfe,Xfe,Zfe,eme,tme,rme,nme,ime,ome,sme,ame,lme,cme,ume,dme,pme,fme,mme,hme,gme,vme,yme,bme,Ime,Sme,_me,Eme,Cme,wme,xme,Pme,Dme,Tme,kme,Nme,Rme,Ame,Mme,Ome,Lme,Kme,Fme,Ume,Wme,Vme,jme,Bme,Hme,qme,Jme,Gme,Yme,$me,zme,Qme,Xme,Zme,ehe,the,rhe,nhe,ihe,ohe,she,ahe,lhe,che,uhe,dhe,phe,fhe,mhe,hhe,ghe,vhe,yhe,bhe,Ihe,She,_he,Ehe,Che,whe,xhe,Phe,Dhe,The,khe,Nhe,Rhe,Ahe,Mhe,Ohe,Lhe,Khe,Fhe,Uhe,Whe,Vhe,jhe,Bhe,Hhe,qhe,Jhe,Ghe,Yhe,$he,zhe,Qhe,Xhe,Zhe,ege,tge,rge,nge,ige,oge,sge,age,lge,cge,uge,dge,pge,fge,mge,hge,gge,vge,yge,bge,Ige,Sge,_ge,Ege,Cge,wge,xge,Pge,Dge,Tge,kge,Nge,Rge,HG=class{constructor(){this[Rfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{totalActivateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},codeLoadingTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},workspaceFolderCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[Afe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:at()};this[Mfe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Ofe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Lfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{hashedNamev2:{classification:"SystemMetaData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...ns()}};this[Kfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{firstTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:at()};this[Ffe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{mimeType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...ns()}};this[Ufe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:at()};this[Wfe]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[Vfe]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer","VariableViewer"]};this[jfe]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[Bfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:at()};this[Hfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:at()};this[qfe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:{codeLensUpdateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},maxCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Jfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Gfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Yfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[$fe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[zfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Qfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...Nd(),failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Reason for failure to fetch kernel specs"},sessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},specsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSpecsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:at()};this[Xfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},serverIdHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},providerExtensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},baseUrlHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelId:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelLanguage:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},isArgv0SameAsInterpreter:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Zfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{serverIdHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},baseUrlHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isLocalHost:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isJupyterHub:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},reason:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[eme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[tme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[rme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:Zi().properties,measures:{...at()}};this[nme]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[ime]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[ome]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[sme]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"},cancelled:{classification:"SystemMetaData",purpose:"FeatureInsight"},successful:{classification:"SystemMetaData",purpose:"FeatureInsight"},opened:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[ame]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{scope:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[lme]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[cme]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[ume]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[dme]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[pme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},info:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[fme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[mme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[hme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[gme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[vme]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{nbformat:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"},nbformat_minor:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"}}};this[yme]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"User Action"};this[bme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Ime]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Sme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[_me]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Eme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Cme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[wme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[xme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[Pme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[Dme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Tme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[kme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Nme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Rme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Ame]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Mme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Ome]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Lme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Kme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Fme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Ume]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Wme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Vme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[jme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[Bme]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Hme]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[qme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[Jme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Gme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[Yme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[$me]={owner:"IanMatthewHuff",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[zme]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Qme]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Xme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"},isModulePresent:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pythonEnvType:{classification:"SystemMetaData",purpose:"FeatureInsight"},resourceHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},...ns()},measures:at()};this[Zme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[ehe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",measures:at()};this[the]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rows:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0},columns:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[rhe]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rowsTimer:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[nhe]={owner:"amunger",feature:["DataFrameViewer","VariableViewer"],source:"N/A",properties:{reason:{classification:"SystemMetaData",purpose:"FeatureInsight"},fromVariableView:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[ihe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action"};this[ohe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[she]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},errorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},fallbackErrorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},zmqBinaries:{classification:"CallstackOrException",purpose:"FeatureInsight"}}};this[ahe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:at()};this[lhe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:{variableCount:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[che]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{kind:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},usesShell:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[uhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...Nd(),...ns()},measures:{...at()}};this[dhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonPathDefined:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonEnvFound:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},isCreatedByUs:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[phe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[fhe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",properties:{hasKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the kernel was known at the time of creation"},hasOwner:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the window was created for a text file"},mode:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Creation mode: multiple, perfile or single"},restored:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Was the window restored from a previous session"}},measures:{windowCount:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Number of active interactive windows the user has open",isMeasurement:!0}}};this[mhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{cdnSearched:{classification:"SystemMetaData",purpose:"FeatureInsight"},hashedName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},modelName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[hhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{type:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:at()};this[ghe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[vhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[yhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},isOnline:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[bhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Ihe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[She]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{selection:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[_he]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[Ehe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{msg_type:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[Che]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:{...at(),attempts:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{...Zi().properties,timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[whe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:at()};this[xhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],measures:{...at()},properties:{...Zi().properties,...Nd()}};this[Phe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Code Execution"],measures:at(),properties:{...Zi().properties,...Nd(),extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Dhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],properties:{...Zi().properties,...Nd()}};this[The]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],properties:{...Zi().properties,...Nd()}};this[khe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:Zi().properties};this[Nhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{result:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},...ns(),...Nd(),...Zi().properties},measures:{...at()}};this[Rhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{...ns(),...Nd(),...Zi().properties},measures:at()};this[Ahe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...ns(),...Zi().properties},measures:{reason:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}}};this[Mhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{exitReason:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...ns(),...Zi().properties},measures:{exitCode:{classification:"CallstackOrException",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[Ohe]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...ns(),...Zi().properties,manuallySelectedKernel:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...at(),computeCwd:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},duration:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},envVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},executeCell:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},getConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},interruptHandle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelIdle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInfo:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelReady:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},portUsage:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},postKernelStart:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},preExecuteCellTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},pythonEnvVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},sessionTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},spawn:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startupCode:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},updateConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputsByteSize:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Lhe]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...ns(),...Zi().properties,wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...at(),callPythonApi:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},activatePython:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},discoverEnv:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},createController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},selectController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Khe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{isRequestToShutdownRestartSession:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...ns(),...Zi().properties}};this[Fhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...ns(),...Zi().properties}};this[Uhe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Whe]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{kernelSpecCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInterpreterCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelLiveCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},localKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},remoteKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[Vhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{outputType:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[jhe]={owner:"IanMatthewHuff",feature:["InteractiveWindow"],tags:["IntelliSense"],source:"N/A",measures:at(),properties:{isResultNull:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Bhe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:at()};this[Hhe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[qhe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:at()};this[Jhe]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"N/A",measures:at()};this[Ghe]={owner:"amunger",feature:"N/A",source:"N/A",properties:{command:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Yhe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{newState:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[$he]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:{numberOfDimensions:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[zhe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{source:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Qhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},dependenciesInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Xhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Zhe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[ege]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[tge]={owner:"roblourens",feature:["Debugger"],properties:{status:{classification:"SystemMetaData",purpose:"FeatureInsight"}},source:"N/A"};this[rge]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[nge]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[ige]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[oge]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[sge]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[age]={owner:"roblourens",feature:["Debugger"],source:"N/A",properties:{reason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[lge]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{...at(),requestDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},timesExceededTimeout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},completionItems:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},monacoLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},completed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusAfterRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusBeforeRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[cge]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[uge]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[dge]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"}},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[pge]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{accessAllowed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[fge]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},cancelledAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestAcknowledgedAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestSentAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},...at()},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},mimeTypes:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}};this[mge]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:at(),properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[hge]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{clientExtId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[gge]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},allowed:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[vge]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},providerId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}},measures:at()};this[yge]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[bge]={owner:"roblourens",feature:["InteractiveWindow","Debugger"],source:"N/A"};this[Ige]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...Zi().properties,...ns()}};this[Sge]={owner:"donjayamanne",source:"N/A",feature:["KernelPicker"]};this[_ge]={owner:"donjayamanne",source:"User Action",feature:["KernelPicker"]};this[Ege]={owner:"amunger",feature:"N/A",source:"N/A",properties:{testName:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},testResult:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},perfWarmup:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},commitHash:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},timedCheckpoints:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[Cge]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{matchedReason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[wge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{requireEntryPointCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}},properties:{failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},failure:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},patternUsedToRegisterRequireConfig:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},widgetFolderNameHash:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[xge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:at()};this[Pge]={owner:"donjayamanne",feature:["DataFrameViewer"],source:"N/A"};this[Dge]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Tge]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[kge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...at(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0},preExecuteDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent in VS Code before starting execution.",isMeasurement:!0},executeDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent executing cells.",isMeasurement:!0},postExecuteDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent in VS Code after executing cells.",isMeasurement:!0}},properties:{outputType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The kind of outputs generated in the notebook, text, html or images."}}};this[Nge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...at(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0}},properties:{outputType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The kind of outputs generated in the notebook, text, html or images."}}};this[Rge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...at(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0}}}}};Rfe="EXTENSION.LOAD",Afe="DS_INTERNAL.EXPERIMENT_LOAD",Mfe="ENVFILE_VARIABLE_SUBSTITUTION",Ofe="ENVFILE_WORKSPACE",Lfe="HASHED_PACKAGE_NAME",Kfe="DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",Ffe="DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",Ufe="DS_INTERNAL.GET_ACTIVATED_ENV_VARIABLES",Wfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX",Vfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",jfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX",Bfe="DATASCIENCE.ADD_CELL_BELOW",Hfe="DS_INTERNAL.CODE_LENS_ACQ_TIME",qfe="DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",Jfe="DATASCIENCE.DEBUG_CONTINUE",Gfe="DATASCIENCE.DEBUG_CURRENT_CELL",Yfe="DATASCIENCE.DEBUG_STEP_OVER",$fe="DATASCIENCE.DEBUG_STOP",zfe="DATASCIENCE.DEBUG_FILE_INTERACTIVE",Qfe="DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",Xfe="DS_INTERNAL.JUPYTER_KERNEL_SPEC",Zfe="DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",eme="DATASCIENCE.DISABLE_INTERACTIVE_SHIFT_ENTER",tme="DATASCIENCE.ENABLE_INTERACTIVE_SHIFT_ENTER",rme="DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",nme="DATASCIENCE.EXPORT_PYTHON_FILE",ime="DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT",ome="DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",sme="DATASCIENCE.EXPORT_NOTEBOOK_AS",ame="DATASCIENCE.IMPORT_NOTEBOOK",lme="DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",cme="DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",ume="DS_INTERNAL.GET_PASSWORD_FAILURE",dme="DS_INTERNAL.GET_PASSWORD_SUCCESS",pme="DS_INTERNAL.JUPYTER_HUB_PASSWORD",fme="DS_INTERNAL.SHOW_DATA_NO_PANDAS",mme="DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD",hme="DS_INTERNAL.SHOW_DATA_PANDAS_OK",gme="DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED",vme="DATASCIENCE.NATIVE.OPEN_NOTEBOOK_ALL",yme="DATASCIENCE.OPEN_PLOT_VIEWER",bme="DATASCIENCE.RUN_ALL_CELLS",Ime="DATASCIENCE.RUN_SELECTION_OR_LINE",Sme="DATASCIENCE.RUN_CURRENT_CELL",_me="DATASCIENCE.RUN_ALL_CELLS_ABOVE",Eme="DATASCIENCE.RUN_CELL_AND_ALL_BELOW",Cme="DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE",wme="DATASCIENCE.RUN_FILE_INTERACTIVE",xme="DATASCIENCE.RUN_TO_LINE",Pme="DATASCIENCE.RUN_FROM_LINE",Dme="DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION",Tme="DATASCIENCE.RUN_INSERT_CELL_BELOW",kme="DATASCIENCE.RUN_INSERT_CELL_ABOVE",Nme="DATASCIENCE.RUN_DELETE_CELLS",Rme="DATASCIENCE.RUN_SELECT_CELL",Ame="DATASCIENCE.RUN_SELECT_CELL_CONTENTS",Mme="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE",Ome="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW",Lme="DATASCIENCE.RUN_MOVE_CELLS_UP",Kme="DATASCIENCE.RUN_MOVE_CELLS_DOWN",Fme="DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN",Ume="DATASCIENCE.RUN_CHANGE_CELL_TO_CODE",Wme="DATASCIENCE.GOTO_NEXT_CELL_IN_FILE",Vme="DATASCIENCE.GOTO_PREV_CELL_IN_FILE",jme="DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW",Bme="DATASCIENCE.SELFCERTSMESSAGECLOSE",Hme="DATASCIENCE.SELFCERTSMESSAGEENABLED",qme="DATASCIENCE.USER_INSTALLED_JUPYTER",Jme="DATASCIENCE.USER_INSTALLED_PANDAS",Gme="DATASCIENCE.USER_DID_NOT_INSTALL_JUPYTER",Yme="DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS",$me="DS_INTERNAL.PYTHON_NOT_INSTALLED",zme="DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",Qme="DS_INTERNAL.PYTHON_EXTENSION_INSTALLED_VIA_KERNEL_PICKER",Xme="DS_INTERNAL.PYTHON_MODULE_INSTALL",Zme="DS_INTERNAL.SHIFTENTER_BANNER_SHOWN",ehe="DATASCIENCE.START_SHOW_DATA_EXPLORER",the="DATASCIENCE.SHOW_DATA_EXPLORER",rhe="DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",nhe="DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",ihe="DATASCIENCE.REFRESH_DATA_VIEWER",ohe="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT",she="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT_FAILURE",ahe="DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME",lhe="DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",che="DATASCIENCE.KERNEL_SPEC_LANGUAGE",uhe="DS_INTERNAL.KERNEL_LAUNCHER_PERF",dhe="GLOBAL_PYTHON_KERNELSPEC",phe="DS_INTERNAL.NEW_FILE_USED_IN_INTERACTIVE",fhe="DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",mhe="DS_INTERNAL.IPYWIDGET_USED_BY_USER",hhe="DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",ghe="DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED",vhe="DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",yhe="DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",bhe="DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",Ihe="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN",She="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",_he="DS_INTERNAL.IPYWIDGET_RENDER_FAILURE",Ehe="DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",Che="DS_INTERNAL.RAWKERNEL_INFO_RESPONSE",whe="DS_INTERNAL.RAWKERNEL_PROCESS_LAUNCH",xhe="DATASCIENCE.EXECUTE_CELL",Phe="DATASCIENCE.EXECUTE_CODE",Dhe="DATASCIENCE.RESUME_EXECUTE_CELL",The="DATASCIENCE.NOTEBOOK_START",khe="DS_INTERNAL.SWITCH_KERNEL",Nhe="DATASCIENCE.NOTEBOOK_INTERRUPT",Rhe="DATASCIENCE.NOTEBOOK_RESTART",Ahe="DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",Mhe="DS_INTERNAL.RAWKERNEL_SESSION_KERNEL_PROCESS_EXITED",Ohe="DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",Lhe="DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",Khe="DS_INTERNAL.RAWKERNEL_SESSION_SHUTDOWN",Fhe="DS_INTERNAL.RAWKERNEL_SESSION_DISPOSED",Uhe="DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER",Whe="DS_INTERNAL.KERNEL_COUNT",Vhe="DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",jhe="DS_INTERNAL.INTERACTIVE_FILE_TOOLTIPS_PERF",Bhe="DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED",Hhe="DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE",qhe="DATAVIEWER.WEBVIEW_LOADED",Jhe="PLOTVIEWER.WEBVIEW_LOADED",Ghe="DS_INTERNAL.COMMAND_EXECUTED",Yhe="DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",$he="DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",zhe="DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",Qhe="DATASCIENCE.CREATE_PYTHON_ENVIRONMENT",Xhe="DATASCIENCE.RECOMMENT_EXTENSION",Zhe="DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP",ege="DATASCIENCE.DEBUGGING.CLOSED_MODAL",tge="DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",rge="DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE",nge="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE",ige="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_IW_JUPYTER",oge="DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL",sge="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL",age="DATASCIENCE.DEBUGGING.ENDED_SESSION",lge="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",cge="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",uge="DATASCIENCE.JUPYTER_KERNEL_API_USAGE",dge="DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",pge="DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",fge="DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",mge="DATASCIENCE.JUPYTER_NEW_KERNEL_API_KERNEL_STARTUP_WAIT_UNTIL",hge="DATASCIENCE.JUPYTER_API_USAGE",gge="DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",vge="DATASCIENCE.JUPYTER_KERNEL_STARTUP_HOOK",yge="DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE",bge="DATASCIENCE.INTERACTIVE_WINDOW_DEBUG_SETUP_CODE_FAILURE",Ige="DATASCIENCE.KERNEL_CRASH",Sge="DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER",_ge="DATASCIENCE.JUPYTER_KERNEL_FILTER_USED",Ege="DS_INTERNAL.RUNTEST",Cge="DS_INTERNAL.PREFERRED_KERNEL_EXACT_MATCH",wge="DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",xge="DS_INTERNAL.IPYWIDGET_TIME_TO_COPY_NBEXTENSIONS_DIR",Pge="DATASCIENCE.NO_ACTIVE_KERNEL_SESSION",Dge="DATAVIEWER.USING_INTERPRETER",Tge="DATAVIEWER.USING_KERNEL",kge="DATASCIENCE.JUPYTER_NOTEBOOK_EXEC_PERFORMANCE",Nge="DATASCIENCE.JUPYTER_JUPYTER_NOTEBOOK_EXEC_PERFORMANCE",Rge="DATASCIENCE.JUPYTER_NOTEBOOK_EDIT_PERFORMANCE";p();var Mf=require("vscode");function Zb(r){let e=Kc(r.uri);return Rt(e.path)}function w2(r=Mf.Uri.file(""),e=Mf.Uri.file(""),t=xi(),n=!1){let i=Kc(r,t,t=="Windows"||n),o=Kc(e,t,t=="Windows"||n);return i===o||Xs(i,o,!0)}function Kc(r=Mf.Uri.file(""),e=xi(),t=!1){let n=ct(r);return t&&(n=n.toLowerCase()),n.endsWith("/bin/python")?["Linux","OSX"].includes(e)?n.endsWith("/bin/python")&&n.split("/").length>4?Mf.Uri.file(n.replace("/bin/python","/python")):Mf.Uri.file(n):Mf.Uri.file(n):Mf.Uri.file(n)}p();var qG=require("vscode");var eI=class{constructor(){this.promises=new Set;this._onStateChange=new qG.EventEmitter;this.onStateChange=this._onStateChange.event}get isComplete(){return this.promises.size===0}dispose(){this._onStateChange.dispose()}push(e){this.promises.add(e),this._onStateChange.fire(),e.finally(()=>{this.promises.delete(e),this.isComplete&&this._onStateChange.fire()}).catch(E)}};p();var LN=class extends Ln{constructor(e){super("Python Extension failed to activate",e,"pythonExtension")}};p();var KN=class extends ot{constructor(){super("pythonExtension","Python Extension API not exported")}};var PY=oe(GN());p();var Ng=require("vscode");var YN=class{};function lY(r,e=""){let t=r?Ng.workspace.getWorkspaceFolder(r):Ng.workspace.workspaceFolders?Ng.workspace.workspaceFolders[0]:void 0;return t?Is(xi()==="Windows"?t.uri.path.toUpperCase():t.uri.path):e}function lI(){let r=Array.isArray(Ng.workspace.workspaceFolders)&&Ng.workspace.workspaceFolders.length>0?Ng.workspace.workspaceFolders[0]:void 0;return r==null?void 0:r.uri}p();var Kg=require("vscode");p();p();p();var uY=oe(GN());var Mg=require("vscode");p();var cY=require("vscode");function Ag(r){return(e,t=null,n)=>{let i=!1,o;return o=r(s=>{if(!i)return o?o.dispose():i=!0,e.call(t,s)},null,n),i&&o.dispose(),o}}function _x(r,e=null,t){return new Promise(n=>Ag(r)(n,e,t))}var Rg=class{constructor(){this._listeners=new Set}get event(){return this._event||(this._event=(e,t,n)=>{this._listeners.add(t?e.bind(t):e);let i=new cY.Disposable(()=>this._listeners.delete(e));return n==null||n.push(i),i}),this._event}async fireAsync(e,t){if(this._listeners){this._asyncDeliveryQueue||(this._asyncDeliveryQueue=[]);for(let n of this._listeners)this._asyncDeliveryQueue.push([n,e]);for(;this._asyncDeliveryQueue.length>0&&!t.isCancellationRequested;){let[n,i]=this._asyncDeliveryQueue.shift(),o=[],s={...i,token:t,waitUntil:a=>{if(Object.isFrozen(o))throw new Error("waitUntil can NOT be called asynchronous");o.push(a)}};try{n(s)}catch(a){console.error(a);continue}Object.freeze(o),await Promise.allSettled(o).then(a=>{for(let l of a)l.status==="rejected"&&console.error(l.reason)})}}}dispose(){this._listeners.clear()}};var hve={output_type:"stream",name:"stdout",text:""},gve={output_type:"error",ename:"",evalue:"",traceback:[""]},vve={output_type:"display_data",data:{},metadata:{}},yve={output_type:"execute_result",execution_count:0,data:{},metadata:{}},f3e={stream:new Set(Object.keys(hve)),error:new Set(Object.keys(gve)),display_data:new Set(Object.keys(vve)),execute_result:new Set(Object.keys(yve))};function Al(r){return r&&Zv(r).toLowerCase().endsWith("ipynb")?"notebook":"interactive"}function Uc(r){return r=r.toLowerCase(),r.length===2&&r.endsWith("#")?`${r.substring(0,1)}sharp`:bB.get(r)||r}function hr(r){return typeof r=="string"?r===St||r===vr:r.notebookType===St||r.notebookType===vr}function _a(r){let e=r.metadata;return JSON.parse(JSON.stringify((e==null?void 0:e.metadata)||{}))}async function dY(r,e){let t=new Mg.WorkspaceEdit;t.set(r.uri,[Mg.NotebookEdit.updateNotebookMetadata(H2({...r.metadata||{},metadata:e}))]),await Mg.workspace.applyEdit(t)}function cI(r){return Mg.workspace.notebookDocuments.find(e=>hr(e)&&e.getCells().some(t=>t.document===r))}function Wc(r){if(Array.isArray(r)){let e="";for(let t=0;t<r.length;t+=1){let n=r[t];t<r.length-1&&!n.endsWith(`
`)?e=e.concat(`${n}
`):e=e.concat(n)}return e}return r.toString()}function uI(r){if(Array.isArray(r))return r;let e=r.toString();if(e.length>0){let t=e.split(`
`);return t.map((n,i)=>i<t.length-1?`${n}
`:n).filter(n=>n.length>0)}return[]}function bve(r){let e=r;do r=e,e=r.replace(/[^\n]\x08/gm,"");while(e.length<r.length);return r}function Ive(r){for(r=r.replace(/\r+\n/gm,`
`);r.search(/\r[^$]/g)>-1;){var e=r.match(/^(.*)\r+/m)[1],t=r.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),r=r.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return r}function pY(r){return Ive(bve(r))}var $N="'''",zN='"""';function Og(r,e,t){let n,i,o=0;for(let s of r){let a=s.trim(),l=a.startsWith($N)?$N:a.startsWith(zN)?zN:void 0,u=a.includes($N)?$N:a.includes(zN)?zN:void 0;if(i)i===u&&(i=void 0),t(s,o);else if(n)n===l&&(n=void 0),n&&e(s,o);else if(u&&!l){let c=a.indexOf(u);i=a.lastIndexOf(u)!==c?void 0:u,t(s,o)}else if(l){let c=a.indexOf(l,3);n=c>=0?void 0:l,a.length>3&&e(a.slice(3,c>=0?c:void 0),o)}else a.startsWith("#")?e(a.slice(1),o):t(s,o);o+=1}}function dI(r,e=`
`,t){return r.map((n,i)=>{let o=t?t(n):n;return i===r.length-1?`${o}`:`${o}${e}`})}function Sve(r){let e=[];return Og(r,t=>e.push(t),t=>{}),e}function QN(r){return dI(Sve(r.slice(r.length>1?1:0)))}function fY(r){let e=r.length,t=-1;return r.forEach((n,i)=>{n.trim()&&(e=i,t<0&&(t=i))}),t>=0?r.slice(t,e+1):[]}function mY(r){var t;let e=/^\s*(\d+)\.(\d+)\.(.+)\s*$/.exec(r);if(e&&e.length>2){let n=parseInt(e[1],10),i=parseInt(e[2],10),o=parseInt(e[3],10);return(t=(0,uY.parse)(`${n}.${i}.${o}`,!0))!=null?t:void 0}}function Of(r){let e=JSON.parse(JSON.stringify(r.metadata||{}))||{metadata:{}};return e.metadata=e.metadata||{},e}function H2(r){return _ve(r)}function _ve(r){return Array.isArray(r)?r.map(H2):r!=null&&typeof r=="object"&&Object.keys(r).length>0?Object.keys(r).sort().reduce((e,t)=>(e[t]=H2(r[t]),e),{}):r}async function Lg(r,e=[]){let t=_x(r.onDidDispose,void 0,e);r.dispose(),await t}var XN=new Map,J2=new Map,q2;function hY(r){q2=r}function G2(r,e){if(!r.pythonEnvironmentPath)return;let t=Re();Eve({interpreterHash:r.pythonEnvironmentPath}).then(n=>{r.pythonEnvironmentPackages=n||r.pythonEnvironmentPackages,e&&(e.pythonEnvironmentPackages=n||e.pythonEnvironmentPackages)}).catch(()=>{}).finally(()=>{t.resolve()})}async function Eve(r){if(!q2)return C.error("Python package provider is not initialized."),"{}";let e;if("interpreter"in r?e=r.interpreter:e=J2.get(r.interpreterHash),!e)return"{}";let t=await q2(e);return!t||t.size===0?"{}":JSON.stringify(Object.fromEntries(t))}async function gY(r){if(!r)return{};let e=XN.get(Ua(r)),t=Al(r);if(!e&&t)return{resourceType:t,resourceHash:r?await Rt(r.toString()):void 0};if(!e)return{};let n=JSON.parse(JSON.stringify(e[0]));return G2(e[0],n),n}function Rr(r,e,t,n,i){gY(r).then(o=>{Object.assign(o,n||{}),ne(e,t,o,i)}).catch(E)}var qn=!1,pI=new WeakMap,ZN=new Map,Ea,yY=0;function Vc(r){var t,n;if(!r)return;if(ui(r)&&!ZN.has(r.toString())){let i=Kg.workspace.notebookDocuments.find(o=>o.uri.toString()===r.toString());i&&ZN.set(r.toString(),new WeakRef(i))}let e=ui(r)?(t=ZN.get(r.toString()))==null?void 0:t.deref():r;if(e)return(n=pI.get(e))==null?void 0:n.tracker}function bY(r){let e=new En;return Ea=r,yY=r.elapsedTime,Kg.workspace.notebookDocuments.forEach(t=>pI.set(t,vY(t,!0,r))),e.add(Kg.workspace.onDidOpenNotebookDocument(t=>{!pI.has(t)&&!qn&&pI.set(t,vY(t,!1,r))})),e.add(Kg.workspace.onDidCloseNotebookDocument(t=>{pI.delete(t),ZN.delete(t.uri.toString())})),e}function IY(r){var e;(e=pI.get(r))==null||e.tracker.kernelManuallySelected()}var e1={starAfter:-1,completedAfter:-1},Y2=new Map,SY=new Map,Cve=new Map,_Y=lr(()=>(e1.starAfter=Ea==null?void 0:Ea.elapsedTime,{stop:lr(()=>{e1.completedAfter=Ea.elapsedTime})}));function EY(r,e){Y2.set(r,Ea==null?void 0:Ea.elapsedTime),Cve.set(r,e||"")}function CY(r){r.executable.uri&&SY.set(r.id,Ea==null?void 0:Ea.elapsedTime)}function vY(r,e,t){let n=Ea.elapsedTime,i=t.elapsedTime,o={openedAfter:i},s=u=>(u==="executeCell"&&(qn=!0),o[`${u}StartedAfter`]=t.elapsedTime,{stop:lr(()=>{o[`${u}CompletedAfter`]=t.elapsedTime})}),a={wasAlreadyOpen:e},l=()=>{};return{measures:o,info:a,tracker:{kernelSelected:lr((u,c)=>{let d=Y2.get(u);typeof d=="number"&&(a.wasAlreadyOpen?o.controllerCreatedAfter=Y2.get(u):o.controllerCreatedAfter=n-d),o.interpreterDiscoveredAfter=SY.get(c||""),o.kernelSelectedAfter=t.elapsedTime,a.manuallySelectedKernel||Pve(r,{wasAlreadyOpen:a.wasAlreadyOpen},{controllerCreatedAfter:o.controllerCreatedAfter,kernelSelectedAfter:o.kernelSelectedAfter,openedAfter:i,interpreterDiscoveredAfter:o.interpreterDiscoveredAfter})}),kernelManuallySelected:lr(()=>a.manuallySelectedKernel=!0),cellExecutionCount:qn?l:lr(u=>o.executeCellCount=u),preExecuteCellTelemetry:qn?l:lr(()=>s("preExecuteCellTelemetry")),startKernel:qn?l:lr(()=>s("startKernel")),executeCell:qn?l:lr(()=>s("executeCell")),executeCellAcknowledged:qn?l:lr(()=>{o.executeCellAcknowledgedAfter=t.elapsedTime,wve(r,a,o)}),jupyterSessionTelemetry:qn?l:lr(()=>s("sessionTelemetry")),postKernelStartup:qn?l:lr(()=>s("postKernelStart")),computeCwd:qn?l:lr(()=>s("computeCwd")),getConnection:qn?l:lr(()=>s("getConnection")),updateConnection:qn?l:lr(()=>s("updateConnection")),kernelReady:qn?l:lr(()=>s("kernelReady")),portUsage:qn?l:lr(()=>s("portUsage")),spawn:qn?l:lr(()=>s("spawn")),pythonEnvVars:qn?l:lr(()=>s("pythonEnvVars")),envVars:qn?l:lr(()=>s("envVars")),interruptHandle:qn?l:lr(()=>s("interruptHandle")),kernelInfo:qn?l:lr(()=>s("kernelInfo")),kernelIdle:qn?l:lr(()=>s("kernelIdle"))}}}var wve=lr(function(r,e,t){if(typeof t.preExecuteCellTelemetryStartedAfter!="number"||typeof t.preExecuteCellTelemetryCompletedAfter!="number"||typeof t.executeCellAcknowledgedAfter!="number"||typeof t.startKernelStartedAfter!="number"||typeof t.startKernelCompletedAfter!="number"||typeof t.executeCellStartedAfter!="number"||typeof t.sessionTelemetryStartedAfter!="number"||typeof t.sessionTelemetryCompletedAfter!="number"||typeof t.postKernelStartStartedAfter!="number"||typeof t.postKernelStartCompletedAfter!="number"||typeof t.kernelInfoStartedAfter!="number"||typeof t.kernelInfoCompletedAfter!="number"||typeof t.kernelIdleStartedAfter!="number"||typeof t.kernelIdleCompletedAfter!="number"||typeof t.computeCwdStartedAfter!="number"||typeof t.computeCwdCompletedAfter!="number"||typeof t.kernelReadyStartedAfter!="number"||typeof t.kernelReadyCompletedAfter!="number"||typeof t.getConnectionStartedAfter!="number"||typeof t.getConnectionCompletedAfter!="number"||typeof t.updateConnectionStartedAfter!="number"||typeof t.updateConnectionCompletedAfter!="number"||typeof t.portUsageStartedAfter!="number"||typeof t.portUsageCompletedAfter!="number"||typeof t.spawnStartedAfter!="number"||typeof t.spawnCompletedAfter!="number"||typeof t.pythonEnvVarsStartedAfter!="number"||typeof t.pythonEnvVarsCompletedAfter!="number"||typeof t.envVarsStartedAfter!="number"||typeof t.envVarsCompletedAfter!="number")return;let n={duration:0,preExecuteCellTelemetry:0,startKernel:0,executeCell:0};{let u=[{name:"preExecuteCellTelemetry",start:t.preExecuteCellTelemetryStartedAfter,end:t.preExecuteCellTelemetryCompletedAfter},{name:"startKernel",start:t.startKernelStartedAfter,end:t.startKernelCompletedAfter},{name:"executeCell",start:t.executeCellStartedAfter,end:t.executeCellAcknowledgedAfter}],c=t.executeCellAcknowledgedAfter-t.preExecuteCellTelemetryStartedAfter;n.duration=c,Ex(n,u,c,t.openedAfter)}let i={sessionTelemetry:0,postKernelStart:0,computeCwd:0,getConnection:0,updateConnection:0,kernelReady:0,portUsage:0,spawn:0};{let u=[{name:"sessionTelemetry",start:t.sessionTelemetryStartedAfter,end:t.sessionTelemetryCompletedAfter},{name:"postKernelStart",start:t.postKernelStartStartedAfter,end:t.postKernelStartCompletedAfter},{name:"computeCwd",start:t.computeCwdStartedAfter,end:t.computeCwdCompletedAfter},{name:"getConnection",start:t.getConnectionStartedAfter,end:t.getConnectionCompletedAfter},{name:"updateConnection",start:t.updateConnectionStartedAfter,end:t.updateConnectionCompletedAfter},{name:"spawn",start:t.spawnStartedAfter,end:t.spawnCompletedAfter},{name:"portUsage",start:t.portUsageStartedAfter,end:t.portUsageCompletedAfter},{name:"kernelReady",start:t.kernelReadyStartedAfter,end:t.kernelReadyCompletedAfter}],c=t.startKernelCompletedAfter-t.startKernelStartedAfter;Ex(i,u,c,t.openedAfter)}let o={startupCode:0,kernelInfo:0,kernelIdle:0};{let u=[{name:"startupCode",start:t.postKernelStartStartedAfter,end:t.kernelInfoStartedAfter},{name:"kernelInfo",start:t.kernelInfoStartedAfter,end:t.kernelInfoCompletedAfter},{name:"kernelIdle",start:t.kernelIdleStartedAfter,end:t.kernelIdleCompletedAfter}],c=t.postKernelStartCompletedAfter-t.postKernelStartStartedAfter;Ex(o,u,c,t.openedAfter)}let s={pythonEnvVars:0,envVars:0,interruptHandle:0};{let u=[{name:"pythonEnvVars",start:t.pythonEnvVarsStartedAfter,end:t.pythonEnvVarsCompletedAfter},{name:"envVars",start:t.envVarsStartedAfter,end:t.envVarsCompletedAfter},{name:"interruptHandle",start:t.interruptHandleStartedAfter||0,end:t.interruptHandleCompletedAfter||0}],c=t.spawnCompletedAfter-t.spawnStartedAfter;Ex(s,u,c,t.openedAfter)}let a=xve(r),l={...n,...i,...o,...s,...a};Rr(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",l,e)});function xve(r){let e={attachmentCharLength:0,attachmentCount:0,codeCellCharLength:0,codeCellCount:0,mdCellCharLength:0,mdCellCount:0,outputCount:0,outputsByteSize:0};return r.getCells().forEach(t=>{let n=t.document.lineAt(t.document.lineCount-1).range.end,i=t.document.offsetAt(n);if(t.kind===Kg.NotebookCellKind.Markup){e.mdCellCount+=1,e.mdCellCharLength+=i;try{let s=Of(t).attachments||{};Object.keys(s).forEach(a=>{e.attachmentCount+=1;let l=s[a];typeof l=="object"&&Object.keys(l).forEach(u=>{let c=l[u];c&&typeof c=="string"&&(e.attachmentCharLength+=c.length)})})}catch(o){C.warn("Error parsing attachments in cell metadata",o)}}else e.codeCellCount+=1,e.codeCellCharLength+=i,e.outputCount+=t.outputs.length,e.outputsByteSize+=t.outputs.reduce((o,s)=>o+s.items.reduce((a,l)=>a+l.data.byteLength,0),0)}),e}var Pve=lr(function(r,e,t){if(t.pythonExtensionActivationStartedAfter=e1.starAfter,t.pythonExtensionActivationCompletedAfter=e1.completedAfter,typeof t.controllerCreatedAfter=="undefined"||typeof t.interpreterDiscoveredAfter=="undefined"||typeof t.pythonExtensionActivationCompletedAfter=="undefined"||typeof t.pythonExtensionActivationStartedAfter=="undefined")return;let n=[{name:"callPythonApi",start:yY,end:t.pythonExtensionActivationStartedAfter},{name:"activatePython",start:t.pythonExtensionActivationStartedAfter,end:t.pythonExtensionActivationCompletedAfter},{name:"discoverEnv",start:t.pythonExtensionActivationCompletedAfter,end:t.interpreterDiscoveredAfter},{name:"createController",start:t.interpreterDiscoveredAfter,end:t.controllerCreatedAfter},{name:"selectController",start:t.controllerCreatedAfter,end:t.kernelSelectedAfter}],i=t.kernelSelectedAfter-t.openedAfter,o={duration:i};Ex(o,n,i,t.openedAfter),Rr(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",o,e)});function Ex(r,e,t,n){e.sort((i,o)=>i.start-o.start).forEach(i=>{typeof n=="number"&&n>=i.start&&n<=i.end?r[i.name]=(i.end-n)*100/t:typeof n=="number"&&n>i.end?r[i.name]=0:(typeof n=="number"&&n<i.start||typeof n!="number")&&(r[i.name]=(i.end-i.start)*100/t)})}p();var Dve=require("vscode");p();function wY(r){return xi()==="Windows"?Is(r).toUpperCase():Is(r)}function t1(r,e){return e.endsWith(Ki)||(e+=Ki),r.endsWith(Ki)||(r+=Ki),wY(r).startsWith(wY(e))}function xY(r,e){let t=e.filter(n=>{var i,o,s;return t1(((o=(i=n.environment)==null?void 0:i.folderUri)==null?void 0:o.fsPath)||((s=n.executable.uri)==null?void 0:s.fsPath)||n.path,r.fsPath)});return t.find(n=>{var i,o;return _r(n)==="Venv"&&((o=(i=n.environment)==null?void 0:i.name)==null?void 0:o.toLowerCase())===".venv"})||t.find(n=>{var i,o;return _r(n)==="Conda"&&((o=(i=n.environment)==null?void 0:i.name)==null?void 0:o.toLowerCase())===".conda"})||t.find(n=>{var i,o;return["VirtualEnv","VirtualEnvWrapper"].includes(_r(n))&&((o=(i=n.environment)==null?void 0:i.name)==null?void 0:o.toLowerCase())===".venv"})||t.find(n=>{var i,o,s,a;return((o=(i=n.environment)==null?void 0:i.name)==null?void 0:o.toLowerCase())===".venv"||((a=(s=n.environment)==null?void 0:s.name)==null?void 0:a.toLowerCase())===".conda"})||t.length?t[0]:void 0}function Cx(r,e){if(r){let t={...r,uri:It.Uri.file(r.path||""),id:e||r.id};return delete t.path,t}}function wx(r){if(r){let e=Object.assign({},r,{path:ct(r.uri)});return delete e.uri,e}}var fI=class{constructor(e,t){this.disposables=e;this.extensionChecker=t;this.api=Re();this.didActivatePython=new It.EventEmitter;this._pythonExtensionHooked=Re();this.extensionChecker.isPythonExtensionInstalled||It.extensions.onDidChange(async()=>{this.extensionChecker.isPythonExtensionInstalled&&await this.registerHooks()},this,this.disposables),this.disposables.push(this.didActivatePython)}get onDidActivatePythonExtension(){return this.didActivatePython.event}get pythonExtensionHooked(){return this._pythonExtensionHooked.promise}get pythonExtensionVersion(){return this._pythonExtensionVersion}getApi(){return this.init().catch(E),this.api.promise}async getNewApi(){var t,n;await this.init();let e=It.extensions.getExtension($s);return(t=e==null?void 0:e.packageJSON)!=null&&t.version&&(this._pythonExtensionVersion=new PY.SemVer((n=e==null?void 0:e.packageJSON)==null?void 0:n.version)),e!=null&&e.exports&&(T7(e.exports),e.exports.environments.known.forEach(i=>{CY(i)})),e==null?void 0:e.exports}setApi(e){this.api.resolved||!It.workspace.isTrusted||this.api.resolve(e)}async init(){if(this.initialized)return;It.extensions.getExtension($s)?await this.registerHooks():await this.extensionChecker.showPythonExtensionInstallRequiredPrompt(),this.initialized=!0}async registerHooks(){var n;if(this.hooksRegistered)return;let e=It.extensions.getExtension($s);if(!e)return;let t=!1;if(!e.isActive){let i=_Y();try{let o=e.activate();o.then(()=>i.stop(),()=>i.stop()),await o,t=!0}catch(o){C.error("Failed activating the python extension: ",o),this.api.reject(new LN(o));return}}this.hooksRegistered||(this.hooksRegistered=!0,t&&this.didActivatePython.fire(),(n=e.exports)!=null&&n.jupyter?e.exports.jupyter.registerHooks():(C.error("Python extension is not exporting the jupyter API"),this.api.reject(new KN)),this._pythonExtensionHooked.resolve())}};fI=U([(0,Ca.injectable)(),x(0,(0,Ca.inject)(ve)),x(1,(0,Ca.inject)(vo))],fI);var Lf=class{constructor(e){this.disposables=e;this.pythonExtensionInstallationStatusChanged=new It.EventEmitter;It.extensions.onDidChange(this.extensionsChangeHandler.bind(this),this,this.disposables),this.previousInstallState=this.isPythonExtensionInstalled}get onPythonExtensionInstallationStatusChanged(){return this.pythonExtensionInstallationStatusChanged.event}get isPythonExtensionInstalled(){return It.extensions.getExtension($s)!==void 0}get isPythonExtensionActive(){var e;return((e=It.extensions.getExtension($s))==null?void 0:e.isActive)===!0}async directlyInstallPythonExtension(){return It.commands.executeCommand("workbench.extensions.installExtension",$s,{context:{skipWalkthrough:!0}})}async showPythonExtensionInstallRequiredPrompt(){if(!It.workspace.isTrusted)return;Lf.promptDisplayed=!0;let e=Ue.bannerLabelYes;ne("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"displayed"}),await It.window.showInformationMessage(W.pythonExtensionRequired,{modal:!0},e)===e?(ne("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"download"}),await this.installPythonExtension()):ne("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"dismissed"})}async installPythonExtension(){It.commands.executeCommand("extension.open",$s).then(E,E)}async extensionsChangeHandler(){let e=this.isPythonExtensionInstalled;e!==this.previousInstallState&&(this.pythonExtensionInstallationStatusChanged.fire(e?"installed":"uninstalled"),this.previousInstallState=e)}};Lf=U([(0,Ca.injectable)(),x(0,(0,Ca.inject)(ve))],Lf);var r1=class{constructor(e,t,n,i){this.apiProvider=e;this.extensionChecker=t;this.disposables=n;this.context=i;this.didChangeInterpreter=new It.EventEmitter;this.didChangeInterpreters=new It.EventEmitter;this._onDidEnvironmentVariablesChange=new It.EventEmitter;this._onDidRemoveInterpreter=new It.EventEmitter;this.onDidRemoveInterpreter=this._onDidRemoveInterpreter.event;this.onDidEnvironmentVariablesChange=this._onDidEnvironmentVariablesChange.event;this._status="idle";this._onDidChangeStatus=new It.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.refreshPromises=new eI;this.onResumeEnvDetection=new It.EventEmitter;this.workspaceCachedActiveInterpreter=new Set;this.lastLoggedResourceAndInterpreterId="";this.pythonEnvHashes=new Map;this.loggedEnvsWithoutInterpreterPath=new Set;this.pendingInterpreterChangeEventTriggers=new Map;this.pendingInterpretersChangeEventTriggers=new Map;this.extensionChecker.isPythonExtensionInstalled&&!this.extensionChecker.isPythonExtensionActive&&this.apiProvider.onDidActivatePythonExtension(()=>{this.hookupOnDidChangeInterpreterEvent()},this,this.disposables),It.workspace.onDidGrantWorkspaceTrust(()=>this.refreshInterpreters(!0),this,this.disposables),this.disposables.push(this._onDidChangeStatus),this.disposables.push(this.refreshPromises),this.disposables.push(this.onResumeEnvDetection),this.refreshPromises.onStateChange(()=>{this.status=this.refreshPromises.isComplete?"idle":"refreshing"})}get status(){return this._status}set status(e){this._status!==e&&(this._status=e,this._onDidChangeStatus.fire())}initialize(){this.hookupOnDidChangeInterpreterEvent()}async hasWorkspaceSpecificEnvironment(){if(!(It.workspace.workspaceFolders||[]).length)return!1;let e=await this.getApi();return e?!!(It.workspace.workspaceFolders||[]).some(t=>xY(t.uri,e.environments.known)):!1}async resolveEnvironment(e){return this.getApi().then(t=>{if(!t)return;let n=typeof e=="string"?t.environments.known.find(i=>i.id===e||i.path===e):e;return t.environments.resolveEnvironment(n||e)})}get onDidChangeInterpreter(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreter.event}get onDidChangeInterpreters(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreters.event}async refreshInterpreters(e=!1){let t=(async()=>{let n=await this.getApi();if(n)try{await n.environments.refreshEnvironments({forceRefresh:e}),this.hookupOnDidChangeInterpreterEvent(),C.debug("Refreshed Environments")}catch(i){C.error("Failed to refresh the list of interpreters")}})();this.refreshPromises.push(t),this.refreshPromises.push(t.then(()=>nc(1e3))),await t}async getActiveInterpreter(e){var o,s,a;if(!It.workspace.isTrusted)return;let t=new yt;this.hookupOnDidChangeInterpreterEvent(),!e&&((o=It.workspace.workspaceFolders)==null?void 0:o.length)===1&&(e=It.workspace.workspaceFolders[0].uri),(s=It.workspace.workspaceFolders)!=null&&s.length&&(e=(e?(a=It.workspace.getWorkspaceFolder(e))==null?void 0:a.uri:void 0)||It.workspace.workspaceFolders[0].uri);let n=lY(e),i=this.getApi().then(async l=>{if(!l)return;let u=l.environments.getActiveEnvironmentPath(e),c=await l.environments.resolveEnvironment(u);return this.trackResolvedEnvironment(c)});return i.then(()=>{this.workspaceCachedActiveInterpreter.has(n)||(this.workspaceCachedActiveInterpreter.add(n),ne("DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",{duration:t.elapsedTime},{firstTime:!0}))}).catch(l=>{C.warn(`Failed to get active interpreter from Python for workspace ${n}`,l)}),(ci||[It.ExtensionMode.Development,It.ExtensionMode.Test].includes(this.context.extensionMode))&&i.then(l=>{let u=`${Ee(e)}'-${Ee(l==null?void 0:l.id)}`;if(this.lastLoggedResourceAndInterpreterId===u)return;this.lastLoggedResourceAndInterpreterId=u;let c=Uu(l);C.trace(`Active Interpreter ${e?`for '${Ee(e)}' `:""}is ${Ee(l==null?void 0:l.id)} (${l&&_r(l)}, '${l?Ss(l):""}', ${c==null?void 0:c.major}.${c==null?void 0:c.minor}.${c==null?void 0:c.micro})`)}).catch(E),i}getInterpreterHash(e){return this.pythonEnvHashes.get(e)}async getInterpreterDetails(e,t){if(!It.workspace.isTrusted)throw new Error("Unable to determine active Interpreter as Workspace is not trusted");this.hookupOnDidChangeInterpreterEvent();try{return await this.getApi().then(async n=>{if(!n||t!=null&&t.isCancellationRequested)return;let i=n.environments.known.find(l=>ui(e)?w2(l.executable.uri,e):typeof e=="string"?l.id===e:w2(It.Uri.file(l.path),It.Uri.file(e.path))),o=ui(e)?Ee(e):typeof e=="string"?e:Ee(It.Uri.file(e.path));if(i){let l=await n.environments.resolveEnvironment(i),u=this.trackResolvedEnvironment(l);return C.ci(`Interpreter details for ${o} from Python is ${JSON.stringify(l)} and our mapping is ${JSON.stringify(u)}`),u}let s=o;if(this.loggedEnvsWithoutInterpreterPath.has(s)||(this.loggedEnvsWithoutInterpreterPath.add(s),C.warn(`No interpreter with path ${o} found in Python API, will convert Uri path to string as Id ${o}`)),t!=null&&t.isCancellationRequested)return;let a=await n.environments.resolveEnvironment(ui(e)?e.fsPath:typeof e=="string"?e:e.path);return this.trackResolvedEnvironment(a)})}catch(n){C.warn(`Failed to get Python interpreter details from Python Extension API for ${typeof e=="string"?e:Ee(ui(e)?e:It.Uri.file(e.path))}`,n);return}}trackResolvedEnvironment(e){if(e){let t=hT(e);return t?(Zb(t).then(n=>{this.pythonEnvHashes.set(t.id,n)}).catch(E),this.triggerEventIfAllowed("interpretersChangeEvent",t),t):void 0}}triggerEventIfAllowed(e,t){e==="interpreterChangeEvent"?this.pendingInterpreterChangeEventTriggers.set((t==null?void 0:t.id)||"",t):this.pendingInterpretersChangeEventTriggers.set((t==null?void 0:t.id)||"",t),this.triggerPendingEvents()}triggerPendingEvents(){this.pendingInterpreterChangeEventTriggers.forEach(t=>this.didChangeInterpreter.fire(t)),this.pendingInterpreterChangeEventTriggers.clear();let e=Array.from(this.pendingInterpretersChangeEventTriggers.values());if(e.length){let t=e.filter(n=>!!n);t.length!==e.length&&t.length===0?this.didChangeInterpreters.fire([]):this.didChangeInterpreters.fire(t)}this.pendingInterpretersChangeEventTriggers.clear()}async getApi(){if(this.extensionChecker.isPythonExtensionInstalled)return this.apiPromise||(this.apiPromise=this.apiProvider.getNewApi()),this.apiPromise}hookupOnDidChangeInterpreterEvent(){this.eventHandlerAdded||this.getApi().then(e=>{!this.eventHandlerAdded&&e&&(this.eventHandlerAdded=!0,e.environments.onDidEnvironmentVariablesChange(t=>{var n,i;C.debug(`Detected changes to env file ${(i=(n=t.resource)==null?void 0:n.uri)==null?void 0:i.path} in PythonApi`),this._onDidEnvironmentVariablesChange.fire()},this,this.disposables),e.environments.onDidChangeActiveEnvironmentPath(()=>{C.trace("Detected change in Active Python environment via Python API"),this.workspaceCachedActiveInterpreter.clear(),this.triggerEventIfAllowed("interpreterChangeEvent",void 0)},this,this.disposables),e.environments.onDidChangeEnvironments(async t=>{if(C.trace(`Python API env change detected, ${t.type} => '${t.env.id}'`),t.type==="remove"){this.triggerEventIfAllowed("interpreterChangeEvent",void 0),this.triggerEventIfAllowed("interpretersChangeEvent",void 0),this._onDidRemoveInterpreter.fire({id:t.env.id});return}let n=hT(Bi(t.env));n&&(this.triggerEventIfAllowed("interpreterChangeEvent",n),this.triggerEventIfAllowed("interpretersChangeEvent",n))},this,this.disposables),this.didChangeInterpreters.fire(N7().map(hT).filter(t=>!!t).map(t=>t)))}).catch(E)}};r1=U([(0,Ca.injectable)(),x(0,(0,Ca.inject)(vy)),x(1,(0,Ca.inject)(vo)),x(2,(0,Ca.inject)(ve)),x(3,(0,Ca.inject)(st))],r1);p();var CI=require("vscode");p();function DY(r,e){let t=r.length>0?`?token=${r}`:"";return`${e}${t}`}async function dR(r,e){let t=W.jupyterSelfCertEnable,n=W.jupyterSelfCertClose,i=await CI.window.showErrorMessage(W.jupyterSelfCertFail(e),{modal:!0},t,n);return i===t?(ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,CI.ConfigurationTarget.Workspace),!0):(i===n&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}async function pR(r,e){let t=W.jupyterSelfCertEnable,n=W.jupyterSelfCertClose,i=await CI.window.showErrorMessage(W.jupyterExpiredCertFail(e),{modal:!0},t,n);return i===t?(ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,CI.ConfigurationTarget.Workspace),!0):(i===n&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}function rj(r,e,t,n,i,o,s){var R;let a=e.baseUrl,l=e.token,u=new URL(e.baseUrl).hostname,c=e.authorizationHeader&&Object.keys((R=e==null?void 0:e.authorizationHeader)!=null?R:{}).length>0?e.authorizationHeader:void 0;l&&r.extensionId===Je&&r.id===UE&&(c=c||{},c.Authorization=c.Authorization||`token ${l}`);let d=c?()=>c:void 0,f={baseUrl:a,appUrl:"",wsUrl:a.replace("http","ws"),fetch:e.fetch,WebSocket:e.WebSocket},m=t.getRequestInit();(!(l===""||l==="null")||d)&&(f={...f,token:l,appendToken:!0});let b=i.getSettings(void 0).allowUnauthorizedRemoteConnection;if(a.startsWith("https")&&b&&n){let P=n.createHttpRequestAgent();m={...m,agent:P}}let{ServerConnection:v}=Jn();return f={...f,init:m,WebSocket:e.WebSocket?t.wrapWebSocketCtor(e.WebSocket):t.getWebsocketCtor(void 0,b,d),fetch:e.fetch||t.getFetchMethod(),Request:t.getRequestCtor(void 0,b,d),Headers:t.getHeadersCtor()},{baseUrl:a,providerId:r.id,serverProviderHandle:r,token:l,hostName:u,displayName:e&&e.displayName?e.displayName:DY(l,a),dispose:()=>s==null?void 0:s.dispose(),rootDirectory:o,getAuthHeader:d,settings:v.makeSettings(f)}}async function Hz(r){let e=Vt(r);return Ba(e,"SHA-256")}var UIe=new Set([Je,"ms-toolsai.vscode-ai","GitHub.codespaces"].map(r=>r.toLowerCase()));function Vt(r){return UIe.has(r.extensionId.toLowerCase())?`${nt.REMOTE_URI}?${nt.REMOTE_URI_ID_PARAM}=${r.id}&${nt.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}`:`${nt.REMOTE_URI}?${nt.REMOTE_URI_ID_PARAM}=${r.id}&${nt.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}&${nt.REMOTE_URI_EXTENSION_ID_PARAM}=${encodeURI(r.extensionId)}`}async function fR(r){var e;if(!ic()&&((e=r.interpreter)!=null&&e.uri)){let t=r.interpreter.uri.fsPath,n=Kc(r.interpreter.uri).fsPath,i=r.id.replace(t,n);return Rt(i)}return Rt(r.id)}var Zc=class{static fromJSON(e){let t=Object.assign(e,{});switch(t.interpreter&&(t.interpreter=Cx(t.interpreter,"")),e.kind){case"startUsingLocalKernelSpec":return nj.create(t);case"connectToLiveRemoteKernel":return Gx.create(t);case"startUsingRemoteKernelSpec":return Yx.create(t);case"startUsingPythonInterpreter":return $x.create(t);default:throw new Error(`Invalid object to be deserialized into a connection, kind = ${t.kind}`)}}},Gx=class r{constructor(e){this.kind="connectToLiveRemoteKernel";this.kernelModel=e.kernelModel,this.interpreter=e.interpreter,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,mR(this)}static create(e){return new r(e)}updateModel(e){Object.assign(this.kernelModel,e)}getHashId(){return fR(this)}toJSON(){return{id:this.id,kind:this.kind,baseUrl:this.baseUrl,interpreter:wx(this.interpreter),kernelModel:this.kernelModel,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return Zc.fromJSON(e)}},nj=class r{constructor(e){this.kind="startUsingLocalKernelSpec";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,mR(this)}static create(e){return new r(e)}getHashId(){return fR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:wx(this.interpreter),kind:this.kind}}static fromJSON(e){return Zc.fromJSON(e)}},Yx=class r{constructor(e){this.kind="startUsingRemoteKernelSpec";this.interpreter=e.interpreter,this.kernelSpec=e.kernelSpec,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,mR(this)}static create(e){return new r(e)}getHashId(){return fR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:wx(this.interpreter),baseUrl:this.baseUrl,kind:this.kind,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return Zc.fromJSON(e)}},$x=class r{constructor(e){this.kind="startUsingPythonInterpreter";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,mR(this)}static create(e){return new r(e)}getHashId(){return fR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:wx(this.interpreter),kind:this.kind}}updateInterpreter(e){Object.assign(this.interpreter,e)}static fromJSON(e){return Zc.fromJSON(e)}};function Qt(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"}function Wt(r){return!Qt(r)}var qe=Symbol("IKernelProvider"),jg=Symbol("IThirdPartyKernelProvider");var TGe=Symbol("IJupyterServerConnector"),zx=Symbol("IKernelSessionFactory");var wI=Symbol("IKernelDependencyService"),ii=Symbol("IKernelFinder"),xI=Symbol("ITracebackFormatter");var Od=Symbol("IStartupCodeProviders"),qz=new Set;function mR(r){var m,g;if(qz.has(r.id))return;qz.add(r.id);let e="kernelSpec"in r?r.kernelSpec:void 0,t=(e==null?void 0:e.language)||(r.kind==="startUsingPythonInterpreter"?Ye:void 0),n="",i="",o="interpreter"in r?r.interpreter:void 0,s="<#>",a;e&&Array.isArray(e.argv)&&e.argv.length>0&&(n=e.argv[0],a=n.toLowerCase()===((g=(m=o==null?void 0:o.uri)==null?void 0:m.fsPath)==null?void 0:g.toLowerCase()),Ht(n)!==n&&(n=`<P>${Ht(n)}`),i=e.argv.map(b=>b.includes("/")||b.includes("\\")?`<P>${Ht(b)}`:b).join(s));let l="kernelSpec"in r&&r.kernelSpec.specFile?Rt(r.kernelSpec.specFile):Promise.resolve(""),u=Rt(r.id),c=Wt(r)?Rt(Vt(r.serverProviderHandle)):Promise.resolve(""),d=Wt(r)?r.serverProviderHandle.extensionId:Je,f=Wt(r)?Rt(r.baseUrl.toLowerCase()):Promise.resolve("");Promise.all([l,u,c,f]).then(([b,v,k,R])=>ne("DS_INTERNAL.JUPYTER_KERNEL_SPEC",void 0,{kernelId:v,serverIdHash:k,kernelSpecHash:b,baseUrlHash:R,providerExtensionId:d,kernelConnectionType:r.kind,kernelLanguage:t,envType:o&&_r(o),isArgv0SameAsInterpreter:a,argv0:n,argv:i})).catch(E)}p();var qg=require("vscode");p();var GIe=oe(rV()),Kd=require("vscode");p();var PI=class{constructor(e,t,n,i){this.specFile=t;this.interpreterPath=n;this.isRegisteredByVSC=i;this.name=e.name,this.argv=e.argv,this.language=e.language,this.executable=e.argv&&e.argv.length>0?e.argv[0]:"",this.display_name=e.display_name,this.metadata=e.metadata,this.env=e.env,this.interrupt_mode=e.interrupt_mode}};p();var oi=require("vscode"),Zz=oe(ij());p();var oj=class{constructor(e,t,n,i=!1){this._impl=e;this.controllerId=t;this._endCallback=n;this.clearOutputOnStartWithTime=i;this._started=!1}get started(){return this._started}get cell(){return this._impl.cell}get token(){return this._impl.token}get executionOrder(){return this._impl.executionOrder}set executionOrder(e){var t;e&&((t=Vc(this._impl.cell.notebook))==null||t.executeCellAcknowledged()),this._impl.executionOrder=e}startIfNecessary(){this.started||this._impl.start()}start(e){this.started||(this._started=!0,this._impl.start(e),this._startTime=e,this.clearOutputOnStartWithTime?(C.trace(`Start cell ${this.cell.index} execution @ ${e} (clear output)`),this._impl.clearOutput().then(E,E)):C.trace(`Start cell ${this.cell.index} execution @ ${e}`))}end(e,t){if(this._endCallback)try{this._impl.end(e,t,this.errorInfo),C.trace(`Cell ${this.cell.index} completed in ${((t||0)-(this._startTime||0))/1e3}s (start: ${this._startTime}, end: ${t})`)}finally{this._endCallback(),this._endCallback=void 0}}clearOutput(e){return this.startIfNecessary(),this._impl.clearOutput(e)}replaceOutput(e,t){return this.startIfNecessary(),this._impl.replaceOutput(e,t)}appendOutput(e,t){return this.startIfNecessary(),this._impl.appendOutput(e,t)}replaceOutputItems(e,t){return this.startIfNecessary(),this._impl.replaceOutputItems(e,t)}appendOutputItems(e,t){return this.startIfNecessary(),this._impl.appendOutputItems(e,t)}},qf=class qf{static getOrCreate(e,t,n=!1){let i;if(i=this.get(e),!i)i=qf.create(e,t,n);else if(i.controllerId!==t.id){let o=i;o.end(void 0),i=qf.create(e,t,n),o.started&&i.start(new Date().getTime())}return i}static get(e){return qf._map.get(e)}static create(e,t,n=!1){let i=new oj(t.createNotebookCellExecution(e),t.id,()=>{qf._map.delete(e)},n);return qf._map.set(e,i),i}};qf._map=new WeakMap;var no=qf;p();function hR(r){return typeof Buffer!="undefined"&&typeof Buffer.from=="function"?Buffer.from(r,"base64"):Uint8Array.from(atob(r),e=>e.charCodeAt(0))}var VIe=new TextDecoder;function gR(r){if(typeof Buffer!="undefined"&&typeof Buffer.from=="function")return Buffer.from(r).toString("base64");{let e=VIe.decode(r);return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(t,n){return String.fromCharCode(Number.parseInt("0x"+n))}))}}var $z=["application/vnd.*","application/vdom.*","application/geo+json","application/x-nteract-model-debug+json","text/html","application/javascript","image/gif","text/latex","text/markdown","image/png","image/svg+xml","image/jpeg","application/json","text/plain"];function zz(r){if(r.mime.startsWith("application/vnd."))try{return new TextDecoder().decode(r.data).length===0}catch(e){}return!1}function jIe(r){return r.sort((e,t)=>{let n=(s,a)=>(s.endsWith(".*")&&(s=s.substr(0,s.indexOf(".*"))),a.startsWith(s)),i=$z.findIndex(s=>n(s,e.mime)),o=$z.findIndex(s=>n(s,t.mime));return zz(e)&&(i=-1),zz(t)&&(o=-1),i=i==-1?100:i,o=o==-1?100:o,i-o})}var Jf=class Jf{static getCellState(e){var t;return(t=Jf.cellStates.get(e))==null?void 0:t.state}static getCellStatus(e){var t;return(((t=Jf.cellStates.get(e))==null?void 0:t.stateTransition)||[]).join(", ")||""}static setCellState(e,t){var o,s;let n=((o=Jf.cellStates.get(e))==null?void 0:o.start)||new yt,i=((s=Jf.cellStates.get(e))==null?void 0:s.stateTransition)||[];i.push(`${t} ${i.length===0?"@ start":`After ${n.elapsedTime}ms`}`),Jf.cellStates.set(e,{stateTransition:i,state:t,start:n})}};Jf.cellStates=new WeakMap;var Gf=Jf;function it(r,e){let t=typeof e=="string"?()=>e:e;C.ci(()=>{var n;return`Cell Index:${r.index}, of document ${pi(r.notebook.uri)} with state:${Gf.getCellStatus(r)}, exec: ${(n=r.executionSummary)==null?void 0:n.executionOrder}. ${t()}. called from ${v8()}`})}var TI=new Map;TI.set("display_data",yR);TI.set("error",JIe);TI.set("execute_result",yR);TI.set("stream",BIe);TI.set("update_display_data",yR);function ls(r){let e=TI.get(r.output_type),t;return e?t=e(r):(C.warn(`Unable to translate cell from ${r.output_type} to NotebookCellData for VS Code.`),t=yR(r)),t}function sj(r){let e={outputType:r.output_type};switch(r.transient&&(e.transient=r.transient),r.output_type){case"display_data":case"execute_result":case"update_display_data":{e.executionCount=r.execution_count,e.metadata=r.metadata?JSON.parse(JSON.stringify(r.metadata)):{};break}default:break}return e}function Bg(r){return r.metadata}function yR(r){let e=sj(r);("image/svg+xml"in r.data||"image/png"in r.data)&&(e.__displayOpenPlotIcon=!0);let t=[];if(r.data)for(let n in r.data)t.push(qIe(n,r.data[n]));return new oi.NotebookCellOutput(jIe(t),e)}function BIe(r){let e=Wc(r.text),t=r.name==="stderr"?oi.NotebookCellOutputItem.stderr:oi.NotebookCellOutputItem.stdout;return new oi.NotebookCellOutput([t(e)],sj(r))}function HIe(r){if(r.items.length>0)return r.items[0].mime==="application/vnd.code.notebook.stderr"?"stderr":"stdout"}function Qz(r){var i;let e=r.items[0];if(!e.data)return{output_type:"error",ename:"",evalue:"",traceback:[]};let t=(i=r.metadata)==null?void 0:i.originalError,n=JSON.parse(new TextDecoder().decode(e.data));return{output_type:"error",ename:n.name,evalue:n.message,traceback:(t==null?void 0:t.traceback)||uI(n.stack||n.message||"")}}var DI=new TextDecoder,eQ=["text/plain","text/markdown","application/vnd.code.notebook.stderr","application/vnd.code.notebook.stdout"];function vR(r,e){if(!e)return"";try{if(r==="application/vnd.code.notebook.error"){let t=DI.decode(e);return JSON.parse(t)}else if(r.startsWith("text/")||eQ.includes(r)){let t=DI.decode(e);return uI(t)}else{if(r.startsWith("image/")&&r!=="image/svg+xml")return gR(e);if(r.toLowerCase().startsWith("application/vnd.holoviews_load.v")&&r.toLowerCase().endsWith("+json")){let t=DI.decode(e);try{return t.length>0?JSON.parse(t):t}catch(n){return t}}else if(r.toLowerCase().includes("json")){let t=DI.decode(e);return t.length>0?JSON.parse(t):t}else return DI.decode(e)}}catch(t){return C.error(`Failed to convert ${r} output from a buffer ${typeof e}, ${e}`,t),""}}function qIe(r,e){if(!e)return oi.NotebookCellOutputItem.text("",r);try{if((r.startsWith("text/")||eQ.includes(r))&&(Array.isArray(e)||typeof e=="string")){let t=Array.isArray(e)?Wc(e):e;return oi.NotebookCellOutputItem.text(t,r)}else return r.startsWith("image/")&&typeof e=="string"&&r!=="image/svg+xml"?new oi.NotebookCellOutputItem(hR(e),r):typeof e=="object"&&e!==null&&!Array.isArray(e)?oi.NotebookCellOutputItem.text(JSON.stringify(e),r):(e=Array.isArray(e)?Wc(e):e,oi.NotebookCellOutputItem.text(e,r))}catch(t){return C.error(`Failed to convert ${r} output to a buffer ${typeof e}, ${e}`,t),oi.NotebookCellOutputItem.text("")}}function Xz(r){let e=[];r.items.filter(n=>n.mime==="application/vnd.code.notebook.stderr"||n.mime==="application/vnd.code.notebook.stdout").map(n=>DI.decode(n.data)).forEach(n=>{let i=n.split(`
`);e.length&&i.length&&i[0].length>0&&(e[e.length-1]=`${e[e.length-1]}${i.shift()}`);for(let o of i)e.push(o)});for(let n=0;n<e.length-1;n++)e[n]=`${e[n]}
`;return e.length&&e[e.length-1].length===0&&e.pop(),{output_type:"stream",name:HIe(r)||"stdout",text:e}}function aj(r){let e=r.metadata,t;switch(e==null?void 0:e.outputType){case"error":{t=Qz(r);break}case"stream":{t=Xz(r);break}case"display_data":{t={output_type:"display_data",data:r.items.reduce((i,o)=>(i[o.mime]=vR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}case"execute_result":{t={output_type:"execute_result",data:r.items.reduce((i,o)=>(i[o.mime]=vR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{},execution_count:typeof(e==null?void 0:e.executionCount)=="number"?e==null?void 0:e.executionCount:null};break}case"update_display_data":{t={output_type:"update_display_data",data:r.items.reduce((i,o)=>(i[o.mime]=vR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}default:{let i=r.items.length===1&&r.items.every(l=>l.mime==="application/vnd.code.notebook.error"),o=r.items.every(l=>l.mime==="application/vnd.code.notebook.stderr"||l.mime==="application/vnd.code.notebook.stdout");if(i)return Qz(r);let s=(e==null?void 0:e.outputType)||(o?"stream":"display_data");ne("DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",void 0,{outputType:s});let a;s==="stream"?a=Xz(r):s==="display_data"?a={data:{},metadata:{},output_type:"display_data"}:a={output_type:s},e!=null&&e.metadata&&(a.metadata=e.metadata),r.items.length>0&&(a.data=r.items.reduce((l,u)=>(l[u.mime]=vR(u.mime,u.data),l),{})),t=a;break}}return t&&e&&e.transient&&(t.transient=e.transient),t}function JIe(r){return r=r||{output_type:"error",ename:"",evalue:"",traceback:[]},new oi.NotebookCellOutput([oi.NotebookCellOutputItem.error({name:(r==null?void 0:r.ename)||"",message:(r==null?void 0:r.evalue)||"",stack:((r==null?void 0:r.traceback)||[]).join(`
`)})],{...sj(r),originalError:r})}async function tQ(r,e,t){var a,l,u,c,d,f,m,g,b,v,k,R,P,D,K,L,B;let n=!1,i;if(!r)return{changed:n,kernelId:i};(a=r==null?void 0:r.language_info)!=null&&a.name||(r.language_info=r.language_info||{name:""});let o;switch(e==null?void 0:e.kind){case"connectToLiveRemoteKernel":o=e.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":o=e.kernelSpec.language;break;case"startUsingPythonInterpreter":o=Ye;break;default:break}if(r.language_info.name!==o&&o&&(r.language_info.name=o,n=!0),t&&"language_info"in t&&t.language_info)(0,Zz.default)(r.language_info,t.language_info)||(r.language_info=JSON.parse(JSON.stringify(t.language_info)),n=!0);else{let N=jt(e),O=N?nQ(e):void 0,h=await kp(O),y=h?`${h.major}.${h.minor}.${h.micro}`:"";O&&h&&r&&r.language_info&&r.language_info.version!==y?(r.language_info.version=y,n=!0):!O&&(r!=null&&r.language_info)&&N&&(r.language_info=void 0,n=!0)}let s=e&&kI(e)?e.kernelModel:e&&"kernelSpec"in e?e.kernelSpec:void 0;if((e==null?void 0:e.kind)==="startUsingPythonInterpreter"){let N=e.kernelSpec,O=N.display_name||((u=(l=Bi(e.interpreter))==null?void 0:l.environment)==null?void 0:u.name)||"",h="";switch(Hg(N)){case"registeredByOldVersionOfExt":case"registeredByNewVersionOfExt":h="python3";break;case"registeredByNewVersionOfExtForCustomKernelSpec":{h=((d=(c=N.metadata)==null?void 0:c.vscode)!=null&&d.originalSpecFile?Ht(Ci(N.metadata.vscode.originalSpecFile)):void 0)||N.name,O=((m=(f=N.metadata)==null?void 0:f.vscode)==null?void 0:m.originalDisplayName)||O;break}default:h=N.name;break}(((g=r.kernelspec)==null?void 0:g.name)!==h||((b=r.kernelspec)==null?void 0:b.display_name)!==O)&&(n=!0,r.kernelspec={name:h,language:Ye,display_name:O},"vscode"in r&&delete r.vscode,"interpreter"in r&&delete r.interpreter)}else if(s&&!r.kernelspec){let N=(k=(v=s.metadata)==null?void 0:v.vscode)!=null&&k.originalSpecFile?Ht(Ci(s.metadata.vscode.originalSpecFile)):void 0;r.kernelspec={name:N||s.name||s.display_name||"",display_name:((P=(R=s.metadata)==null?void 0:R.vscode)==null?void 0:P.originalDisplayName)||s.display_name||s.name||""},s.language&&(r.kernelspec.language=s.language),i=s.id,n=!0}else if(s&&r.kernelspec){let O=((K=(D=s.metadata)==null?void 0:D.vscode)!=null&&K.originalSpecFile?Ht(Ci(s.metadata.vscode.originalSpecFile)):void 0)||s.name||s.display_name||"",h=((B=(L=s.metadata)==null?void 0:L.vscode)==null?void 0:B.originalDisplayName)||s.display_name||s.name||"",y=s.language||s.language||"";(r.kernelspec.name!==O||r.kernelspec.language!==y||r.kernelspec.display_name!==h||i!==s.id)&&(n=!0,r.kernelspec.name=O,r.kernelspec.display_name=h,r.kernelspec.language=y,i=s.id);try{delete r.kernelspec.metadata}catch(w){}}return{changed:n,kernelId:i}}async function Ld(r,e,t,n){var a,l,u,c,d,f,m;let i=Iy(t);if(!i){let g=no.get(r);n&&(g!=null&&g.started)&&g.end(n?void 0:!1,(l=(a=r.executionSummary)==null?void 0:a.timing)==null?void 0:l.endTime);return}no.get(r)||(n=!0);let o=no.getOrCreate(r,e),s=o.executionOrder;o.started||(o.start((c=(u=r.executionSummary)==null?void 0:u.timing)==null?void 0:c.startTime),o.executionOrder=((d=r.executionSummary)==null?void 0:d.executionOrder)||s),await o.appendOutput(i),o.end(n?void 0:!1,(m=(f=r.executionSummary)==null?void 0:f.timing)==null?void 0:m.endTime)}function rQ(r,e){var s;let t=/Cell\s+In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,n=/Input\s+?In\s*\[(?<executionCount>\d+)\][^<]*<cell line:\s?(?<lineNumber>\d+)>.*/,i;for(let a of r){let l=a.replace(/(?:\u001b\[.+?m)/g,""),u=(s=t.exec(l))!=null?s:n.exec(l);if(u&&u.groups){i=parseInt(u.groups.lineNumber);break}}let o;if(i&&i>0&&i<=e.document.lineCount){let a=e.document.lineAt(i-1),l=a.text.split("#")[0].trimEnd().length;o=new oi.Range(new oi.Position(a.lineNumber,a.firstNonWhitespaceCharacterIndex),new oi.Position(a.lineNumber,l))}return o}p();function Qx(r){if(r.hasOwnProperty("text/html")){let e=r["text/html"];typeof e=="string"&&e.includes('<iframe id="tensorboard-frame-')&&(r["text/html"]=e.replace(/new URL\((.*), window.location\)/,'new URL("http://localhost")'))}return r}var YIe="{connection_file}";var Yf="-jvsc-",$Ie=/^python\d*.?\d*$/;async function Zx(r,e){return zIe(await tSe(r),r,e)}function zIe(r,e,t){var s,a;let n=e?{path:ct(e.uri)}:{},i={name:r,language:"python",display_name:(e?(a=(s=Bi(e))==null?void 0:s.environment)==null?void 0:a.name:"")||"Python 3",metadata:{interpreter:n},argv:["python","-m","ipykernel_launcher","-f",YIe],env:{},resources:{}},o=t&&i.name?Fi(t,i.name,"kernel.json"):void 0;return new PI(i,o?ct(o):void 0,ct(e==null?void 0:e.uri),"registeredByNewVersionOfExt")}function bR(r){var t,n,i;let e=r==null?void 0:r.kernelspec;return(t=r==null?void 0:r.language_info)!=null&&t.name&&r.language_info.name!==Ye?!1:(n=e==null?void 0:e.name)!=null&&n.includes(Ye)?!0:(e==null?void 0:e.language)===Ye||((i=r==null?void 0:r.language_info)==null?void 0:i.name)===Ye}function QIe(r){var i,o,s,a,l;let e=((o=(i=r.metadata)==null?void 0:i.vscode)==null?void 0:o.originalSpecFile)||((s=r.metadata)==null?void 0:s.originalSpecFile),t=e?Ht(Ci(e)):r.name||"",n=((l=(a=r.metadata)==null?void 0:a.vscode)==null?void 0:l.originalDisplayName)||r.display_name||"";return!!(t.toLowerCase().match($Ie)||n.toLowerCase()==="python 3 (ipykernel)"||n.toLowerCase()==="python 3")}function XIe(r){if(r.includes(Yf)){let e=/[a-f0-9]$/;if(r.substring(r.lastIndexOf(Yf)+Yf.length).search(e)!==-1){let t=r.substring(0,r.lastIndexOf(Yf));return t.toLowerCase().endsWith(".ipynb")||t.toLowerCase().endsWith(".py")?t:`${t}.ipynb`}}return r}function IR(r){return r.kind!=="connectToLiveRemoteKernel"}function kI(r){return r.kind==="connectToLiveRemoteKernel"}function SR(r,e,t){var u,c,d;e=lj(r)?e:void 0;let n=r.name,i=Hg(r);if(i&&n.includes(Xx)&&(n=n.substring(n.indexOf(Xx)),i==="registeredByNewVersionOfExtForCustomKernelSpec")){let f=((c=(u=r.metadata)==null?void 0:u.vscode)==null?void 0:c.originalSpecFile)||((d=r.metadata)==null?void 0:d.originalSpecFile);f&&(n=`${n}#${Ht(Ci(f))}`)}let o="";lj(r)?o=r.argv.slice(1).filter(f=>!["-f","{connection_file}"].includes(f)).join("#").toLowerCase():o=r.argv.join("#").toLowerCase();let s=t?`${t}.`:"",a=ct(Kc(r.interpreterPath?Kd.Uri.file(r.interpreterPath):Kd.Uri.file(r.executable))),l=ct(Kc(e==null?void 0:e.uri))||"";return`${s}${r.id||""}.${n}.${a}.${l}.${o}`}function ut(r){var t,n,i,o;let e=ZIe(r);if(!r)return e;switch(r.kind){case"connectToLiveRemoteKernel":{let a=XIe(((n=(t=r.kernelModel)==null?void 0:t.notebook)==null?void 0:n.path)||((o=(i=r.kernelModel)==null?void 0:i.model)==null?void 0:o.path)||"");return a?`${e} (${a})`:e}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":if(r.interpreter&&_r(r.interpreter)!=="Unknown"){let a=Ss(r.interpreter);if(r.kernelSpec.language===Ye){let l=`Python ${cy(Uu(r.interpreter))||""}`.trim();return a?`${e} (${l})`:e}else return a?`${e} (${a})`:e}else return e;case"startUsingPythonInterpreter":let s=(cy(Uu(r.interpreter))||"").trim();if(r.interpreter&&_r(r.interpreter)!=="Unknown"){if(r.kernelSpec.display_name&&Hg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return r.kernelSpec.display_name;let a=Tp(r.interpreter),l=s.trim()?`Python ${s}`:"Python",u=Ss(r.interpreter);return a&&u?u:u?`${u} (${l})`:l}else return`Python ${s}`.trim()}return e}function ZIe(r){var i,o;if(!r)return"";let e=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.display_name:(i=r.kernelSpec)==null?void 0:i.display_name,t=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(o=r.kernelSpec)==null?void 0:o.name,n=r.kind==="startUsingPythonInterpreter"?Fu(r.interpreter):void 0;return[e,t,n,""].find(s=>typeof s=="string"&&s.length>0)||""}function iQ(r,e=""){var t;return r?r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(t=r.kernelSpec)==null?void 0:t.name:e}function eSe(r){var n,i,o,s,a;if(!r)return;let e=kI(r)?r.kernelModel:void 0,t=IR(r)?r.kernelSpec:void 0;if(r.kind==="startUsingPythonInterpreter"||(r.kind==="startUsingRemoteKernelSpec"||r.kind==="startUsingLocalKernelSpec")&&r.kernelSpec.language===Ye){let l=((i=(n=t==null?void 0:t.metadata)==null?void 0:n.interpreter)==null?void 0:i.path)||(t==null?void 0:t.interpreterPath)||(t==null?void 0:t.executable);if(l==="/python"||l==="python"){let u=Bi(r.interpreter);return((o=u==null?void 0:u.environment)==null?void 0:o.folderUri)||(u?Kd.Uri.file(u.path):void 0)}return l?Kd.Uri.file(l):void 0}else{let l=(e==null?void 0:e.executable)||(t==null?void 0:t.executable)||((a=(s=t==null?void 0:t.metadata)==null?void 0:s.interpreter)==null?void 0:a.path)||(t==null?void 0:t.interpreterPath);return l?Kd.Uri.file(l):void 0}}function cj(r,e=""){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel"){let t;if(typeof r.kernelModel.lastActivityTime=="string")try{t=new Date(r.kernelModel.lastActivityTime)}catch(n){C.debug(`Error parsing date ${n}`)}else t=r.kernelModel.lastActivityTime;return W.jupyterSelectLiveRemoteKernelDescription(t,r.kernelModel.numberOfConnections)}return e}function oQ(r,e){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel")return;let t=eSe(r),n=Kd.workspace.workspaceFolders?Kd.workspace.workspaceFolders:[];return t?Ee(t,n,e.homeDir):""}function nQ(r){var n,i,o;if(!r)return;if(r.interpreter)return r.interpreter;let e=kI(r)?r.kernelModel:void 0;if((n=e==null?void 0:e.metadata)!=null&&n.interpreter)return Cx((i=e==null?void 0:e.metadata)==null?void 0:i.interpreter,"");let t=IR(r)?r.kernelSpec:void 0;return Cx((o=t==null?void 0:t.metadata)==null?void 0:o.interpreter,"")}function sQ(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"&&r.kernelSpec&&Hg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec"}function jt(r){if(!r)return!1;if(r.kind==="startUsingPythonInterpreter")return!0;let e=kI(r)?r.kernelModel:void 0,t=IR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)===Ye||lj(t)}function lj(r){return((r==null?void 0:r.language)||"").toLowerCase()===Ye}function eu(r){if(!r)return;if(r.kind==="startUsingPythonInterpreter")return Ye;let e=kI(r)?r.kernelModel:void 0,t=IR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)||lQ(t)}function aQ(r){var t;if(!r)return;let e=r.kernelspec;return lQ(e)||((t=r.language_info)==null?void 0:t.name)}function lQ(r){return r==null?void 0:r.language}var Xx="jvsc74a57bd0";async function tSe(r){let t=(cy(Uu(r))||"3").replace(/\./g,""),n=r?`python${t}`:"";return r?`${n}${Xx}${await Zb(r)}`:"python3"}function Hg(r){var o,s,a,l;if(r.isRegisteredByVSC)return r.isRegisteredByVSC;if(!r.name)return;let e=((s=(o=r.metadata)==null?void 0:o.vscode)==null?void 0:s.originalSpecFile)||((a=r.metadata)==null?void 0:a.originalSpecFile),t=e?Ht(Ci(e)):r.name,n=QIe({...r,name:t})?Object.keys(r.env||{}).length>0:typeof e=="string"&&!e.includes(Xx);if(r.name.includes(Xx))return n?"registeredByNewVersionOfExtForCustomKernelSpec":"registeredByNewVersionOfExt";let i=/[a-f0-9]{32}$/;if((l=r.metadata)!=null&&l.interpreter&&r.name.toLowerCase().search(i)!==-1)return"registeredByOldVersionOfExt"}function cQ(r,e){return!r&&!e?!0:!r&&e||r&&!e?!1:(r==null?void 0:r.id)===(e==null?void 0:e.id)}async function Ai(r,e,t){C.trace(`Executing silently Code (${r.status}) = ${lt(e.substring(0,100)).join("\\n")}`);let n=Jn(),i=r.requestExecute({code:e.replace(/\r\n/g,`
`),silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!1},!0),o=[];i.onIOPub=a=>{if(n.KernelMessage.isStreamMsg(a))if(C.ci(`Got io pub message (stream), ${lt(a.content.text.substr(0,100)).join("\\n")}`),o.length>0&&o[o.length-1].output_type==="stream"&&o[o.length-1].name===a.content.name){let l=o[o.length-1];l.text+=a.content.text}else{let l={name:a.content.name,text:a.content.text,output_type:"stream"};o.push(l)}else if(n.KernelMessage.isExecuteResultMsg(a)){C.ci("Got io pub message (execresult)}");let l={data:a.content.data,execution_count:a.content.execution_count,metadata:a.content.metadata,output_type:"execute_result"};o.push(l)}else if(n.KernelMessage.isDisplayDataMsg(a)){C.ci("Got io pub message (displaydata)}");let l={data:a.content.data,metadata:a.content.metadata,output_type:"display_data"};o.push(l)}else if(n.KernelMessage.isErrorMsg(a)){if(C.ci(`Got io pub message (error), ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join().substring(0,100)}}`),t!=null&&t.traceErrors){let u=`${t.traceErrorsMessage||"Failed to execute (silent) code against the kernel"}, 
Code = ${e}
Error details: `;C.error(`${u} ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join()}`)}let l={ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback,output_type:"error"};o.push(l)}else C.ci(`Got io pub message (${a.header.msg_type})`)},await i.done;let s=lt(e.substring(0,100)).join("\\n");return t&&rSe(o,t,s),C.trace(`Executing silently Code (completed) = ${s} with ${o.length} output(s)`),o}function uQ(r,e,t,n){e=e.replace(/\r\n/g,`
`);let i=Jn(),o=r.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!1,store_history:!1},!0),s=lr(t);return o.onIOPub=a=>{s(),i.KernelMessage.isStreamMsg(a)?n(ls({output_type:"stream",name:a.content.name,text:a.content.text})):i.KernelMessage.isExecuteResultMsg(a)?n(ls({output_type:"execute_result",data:a.content.data,metadata:a.content.metadata,transient:a.content.transient,execution_count:a.content.execution_count})):i.KernelMessage.isDisplayDataMsg(a)?n(ls({output_type:"display_data",data:Qx(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isUpdateDisplayDataMsg(a)?n(ls({output_type:"display_data",data:Qx(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isErrorMsg(a)?n(ls({output_type:"error",ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback})):i.KernelMessage.isExecuteInputMsg(a)||i.KernelMessage.isStatusMsg(a)||C.warn(`Got unexpected io pub message when executing code sillenty (${a.header.msg_type})`)},o}function rSe(r,e,t){r.filter(n=>n.output_type==="error").forEach(n=>{let i=n,o=`${i.ename}: ${i.evalue} 
 ${i.traceback.map(a=>`    ${a}`).join(`
`)}`,s=`${e.traceErrorsMessage||""} ${t} ${o}`;e.traceErrors?C.error(s):C.warn(s),e.telemetryName&&ne(e.telemetryName)})}p();var _R="application/vnd.vscode.chat_message",dQ=`
def __VSCODE_inject_module():

    def __VSCODE_call_function(function, callback, data=None):
        __VSCODE_send_chat_message__(function, data, callback=callback)

    def __VSCODE_send_chat_message__(function, data, callback):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        import uuid as __VSCODE_send_chat_message__uuid
        import IPython.display as __VSCODE_send_chat_message__ipython_display

        id = str(__VSCODE_send_chat_message__uuid.uuid4())
        requests[id] = callback
        data_is_none = data is None
        __VSCODE_send_chat_message__ipython_display.display({"${_R}": data}, metadata={"id":id, "function": function, "dataIsNone": data_is_none}, raw=True)

        del __VSCODE_send_chat_message__ipython_display
        del __VSCODE_send_chat_message__uuid

    def __VSCODE_on_chat_message(id, data):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        if id in requests:
            requests[id](data)
            del requests[id]
        else:
            raise NotImplementedError(f"Callback not found for message {id}")

    import sys as __VSCODE_send_chat_message__sys
    import IPython as __VSCODE_send_chat_message__IPython
    chat = type(__VSCODE_send_chat_message__IPython)("chat")
    chat.send_message = __VSCODE_send_chat_message__
    chat.call_function = __VSCODE_call_function
    chat.__on_message = __VSCODE_on_chat_message
    __VSCODE_send_chat_message__sys.modules["vscode"] = type(__VSCODE_send_chat_message__IPython)("vscode")
    __VSCODE_send_chat_message__sys.modules["vscode"].chat = chat
    del __VSCODE_send_chat_message__sys
    del __VSCODE_send_chat_message__IPython


__VSCODE_inject_module()
del __VSCODE_inject_module
`,nSe=[[new RegExp("\\\\","g"),"\\\\"],[new RegExp('"',"g"),'\\"'],[new RegExp("'","g"),"'"],[new RegExp("\\\b","g"),"\\b"],[new RegExp("\\f","g"),"\\f"],[new RegExp("\\n","g"),"\\n"],[new RegExp("\\r","g"),"\\r"],[new RegExp("\\t","g"),"\\t"]];function pQ(r,e){let t=eP(e),n=typeof t=="string"?`"${t}"`:"None";return`
import vscode as __vscode
try:
    __vscode.chat.__on_message('${r}', ${n})
finally:
    del __vscode
`}function eP(r){if(typeof r!="string")return r;for(let[e,t]of nSe)r=r.replace(e,t);return r}p();var tP=new WeakMap;function ER(r,e,t){var a,l;let n=Bg(t),i=(a=n==null?void 0:n.transient)==null?void 0:a.display_id;if(((l=t.metadata)==null?void 0:l.outputType)!=="display_data"||!i)return;let o=tP.get(e)||new Map;tP.set(e,o);let s=o.get(r)||[];o.set(r,s),s.push(i),s.length>1e3&&s.shift()}function fQ(r,e){let t=tP.get(r)||new Map;for(let n of t.values())if(n.includes(e))return!0;return!1}function mQ(r,e,t){return((tP.get(e)||new Map).get(r)||[]).includes(t)}function hQ(r,e){let t=tP.get(r)||new Map;for(let n of t.values()){let i=n.indexOf(e);i>=0&&n.splice(i,1)}}p();var kn=require("vscode");var NI=new Map,gQ=new Set,xR=new kn.EventEmitter;Ou(xR);function vQ(r){return xR.event(r)}async function yQ(r){if(!kn.workspace.isTrusted)return{accessAllowed:!1};if(r===Je)return{accessAllowed:!0};let e=NI.get(r);return e||(e=iSe(r),NI.set(r,e),e.then(({result:t})=>{(t==="learnMore"||t==="cancelled")&&NI.get(r)===e&&(NI.delete(r),gQ.add(r))})),e.then(({result:t})=>({accessAllowed:t==="allowed"}))}async function iSe(r){var s,a;let e=await uj();if(e.get(r)===!0)return{result:"allowed"};if(e.get(r)===!1)return C.warn(`Kernel API access already revoked for extension ${r}`),{result:"denied"};let t=(a=(s=kn.extensions.getExtension(r))==null?void 0:s.packageJSON)==null?void 0:a.displayName;if(!t)return C.error(`Kernel API access revoked, as extension ${r} does not exist!`),{result:"denied"};let n=kn.l10n.t("Allow"),i=kn.l10n.t("Deny"),o=await kn.window.showInformationMessage(kn.l10n.t("Do you want to grant Kernel access to the extension {0} ({1})?",t,r),{modal:!0,detail:kn.l10n.t("This allows the extension to execute code against Jupyter Kernels.")},n,Ue.learnMore,i);switch(o===Ue.learnMore?kn.env.openExternal(kn.Uri.parse("https://aka.ms/vscodeJupyterKernelApiAccess")).then(E,E):(o===n||o===i)&&await oSe(r,o===n),o){case n:return{result:"allowed"};case Ue.learnMore:return{result:"learnMore"};case i:return C.error(`Kernel API access revoked for extension ${r}`),{result:"denied"};default:return{result:"cancelled"}}}async function bQ(){let r=new Set,[e]=await Promise.all([uj().then(t=>new Map(t)),...Array.from(NI.entries()).map(async([t,n])=>{(await n).result!=="allowed"&&r.add(t)})]);return r.forEach(t=>e.set(t,!1)),gQ.forEach(t=>e.set(t,e.get(t)===!0)),e}var CR="API.Access",$f;async function uj(r=!1){let e=tt.instance.get(st);if(e.extensionMode===kn.ExtensionMode.Test)return new Map;if(lr(()=>{tt.instance.get(ve).push(e.secrets.onDidChange(i=>{i.key===CR&&($f=void 0)}))})(),$f&&!r)return $f;let t="";try{return t=await e.secrets.get(CR),!t||t.length===0?new Map:($f=new Map(Object.entries(JSON.parse(t))),$f)}catch(n){return C.error(`Failed to parse API access information ${t}`,n),new Map}}var wR=Promise.resolve();async function IQ(r){return wR=wR.then(async()=>{await Promise.all(Array.from(NI.entries()).map(async([t,n])=>{let i=await n;i.result=r.includes(t)===!0?"allowed":"denied"})),$f=new Map(r.map(t=>[t,!0]));let e=tt.instance.get(st);if(e.extensionMode!==kn.ExtensionMode.Test)try{await e.secrets.store(CR,JSON.stringify(Object.fromEntries($f))),xR.fire()}catch(t){C.error(`Failed to update API access information ${JSON.stringify(Object.fromEntries($f))}`,t)}})}async function oSe(r,e){return wR=wR.then(async()=>{let t=tt.instance.get(st);if(t.extensionMode===kn.ExtensionMode.Test)return;let n=await uj(!0);if(e!==n.get(r)){n.set(r,e);try{await t.secrets.store(CR,JSON.stringify(Object.fromEntries(n))),xR.fire()}catch(i){C.error(`Failed to store API access information ${JSON.stringify(Object.fromEntries(n))}`,i)}}})}p();var SQ=" (Interactive)",Nt=Symbol("IControllerRegistration");var PR=Symbol("IRemoteNotebookKernelSourceSelector"),_Q=Symbol("ILocalNotebookKernelSourceSelector"),DR=Symbol("ILocalPythonNotebookKernelSourceSelector"),RI=Symbol("IConnectionDisplayData");p();var cs=require("vscode");var dj=class extends MD{constructor(t,n){super();this.controller=t;this.notebook=n}dispose(){this.disposeExistingExecution()}createReferencedObject(t,...n){return this.existingExecutions||(this.existingExecutions=this.controller.createNotebookExecution(this.notebook),this.existingExecutions.start()),this.existingExecutions}destroyReferencedObject(t,n){this.disposeExistingExecution()}disposeExistingExecution(){var t;try{(t=this.existingExecutions)==null||t.end()}catch(n){}this.existingExecutions=void 0}},rP=class rP{constructor(e,t,n){this.extensionId=e;this.kernel=t;var o,s;this.executionRefCountedDisposableFactory=n?new dj(n,t.notebook):void 0;let i=((s=(o=cs.extensions.getExtension(e))==null?void 0:o.packageJSON)==null?void 0:s.displayName)||e;this.notebook=cs.workspace.notebookDocuments.find(a=>{var l;return a.uri.toString()===((l=t.resourceUri)==null?void 0:l.toString())}),this.controllerDisplayName=ut(t.kernelConnectionMetadata),this.title=cs.l10n.t("Executing code in {0} from {1}",this.controllerDisplayName,i),this.eventHandler=cs.window.onDidChangeVisibleNotebookEditors(this.showProgressImpl,this)}dispose(){var e,t;this.eventHandler.dispose(),(e=this.disposable)==null||e.dispose(),(t=this.executionRefCountedDisposableFactory)==null||t.dispose()}show(){var t;let e;try{e=(t=this.executionRefCountedDisposableFactory)==null?void 0:t.acquire("")}catch(n){}if(this.deferred&&!this.deferred.completed){let n=this.deferred;this.deferred=Re(),n.resolve()}else this.deferred=Re(),this.showProgress().catch(E);return this.disposable=new cs.Disposable(()=>{var n;e==null||e.dispose(),(n=this.deferred)==null||n.resolve()})}async showProgress(){await nc(1e3),!(!this.deferred||this.deferred.completed||this.displayInProgress)&&(this.shouldDisplayProgress=!0,await Promise.all([this.showProgressImpl(),this.waitUntilCompleted()]),this.shouldDisplayProgress=!1)}async showProgressImpl(){let e=rP.notificationsPerExtension.get(this.kernel)||new Set;rP.notificationsPerExtension.set(this.kernel,e),!e.has(this.extensionId)&&(e.add(this.extensionId),!(!this.notebook||!this.shouldDisplayProgress)&&cs.window.visibleNotebookEditors.some(t=>t.notebook===this.notebook)&&(this.displayInProgress=!0,await cs.window.withProgress({location:cs.ProgressLocation.Notification,title:this.title},async()=>this.waitUntilCompleted()),this.displayInProgress=!1))}async waitUntilCompleted(){let e=this.deferred;for(;e&&!e.completed;)await e.promise,e=this.deferred}};rP.notificationsPerExtension=new WeakMap;var TR=rP;var fj=class extends Error{constructor(){super(qg.l10n.t("Access to Jupyter Kernel has been revoked")),this.name="vscode.jupyter.apiAccessRevoked"}},mj=class r extends Pr{constructor(t,n,i,o){super();this.extensionId=t;this.kernel=n;this.execution=i;this._onDidChangeStatus=this._register(new qg.EventEmitter);this._onDidReceiveDisplayUpdate=this._register(new qg.EventEmitter);this.progress=this._register(new TR(t,n,o)),this._register(Ag(n.onDisposed)(()=>this.progress.dispose())),this.language=n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?Ye:n.kernelConnectionMetadata.kernelSpec.language||Ye,this._register(this.kernel.onStatusChanged(()=>this._onDidChangeStatus.fire(this.kernel.status))),this._register(i.onDidReceiveDisplayUpdate(a=>{var c,d;let l=this.kernel.session,u=Bg(a);(u==null?void 0:u.outputType)==="display_data"&&((c=u==null?void 0:u.transient)!=null&&c.display_id)&&l&&mQ(this.extensionId,l,(d=u==null?void 0:u.transient)==null?void 0:d.display_id)&&this._onDidReceiveDisplayUpdate.fire(a)}));let s=this;this._api=Object.freeze({language:this.language,get status(){return s.kernel.status},onDidChangeStatus:s.onDidChangeStatus.bind(this),get onDidReceiveDisplayUpdate(){if(![Je,mD,pD].includes(t)&&!fD.includes(t.split(".")[0]))throw new Error(`Proposed API is not supported for extension ${t}`);return s.onDidReceiveDisplayUpdate.bind(this)},executeCode:(a,l)=>this.executeCode(a,l),executeChatCode:(a,l,u)=>this.executeChatCode(a,l,u)})}get status(){return this.kernel.status}get onDidChangeStatus(){return this._onDidChangeStatus.event}get onDidReceiveDisplayUpdate(){return this._onDidReceiveDisplayUpdate.event}static createApiKernel(t,n,i,o){let s=new r(t,n,i,o);return tt.instance.get(ve).push(s),{api:s._api,progress:s.progress}}async checkAccess(){if(this.extensionId===Je)return;if(this.accessAllowed||(this.accessAllowed=this.doCheckAccess(),this._register(vQ(()=>this.accessAllowed=void 0))),!await this.accessAllowed)throw new fj}async doCheckAccess(){let n=(await yQ(this.extensionId)).accessAllowed;return ne("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:this.extensionId,pemUsed:"getKernel",accessAllowed:n}),n}async*executeCode(t,n){await this.checkAccess();for await(let i of this.executeCodeInternal(t,void 0,n))yield i}async*executeChatCode(t,n,i){if(await this.checkAccess(),!["ms-vscode.dscopilot-agent",Je].includes(this.extensionId.toLowerCase()))throw new Error(`Proposed API is not supported for extension ${this.extensionId}`);if(!jt(this.kernel.kernelConnectionMetadata))throw new Error("Chat code execution is only supported for Python kernels");for await(let s of this.executeCodeInternal(t,n,i))yield s}async*executeCodeInternal(t,n={},i){var m;let o=!1,s={executionCount:this.execution.executionCount,requestSentAfter:0,requestAcknowledgedAfter:0,cancelledAfter:0,duration:0},a={kernelId:"",extensionId:this.extensionId,cancelled:!1,requestSent:!1,requestAcknowledged:!1,cancelledBeforeRequestSent:!1,cancelledBeforeRequestAcknowledged:!1,mimeTypes:"",failed:!1},l=new yt,u=new Set;if(sSe(this.extensionId,this.kernel,"executeCode",s.executionCount).catch(E),this.kernel.disposed)throw a.failed=!0,pj(this.kernel,s,a).catch(E),new Error("Kernel is disposed");if(!((m=this.kernel.session)!=null&&m.kernel))throw a.failed=!0,pj(this.kernel,s,a).catch(E),this.kernel.status==="dead"||this.kernel.status==="terminating"?new Error("Kernel is dead or terminating"):new Error("Kernel connection not available to execute 3rd party code");let c=[];c.push({dispose:()=>{s.duration=l.elapsedTime,a.mimeTypes=Array.from(u).join(","),o=!0,pj(this.kernel,s,a).catch(E)}});let d=tt.instance.get(qe).getKernelExecution(this.kernel),f={started:new qg.EventEmitter,executionAcknowledged:new qg.EventEmitter};f.started.event(()=>{a.requestSent=!0,s.requestSentAfter=l.elapsedTime,!i.isCancellationRequested&&this.extensionId!==Je&&c.push(this.progress.show())},this,c),f.executionAcknowledged.event(()=>{a.requestAcknowledged=!0,s.requestAcknowledgedAfter=l.elapsedTime},this,c),i.onCancellationRequested(()=>{o||(a.cancelled=!0,s.cancelledAfter=l.elapsedTime,a.cancelledBeforeRequestSent=!a.requestSent,a.cancelledBeforeRequestAcknowledged=!a.requestAcknowledged,C.debug(`Code execution cancelled by extension ${this.extensionId}`))},this,c);try{for await(let g of d.executeCode(t,this.extensionId,f,i))if(ER(this.extensionId,this.kernel.session,g),g.items.forEach(b=>u.add(b.mime)),n&&EQ(g))for await(let b of this.handleChatOutput(g,d,f,u,n,i))yield b;else yield g}finally{Ce(c)}}async*handleChatOutput(t,n,i,o,s={},a){let l=t.items.find(v=>v.mime===_R);if(!l)return;let u=(t.metadata||{}).metadata,c=u.function,d=u.id,f=u.dataIsNone?void 0:new TextDecoder().decode(l.data),m=s[c];if(!m)throw new Error(`Chat Function ${c} not found`);let g=await m(f),b=pQ(d,g);for await(let v of n.executeCode(b,this.extensionId,i,a))if(v.items.forEach(k=>o.add(k.mime)),EQ(v))for await(let k of this.handleChatOutput(v,n,i,o,s,a))yield k;else yield v}};function EQ(r){return r.items.some(e=>e.mime===_R)}async function sSe(r,e,t,n){let i=await Rt(e.id);ne("DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",{executionCount:n},{kernelId:i,pemUsed:t,extensionId:r})}async function pj(r,e,t){t.kernelId=await Rt(r.id),ne("DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",e,t)}function kR(r,e){var i;let t=tt.instance.get(qe),n=(i=tt.instance.get(Nt).getSelected(e.notebook))==null?void 0:i.controller;return mj.createApiKernel(r,e,t.getKernelExecution(e),n)}p();p();var AI=oe(he());p();var w$e=Symbol("IReservedPythonNamedProvider"),x$e=Symbol("IInterpreterPackages"),CQ=Symbol("IWorkspaceInterpreterTracker");var Ol=class{constructor(e){this.workspaceInterpreterTracker=e;Ol.isActiveWorkspaceInterpreter=this.isActiveWorkspaceInterpreterImpl.bind(this)}activate(){var e;(e=this.workspaceInterpreterTracker)==null||e.activate()}isActiveWorkspaceInterpreterImpl(e,t){var n,i;return(i=(n=this.workspaceInterpreterTracker)==null?void 0:n.isActiveWorkspaceInterpreter(e,t))!=null?i:!1}};Ol.isActiveWorkspaceInterpreter=()=>!1,Ol=U([(0,AI.injectable)(),x(0,(0,AI.inject)(CQ)),x(0,(0,AI.optional)())],Ol);async function nP(r,e){if(!r)return;let t=Ua(r),[n,i]=XN.get(t)||[{resourceType:Al(r),resourceHash:r?await Rt(r.toString()):void 0,kernelSessionId:await Rt(Date.now().toString()),capturedEnvVars:void 0,userExecutedCell:void 0,disableUI:void 0,kernelLanguage:void 0,kernelId:void 0,kernelSpecHash:void 0,isUsingActiveInterpreter:void 0,pythonEnvironmentType:void 0,pythonEnvironmentPath:void 0,pythonEnvironmentVersion:void 0,kernelConnectionType:void 0},{previouslySelectedKernelConnectionId:""}];typeof e.capturedEnvVars=="boolean"&&(n.capturedEnvVars=e.capturedEnvVars),e.userExecutedCell&&(n.userExecutedCell=!0),typeof e.disableUI=="boolean"&&(n.disableUI=e.disableUI);let o=e.kernelConnection;if(o){let s=o.id;i.previouslySelectedKernelConnectionId!==s&&(n.userExecutedCell=e.userExecutedCell,n.disableUI=e.disableUI),i.previouslySelectedKernelConnectionId&&i.previouslySelectedKernelConnectionId!==s&&(n.kernelSessionId=await Rt(Date.now().toString()));let a;switch(o.kind){case"connectToLiveRemoteKernel":a=o.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":a=o.kernelSpec.language;break;case"startUsingPythonInterpreter":a=Ye;break;default:break}let l="kernelSpec"in o&&o.kernelSpec.specFile?Rt(o.kernelSpec.specFile):Promise.resolve("");n.kernelLanguage=a,[n.kernelId,n.kernelSpecHash]=await Promise.all([Rt(o.id),l]),i.previouslySelectedKernelConnectionId=o.id;let u=o.interpreter;if(u){n.isUsingActiveInterpreter=Ol.isActiveWorkspaceInterpreter(r,u),n.pythonEnvironmentType=_r(u);let[c,d]=await Promise.all([Rt(ct(Kc(u.uri))),kp(u)]);n.pythonEnvironmentPath=c,J2.set(n.pythonEnvironmentPath,u),d?n.pythonEnvironmentVersion=`${d.major}.${d.minor}.${d.micro}`:n.pythonEnvironmentVersion=void 0,G2(n)}n.kernelConnectionType=n.kernelConnectionType||(o==null?void 0:o.kind)}else i.previouslySelectedKernelConnectionId="";XN.set(t,[n,i])}async function Ll(r,e){await nP(r,{kernelConnection:e,userExecutedCell:!0})}var hj=new Map;function xQ(r){return hj.has(r)||hj.set(r,{onDidStart:void 0,kernels:new WeakMap}),hj.get(r)}function wQ(r,e){let t=xQ(e),n=t.kernels.get(r)||kR(e,r);return t.kernels.set(r,n),n}function PQ(r){return{async getKernel(e){let t,n=tt.instance.get(qe),i=NR.workspace.notebookDocuments.find(a=>a.uri.toString()===e.toString()),o=n.get(i||e);if(!o||!o.startedAtLeastOnce||!o.userStartedKernel){ne("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:r,pemUsed:"getKernel",accessAllowed:t});return}r!==Je&&Ll(o.resourceUri,o.kernelConnectionMetadata);let{api:s}=wQ(o,r);return s},get onDidStart(){if(![Je,pD].includes(r)&&!fD.includes(r.split(".")[0]))throw new Error(`Proposed API is not supported for extension ${r}`);let e=xQ(r);if(!e.onDidStart){let t=tt.instance.get(qe),n=tt.instance.get(ve);e.onDidStart=new NR.EventEmitter,n.push(e.onDidStart,t.onDidPostInitializeKernel(({kernel:i,token:o,waitUntil:s})=>{var u;let{api:a,progress:l}=wQ(i,r);(u=e.onDidStart)==null||u.fire({uri:i.uri,kernel:a,token:o,waitUntil:c=>{let d=La(Promise.resolve(c));s(c);let f=l.show(),m=new yt;d.promise.finally(()=>{C.trace(`${r} took ${m.elapsedTime}ms during kernel startup`),Rr(i.resourceUri,"DATASCIENCE.JUPYTER_NEW_KERNEL_API_KERNEL_STARTUP_WAIT_UNTIL",{duration:m.elapsedTime},{extensionId:r}),f.dispose()})}})}),e.onDidStart)}return e.onDidStart.event}}}p();p();var RR=Symbol("JupyterServerHelper"),sze=Symbol("INotebookImporter"),MI=Symbol("INotebookExporter"),DQ=Symbol("IJupyterInterpreterDependencyManager"),aze=Symbol("INbConvertInterpreterDependencyChecker"),lze=Symbol("INbConvertExportToPythonService"),AR=Symbol("IJupyterServerProvider"),dr=Symbol("IJupyterServerUriStorage"),MR=Symbol("IJupyterKernelService"),OR=Symbol("IJupyterRequestAgentCreator"),Jg=Symbol("IJupyterRequestCreator"),cze=Symbol("INotebookStarter"),Gg=Symbol("ILiveRemoteKernelConnectionUsageTracker"),LR=Symbol("IJupyterRemoteCachedKernelValidator"),sr=Symbol("IJupyterServerProviderRegistry");function KR(r,e,t,n,i){ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"createJupyterServerCollection"});let s=i.get(sr).createJupyterServerCollection(n,r,zv(e),t);return{dispose:()=>{s==null||s.dispose()},get id(){return r},set label(l){s.label=zv(l)},get label(){return s.label},set documentation(l){s.documentation=l},get documentation(){return s.documentation},set commandProvider(l){s.commandProvider=l},get commandProvider(){return s.commandProvider}}}p();var TQ=!1;function kQ(r,e){if(TQ)return;TQ=!0,e.get(vy).setApi(r)}p();var Zf=require("vscode");p();var OI=oe(he());p();var nu=oe(he());p();var zf=class extends ot{constructor(t,n){super("remotejupyterserveruriprovider",n.message||n.toString());this.serverProviderHandle=t;this.originalError=n}};p();var Os=class extends ot{constructor(e){super("jupyterselfcert",e)}static isSelfCertsError(e){return e.message.indexOf("reason: self signed certificate")>=0}};p();var tu=class extends ot{constructor(e){super("jupyterselfexpiredcert",e)}static isSelfCertsExpiredError(e){return e.message.indexOf("reason: certificate has expired")>=0}};p();var pn=Symbol("IDataScienceErrorHandler"),Ii=class extends ot{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}},ru=class extends Ln{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}};p();var io=class extends ot{constructor(t,n,i){super("remotejupyterserverconnection",W.remoteJupyterConnectionFailedWithServerWithError(NQ(t),i.message||i.toString()));this.url=t;this.serverProviderHandle=n;this.originalError=i;this.baseUrl=NQ(t)}};function NQ(r){let e=new URL(r);return`${e.protocol}//${e.host}/`}var iP=require("vscode");p();var RQ=require("vscode");var Qf=class r extends ac{constructor(t){super();this.serverSettings=t;this._isDisposing=!1;this.kernelSpecManager=new this.jupyterlab.KernelSpecManager({serverSettings:this.serverSettings}),this.kernelManager=new this.jupyterlab.KernelManager({serverSettings:this.serverSettings}),this.sessionManager=new this.jupyterlab.SessionManager({serverSettings:this.serverSettings,kernelManager:this.kernelManager}),this.contentsManager=new this.jupyterlab.ContentsManager({serverSettings:this.serverSettings})}get jupyterlab(){return this._jupyterlab||(this._jupyterlab=Jn()),this._jupyterlab}static create(t){return new r(t)}dispose(){this.isDisposed||this._isDisposing||(this._isDisposing=!0,(async()=>{var t,n,i,o;C.trace("Disposing Jupyter Lab Helper");try{this.contentsManager&&(C.trace("SessionManager - dispose contents manager"),this.contentsManager.dispose()),this.sessionManager&&!this.sessionManager.isDisposed&&(C.trace("ShutdownSessionAndConnection - dispose session manager"),await po(1e4,this.sessionManager.ready),this.sessionManager.dispose()),(t=this.kernelManager)!=null&&t.isDisposed||(n=this.kernelManager)==null||n.dispose(),(i=this.kernelSpecManager)!=null&&i.isDisposed||(o=this.kernelSpecManager)==null||o.dispose()}catch(s){C.error("Exception on Jupyter Lab Helper shutdown: ",s)}finally{C.trace("Finished disposing Jupyter Lab Helper")}})().catch(E).finally(()=>super.dispose()))}async getRunningSessions(){if(!this.sessionManager)return[];await po(1e4,this.sessionManager.ready).catch(E),await this.sessionManager.refreshRunning();let t=[],n=this.sessionManager.running(),i=n.next().value;for(;i;)t.push(i),i=n.next().value;return t}async getRunningKernels(){let t=await this.jupyterlab.KernelAPI.listRunning(this.serverSettings),n=new Set;return t.map(i=>{let o=i;return{id:i.id,name:i.name,lastActivityTime:o.last_activity?new Date(Date.parse(o.last_activity.toString())):new Date,numberOfConnections:o.connections?parseInt(o.connections.toString(),10):0}}).filter(i=>n.has(i.id)?!1:(n.add(i.id),!0))}async getKernelSpecs(){var t,n,i;if(!this.serverSettings||!this.sessionManager||!this.contentsManager)throw new Qr;try{let o=new yt,s=this.kernelSpecManager;if(!s)return C.error(`No SessionManager to enumerate kernelspecs (no specs manager). Returning a default kernel. Specs ${JSON.stringify(((n=(t=this.kernelSpecManager)==null?void 0:t.specs)==null?void 0:n.kernelspecs)||{})}.`),ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsManager"}),[await Zx()];let a={wasSessionManagerReady:this.sessionManager.isReady,wasSpecsManagerReady:s.isReady,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:s.isReady,waitedForChangeEvent:!1},l=(f={})=>s.specs&&Object.keys(s.specs.kernelspecs).length?s.specs.kernelspecs:f,u=l();await po(1e4,this.sessionManager.ready),a.sessionManagerReady=this.sessionManager.isReady,await po(1e4,s.refreshSpecs()),a.specsManagerReady=s.isReady;let c=!1;if(s&&Object.keys(((i=s.specs)==null?void 0:i.kernelspecs)||{}).length===0){let f=[],m=Re(),g=m.resolve.bind(m);s.specsChanged.connect(g),f.push(new RQ.Disposable(()=>s.specsChanged.disconnect(g)));let b=Promise.all([m.promise,s.ready,s.refreshSpecs(),this.sessionManager.ready]);await po(1e4,b),a.waitedForChangeEvent=!0,m.completed||(c=!0,ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:s.isReady,reason:s.isReady?this.sessionManager.isReady?"SpecsDidNotChangeInTime":"SessionManagerIsNotReady":"SpecManagerIsNotReady"})),Ce(f)}let d=l(u);if(Object.keys(d||{}).length){let f=[];return Object.entries(d).forEach(([m,g])=>{g&&f.push(new PI(g))}),ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",{duration:o.elapsedTime},a),f}else return C.error(`Jupyter Lab Helper cannot enumerate kernelspecs. Returning a default kernel. Specs ${JSON.stringify(d)}.`),c||ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsEventAfterRefresh"}),[await Zx()]}catch(o){return C.error("Jupyter Lab Helper:getKernelSpecs failure: ",o),[]}}};var fn=class{constructor(e,t,n,i,o){this.jupyterPickerRegistration=e;this.configService=t;this.errorHandler=n;this.requestAgentCreator=i;this.requestCreator=o}async createConnectionInfo(e){let t=await this.getJupyterServerUri(e);if(!t)throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`);let n={baseUrl:t.connectionInformation.baseUrl.toString(!0),displayName:t.label,token:t.connectionInformation.token||"",authorizationHeader:t.connectionInformation.headers||{},fetch:t.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:t.connectionInformation.WebSocket};return rj(e,n,this.requestCreator,this.requestAgentCreator,this.configService,iP.Uri.file(""))}async validateRemoteUri(e,t,n){let i;if(!t){let s=await this.getJupyterServerUri(e);if(s)t={baseUrl:s.connectionInformation.baseUrl.toString(!0),displayName:s.label,token:s.connectionInformation.token||"",authorizationHeader:s.connectionInformation.headers||{},fetch:s.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:s.connectionInformation.WebSocket};else throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`)}let o=rj(e,t,this.requestCreator,this.requestAgentCreator,this.configService,iP.Uri.file(""));try{i=Qf.create(o.settings),await Promise.all([i.getRunningKernels(),i.getKernelSpecs()])}catch(s){if(Os.isSelfCertsError(s)){if(!await dR(this.configService,s.message))throw s}else if(tu.isSelfCertsExpiredError(s)){if(!await pR(this.configService,s.message))throw s}else throw t&&!n&&await this.errorHandler.handleError(new io(t.baseUrl,e,s)),s}finally{o.dispose(),i&&i.dispose()}}async getJupyterServerUri(e){let t=new iP.CancellationTokenSource;try{let n=this.jupyterPickerRegistration.jupyterCollections.find(l=>l.extensionId===e.extensionId&&l.id===e.id)||await this.jupyterPickerRegistration.activateThirdPartyExtensionAndFindCollection(e.extensionId,e.id);if(!n)return;let i=await Promise.resolve(n.serverProvider.provideJupyterServers(t.token)),o=i==null?void 0:i.find(l=>l.id===e.handle);if(!o&&(i==null?void 0:i.length)===0)try{o=await n.serverProvider.resolveJupyterServer({id:e.handle,label:""},t.token)}catch(l){}if(!o)return;if(o.connectionInformation)return o;let s=await Promise.resolve(n.serverProvider.resolveJupyterServer(o,t.token));if(!(s!=null&&s.connectionInformation))return;let a=Object.assign({},o);return a.connectionInformation=s.connectionInformation,a}catch(n){throw n instanceof ot?n:new zf(e,n)}finally{t.dispose()}}};fn=U([(0,nu.injectable)(),x(0,(0,nu.inject)(sr)),x(1,(0,nu.inject)(Ke)),x(2,(0,nu.inject)(pn)),x(3,(0,nu.inject)(OR)),x(3,(0,nu.optional)()),x(4,(0,nu.inject)(Jg))],fn);var Kl=class{constructor(e,t,n){this.serverUriStorage=e;this.jupyterConnection=t;this.serverProviderRegistry=n}async addJupyterServer(e){if(e.extensionId.toLowerCase()!=tc.toLowerCase())throw new Error("Deprecated API");try{await this.jupyterConnection.validateRemoteUri(e)}catch(t){C.error(`Error in validating the Remote Uri ${e.id}.${e.handle}`,t);return}this.serverProviderRegistry.jupyterCollections.some(t=>t.extensionId===e.extensionId)||await this.serverUriStorage.add(e)}};Kl=U([(0,OI.injectable)(),x(0,(0,OI.inject)(dr)),x(1,(0,OI.inject)(fn)),x(2,(0,OI.inject)(sr))],Kl);p();var MQ=oe(he()),iu=require("vscode");p();var Xf=require("vscode");function Yn(r,e=!1){return typeof r!="object"||!r?!1:!!(r instanceof Xf.CancellationError||e&&(r.message.includes("Canceled")||r.message.includes(Ue.canceled)))}async function Ls(r,e,...t){let n;return gD(e)?(t.push(e),n=void 0):n=e,r?r.isCancellationRequested?n:new Promise((i,o)=>{if(r.isCancellationRequested)return i(n);let s=r.onCancellationRequested(()=>{s.dispose(),i(n)});Promise.race(t).then(i,o).finally(()=>s.dispose())}):await Promise.race(t)}async function us(r,...e){if(!r)return Promise.race(e);if(r.isCancellationRequested)throw new Xf.CancellationError;return new Promise((t,n)=>{if(r.isCancellationRequested)return n(new Xf.CancellationError);let i=r.onCancellationRequested(()=>{i.dispose(),n(new Xf.CancellationError)});Promise.race(e).then(t,n).finally(()=>i.dispose())})}function AQ(...r){let e=new Xf.CancellationTokenSource,t=[];for(let i of r)i&&(i.isCancellationRequested&&e.cancel(),i.onCancellationRequested(()=>e.cancel(),void 0,t));let n=e.dispose.bind(e);return e.dispose=()=>{n(),Ce(t)},e}var Fd;(e=>{function r(t){if(t!=null&&t.isCancellationRequested)throw new Xf.CancellationError}e.throwIfCanceled=r})(Fd||(Fd={}));function OQ(r){let e=new Map,t=(a,l)=>{if(!e.has(a)){let u={id:a,label:l.displayName,connectionInformation:{baseUrl:iu.Uri.parse(l.baseUrl),token:l.token,fetch:l.fetch,headers:l.authorizationHeader,WebSocket:l.WebSocket}};e.set(a,{serverUri:l,server:u})}return e.get(a).server},n=new iu.EventEmitter,i={async provideJupyterServers(a){let l=r.getHandles?await us(a,r.getHandles()):[];return!l||l.length===0?[]:us(a,Promise.all(l.map(u=>r.getServerUri(u).then(c=>t(u,c)))))},resolveJupyterServer(a,l){return a},onDidChangeServers:n.event};if(!r.handleQuickPick||!r.getQuickPickEntryItems)return{serverProvider:i};let o=new Map;return{serverProvider:i,commandProvider:{async handleCommand(a,l){let u=o.get(a.label);if(!u||!r.handleQuickPick)return;let c=await us(l,r.handleQuickPick(u,!0));if(c==="back")return;if(!c)throw new iu.CancellationError;let d=await r.getServerUri(c);return t(c,d)},async provideCommands(a,l){return r.getQuickPickEntryItems?(await us(l,Promise.resolve(r.getQuickPickEntryItems()))).map(c=>{let d={label:zv(c.label),canBeAutoSelected:c.default,description:zv(c.description)};return o.set(d.label,c),d}):[]}}}}var gj=class extends ac{constructor(t,n,i,o){super();this.extensionId=t;this.id=n;this.label=i;this.serverProvider=o;this._onDidChangeProvider=new iu.EventEmitter;this.onDidChangeProvider=this._onDidChangeProvider.event}set commandProvider(t){this._commandProvider=t,this._onDidChangeProvider.fire()}get commandProvider(){return this._commandProvider}},LI=class extends Pr{constructor(){super();this._onDidChangeCollections=new iu.EventEmitter;this._collections=new Map;tt.instance.get(ve).push(this)}get onDidChangeCollections(){return this._onDidChangeCollections.event}get jupyterCollections(){return Array.from(this._collections.values())}async activateThirdPartyExtensionAndFindCollection(t,n){return await this.loadExtension(t,n).catch(E),this.jupyterCollections.find(i=>i.extensionId===t&&i.id===n)}async loadExtension(t,n){if(t===Je)return;let i=iu.extensions.getExtension(t);if(!i)throw new Error(`Extension '${t}' that provides Jupyter Server '${n}' not found`);i.isActive||await i.activate().then(E,E)}createJupyterServerCollection(t,n,i,o){let s=`${t}#${n}`;if(this._collections.has(s)&&t!==Je)throw new Error(`Jupyter Server Provider with id ${s} already exists`);let a=new gj(t,n,i,o);return this._collections.set(s,a),this._onDidChangeCollections.fire({added:[a],removed:[]}),this._register(a.onDidDispose(()=>{this._collections.delete(s),this._onDidChangeCollections.fire({removed:[a],added:[]})},this)),a}};LI=U([(0,MQ.injectable)()],LI);p();var FR=Symbol("IExportedKernelServiceFactory");function aSe(r,e){return new Promise(t=>{e.onDidChange(n=>{for(let i of n.added)Wt(i.connection)&&i.connection.serverProviderHandle.id===r.id&&i.connection.serverProviderHandle.handle===r.handle&&t()})})}function LQ(r,e){let t=e.get(Ha),n=r.id.startsWith("_builtin")?Je:t.determineExtensionFromCallStack().extensionId;if(C.error(`The API registerRemoteServerProvider has being deprecated and will be removed soon, please use createJupyterServerCollection (extension ${n}).`),n.toLowerCase()!=tc.toLowerCase())throw new Error("Deprecated API");ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"registerRemoteServerProvider"});let{serverProvider:i,commandProvider:o}=OQ(r),s=KR(r.id,r.displayName||r.detail||r.id,i,n,e);return o&&(s.commandProvider=o),{dispose:()=>{s.dispose()}}}function KQ(r){return r.then(()=>void 0).catch(e=>(C.error("Failure during activation.",e),Promise.reject(e)))}function FQ(r){let e=r.get(Ha);return ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:e.determineExtensionFromCallStack().extensionId,pemUsed:"registerRemoteServerProvider"}),r.get(FR).getService()}async function UQ(r,e,t){let n=t.get(Ha);C.error("The API addRemoteJupyterServer has being deprecated and will be removed soon, please use createJupyterServerCollection.");let i=n.determineExtensionFromCallStack().extensionId;if(i.toLowerCase()!=tc.toLowerCase())throw new Error("Deprecated API");ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:i,pemUsed:"addRemoteJupyterServer"});let o=t.get(Kl),s=t.get(Nt),a=aSe({id:r,handle:e},s);await o.addJupyterServer({id:r,handle:e,extensionId:i}),await a}async function WQ(r,e,t){var u,c,d,f,m,g;let n=t.get(Ha);ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n.determineExtensionFromCallStack().extensionId,pemUsed:"openNotebook"});let i=t.get(Nt),o=typeof e=="string"?e:void 0,s=typeof e=="string"?void 0:e,a=o&&((u=i.all.find(b=>b.id===e))==null?void 0:u.id);if(!a&&s&&!ic()&&(a=(c=i.all.find(b=>b.kind==="startUsingPythonInterpreter"&&b.interpreter.id===s.id))==null?void 0:c.id,!a)){let v=await t.get(DR).getKernelConnection(s);a=v&&((d=i.all.find(k=>k.id===(v==null?void 0:v.id)))==null?void 0:d.id)}if(!a)throw new Error(`Kernel ${e} not found.`);let l=((g=(m=(f=Zf.window.activeNotebookEditor)==null?void 0:f.notebook)==null?void 0:m.uri)==null?void 0:g.toString())===r.toString()?Zf.window.activeNotebookEditor:await Zf.window.showNotebookDocument(await Zf.workspace.openNotebookDocument(r));return await Zf.commands.executeCommand("notebook.selectKernel",{notebookEditor:l,id:a,extension:Je}),l.notebook}p();var Ao=Symbol("INotebookEditorProvider"),UR=Symbol("INotebookPythonEnvironmentService");function VQ(r,e,t,n){let i=t.get(Ha),o=t.get(UR),s={ready:KQ(r),registerPythonApi:a=>kQ(a,t),registerRemoteServerProvider:a=>LQ(a,t),getKernelService:()=>FQ(t),addRemoteJupyterServer:(a,l)=>UQ(a,l,t),openNotebook:async(a,l)=>WQ(a,l,t),createJupyterServerCollection:(a,l,u)=>KR(a,l,u,i.determineExtensionFromCallStack().extensionId,t),get kernels(){return PQ(i.determineExtensionFromCallStack().extensionId)},onDidChangePythonEnvironment:o.onDidChangeEnvironment,getPythonEnvironment(a){return o.getPythonEnvironment(a)}};return(hn()||n.extensionMode===vj.ExtensionMode.Development||n.extensionMode===vj.ExtensionMode.Test)&&(s.serviceContainer=t,s.serviceManager=e),s}p();var jQ=require("vscode"),BQ={codeLoadingTime:0,endActivateTime:0,startActivateTime:0,totalActivateTime:0,workspaceFolderCount:0};function HQ(r,e){if(!hn())try{r.endActivateTime=e.elapsedTime,r.totalActivateTime=e.elapsedTime,Object.assign(BQ,r),JQ(r),ne("EXTENSION.LOAD",r)}catch(t){C.error("sendStartupTelemetry() failed.",t)}}function qQ(r,e,t){try{let n={};e.endActivateTime=t.elapsedTime,e.totalActivateTime=t.elapsedTime,Object.assign(BQ,e),JQ(e),ne("EXTENSION.LOAD",e,n,r)}catch(n){C.error("sendErrorTelemetry() failed.",n)}}function JQ(r){var t,n;let e=(n=(t=jQ.workspace.workspaceFolders)==null?void 0:t.length)!=null?n:0;r.workspaceFolderCount=e}p();p();var WR=Symbol("IWorkspaceService"),oo=Symbol("IDebugManager"),KI=Symbol("IApplicationEnvironment"),yXe=Symbol("IWebviewPanelMessageListener"),bXe=Symbol("IWebviewViewMessageListener"),IXe=Symbol("IWebview"),SXe=Symbol("IWebviewView"),_Xe=Symbol("IWebviewPanel"),FI=Symbol("IWebviewPanelProvider"),VR=Symbol("IWebviewViewProvider"),oP=Symbol("IEncryptedStorage");p();var GQ=oe(he());p();var Si=require("vscode");p();var Ud=require("vscode");var Yg=class Yg{constructor(e){this.jupyterConfig=e}async migrateSettings(){let e=[];for(let t of Object.keys(Yg.migratedSettings))e.push(...this.migrateSetting(t,Yg.migratedSettings[t]));e.push(this.migrateIntellisenseSettings());try{await Promise.all(e)}catch(t){UI(t)}}async migrateIntellisenseSettings(){let e="pythonCompletionTriggerCharacters",t="completionTriggerCharacters",n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t);try{if((n==null?void 0:n.globalValue)===(n==null?void 0:n.defaultValue)||!i||i!=null&&i.globalValue&&i.globalValue[Ye])return;if(typeof(n==null?void 0:n.globalValue)=="string"){let o=i.globalValue||i.defaultValue||{};o[Ye]=n.globalValue.split(""),await this.jupyterConfig.update(t,o,Ud.ConfigurationTarget.Global).then(E,UI)}}finally{n!=null&&n.globalValue&&await this.jupyterConfig.update(e,void 0,Ud.ConfigurationTarget.Global).then(E,UI)}}migrateSetting(e,t){let n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t),o=[];if((n==null?void 0:n.workspaceValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceValue,Ud.ConfigurationTarget.Workspace)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Ud.ConfigurationTarget.Workspace),UI))}if((n==null?void 0:n.workspaceFolderValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceFolderValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceFolderValue,Ud.ConfigurationTarget.WorkspaceFolder)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Ud.ConfigurationTarget.WorkspaceFolder),UI))}if((n==null?void 0:n.globalValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.globalValue)===void 0&&(s=this.jupyterConfig.update(t,n.globalValue,Ud.ConfigurationTarget.Global)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Ud.ConfigurationTarget.Global),UI))}return o}};Yg.migratedSettings={interactiveWindowMode:"interactiveWindow.creationMode",interactiveWindowViewColumn:"interactiveWindow.viewColumn",splitRunFileIntoCells:"interactiveWindow.splitRunFileIntoCells",interactiveReplNotebook:"interactiveWindow.notebookRepl",sendSelectionToInteractiveWindow:"interactiveWindow.textEditor.executeSelection",normalizeSelectionForInteractiveWindow:"interactiveWindow.textEditor.normalizeSelection",magicCommandsAsComments:"interactiveWindow.textEditor.magicCommandsAsComments",enableAutoMoveToNextCell:"interactiveWindow.textEditor.autoMoveToNextCell",newCellOnRunLast:"interactiveWindow.textEditor.autoAddNewCell",pythonCellFolding:"interactiveWindow.textEditor.cellFolding",enableCellCodeLens:"interactiveWindow.codeLens.enable",addGotoCodeLenses:"interactiveWindow.codeLens.enableGotoCell",codeLenses:"interactiveWindow.codeLens.commands",debugCodeLenses:"interactiveWindow.codeLens.debugCommands","interactiveWindow.codeLes.debugCommands":"interactiveWindow.codeLens.debugCommands",codeRegularExpression:"interactiveWindow.cellMarker.codeRegex",markdownRegularExpression:"interactiveWindow.cellMarker.markdownRegex",decorateCells:"interactiveWindow.cellMarker.decorateCells",defaultCellMarker:"interactiveWindow.cellMarker.default",enableExtendedKernelCompletions:"enableExtendedPythonKernelCompletions"},Yg.fullSettingIds={...Yg.migratedSettings};var sP=Yg;function UI(r){C.warn("Error migrating Jupyter configuration",r)}p();function lSe(r){return(e,t,n)=>{let i=null,o=null;if(typeof n.value=="function"?(i="value",o=n.value):typeof n.get=="function"&&(i="get",o=n.get),!o)throw new Error("not supported");n[i]=r(o,t)}}function jR(r,e,t){return lSe((n,i)=>{let o=`$debounce$${i}`,s=`$debounce$result$${i}`;return function(...a){this[s]||(this[s]=t?t():void 0),clearTimeout(this[o]),e&&(this[s]=e(this[s],...a),a=[this[s]]),this[o]=setTimeout(()=>{n.apply(this,a),this[s]=t?t():void 0},r)}})}var Pa=class Pa{constructor(e,t,n){this._systemVariablesCtor=t;this._type=n;this.allowUnauthorizedRemoteConnection=!1;this.jupyterInterruptTimeout=1e4;this.jupyterLaunchTimeout=6e4;this.jupyterLaunchRetries=3;this.notebookFileRoot="";this.useDefaultConfigForJupyter=!1;this.sendSelectionToInteractiveWindow=!1;this.splitRunFileIntoCells=!0;this.markdownRegularExpression="";this.codeRegularExpression="";this.errorBackgroundColor="";this.variableExplorerExclude="";this.decorateCells="currentCell";this.enableCellCodeLens=!1;this.askForLargeDataFrames=!1;this.enableAutoMoveToNextCell=!1;this.askForKernelRestart=!1;this.codeLenses="";this.debugCodeLenses="";this.debugpyDistPath="";this.stopOnFirstLineWhileDebugging=!1;this.magicCommandsAsComments=!1;this.pythonExportMethod="direct";this.stopOnError=!1;this.addGotoCodeLenses=!1;this.runStartupCommands=[];this.debugJustMyCode=!1;this.defaultCellMarker="";this.themeMatplotlibPlots=!1;this.disableJupyterAutoStart=!1;this.enablePythonKernelLogging=!1;this.jupyterCommandLineArguments=[];this.widgetScriptSources=[];this.interactiveWindowMode="multiple";this.pythonCellFolding=!0;this.interactiveWindowViewColumn="secondGroup";this.disableZMQSupport=!1;this.forceIPyKernelDebugger=!1;this.verboseLogging=!1;this.showVariableViewWhenDebugging=!0;this.newCellOnRunLast=!0;this.logKernelOutputSeparately=!1;this.development=!1;this.poetryPath="";this.excludeUserSitePackages=!1;this.enableExtendedPythonKernelCompletions=!1;this.formatStackTraces=!1;this.interactiveReplNotebook=!1;this._changeEmitter=new Si.EventEmitter;this._disposables=[];this._workspaceRoot=e,this.initialize(),Si.workspace.isTrusted===!1&&(this.disableJupyterAutoStart=!0)}get onDidChange(){return this._changeEmitter.event}static getInstance(e,t,n){let i=Pa.getSettingsUriAndTarget(e).uri,o=i?i.path:"",s=Pa.jupyterSettings.get(o);return s?s._type==="web"&&n==="node"&&(s._systemVariablesCtor=t,s._type=n):(s=new Pa(i,t,n),Pa.jupyterSettings.set(o,s)),s}static getSettingsUriAndTarget(e){let t=e?Si.workspace.getWorkspaceFolder(e):void 0,n=t?t.uri:void 0;!n&&Array.isArray(Si.workspace.workspaceFolders)&&Si.workspace.workspaceFolders.length>0&&(n=Si.workspace.workspaceFolders[0].uri);let i=n?Si.ConfigurationTarget.WorkspaceFolder:Si.ConfigurationTarget.Global;return{uri:n,target:i}}static dispose(){if(!hn())throw new Error("Dispose can only be called from unit tests");Pa.jupyterSettings.forEach(e=>e&&e.dispose()),Pa.jupyterSettings.clear()}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}createSystemVariables(e){return new this._systemVariablesCtor(e,this._workspaceRoot)}toJSON(){let e={};return this.getSerializableKeys().forEach(n=>e[n]=this[n]),e}update(e,t){let n=this.createSystemVariables(void 0),i=n.resolveAny(e.get("experiments"));this.experiments?Object.assign(this.experiments,i):this.experiments=i,this.experiments=this.experiments?this.experiments:{enabled:!0,optInto:[],optOutFrom:[]};let o=(a,l)=>{let u=sP.fullSettingIds[a],c=u&&l.get(u)!==void 0?l.get(u):l.get(a),d=n.resolveAny(c);d!==void 0&&(this[a]=d)};this.getSerializableKeys().filter(a=>a!=="experiments"&&a!=="logging"&&a!=="kernelPickerType").forEach(a=>o(a,e)),t&&o("poetryPath",t)}onWorkspaceFoldersChanged(){let e=(Si.workspace.workspaceFolders||[]).map(i=>i.uri.path),n=Array.from(Pa.jupyterSettings.keys()).filter(i=>e.indexOf(i)<0);if(n.length>0)for(let i of n)Pa.jupyterSettings.delete(i)}initialize(){let e=()=>{let i=Si.workspace.getConfiguration("jupyter",this._workspaceRoot),o=Si.workspace.getConfiguration("python",this._workspaceRoot);this.update(i,o),this.debounceChangeNotification()};this._disposables.push(Si.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this)),this._disposables.push(Si.workspace.onDidChangeConfiguration(i=>{i.affectsConfiguration("jupyter")&&e(),i.affectsConfiguration("python.poetryPath")&&e()}));let t=Si.workspace.getConfiguration("jupyter",this._workspaceRoot),n=Si.workspace.getConfiguration("python",this._workspaceRoot);t&&(this.update(t,n),this.migrateSettings(t).catch(E))}async migrateSettings(e){await new sP(e).migrateSettings()}debounceChangeNotification(){this._changeEmitter.fire()}fireChangeNotification(){this._changeEmitter.fire()}getSerializableKeys(){return Object.getOwnPropertyNames(this).filter(e=>!e.startsWith("_"))}};Pa.jupyterSettings=new Map,U([jR(1)],Pa.prototype,"debounceChangeNotification",1);var WI=Pa;p();var ou=require("vscode");p();p();var yj={number:"number",string:"string",undefined:"undefined",object:"object",function:"function"};function bj(r){return Array.isArray?Array.isArray(r):!!(r&&typeof r.length===yj.number&&r.constructor===Array)}function BR(r){return typeof r===yj.string||r instanceof String}function Ij(r){return typeof r===yj.object&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}var HR=class{resolve(e){return BR(e)?this.__resolveString(e):bj(e)?this.__resolveArray(e):Ij(e)?this.__resolveLiteral(e):e}resolveAny(e){return BR(e)?this.__resolveString(e):bj(e)?this.__resolveAnyArray(e):Ij(e)?this.__resolveAnyLiteral(e):e}__resolveString(e){let t=/\$\{(.*?)\}/g;return e.replace(t,(n,i)=>{let o=this[i];return BR(o)?o:n&&(n.indexOf("env.")>0||n.indexOf("env:")>0)?"":n})}__resolveLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolve(i)}),t}__resolveAnyLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolveAny(i)}),t}__resolveArray(e){return e.map(t=>this.__resolveString(t))}__resolveAnyArray(e){return e.map(t=>this.resolveAny(t))}};var qR=class extends HR{constructor(t,n){super();let i=t?ou.workspace.getWorkspaceFolder(t):void 0;this._workspaceFolder=i?i.uri.path:n||"",this._filePath=t?t.path:void 0,ou.window.activeTextEditor&&(this._lineNumber=ou.window.activeTextEditor.selection.anchor.line+1,this._selectedText=ou.window.activeTextEditor.document.getText(new ou.Range(ou.window.activeTextEditor.selection.start,ou.window.activeTextEditor.selection.end)))}get cwd(){return this.workspaceFolder}get workspaceRoot(){return this._workspaceFolder}get workspaceFolder(){return this._workspaceFolder}get file(){return this._filePath}get lineNumber(){return this._lineNumber}get selectedText(){return this._selectedText}};p();var su=require("vscode");var JR=class{async updateSectionSetting(e,t,n,i,o){let a={uri:i,target:o||su.ConfigurationTarget.WorkspaceFolder};e==="jupyter"&&o!==su.ConfigurationTarget.Global&&(a=WI.getSettingsUriAndTarget(i));let l=su.workspace.getConfiguration(e,a.uri),u=l.inspect(t);u!==void 0&&(o===su.ConfigurationTarget.Global&&u.globalValue===n||o===su.ConfigurationTarget.Workspace&&u.workspaceValue===n||o===su.ConfigurationTarget.WorkspaceFolder&&u.workspaceFolderValue===n)||(await l.update(t,n,o),o&&await this.verifySetting(l,o,t,n))}async updateSetting(e,t,n,i){return this.updateSectionSetting("jupyter",e,t,n,i)}async verifySetting(e,t,n,i){if(hn()&&!BE()){let o=0;do{let s=e.inspect(n);if(!s&&i===void 0||s&&i!==void 0&&(t===su.ConfigurationTarget.Global?s.globalValue:t===su.ConfigurationTarget.Workspace?s.workspaceValue:s.workspaceFolderValue)===i)break;await new Promise(a=>setTimeout(a,250)),o+=1}while(o<20)}}};var VI=class extends JR{getSettings(e){return WI.getInstance(e,qR,"web")}};VI=U([(0,GQ.injectable)()],VI);p();function YQ(r){r.addSingleton(vy,fI),r.addSingleton(vo,Lf)}p();p();var nm=oe(he()),pX=require("vscode"),aP=oe(dX());p();var iA=class{setSharedProperty(e,t){Xb(e,t)}postEvent(e,t){let n={};t.forEach((i,o)=>{n[o]=i}),ne(e,void 0,n)}};p();var Lj=oe(require("vscode")),oA=oe(he());var qI=class{constructor(e){this.extensionContext=e}get extensionVersion(){return this.extensionContext.extension.packageJSON.version}};qI=U([(0,oA.injectable)(),x(0,(0,oA.inject)(st))],qI);function Wd(){return Lj.env.appName.indexOf("Insider")>0||Lj.env.appName.indexOf("Code - OSS Dev")>=0?"insiders":"stable"}var NSe="VSCode.ABExp.FeatureData",Kj="vscode",JI=class{constructor(e,t,n){this.configurationService=e;this.appEnvironment=t;this.globalState=n;this._optInto=[];this._optOutFrom=[];this.settings=e.getSettings(void 0);let i=this.settings.experiments.optInto,o=this.settings.experiments.optOutFrom;if(this._optInto=i.filter(l=>!l.endsWith("control")),this._optOutFrom=o.filter(l=>!l.endsWith("control")),!this.enabled)return;let s;Wd()==="insiders"?s=aP.TargetPopulation.Insiders:s=aP.TargetPopulation.Public;let a=new iA;this.experimentationService=(0,aP.getExperimentationService)(Je,this.appEnvironment.extensionVersion,s,a,this.globalState)}get enabled(){return this.settings.experiments.enabled&&!this.settings.experiments.optOutFrom.includes("All")}async activate(){this.experimentationService&&this.enabled&&(await this.experimentationService.initializePromise,this.getFeatures().length===0&&await this.experimentationService.initialFetch,this.logExperiments())}inExperiment(e){return!this.experimentationService||!this.enabled||this._optOutFrom.includes(e.toString())?!1:this._optInto.includes(e.toString())||this._optInto.includes("All")?(this.experimentationService.getTreatmentVariable(Kj,e),!0):e==="DoNotWaitForZmqPortsToBeUsed"&&(Wd()==="insiders"||jv())||e==="DataViewerContribution"&&(Wd()==="insiders"||jv())?!0:this.experimentationService.getTreatmentVariable(Kj,e)===!0}async getExperimentValue(e){if(!(!this.experimentationService||!this.enabled||this._optOutFrom.includes(e)))return this.experimentationService.getTreatmentVariable(Kj,e)}getFeatures(){return this.globalState.get(NSe,{features:[]}).features}logExperiments(){let e=pX.workspace.getConfiguration("telemetry"),t=!1;if(e&&e.get("enableTelemetry")===!1&&(C.info("Telemetry is disabled"),t=!0),e&&e.get("telemetryLevel")==="off"&&(C.info("Telemetry level is off"),t=!0),t&&C.info("Experiments are disabled, only manually opted experiments are active."),this._optOutFrom.includes("All"))return;if(this._optInto.includes("All")){C.info(Np.inGroup("All"));return}let n=new Set(this._optInto),i=new Set;this._optOutFrom.filter(o=>o!=="All").forEach(o=>{C.info(Np.notInGroup(o))}),this._optInto.filter(o=>o!=="All").forEach(o=>{i.add(o),C.info(Np.inGroup(o))}),t&&!i.has("DoNotWaitForZmqPortsToBeUsed")&&(Wd()==="insiders"||jv())&&C.info(Np.inGroup("DoNotWaitForZmqPortsToBeUsed")),t||this.getFeatures().forEach(o=>{o.toLowerCase().startsWith("jupyter")&&!this._optOutFrom.includes(o)&&!this._optInto.includes(o)&&(n.add(o),C.info(Np.inGroup(o)))})}};JI=U([(0,nm.injectable)(),x(0,(0,nm.inject)(Ke)),x(1,(0,nm.inject)(KI)),x(2,(0,nm.inject)(Et)),x(2,(0,nm.named)(rr))],JI);p();var aA=oe(he()),Ks=require("vscode");p();var sA=require("vscode");function GI(r){sA.env.openExternal(typeof r=="string"?sA.Uri.parse(r):r).then(E,E)}var RSe=[{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE",message:uy.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/309",setting:{setting:"formatting.formatOnSave",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE",message:uy.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/313",setting:{setting:"linting.lintOnTextChange",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES",message:uy.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/1704",setting:{setting:"autoComplete.preloadModules"}}],YI=class{constructor(e){this.persistentStateFactory=e;this._onDidChangeFeatures=new Ks.EventEmitter;this.onDidChangeFeatures=this._onDidChangeFeatures.event;this._features={};this.disposables=[];this._updateFeatures(),this.disposables.push(Ks.workspace.onDidChangeConfiguration(()=>{this._updateFeatures()}))}get features(){return this._features}set features(e){this._features=e,this._onDidChangeFeatures.fire()}_updateFeatures(){this.features={}}dispose(){this.disposables.forEach(e=>e.dispose())}initialize(){RSe.forEach(this.registerDeprecation.bind(this))}registerDeprecation(e){Array.isArray(e.commands)&&e.commands.forEach(t=>{this.disposables.push(Ks.commands.registerCommand(t,()=>this.notifyDeprecation(e),this))}),e.setting&&this.checkAndNotifyDeprecatedSetting(e)}async notifyDeprecation(e){let t=this.persistentStateFactory.createGlobalPersistentState(e.doNotDisplayPromptStateKey,!0);if(!t.value)return;let n="Learn more",i="Never show again",o=await Ks.window.showInformationMessage(e.message,n,i);if(o)switch(o){case n:{GI(e.moreInfoUrl);break}case i:{await t.updateValue(!1);break}default:throw new Error("Selected option not supported.")}}checkAndNotifyDeprecatedSetting(e){let t=!1;Array.isArray(Ks.workspace.workspaceFolders)&&Ks.workspace.workspaceFolders.length>0?Ks.workspace.workspaceFolders.forEach(n=>{t||(t=this.isDeprecatedSettingAndValueUsed(Ks.workspace.getConfiguration("jupyter",n.uri),e.setting))}):t=this.isDeprecatedSettingAndValueUsed(Ks.workspace.getConfiguration("jupyter"),e.setting),t&&this.notifyDeprecation(e).catch(n=>C.debug("Jupyter Extension: notifyDeprecation",n))}isDeprecatedSettingAndValueUsed(e,t){if(!e.has(t.setting))return!1;let n=e.get(t.setting);return!Array.isArray(t.values)||t.values.length===0?Array.isArray(n)?n.length>0:!0:!Array.isArray(t.values)||t.values.length===0?n===void 0?!1:Array.isArray(n)?n.length>0:!0:t.values.indexOf(e.get(t.setting))>=0}};YI=U([(0,aA.injectable)(),x(0,(0,aA.inject)(IT))],YI);p();var im=oe(he());var lA=class{constructor(e,t,n,i){this.storage=e;this.key=t;this.defaultValue=n;this.expiryDurationMs=i}get value(){if(this.expiryDurationMs){let e=this.storage.get(this.key,{data:this.defaultValue});return!e||!e.expiry||e.expiry<Date.now()?this.defaultValue:e.data}else return this.storage.get(this.key,this.defaultValue)}async updateValue(e){this.expiryDurationMs?await this.storage.update(this.key,{data:e,expiry:Date.now()+this.expiryDurationMs}):await this.storage.update(this.key,e)}},$I=class{constructor(e,t){this.globalState=e;this.workspaceState=t}createGlobalPersistentState(e,t,n){return new lA(this.globalState,e,t,n)}createWorkspacePersistentState(e,t,n){return new lA(this.workspaceState,e,t,n)}};$I=U([(0,im.injectable)(),x(0,(0,im.inject)(Et)),x(0,(0,im.named)(rr)),x(1,(0,im.inject)(Et)),x(1,(0,im.named)(_s))],$I);p();p();var fX=oe(he());var zI=class{constructor(){this.osType="Unknown"}get tempDir(){}get homeDir(){}get pathVariableName(){return""}get isWindows(){return this.osType==="Windows"}get isMac(){return this.osType==="OSX"}get isLinux(){return this.osType==="Linux"}};zI=U([(0,fX.injectable)()],zI);p();var ds=Symbol("IPlatformService"),Pt=Symbol("IFileSystem");function mX(r){r.addSingleton(ds,zI)}p();var hX=oe(he()),Fj=require("vscode");var QI=class{determineExtensionFromCallStack(e){if(e=e||new Error().stack,e){let t=Fj.extensions.getExtension(Je).extensionUri.toString().toLowerCase(),n=e.split(`
`).map(i=>{let o=/\((.*)\)/.exec(i);if(o)return o[1]}).filter(i=>i&&i.toLowerCase().startsWith("http")).filter(i=>i&&!i.toLowerCase().startsWith(t));bK(new Error("Ex")).forEach(i=>{let o=i.getFileName();o&&!o.toLowerCase().startsWith(t)&&n.push(o)});for(let i of n){let o=Fj.extensions.all.find(s=>s.id!==Je&&i.startsWith(s.extensionUri.toString()));if(o)return{extensionId:o.id,displayName:o.packageJSON.displayName}}C.error("Unable to determine the caller of the extension API for trace stack.",e)}return{extensionId:hD,displayName:W.unknownPackage}}};QI=U([(0,hX.injectable)()],QI);p();var cA=oe(he()),Uj=require("vscode");var XI=class{constructor(e){this.extensionContext=e;this.testingState=new Map}async store(e,t,n){if(ci&&this.extensionContext.extensionMode!==Uj.ExtensionMode.Production){this.testingState.set(`${e}#${t}`,n||"");return}if(n)await this.extensionContext.secrets.store(`${e}.${t}`,n);else try{await this.extensionContext.secrets.delete(`${e}.${t}`)}catch(i){C.error(i)}}async retrieve(e,t){if(ci&&this.extensionContext.extensionMode!==Uj.ExtensionMode.Production)return this.testingState.get(`${e}#${t}`);try{return await this.extensionContext.secrets.get(`${e}.${t}`)}catch(n){try{await this.extensionContext.secrets.delete(`${e}.${t}`);return}catch(i){C.error(i)}}}};XI=U([(0,cA.injectable)(),x(0,(0,cA.inject)(st))],XI);p();var gX=oe(he());var ZI=class{constructor(){this._list=[]}async dispose(){let e=this._list.map(t=>t.dispose());await Promise.all(e),this._list=[]}push(e){e&&this._list.push(e)}get list(){return this._list}};ZI=U([(0,gX.injectable)()],ZI);p();var vX=oe(he()),lu=require("vscode");var om=class om extends Error{};om.back=new om("back"),om.cancel=new om("cancel"),om.resume=new om("resume");var ze=om,lP=class{constructor(){this.steps=[]}run(e,t){return this.stepThrough(e,t)}async showQuickPick(e){return this.showLazyLoadQuickPick(e).selection}showLazyLoadQuickPick({title:e,step:t,totalSteps:n,items:i,activeItem:o,placeholder:s,buttons:a,shouldResume:l,matchOnDescription:u,matchOnDetail:c,acceptFilterBoxTextAsSelection:d,startBusy:f,stopBusy:m,validate:g,onDidTriggerItemButton:b,onDidTriggerButton:v,supportBackInFirstStep:k,onDidChangeItems:R,ignoreFocusOut:P}){let D=[],K=Re(),L=lu.window.createQuickPick();return L.title=e,L.step=t,L.totalSteps=n,L.placeholder=s,L.ignoreFocusOut=P!=null?P:!0,L.items=i,m&&(L.busy=f!=null?f:!1,m(()=>{L.enabled&&(L.busy=!1)},this,D)),R&&(L.keepScrollPosition=!0,R(B=>{L.items=B},this,D)),b&&L.onDidTriggerItemButton(B=>b(B),void 0,D),L.matchOnDescription=u||!1,L.matchOnDetail=c||!1,o?L.activeItems=[o]:L.activeItems=[],L.buttons=[...this.steps.length>1||k?[lu.QuickInputButtons.Back]:[],...a||[]],D.push(L.onDidTriggerButton(B=>{B===lu.QuickInputButtons.Back?K.reject(ze.back):v?v(B):K.resolve(B)}),L.onDidChangeSelection(async B=>{let N=B.length?B[0].label:"",O=!!N;if(N&&g&&B.length){L.enabled=!1,L.busy=!0;let h=await g(B[0]);h&&(O=!1,await lu.window.showErrorMessage(h,{modal:!0})),L.enabled=!0,L.busy=!1}O&&K.resolve(B[0])}),L.onDidHide(()=>{(async()=>{K.reject(l&&await l()?ze.resume:ze.cancel)})().catch(K.reject)})),d&&D.push(L.onDidAccept(async()=>{if(!L.busy){let B=g?await g(L):void 0;B?(L.enabled=!1,L.busy=!0,await lu.window.showErrorMessage(B),L.enabled=!0,L.busy=!1):K.resolve(L.value)}})),this.current&&this.current.dispose(),this.current=L,this.current.show(),K.promise.finally(()=>Ce(D)).catch(E),{quickPick:L,selection:K.promise}}async showInputBox({title:e,step:t,totalSteps:n,value:i,prompt:o,validate:s,password:a,buttons:l,shouldResume:u,validationMessage:c}){let d=[];try{return await new Promise((f,m)=>{let g=lu.window.createInputBox();g.title=e,g.step=t,g.totalSteps=n,g.password=!!a,g.value=i||"",g.prompt=o,g.validationMessage=c||"",g.ignoreFocusOut=!0,g.validationMessage=c||"",g.buttons=[...this.steps.length>1?[lu.QuickInputButtons.Back]:[],...l||[]],d.push(g.onDidTriggerButton(b=>{b===lu.QuickInputButtons.Back?m(ze.back):f(b)}),g.onDidAccept(async()=>{let b=g.value;g.enabled=!1,g.busy=!0;let v=await s(b);v?(g.validationMessage=v,g.show()):(g.validationMessage="",f(b)),g.enabled=!0,g.busy=!1}),g.onDidChangeValue(async()=>{g.validationMessage=""}),g.onDidHide(()=>{(async()=>{g.busy||m(u&&await u()?ze.resume:ze.cancel)})().catch(m)})),this.current&&this.current.dispose(),this.current=g,this.current.show()})}finally{d.forEach(f=>f.dispose())}}async stepThrough(e,t){let n=e;for(;n;){this.steps.push(n),this.current&&(this.current.enabled=!1,this.current.busy=!0);try{n=await n(this,t)}catch(i){if(i===ze.back)this.steps.pop(),n=this.steps.pop();else if(i===ze.resume)n=this.steps.pop();else if(i===ze.cancel)n=void 0;else throw i;if(!n)return i}}this.current&&this.current.dispose()}},yX=Symbol("IMultiStepInputFactory"),eS=class{create(){return new lP}};eS=U([(0,vX.injectable)()],eS);p();var bX=oe(he()),Mo=require("vscode");var Vd=class{get activeDebugConsole(){return Mo.debug.activeDebugConsole}get activeDebugSession(){var e;return C.ci(`Getting active debug session, ${(e=Mo.debug.activeDebugSession)==null?void 0:e.name}`),Mo.debug.activeDebugSession}get breakpoints(){return Mo.debug.breakpoints}get onDidChangeActiveDebugSession(){return Mo.debug.onDidChangeActiveDebugSession}get onDidStartDebugSession(){return Mo.debug.onDidStartDebugSession}get onDidReceiveDebugSessionCustomEvent(){return Mo.debug.onDidReceiveDebugSessionCustomEvent}get onDidTerminateDebugSession(){return Mo.debug.onDidTerminateDebugSession}get onDidChangeBreakpoints(){return Mo.debug.onDidChangeBreakpoints}registerDebugConfigurationProvider(e,t){return Mo.debug.registerDebugConfigurationProvider(e,t)}registerDebugAdapterTrackerFactory(e,t){return Mo.debug.registerDebugAdapterTrackerFactory(e,t)}startDebugging(e,t,n){return Mo.debug.startDebugging(e,t,n)}addBreakpoints(e){Mo.debug.addBreakpoints(e)}removeBreakpoints(e){Mo.debug.removeBreakpoints(e)}};Vd.instance=new Vd,Vd=U([(0,bX.injectable)()],Vd);p();var cP=oe(he());var SX=oe(uA());var IX="_VSCODE_getDataFrame",dA=SX.default`
                            try:
                                del _VSCODE_getDataFrame
                            except:
                                pass
                            `,cu=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetDataFrameInfo(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${IX}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:dA}:{code:`${t}

${i}

${dA}`}}async generateCodeToGetDataFrameRows(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${IX}("rows", ${n}, ${e.variableName}, ${e.startIndex}, ${e.endIndex})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:dA}:{code:`${t}

${i}

${dA}`}}async getContentsOfDataFrameScript(){if(cu.contentsOfDataFrameScript)return cu.contentsOfDataFrameScript;let e=Fi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","dataframes","vscodeDataFrame.py"),t=await this.fs.readFile(e);return cu.contentsOfDataFrameScript=t,t}};cu=U([(0,cP.injectable)(),x(0,(0,cP.inject)(Pt)),x(1,(0,cP.inject)(st))],cu);p();var uP=oe(he());var jj=oe(uA());var Vj="_VSCODE_getVariable",tS=jj.default`
                            try:
                                del _VSCODE_getVariable
                            except:
                                pass
                            `,Fs=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetVariableInfo(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${Vj}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:tS}:{code:`${t}

${i}

${tS}`}}async generateCodeToGetVariableProperties(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${Vj}("properties", ${n}, ${e.variableName}, ${e.stringifiedAttributeNameList})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:tS}:{code:`${t}

${i}

${tS}`}}async generateCodeToGetAllVariableDescriptions(e){let t=await this.getContentsOfVariablesScript();return e?t=t+`

return _VSCODE_getAllChildrenDescriptions('${e.root}', ${JSON.stringify(e.propertyChain)}, ${e.startIndex})`:t=t+`

variables= %who_ls
return _VSCODE_getVariableDescriptions(variables)`,t}async generateCodeToGetVariableTypes(e){let n=`${await this.getContentsOfScript()}

_VSCODE_rwho_ls = %who_ls
`,i=e.isDebugging?"True":"False",o=jj.default`
        try:
            del _VSCODE_rwho_ls
        except:
            pass
        `,s=`${Vj}("types", ${i}, _VSCODE_rwho_ls)`;return e.isDebugging?{initializeCode:n,code:s,cleanupCode:`${tS}
${o}`}:{code:`${n}${s}

${tS}
${o}`}}async generateCodeToGetVariableValueSummary(e){let t=await this.getContentsOfVariablesScript();return t=t+`

variables= %who_ls
return _VSCODE_getVariableSummary(${e})`,t}async getContentsOfScript(){if(Fs.contentsOfScript)return Fs.contentsOfScript;let e=Fi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariableInfo.py"),t=await this.fs.readFile(e);return Fs.contentsOfScript=t,t}async getContentsOfVariablesScript(){if(Fs.contentsOfVariablesScript)return Fs.contentsOfVariablesScript;let e=Fi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariablesForProvider.py"),t=await this.fs.readFile(e);return Fs.contentsOfVariablesScript=t,t}};Fs=U([(0,uP.injectable)(),x(0,(0,uP.inject)(Pt)),x(1,(0,uP.inject)(st))],Fs);p();var pA=Symbol("IExtensionActivationManager"),Ve=Symbol("IExtensionSyncActivationService");p();var dP=require("vscode");var uu=oe(he());var _X=["currentServerHash","connectToLocalKernelsOnly","JUPYTER_LOCAL_KERNELSPECS","JUPYTER_LOCAL_KERNELSPECS_V1","JUPYTER_LOCAL_KERNELSPECS_V2","JUPYTER_LOCAL_KERNELSPECS_V3","JUPYTER_REMOTE_KERNELSPECS","JUPYTER_REMOTE_KERNELSPECS_V1","JUPYTER_REMOTE_KERNELSPECS_V2","JUPYTER_REMOTE_KERNELSPECS_V3","JUPYTER_LOCAL_KERNELSPECS_V4","JUPYTER_REMOTE_KERNELSPECS_V4-","LOCAL_KERNEL_SPECS_CACHE_KEY_V_2022_10","LOCAL_KERNEL_PYTHON_AND_RELATED_SPECS_CACHE_KEY_V_2022_10","user-jupyter-server-uri-list-v2","REGISTRATION_ID_EXTENSION_OWNER_MEMENTO_KEY","jupyter.jupyterServer.uriList"],rS=class{constructor(e,t,n,i){this.globalState=e;this.crypto=t;this.workspaceState=n;this.extensionContext=i}activate(){this.removeOldCachedItems().then(E,E)}async removeOldCachedItems(){await Promise.all([await this.getUriAccountKey()].concat(_X).filter(t=>this.globalState.get(t,void 0)!==void 0).map(t=>this.globalState.update(t,void 0).then(E,E)));let e=this.workspaceState.keys().filter(t=>t.startsWith("LAST_EXECUTED_CELL_")&&!t.startsWith("LAST_EXECUTED_CELL_V2_"));await Promise.all(e.map(t=>this.workspaceState.update(t,void 0))),await Promise.all(_X.map(t=>this.globalState.keys().filter(n=>n.startsWith(t)).map(n=>this.globalState.update(n,void 0).then(E,E))).flat()),await this.extensionContext.secrets.delete(`${li.JupyterServerRemoteLaunchService}.remote-uri-list`).then(E,E)}async getUriAccountKey(){let e=lI();return e?this.crypto.createHash(ct(e),"SHA-512"):dP.workspace.workspaceFile?this.crypto.createHash(ct(dP.workspace.workspaceFile),"SHA-512"):dP.env.machineId}};rS=U([(0,uu.injectable)(),x(0,(0,uu.inject)(Et)),x(0,(0,uu.named)(rr)),x(1,(0,uu.inject)(dy)),x(2,(0,uu.inject)(Et)),x(2,(0,uu.named)(_s)),x(3,(0,uu.inject)(st))],rS);function EX(r){r.addSingletonInstance(z7,!1),r.addSingleton(py,JI),r.addSingleton(ST,YI),r.addSingleton(IT,$I),r.addSingleton(Ha,QI),r.addSingleton(dy,ly),r.addSingleton(oP,XI),r.addSingleton(oo,Vd),r.addSingleton(Vu,ZI),r.addSingleton(yX,eS),r.addSingleton(hy,cu),r.addSingleton(my,Fs),r.addSingleton(Ve,rS),mX(r)}p();p();var fA=oe(he()),jd=require("vscode");var Bd=class{constructor(e){this.disposables=[];this._onDidChange=new jd.EventEmitter;e.push(this),zr()||jd.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.kernels.excludePythonEnvironments")&&this._onDidChange.fire()},this,this.disposables)}get onDidChange(){return this._onDidChange.event}dispose(){this._onDidChange.dispose(),Ce(this.disposables)}isPythonEnvironmentExcluded(e){if(zr())return!1;let t=this.getExcludedPythonEnvironments(),n=MSe(e,t),i="uri"in e?e.uri:e.executable.uri;return n&&(ne("DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER"),C.debug(`Python Env hidden via filter: ${Ee(i)}`)),n}getExcludedPythonEnvironments(){if(!jd.workspace.workspaceFolders||jd.workspace.workspaceFolders.length===0)return jd.workspace.getConfiguration("jupyter",void 0).get("kernels.excludePythonEnvironments",[]);let e=[];return jd.workspace.workspaceFolders.forEach(t=>{e.push(...jd.workspace.getConfiguration("jupyter",t.uri).get("kernels.excludePythonEnvironments",[]))}),e}};Bd=U([(0,fA.injectable)(),x(0,(0,fA.inject)(ve))],Bd);function MSe(r,e){var o;let t="uri"in r?r.envPath:(o=r.environment)==null?void 0:o.folderUri,n="uri"in r?r.uri:r.executable.uri;return!n&&!t?!1:e.some(s=>{let a=Ee(s.trim()).toLowerCase().replace(/\\/g,"/");if(s=s.trim().toLowerCase().replace(/\\/g,"/"),s.length===0||a.length===0)return!1;let l=Ee(n).toLowerCase().replace(/\\/g,"/"),u=n?n.fsPath.toLowerCase().replace(/\\/g,"/"):"";if(s===l||a===l||s===u||a===u)return!0;let c=Ee(t||"").toLowerCase().replace(/\\/g,"/"),d=Ee(t||"").toLowerCase().replace(/\\/g,"/");return s===c||a===c||s===d||a===d})}p();var CX=oe(he()),so=require("vscode");var nS=class{activate(){this.migrateFilters().catch(E)}async migrateFilters(){let e=Array.isArray(so.workspace.workspaceFolders)?so.workspace.workspaceFolders:[];await this.migrateWorkspaceFilters(so.workspace.getConfiguration("jupyter",void 0),so.ConfigurationTarget.Global),e.length===0?await this.migrateWorkspaceFilters(so.workspace.getConfiguration("jupyter",void 0),so.ConfigurationTarget.Global):e.length===1?await this.migrateWorkspaceFilters(so.workspace.getConfiguration("jupyter",e[0].uri),so.ConfigurationTarget.WorkspaceFolder):(await this.migrateWorkspaceFilters(so.workspace.getConfiguration("jupyter",void 0),so.ConfigurationTarget.Workspace),await Promise.all(e.map(t=>this.migrateWorkspaceFilters(so.workspace.getConfiguration("jupyter",t.uri),so.ConfigurationTarget.WorkspaceFolder))))}async migrateWorkspaceFilters(e,t){let n=e.inspect("kernels.filter"),i=[];switch(t){case so.ConfigurationTarget.Global:i=(n==null?void 0:n.globalValue)||[];break;case so.ConfigurationTarget.Workspace:i=(n==null?void 0:n.workspaceValue)||[];break;default:i=(n==null?void 0:n.workspaceFolderValue)||[]}let o=i.filter(s=>s.type==="pythonEnvironment").map(s=>s.path);i.length&&await e.update("kernels.filter",void 0,t),o.length&&await e.update("kernels.excludePythonEnvironments",Array.from(new Set(o)),t)}};nS=U([(0,CX.injectable)()],nS);p();var mA=oe(he());var Bj=require("vscode");var iS=class{constructor(e){this.disposables=e}activate(){this.disposables.push(Bj.commands.registerCommand("jupyter.filterKernels",()=>Bj.commands.executeCommand("workbench.action.openSettings","jupyter.kernels.excludePythonEnvironments").then(E,E),this))}};iS=U([(0,mA.injectable)(),x(0,(0,mA.inject)(ve))],iS);function wX(r){r.addSingleton(Ve,nS),r.addSingleton(Ve,iS),r.addSingleton(Bd,Bd)}p();var kX=oe(he()),oS=require("vscode");p();var PX=new Set;function DX(r){PX.add(r)}function xX(r){try{PX.forEach(e=>e.report(r))}catch(e){C.error("Failed to report progress",e)}}function TX(r){return function(e,t,n){let i=n.value;n.value=async function(...o){return xX({action:r,phase:"started"}),i.apply(this,o).finally(()=>{xX({action:r,phase:"completed"})})}}}p();p();var LSe={JupyterSessionWaitForIdleSession:W.waitingForJupyterSessionToBeIdle,KernelsGetKernelForRemoteConnection:W.gettingListOfKernelsForRemoteConnection,KernelsGetKernelSpecs:W.gettingListOfKernelSpecs,KernelsRegisterKernel:W.registeringKernel,NotebookConnect:W.connectingToJupyter,NotebookStart:W.startingJupyterNotebook,InstallingMissingDependencies:W.installingMissingDependencies,ExportNotebookToPython:W.exportNotebookToPython,PerformingExport:W.performingExport};function hA(r){return LSe[r]}var Fl=class{constructor(){this.progressReporters=[];this.actionPhases=new Map;this.currentActions=[];DX(this)}get currentAction(){return this.currentActions.length===0?void 0:this.currentActions[this.currentActions.length-1]}createProgressIndicator(e,t=!1){let n=new oS.CancellationTokenSource,i=Re(),o={location:oS.ProgressLocation.Notification,cancellable:t,title:e};return oS.window.withProgress(o,async(s,a)=>{a.onCancellationRequested(()=>{a.isCancellationRequested&&n.cancel(),i.resolve()}),n.token.onCancellationRequested(()=>{i.resolve()}),this.progressReporters.push(s),await i.promise}).then(E,E),{token:n.token,dispose:()=>i.resolve()}}report(e){if(this.progressReporters.length!==0&&(this.actionPhases.set(e.action,e.phase),e.phase==="started"&&this.currentActions.push(e.action),!!this.currentAction)){for(;this.actionPhases.get(this.currentAction)&&this.actionPhases.get(this.currentAction)!=="started";)this.actionPhases.delete(this.currentAction),this.currentActions.pop();this.updateProgressMessage()}}updateProgressMessage(){if(!this.currentAction||this.progressReporters.length===0)return;let e=hA(this.currentAction);e&&this.progressReporters.forEach(t=>t.report({message:e}))}};Fl=U([(0,kX.injectable)()],Fl);p();var NX=oe(he());var RX=require("vscode");var sS=class extends YN{async computeWorkingDirectory(e){var t;if(e){let n=ct(e);return n.includes(".")?ct(Km(e)):n}return e=(e?(t=RX.workspace.getWorkspaceFolder(e))==null?void 0:t.uri:void 0)||lI(),e?ct(e):"."}};sS=U([(0,NX.injectable)()],sS);p();var $g=oe(he());var AX=require("vscode");var aS=class{constructor(e,t){this.jupyterOutput=e;this.disposableRegistry=t}register(){this.disposableRegistry.push(AX.commands.registerCommand(le.ViewJupyterOutput,this.viewJupyterOutput,this))}viewJupyterOutput(){this.jupyterOutput.show(!0)}};aS=U([(0,$g.injectable)(),x(0,(0,$g.inject)(jm)),x(0,(0,$g.named)(qv)),x(1,(0,$g.inject)(ve))],aS);p();var WX=oe(he()),sm=oe(require("vscode"));p();var lS=oe(require("vscode")),Hj;(l=>{let r=lS.FileSystemError.FileNotFound().name,e=lS.FileSystemError.FileExists().name,t=lS.FileSystemError.FileIsADirectory().name,n=lS.FileSystemError.FileNotADirectory().name,i=lS.FileSystemError.NoPermissions().name,o=[r,e,t,n,i];function s(u,c){if(o.includes(u.name))return u.name===c}function a(u){return s(u,r)}l.isFileNotFound=a})(Hj||(Hj={}));function KSe(r,e){let t=r.code;if(t)return t===e}function MX(r){let e=Hj.isFileNotFound(r);return e!==void 0?e:KSe(r,"ENOENT")}p();var FX=oe(KX()),UX=require("vscode"),du=class{constructor(e=FX.fetch){this.fetchImplementation=e;this.requestOptions={};let t=UX.workspace.getConfiguration("http").get("proxy","");t&&(this.requestOptions={headers:{proxy:t}})}async downloadFile(e){return this.fetchImplementation(e,this.requestOptions)}async exists(e){try{return(await this.downloadFile(e)).status===200}catch(t){return C.debug(`HttpClient - Failure checking for file ${e}: ${t}`),!1}}};var uS=class{constructor(){this.vscfs=sm.workspace.fs}arePathsSame(e,t){return Xs(e,t)}async getFiles(e){return(await this.vscfs.readDirectory(e)).filter(n=>n[1]===sm.FileType.File).map(n=>sm.Uri.file(n[0]))}async copy(e,t,n){await this.vscfs.copy(e,t,n)}async createDirectory(e){await this.vscfs.createDirectory(e)}async delete(e){await this.vscfs.delete(e)}async readFile(e){let t=await this.vscfs.readFile(e);return new TextDecoder().decode(t)}async stat(e){return this.vscfs.stat(e)}async writeFile(e,t){return this.vscfs.writeFile(e,typeof t=="string"?new TextEncoder().encode(t):t)}async exists(e,t){if(e.scheme.toLowerCase()==="http"||e.scheme.toLowerCase()==="https")return new du().exists(e.toString());let n;try{n=await this.stat(e)}catch(i){return MX(i)||C.error(`stat() failed for "${e}"`,i),!1}return t===void 0?!0:t===sm.FileType.Unknown?n.type===sm.FileType.Unknown:(n.type&t)===t}async getFileHash(e){let t=await this.stat(e),n=`${t.ctime}-${t.mtime}`;return Ba(n,"SHA-512")}};uS=U([(0,WX.injectable)()],uS);p();var vA=oe(he()),pu=require("vscode");var Kt=class{constructor(e){this.kernelResourceProgressReporter=new Map;e.push(this),Kt.instance=this}activate(){}dispose(){Ce(Array.from(Kt.disposables))}static createProgressReporter(e,t,n){if(!Kt.instance)return new pu.Disposable(E);let i=e?Ua(e):"";return Kt.instance.kernelResourceProgressReporter.has(i)?Kt.reportProgress(e,t):Kt.createProgressReporterInternal(i,t,n)}static wrapAndReportProgress(e,t,n){let i=e?Ua(e):"";if(!Kt.instance)return n();let o=Kt.reportProgressInternal(i,t);return n().finally(()=>o==null?void 0:o.dispose())}static reportProgress(e,t){let n=hA(t)||t,i=e?Ua(e):"";return n?Kt.reportProgressInternal(i,n||""):new pu.Disposable(()=>E)}static reportProgressInternal(e,t){if(!Kt.instance)return new pu.Disposable(E);let n=Kt.instance.kernelResourceProgressReporter.get(e);if(n||(n={title:t,pendingProgress:[],progressList:[],dispose:E},Kt.instance.kernelResourceProgressReporter.set(e,n)),n.reporter)n.progressList.push(t),n.reporter.report({message:t});else{if(n.progressList.includes(t))return new pu.Disposable(E);n.pendingProgress.push(t)}return{dispose:()=>{try{if(!n)return;let i=n.progressList.findIndex(o=>o===t);if(i>=0&&n.progressList.splice(i),n.progressList.length>0){let o=n.progressList[n.progressList.length-1];n.reporter&&n.reporter.report({message:o===n.title&&n.reporter?"":o})}else Kt.instance.kernelResourceProgressReporter.delete(e),n.dispose()}catch(i){C.error(`Failed to dispose Progress reporter for ${e}`,i)}}}}static createProgressReporterInternal(e,t,n){let i=Re(),o=new pu.Disposable(()=>i.resolve()),s=Kt.instance.kernelResourceProgressReporter.get(e)||{title:t,pendingProgress:[],progressList:[],tokenSources:[],dispose:()=>{o.dispose()}},a=!1,l=()=>{a||(a=!0,pu.window.withProgress({location:pu.ProgressLocation.Notification,title:t},async(u,c)=>{let d=Kt.instance.kernelResourceProgressReporter.get(e);if(d){for(d.reporter=u;d.pendingProgress.length>0;){let f=d.pendingProgress.shift();f===t?d.progressList.push(f):f!==t&&f&&(d.progressList.push(f),u.report({message:f}))}await Ls(c,i.promise),Kt.instance.kernelResourceProgressReporter.get(e)===d&&Kt.instance.kernelResourceProgressReporter.delete(e),Kt.disposables.delete(o)}}).then(E,E))};return Kt.instance.kernelResourceProgressReporter.set(e,{...s,dispose:()=>o.dispose(),show:l}),Kt.disposables.add(o),s.pendingProgress.push(t),n||l(),{dispose:()=>o.dispose(),show:l}}};Kt.disposables=new Set,Kt=U([(0,vA.injectable)(),x(0,(0,vA.inject)(ve))],Kt);p();var fS=oe(he()),yA=require("vscode");p();var VX=require("vscode");var dS=class{constructor(e,t,n,i=[]){this.fs=e;this.disposableRegistry=t;this.options=n;this.loadFailedEmitter=new VX.EventEmitter;let o={enableScripts:!0,localResourceRoots:[this.options.rootPath,this.options.cwd,...i]};n.webviewHost?(this.webviewHost=n.webviewHost,this.webviewHost.webview.options=o):this.webviewHost=this.createWebview(o),this.loadPromise=this.load()}get loadFailed(){return this.loadFailedEmitter.event}asWebviewUri(e){var t;if(!((t=this.webviewHost)!=null&&t.webview))throw new Error("WebView not initialized, too early to get a Uri");return this.webviewHost.webview.asWebviewUri(e)}postMessage(e){var t,n;(t=this.webviewHost)!=null&&t.webview&&((n=this.webviewHost)==null||n.webview.postMessage(e))}async generateLocalReactHtml(){var o;if(!((o=this.webviewHost)!=null&&o.webview))throw new Error("WebView not initialized, too early to get a Uri");let e=this.webviewHost.webview.asWebviewUri(this.options.cwd).toString(),t=this.options.scripts.map(s=>this.webviewHost.webview.asWebviewUri(s)),n=this.webviewHost.webview.asWebviewUri(this.options.rootPath).toString(),i="false";return`<!doctype html>
        <html lang="en">
            <head>
                <meta charset="utf-8">
                <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
                <meta http-equiv="Content-Security-Policy" content="img-src 'self' data: https: http: blob: ${this.webviewHost.webview.cspSource}; default-src 'unsafe-inline' 'unsafe-eval' data: https: http: blob: ${this.webviewHost.webview.cspSource};">
                <meta name="theme-color" content="#000000">
                <meta name="theme" content="${nt.GeneratedThemeName}"/>
                <title>VS Code Python React UI</title>
                <base href="${e}${e.endsWith("/")?"":"/"}"/>
                </head>
            <body>
                <noscript>You need to enable JavaScript to run this app.</noscript>
                <div id="root"></div>
                <script type="text/javascript">
                    // Public path that will be used by webpack.
                    window.__PVSC_Public_Path = "${n}/";
                    function resolvePath(relativePath) {
                        if (relativePath && relativePath[0] == '.' && relativePath[1] != '.') {
                            return "${e}" + relativePath.substring(1);
                        }

                        return "${e}" + relativePath;
                    }
                    function forceTestMiddleware() {
                        return ${i};
                    }
                <\/script>
                ${t.map(s=>`<script type="text/javascript" src="${s}"><\/script>`).join(`
`)}
            </body>
        </html>`}async load(){var e;try{(e=this.webviewHost)!=null&&e.webview&&((await Promise.all(this.options.scripts.map(n=>this.fs.exists(n)))).every(n=>n===!0)?(this.webviewHost.webview.html=await this.generateLocalReactHtml(),this.postLoad(this.webviewHost)):this.webviewHost.webview.html=W.badWebPanelFormatString(this.options.scripts.join(", ")))}catch(t){C.error(`Error Loading WebviewPanel: ${t}`),this.loadFailedEmitter.fire()}}};var qj=class extends dS{get panel(){return this.webviewHost}get panelOptions(){return this.options}constructor(e,t,n,i=[]){super(e,t,n,i)}async show(e){await this.loadPromise,this.panel&&(e?this.panel.visible||this.panel.reveal(this.panel.viewColumn,e):this.panel.active||this.panel.reveal(this.panel.viewColumn,e))}close(){this.panel&&this.panel.dispose()}get viewColumn(){var e;return(e=this.panel)==null?void 0:e.viewColumn}isVisible(){return this.panel?this.panel.visible:!1}isActive(){return this.panel?this.panel.active:!1}setTitle(e){this.panelOptions.title=e,this.panel&&(this.panel.title=e)}createWebview(e){return yA.window.createWebviewPanel(this.panelOptions.title.toLowerCase().replace(" ",""),this.panelOptions.title,{viewColumn:this.panelOptions.viewColumn,preserveFocus:!0},{retainContextWhenHidden:!0,enableFindWidget:!0,...e})}postLoad(e){this.disposableRegistry.push(e.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose()})),this.disposableRegistry.push(e.webview.onDidReceiveMessage(t=>{this.panelOptions.listener.onMessage(t.type,t.payload)})),this.disposableRegistry.push(e.onDidChangeViewState(t=>{this.panelOptions.listener.onChangeViewState(this)})),this.panelOptions.listener.onChangeViewState(this)}},pS=class{constructor(e,t,n){this.disposableRegistry=e;this.fs=t;this.context=n}async create(e){let t=[yA.Uri.file(YE(this.context.extensionPath,"temp"))];return Array.isArray(e.additionalPaths)&&t.push(...e.additionalPaths),new qj(this.fs,this.disposableRegistry,e,t)}};pS=U([(0,fS.injectable)(),x(0,(0,fS.inject)(ve)),x(1,(0,fS.inject)(Pt)),x(2,(0,fS.inject)(st))],pS);p();var pP=oe(he()),jX=require("vscode");var Jj=class extends dS{constructor(t,n,i,o=[]){super(t,n,i,o);this.panelOptions=i;this._onDidChangeVisibility=new jX.EventEmitter}get visible(){return this.webviewHost?this.webviewHost.visible:!1}get onDidChangeVisibility(){return this._onDidChangeVisibility.event}createWebview(t){throw new Error("Webview Views must be passed in an initial view")}postLoad(t){this.disposableRegistry.push(t.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose()})),this.disposableRegistry.push(t.webview.onDidReceiveMessage(n=>{this.panelOptions.listener.onMessage(n.type,n.payload)})),this.disposableRegistry.push(t.onDidChangeVisibility(()=>{this._onDidChangeVisibility.fire()})),this._onDidChangeVisibility.fire()}},mS=class{constructor(e,t){this.disposableRegistry=e;this.fs=t}async create(e){return new Jj(this.fs,this.disposableRegistry,e)}};mS=U([(0,pP.injectable)(),x(0,(0,pP.inject)(ve)),x(1,(0,pP.inject)(Pt))],mS);function BX(r){r.addSingleton(Pt,uS),r.addSingleton(WR,sS),r.addSingleton(KI,qI),r.addSingleton(Ke,VI),r.addSingleton(fy,aS),r.addSingleton(Fl,Fl),EX(r),YQ(r),wX(r),r.addSingleton(Ve,Kt),r.addSingleton(Ve,Ol),r.add(VR,mS),r.add(FI,pS)}p();p();var $it=Symbol("IKernelLauncher"),qd=Symbol("IRawNotebookSupportedService"),HX=Symbol("IRawKernelSessionFactory");p();var fP=oe(he()),Gj=require("vscode");p();var bA=require("vscode");var Mr;(n=>{let r=Ou(new bA.EventEmitter);n.onDidChangeNotebookCellExecutionState=r.event;function t(i,o,s){if(o!==1||!s){r.fire({cell:i,state:o});return}let a=Ou(bA.workspace.onDidChangeNotebookDocument(l=>{var c,d;if(l.notebook!==i.notebook)return;let u=l.cellChanges.find(f=>f.cell===i);((d=(c=u==null?void 0:u.cell)==null?void 0:c.executionSummary)==null?void 0:d.executionOrder)===s&&(a.dispose(),r.fire({cell:i,state:1}))}))}n.changeCellState=t})(Mr||(Mr={}));var zg=class{constructor(e,t){this.disposableRegistry=e;this.kernelProvider=t;this.lastExecutedCellPerKernel=new WeakMap;this.kernelsStartedSuccessfully=new WeakSet}activate(){this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this,this.disposableRegistry),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry)}onDidStartKernel(e){this.kernelsStartedSuccessfully.add(e),Mr.onDidChangeNotebookCellExecutionState(t=>{t.cell.notebook===e.notebook&&this.kernelProvider.get(t.cell.notebook)===e&&this.lastExecutedCellPerKernel.set(e,t.cell)})}async onKernelStatusChanged({kernel:e}){this.kernelsStartedSuccessfully.has(e)&&(e.disposed||e.disposing||!e.session||(e.session.kind==="localRaw"&&e.status==="dead"&&(Gj.window.showErrorMessage(W.kernelDiedWithoutError(ut(e.kernelConnectionMetadata))).then(E,E),await this.endCellAndDisplayErrorsInCell(e)),e.session.kind!=="localRaw"&&e.status==="autorestarting"&&(Gj.window.showErrorMessage(W.kernelDiedWithoutErrorAndAutoRestarting(ut(e.kernelConnectionMetadata))).then(E,E),await this.endCellAndDisplayErrorsInCell(e))))}async endCellAndDisplayErrorsInCell(e){let t=this.lastExecutedCellPerKernel.get(e);if(Rr(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),!!t)return Ld(t,e.controller,W.kernelCrashedDueToCodeInCurrentOrPreviousCell,!1)}};U([gn()],zg.prototype,"onKernelStatusChanged",1),zg=U([(0,fP.injectable)(),x(0,(0,fP.inject)(ve)),x(1,(0,fP.inject)(qe))],zg);p();p();var QX=oe(he());p();var Da=oe(he());p();var am=class extends ot{constructor(e){super("jupyterinstall",e)}};var Or=require("vscode");p();var IA=class extends Ii{constructor(e){super("timeout",W.rawKernelStartFailedDueToTimeout(ut(e)),e)}};p();var hS=class extends ru{constructor(t,n,i,o){super(t,i,o);this.stdErr=n}};p();var SA=class extends Ii{constructor(e){super("timeout",W.rawKernelStartFailedDueToTimeoutWaitingForPort(ut(e)),e)}};p();var gS=class extends Ii{constructor(t=-1,n,i){super("kerneldied",W.kernelDied(n.trim()),i);this.exitCode=t;this.stdErr=n}};p();p();var Lot=Symbol("IModuleInstaller"),Kot=Symbol("IPythonInstallation"),Fot=Symbol("IInstallationChannelManager"),Uot=Symbol("IProductService"),Wot=Symbol("IProductPathService");var Vot=Symbol("IInstaller");function Yj(r){switch(r){case 18:return"jupyter";case 20:return"notebook";case 23:return"pandas";case 19:return"ipykernel";case 22:return"nbconvert";case 21:return"kernelspec";case 27:return"pip";case 28:return"ensurepip";default:throw new Error(`Product ${r} cannot be installed as a Python Module.`)}}p();var _i=new Map;_i.set(18,"jupyter");_i.set(20,"notebook");_i.set(19,"ipykernel");_i.set(22,"nbconvert");_i.set(21,"kernelspec");_i.set(23,"pandas");_i.set(27,"pip");_i.set(28,"ensurepip");p();var mP=class extends Ii{constructor(t,n){super("noipykernel",W.kernelInvalid(ut(n)),n);this.reason=t}};p();var Ul=class extends ru{constructor(e){super(W.kernelDiedWithoutError(ut(e)),void 0,e)}};p();var qX=require("vscode"),pr=class{constructor(e){this._event=new qX.EventEmitter;this._disableUI=e}get disableUI(){return this._disableUI}set disableUI(e){let t=this._disableUI!==e;this._disableUI=e,t&&this._event.fire()}get onDidChangeDisableUI(){return this._event.event}dispose(){this._event.dispose()}},EA=class extends pr{constructor(t,n){super(t);this.ignoreTriggeringOnPostInitialized=n}};p();var CA=class extends ot{constructor(e){super("jupyterexpiredcert",e)}};p();var lm=class extends ot{constructor(t){super("invalidremotejupyterserverurihandle","Server handle not in list of known handles");this.serverProviderHandle=t}};p();var cm=Symbol("IInterpreterService");p();var wA=class extends ot{constructor(t,n,i){super("windowsLongPathNotEnabled",i);this.product=t;this.interpreter=n;this.originalMessage=i}};p();var hP=class extends ot{constructor(t,n,i){super("jupyternotebooknotinstalled",t+(n?`
${n}`:""));this.interpreter=i}};p();var JX=new Map;function xA(r,e){JX.set(Vt(r),e)}function vS(r,e,t){let n=e.jupyterCollections.find(i=>i.extensionId===r.extensionId&&i.id===r.id);return JX.get(Vt(r))||(n==null?void 0:n.label)||t||`${r.id}:${r.handle}`}p();var FSe=new Set;async function GX(r,e,t){let n=`${await Zb(t)}#${_i.get(e)}`;await r.update(n,void 0)}function YX(r){return FSe.has(r.id)}var bS=class{constructor(e,t,n,i,o,s,a){this.dependencyManager=e;this.configuration=t;this.kernelDependency=n;this.serverUriStorage=i;this.jupyterUriProviderRegistration=o;this.fs=s;this.interpreterService=a;this.handledErrors=new WeakSet;this.handledKernelErrors=new WeakSet}async handleError(e){var t;if(C.warn("DataScience Error",e),e=Ln.unwrap(e),!this.handledErrors.has(e)){if(this.handledErrors.add(e),e instanceof am)await((t=this.dependencyManager)==null?void 0:t.installMissingDependencies(e));else if(e instanceof Os)await dR(this.configuration,e.message);else if(e instanceof CA)await pR(this.configuration,e.message);else if(!Yn(e))if(e instanceof IA||e instanceof SA)Or.window.showErrorMessage(e.message).then(E,E);else if(e instanceof hS||e instanceof gS||e instanceof hP||e instanceof Mp)Or.window.showErrorMessage(yS(e)).then(E,E);else if(e instanceof io&&zr())Or.window.showErrorMessage(W.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl)).then(E,E);else if(e instanceof io){let n=await this.handleJupyterServerConnectionError(e,void 0);Or.window.showErrorMessage(n).then(E,E)}else if(e instanceof zf){let n=await this.handleJupyterServerUriProviderError(e,void 0);Or.window.showErrorMessage(n).then(E,E)}else{let n=zX(e.message||e.toString());Or.window.showErrorMessage(n).then(E,E)}}}async getErrorMessageForDisplayInCell(e,t,n){return this.getErrorMessageForDisplayInCellImpl(e,t,n,!1)}async getErrorMessageForDisplayInCellOutput(e,t,n){return this.getErrorMessageForDisplayInCellImpl(e,t,n,!0)}async getErrorMessageForDisplayInCellImpl(e,t,n,i){var o;if(e=Ln.unwrap(e),Yn(e)||C.error("Error in execution (get message for cell)",e),e instanceof Ul)return"";if(e instanceof mP){let s=this.interpreterService?await this.interpreterService.hasWorkspaceSpecificEnvironment():!1;return $j(e.kernelConnectionMetadata,!s&&!zr()&&i)||e.message}else{if(e instanceof am)return VSe(e)||e.message;if(e instanceof io&&!zr())return e.message;if(e instanceof io&&zr())return W.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl);if(Yn(e))return"";if(e instanceof wA){let s=typeof e.product=="string"?e.product:_i.get(e.product)||`${e.product}`,a=Fu(e.interpreter)||e.interpreter.id||"",l=Bi(e.interpreter),u=Ee(l==null?void 0:l.executable.uri),c=a?` ${a} (${u})`:u;return W.packageNotInstalledWindowsLongPathNotEnabledError(s,c)}else{if((e instanceof hS||e instanceof gS)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&!await this.fs.exists(e.kernelConnectionMetadata.interpreter.uri))return W.failedToStartKernelDueToMissingPythonEnv(Fu(e.kernelConnectionMetadata.interpreter)||Ss(e.kernelConnectionMetadata.interpreter)||Ee(e.kernelConnectionMetadata.interpreter.uri));if((e instanceof hS||e instanceof gS)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(e.kernelConnectionMetadata,void 0,!0)){let s=this.interpreterService?await this.interpreterService.hasWorkspaceSpecificEnvironment():!1;return $j(e.kernelConnectionMetadata,!s&&!zr()&&i)||e.message}else if(e instanceof Ii||e instanceof ru){let[s,a]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(n),uK(e.kernelConnectionMetadata.interpreter)]),l=Bm(Or.workspace.workspaceFolders||[],e,ut(e.kernelConnectionMetadata),a,s.map(u=>u.uri));if(l){if(l.reason==="moduleNotFound"&&["ipykernel_launcher","ipykernel"].includes(l.moduleName)){let c=this.interpreterService?await this.interpreterService.hasWorkspaceSpecificEnvironment():!1;return $j(e.kernelConnectionMetadata,!c&&!zr()&&i)||e.message}let u=[l.message];return l.moreInfoLink&&u.push(Ue.clickHereForMoreInfoWithHtml(l.moreInfoLink)),Qt(e.kernelConnectionMetadata)&&l.reason==="moduleNotFound"&&!["ipykernel_launcher","ipykernel"].includes(l.moduleName)&&await this.addErrorMessageIfPythonArePossiblyOverridingPythonModules(u,n),u.join(`
`)}}else{if(e instanceof io)return this.handleJupyterServerConnectionError(e,t);if(e instanceof zf)return this.handleJupyterServerUriProviderError(e,t);if(e instanceof lm){let s=((o=Or.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:o.packageJSON.displayName)||e.serverProviderHandle.extensionId;return yS(W.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(s),t)}}}}return yS(e,t)}async handleJupyterServerUriProviderError(e,t){var o;let n=await vS(e.serverProviderHandle,this.jupyterUriProviderRegistration),i=((o=e.originalError)==null?void 0:o.message)||e.message;return yS(W.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerConnectionError(e,t){let n=await vS(e.serverProviderHandle,this.jupyterUriProviderRegistration,e.baseUrl),i=e.originalError.message||"";return yS(W.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerProviderConnectionError(e,t){let n=new Or.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i&&(i.find(o=>o.id===e.handle)||await this.serverUriStorage.remove(e).catch(E)),!0}catch(i){return!1}finally{n.dispose()}}async handleKernelError(e,t,n,i,o){var s,a;if(Yn(e)||C.warn(`Kernel Error, context = ${t}`,e),e=Ln.unwrap(e),Yn(e))return this.sendKernelTelemetry(e,t,i,"cancelled"),1;if(e instanceof mP)if(C.warn(`Jupyter Kernel Dependency Error, reason=${e.reason}`,e),this.sendKernelTelemetry(e,t,i,e.category),e.reason===4&&this.kernelDependency){let l=new Or.CancellationTokenSource;try{let u=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new pr(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:u})}finally{l.dispose()}}else return e.reason;else{if((t==="start"||t==="restart")&&e instanceof am)return this.sendKernelTelemetry(e,t,i,e.category),(this.dependencyManager?await this.dependencyManager.installMissingDependencies(e):2)===0?0:1;if(e instanceof io||e instanceof zf||e instanceof lm){this.sendKernelTelemetry(e,t,i,e.category);let l=e instanceof lm?"":e instanceof io?e.originalError.message||"":((s=e.originalError)==null?void 0:s.message)||e.message,u=e.serverProviderHandle.extensionId,c=e.serverProviderHandle.id,d=this.jupyterUriProviderRegistration.jupyterCollections.find(k=>k.extensionId===u&&k.id==c);if(!d||await this.handleJupyterServerProviderConnectionError(e.serverProviderHandle,d))return 3;let f=e instanceof io?e.baseUrl:"",m=vS(e.serverProviderHandle,this.jupyterUriProviderRegistration,f),g=e instanceof lm?((a=Or.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:a.packageJSON.displayName)||e.serverProviderHandle.extensionId:"",b=o==="jupyterExtension"?[W.selectDifferentKernel]:[];switch(await Or.window.showErrorMessage(e instanceof lm?W.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(g):W.remoteJupyterConnectionFailedWithServer(m),{detail:l,modal:!0},W.removeRemoteJupyterConnectionButtonText,W.changeRemoteJupyterConnectionButtonText,...b)){case W.removeRemoteJupyterConnectionButtonText:return await this.serverUriStorage.remove(e.serverProviderHandle).catch(E),1;case W.changeRemoteJupyterConnectionButtonText:return 1;case W.selectDifferentKernel:return 3}return 1}else if(e instanceof Os){this.sendKernelTelemetry(e,t,i,e.category);let l=W.jupyterSelfCertEnable,u=W.jupyterSelfCertClose;return Or.window.showErrorMessage(W.jupyterSelfCertFail(e.message),l,u).then(c=>{c===l?(ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),this.configuration.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,Or.ConfigurationTarget.Workspace).catch(E)):c===u&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE")}).then(E,E),2}else{if((t==="start"||t==="restart")&&n.kind==="startUsingPythonInterpreter"&&this.interpreterService&&!await this.fs.exists(n.interpreter.uri))return this.sendKernelTelemetry(e,t,i,"pythonEnvironmentMissing"),Or.window.showErrorMessage(W.failedToStartKernelDueToMissingPythonEnv(Fu(n.interpreter)||Ss(n.interpreter)||Ee(n.interpreter.uri))).then(E,E),this.interpreterService.refreshInterpreters(!0).catch(E),2;if((t==="start"||t==="restart")&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(n,void 0,!0)){this.sendKernelTelemetry(e,t,i,"noipykernel");let l=new Or.CancellationTokenSource;try{let u=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new pr(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:u})}finally{l.dispose()}}else{let[l,u]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(i),uK(n.interpreter)]),c=Bm(Or.workspace.workspaceFolders||[],e,ut(n),u,l.map(d=>d.uri));return this.sendKernelTelemetry(e,t,i,c==null?void 0:c.reason),c?this.showMessageWithMoreInfo(c.message,c==null?void 0:c.moreInfoLink).catch(E):this.showMessageWithMoreInfo(yS(e,t)).catch(E),2}}}}sendKernelTelemetry(e,t,n,i){this.handledKernelErrors.has(e)||(this.handledKernelErrors.add(e),t==="start"&&Rr(n,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:!1,failureCategory:i},e))}async showMessageWithMoreInfo(e,t){e.includes(le.ViewJupyterOutput)||(e=`${e} 
${W.viewJupyterLogForFurtherInfo}`);let n=t?[Ue.learnMore]:[];await Or.window.showErrorMessage(e,...n).then(i=>{i===Ue.learnMore&&t&&Or.env.openExternal(Or.Uri.parse(t))})}};bS=U([x(0,(0,Da.inject)(DQ)),x(0,(0,Da.optional)()),x(1,(0,Da.inject)(Ke)),x(2,(0,Da.inject)(wI)),x(2,(0,Da.optional)()),x(3,(0,Da.inject)(dr)),x(4,(0,Da.inject)(sr)),x(5,(0,Da.inject)(Pt)),x(6,(0,Da.inject)(cm)),x(6,(0,Da.optional)())],bS);var USe={restart:W.failedToRestartKernel,start:W.failedToStartKernel,interrupt:W.failedToInterruptKernel,execution:""};function yS(r,e){r=typeof r=="string"?r:Ln.unwrap(r);let t=e?USe[e]:"",n="";return r instanceof hP?n=W.jupyterNotebookNotInstalledOrNotFound(r.interpreter):r instanceof ot?n=f8(r.stdErr)||r.stdErr||r.message:n=typeof r=="string"?r:r.message,zX(t,n)}function WSe(r){var t,n;return((n=(t=new RegExp(/\[([^\[]+)\]\((.*)\)/).exec(r))==null?void 0:t.length)!=null?n:0)>0}function zX(r="",e=""){r&&e.startsWith(r.substring(0,r.length-1))&&(r="");let t=[r,e].map(n=>n.trim()).filter(n=>n.length>0).join(` 
`);return!WSe(t)&&t.length&&t.indexOf("command:jupyter.viewOutput")===-1?`${t.endsWith(".")?t:t+"."} 
${W.viewJupyterLogForFurtherInfo}`:t}function $j(r,e){var a,l,u,c;if(r.kind==="connectToLiveRemoteKernel"||r.kind==="startUsingRemoteKernelSpec"||!r.interpreter)return;let t=Fu(r.interpreter)||ct(r.interpreter.uri),n=_i.get(19),i=Yj(19),o=`${bL(ct(r.interpreter.uri))} -m pip install ${i} -U --force-reinstall`;if(r.interpreter&&_r(r.interpreter)==="Conda"){let d=Bi(r.interpreter);(a=d==null?void 0:d.environment)!=null&&a.name?o=`conda install -n ${(l=d==null?void 0:d.environment)==null?void 0:l.name} ${i} --update-deps --force-reinstall`:(u=d==null?void 0:d.environment)!=null&&u.folderUri&&(o=`conda install -p ${ct((c=d==null?void 0:d.environment)==null?void 0:c.folderUri)} ${i} --update-deps --force-reinstall`)}else r.interpreter&&_r(r.interpreter)==="Unknown"&&(o=`${bL(ct(r.interpreter.uri))} -m pip install ${i} -U --user --force-reinstall`);let s=[W.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter(t,_i.get(19))];return e?YX(r.interpreter)?s.push(W.createANewPythonEnvironment()):(s.push(W.createANewPythonEnvironment()),s.push(W.OrInstallPackageInstructions(n,o))):s.push(W.installPackageInstructions(n,o)),s.join(`
`)}function VSe(r){let e=`${_i.get(18)} ${Ue.and} ${_i.get(20)}`,t=[18,20].map(Yj).join(" "),n=`python -m pip install ${t} -U
or
conda install ${t} -U`,i=W.installPackageInstructions(e,n);return r.message+`
`+i+`
`+Ue.clickHereForMoreInfoWithHtml("https://aka.ms/installJupyterForVSCode")}var IS=class extends bS{async addErrorMessageIfPythonArePossiblyOverridingPythonModules(e,t){}async getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(e){return[]}};IS=U([(0,QX.injectable)()],IS);p();var XX=oe(he());var Qg=class{async ensureKernelIsUsable(e,t,n,i,o){C.debug("Check if a kernel is usable")}};U([x(1,mK("id")),x(2,mK("disableUI")),x(3,Y7())],Qg.prototype,"ensureKernelIsUsable",1),Qg=U([(0,XX.injectable)()],Qg);p();var gP=oe(he());var ZX=require("vscode");var SS=class{constructor(e,t){this.liveKernelConnectionTracker=e;this.providerRegistration=t}async isValid(e){if(!this.liveKernelConnectionTracker.wasKernelUsed(e))return!1;let t=await this.providerRegistration.jupyterCollections.find(i=>i.extensionId===e.serverProviderHandle.extensionId&&i.id===e.serverProviderHandle.id);if(!t)return C.warn(`Extension ${e.serverProviderHandle.extensionId} may have been uninstalled for provider ${e.serverProviderHandle.id}, handle ${e.serverProviderHandle.handle}`),!1;let n=new ZX.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i?i.map(o=>o.id).includes(e.serverProviderHandle.handle)?!0:(C.warn(`Hiding remote kernel ${e.id} for ${t.id} as the remote Jupyter Server ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}:${e.serverProviderHandle.handle} is no longer available`),!1):!1}catch(i){return C.warn(`Failed to fetch remote servers from ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}`,i),!1}finally{n.dispose()}}};SS=U([(0,gP.injectable)(),x(0,(0,gP.inject)(Gg)),x(1,(0,gP.inject)(sr))],SS);p();var eZ=oe(he());var _S=class{async getOrStartServer(e){throw new Error("Invalid Operation in Web")}};_S=U([(0,eZ.injectable)()],_S);p();var fu=require("vscode"),Xg=oe(he());var ES=class extends Pr{constructor(t,n){super();this._onDidLoad=this._register(new fu.EventEmitter);this._onDidChangeUri=this._register(new fu.EventEmitter);this._onDidRemoveUris=this._register(new fu.EventEmitter);this._onDidAddUri=this._register(new fu.EventEmitter);this._all=[];n.push(this),this.newStorage=this._register(new zj(t))}get onDidLoad(){return this._onDidLoad.event}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}get all(){return this.updateStore(),this._all}hookupStorageEvents(){this.storageEventsHooked||(this.storageEventsHooked=!0,this._register(this.newStorage.onDidAdd(t=>this._onDidAddUri.fire(t),this)),this._register(this.newStorage.onDidChange(t=>this._onDidChangeUri.fire(t),this)),this._register(this.newStorage.onDidRemove(t=>this._onDidRemoveUris.fire(t),this)))}updateStore(){this.hookupStorageEvents();let t=this._all;return this._all=this.newStorage.getAll(),(t.length!==this._all.length||JSON.stringify(this._all)!==JSON.stringify(t))&&this._onDidLoad.fire(),this._all}async clear(){this.hookupStorageEvents(),await this.newStorage.clear(),this._all=[],this._onDidLoad.fire()}async add(t,n){var o;this.hookupStorageEvents(),C.ci(`setUri: ${t.id}.${t.handle}`);let i={time:(o=n==null?void 0:n.time)!=null?o:Date.now(),displayName:"",provider:t};await this.newStorage.add(i),this.updateStore()}async update(t){this.hookupStorageEvents(),await this.newStorage.update(t),this.updateStore()}async remove(t){this.hookupStorageEvents(),await this.newStorage.remove(t),this.updateStore()}};ES=U([(0,Xg.injectable)(),x(0,(0,Xg.inject)(Et)),x(0,(0,Xg.named)(rr)),x(1,(0,Xg.inject)(ve))],ES);var zj=class{constructor(e){this.memento=e;this._onDidChangeUri=new fu.EventEmitter;this._onDidRemoveUris=new fu.EventEmitter;this._onDidAddUri=new fu.EventEmitter;this.updatePromise=Promise.resolve();this.mementoKey=`MEMENTO_KEY_FOR_STORING_USED_JUPYTER_PROVIDERS_${fu.env.machineId}`}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}dispose(){this._onDidAddUri.dispose(),this._onDidChangeUri.dispose(),this._onDidRemoveUris.dispose()}async add(e){return this.updatePromise=this.updatePromise.then(async()=>{let t=this.getAll(),n=t.find(a=>Vt(a.provider)===Vt(e.provider)),o=[{displayName:e.displayName||(n==null?void 0:n.displayName)||Vt(e.provider),serverHandle:e.provider,time:e.time}].concat(t.sort((a,l)=>l.time-a.time).filter(a=>Vt(a.provider)!==Vt(e.provider)).map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}))),s=o.splice(li.JupyterServerUriListMax);if(await this.memento.update(this.mementoKey,o),n||this._onDidAddUri.fire(e),s.length){let a=s.map(l=>({provider:l.serverHandle,time:l.time,displayName:l.displayName||""}));this._onDidRemoveUris.fire(a.map(l=>l.provider))}this._onDidChangeUri.fire()}).catch(E)}async update(e){let n=this.getAll().find(o=>o.provider.id===e.id&&o.provider.handle===e.handle),i={provider:e,time:Date.now(),displayName:(n==null?void 0:n.displayName)||""};await this.add(i)}async remove(e){await(this.updatePromise=this.updatePromise.then(async()=>{let t=!1;try{let n=this.getAll();if(n.length===0)return;let i=n.filter(s=>s.provider.id!==e.id||s.provider.handle!==e.handle),o=n.filter(s=>s.provider.id===e.id&&s.provider.handle===e.handle);if(i.length===0)await this.clear();else if(o.length){let s=i.map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}));t=!0,await this.memento.update(this.mementoKey,s),this._onDidRemoveUris.fire(o.map(a=>a.provider))}}finally{t||this._onDidRemoveUris.fire([e])}}).catch(t=>C.error(`Failed to remove Server handle ${JSON.stringify(e)}`,t)))}getAll(){let e=this.memento.get(this.mementoKey,[]),t=[];return e.forEach(async n=>{let i=Vt(n.serverHandle),o={time:n.time,displayName:n.displayName||i,provider:n.serverHandle};t.push(o)}),t}async clear(){let e=this.getAll();await this.memento.update(this.mementoKey,[]),e.length&&this._onDidRemoveUris.fire(e.map(t=>t.provider))}};p();var um=oe(he());var PA="removeKernelUrisAndSessionsUsedByResources",CS=class{constructor(e,t,n){this.disposables=e;this.uriStorage=t;this.memento=n;this.usedRemoteKernelServerIdsAndSessions={}}activate(){this.usedRemoteKernelServerIdsAndSessions=this.memento.get(PA,{}),this.uriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}wasKernelUsed(e){let t=Vt(e.serverProviderHandle);return t in this.usedRemoteKernelServerIdsAndSessions&&typeof e.kernelModel.id=="string"&&e.kernelModel.id in this.usedRemoteKernelServerIdsAndSessions[t]}trackKernelIdAsUsed(e,t,n){let i=Vt(t);this.usedRemoteKernelServerIdsAndSessions[i]=this.usedRemoteKernelServerIdsAndSessions[i]||{},this.usedRemoteKernelServerIdsAndSessions[i][n]=this.usedRemoteKernelServerIdsAndSessions[i][n]||[];let o=this.usedRemoteKernelServerIdsAndSessions[i][n];o.includes(e.toString())||(o.push(e.toString()),this.memento.update(PA,this.usedRemoteKernelServerIdsAndSessions).then(E,E))}trackKernelIdAsNotUsed(e,t,n){let i=Vt(t);if(!(i in this.usedRemoteKernelServerIdsAndSessions)||!(n in this.usedRemoteKernelServerIdsAndSessions[i]))return;let o=this.usedRemoteKernelServerIdsAndSessions[i][n];!Array.isArray(o)||!o.includes(e.toString())||(o.splice(o.indexOf(e.toString()),1),o.length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i][n],Object.keys(this.usedRemoteKernelServerIdsAndSessions[i]).length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i],this.memento.update(PA,this.usedRemoteKernelServerIdsAndSessions).then(E,E))}onDidRemoveServers(e){e.forEach(t=>{let n=Vt(t);delete this.usedRemoteKernelServerIdsAndSessions[n],this.memento.update(PA,this.usedRemoteKernelServerIdsAndSessions).then(E,E)})}};CS=U([(0,um.injectable)(),x(0,(0,um.inject)(ve)),x(1,(0,um.inject)(dr)),x(2,(0,um.inject)(Et)),x(2,(0,um.named)(rr))],CS);p();var iZ=oe(he()),oZ=oe(rZ());p();var nZ=require("vscode");function Qj(r){return class extends r{constructor(...n){super(...n);this._onAnyMessage=new nZ.EventEmitter;this.onAnyMessage=this._onAnyMessage.event;this.msgChain=Promise.resolve(),this.sendChain=Promise.resolve(),this.receiveHooks=[],this.sendHooks=[]}patchSuperEmit(n){super.emit=n}send(n,i){this.sendHooks?this.sendChain=this.sendChain.then(()=>Promise.all(this.sendHooks.map(o=>o(n,i)))).then(()=>super.send(n,i)):super.send(n,i)}handleEvent(n,i,...o){return i==="message"&&this.receiveHooks.length?(this.msgChain=this.msgChain.then(()=>Promise.all(this.receiveHooks.map(s=>s(o[0])))).then(()=>n(i,...o)).catch(s=>C.error(`Exception while handling messages: ${s}`)),!0):n(i,...o)}emit(n,...i){if(n==="unexpected-response"&&i.length===2){let o=i[1];C.error(`Error in websocket: (${o==null?void 0:o.statusCode}) ${o==null?void 0:o.statusMessage}, ${o==null?void 0:o.path}, Headers = ${JSON.stringify(o==null?void 0:o.headers)}`)}return n==="error"&&C.error("Error in websocket",i.length?i[0]:void 0),this.handleEvent((o,...s)=>super.emit(o,...s),n,...i)}addReceiveHook(n){this.receiveHooks.push(n)}removeReceiveHook(n){this.receiveHooks=this.receiveHooks.filter(i=>i!==n)}addSendHook(n){this.sendHooks.push(n)}removeSendHook(n){this.sendHooks=this.sendHooks.filter(i=>i!==n)}}}p();var Oo=new Map;var xS=class{getRequestCtor(e,t,n){class i extends Request{constructor(s,a){super(s,a);let l=this.headers;if(n){let u=n();Object.keys(u).forEach(f=>l.append(f,u[f].toString())),l.set("Content-Type","application/json");let d=l.append.bind(l);l.append=(f,m)=>{f.toLowerCase()!=="authorization"&&d(f,m)}}e&&this.headers.append("Cookie",e)}}return i}wrapWebSocketCtor(e){class t extends Qj(e){constructor(o,s){super(o,s);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let a,l=/.*\/kernels\/(.*)\/.*/.exec(o);l&&l.length>1&&(this.kernelId=l[1]),this.kernelId?(Oo.set(this.kernelId,this),this.onclose=()=>{a&&this.timer!==a&&clearInterval(a),Oo.get(this.kernelId)===this&&Oo.delete(this.kernelId)}):C.error("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener&&this.addEventListener("open",this.boundOpenHandler)}openHandler(){let o=this.onmessage;this.onmessage=s=>{this.handleEvent((a,...l)=>{let u={data:l[0],type:a.toString(),target:this};return o(u),!0},"message",s.data)},this.removeEventListener("open",this.boundOpenHandler)}}return t}getWebsocketCtor(e,t,n){class i extends Qj(oZ.default){constructor(a,l){super(a,l);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let u,c=/.*\/kernels\/(.*)\/.*/.exec(a);c&&c.length>1&&(this.kernelId=c[1]),this.kernelId?(Oo.set(this.kernelId,this),this.onclose=()=>{u&&this.timer!==u&&clearInterval(u),Oo.get(this.kernelId)===this&&Oo.delete(this.kernelId)}):C.error("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener("open",this.boundOpenHandler)}openHandler(){let a=this.onmessage;this.onmessage=l=>{this.handleEvent((u,...c)=>{let d={data:c[0],type:u.toString(),target:this};return a(d),!0},"message",l.data)},this.removeEventListener("open",this.boundOpenHandler)}}return i}getFetchMethod(){return fetch}getHeadersCtor(){return Headers}getRequestInit(){return{cache:"no-store"}}};xS=U([(0,iZ.injectable)()],xS);p();var Ws=oe(he());p();var Us=require("vscode");p();var jSe=["/bin/sh","/bin/bash","/bin/zsh"];function sZ(r,e){let t=(r.argv||[]).some(n=>(n=n.toLowerCase(),jSe.some(i=>n.includes(i))));ne("DATASCIENCE.KERNEL_SPEC_LANGUAGE",void 0,{language:r.language,kind:e,usesShell:t})}p();p();var PS="remoteKernelSpecCache.json";var BSe=2e3,TA=class extends ac{constructor(t,n,i,o,s,a,l,u,c,d){super();this.id=t;this.displayName=n;this.env=i;this.cachedRemoteKernelValidator=o;this.kernelProvider=a;this.serverProviderHandle=l;this.jupyterConnection=u;this.fs=c;this.context=d;this._status="idle";this._onDidChangeStatus=new Us.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.promiseMonitor=new eI;this.kernelIdsToHide=new Set;this.kind="remote";this.cache=[];this._onDidChangeKernels=new Us.EventEmitter;this.onDidChangeKernels=this._onDidChangeKernels.event;this._onDidChange=new Us.EventEmitter;this.onDidChange=this._onDidChange.event;this.cacheFile=Us.Uri.joinPath(d.globalStorageUri,PS),this.cacheKey=Vt(l),this._register(s.registerKernelFinder(this)),this._register(this._onDidChangeKernels.event(()=>this._onDidChange.fire(),this)),this._register(this._onDidChangeKernels),this._register(this._onDidChange),this._register(this._onDidChangeStatus),this._register(this.promiseMonitor)}get status(){return this._status}set status(t){this._status!==t&&(this._status=t,this._onDidChangeStatus.fire())}get lastError(){return this._lastError}get kernels(){return this.cache}get items(){return this.kernels}get title(){return this.displayName}dispose(){var t,n;super.dispose(),(t=this._cacheUpdateCancelTokenSource)==null||t.dispose(),(n=this.kernelDisposeDelayTimer)==null||n.dispose()}async activate(){this.promiseMonitor.onStateChange(()=>{this.status=this.promiseMonitor.isComplete?"idle":"discovering"}),this.loadCache().then(E,E),this._register(this.kernelProvider.onDidStartKernel(t=>{Wt(t.kernelConnectionMetadata)&&this.updateCache().then(E,E)},this)),this._register(this.kernelProvider.onDidDisposeKernel(t=>{var n;if(t&&Wt(t.kernelConnectionMetadata)){(n=this.kernelDisposeDelayTimer)==null||n.dispose();let i=setTimeout(()=>{this.updateCache().then(E,E)},BSe);return this.kernelDisposeDelayTimer=new Us.Disposable(()=>clearTimeout(i)),i}},this))}async refresh(){await this.loadCache(!0,!0)}getListOfKernelsWithCachedConnection(t,n=!1){return(!this.cachedConnection||n)&&(this.cachedConnection=this.getRemoteConnectionInfo(t)),this.cachedConnection.then(i=>i?(this.cachedConnection=Promise.resolve(i),this.listKernelsFromConnection(i)):Promise.resolve([])).catch(i=>this.isDisposed?Promise.reject(i):n?(this.cachedConnection=void 0,Promise.reject(i)):this.getListOfKernelsWithCachedConnection(t,!0))}async loadCache(t=!1,n=!1){C.ci(`Remote Kernel Finder load cache Server: ${this.id}`);let i=(async()=>{let o=t?[]:await this.getFromCache(),s=[];if(!t&&Array.isArray(o)&&o.length>0)s=o,this.updateCache().then(E,E),this.loadCache(!0).then(E,E);else try{s=await this.getListOfKernelsWithCachedConnection(n),this._lastError=void 0}catch(a){a instanceof Us.CancellationError||(C.error("UniversalRemoteKernelFinder: Failed to get kernels without cache",a),this._lastError=a,this._onDidChange.fire())}await this.writeToCache(s)})();this.promiseMonitor.push(i),await i}async updateCache(){let t=(async()=>{var o;let n=[];(o=this._cacheUpdateCancelTokenSource)==null||o.dispose();let i=new Us.CancellationTokenSource;this._cacheUpdateCancelTokenSource=i;try{n=await this.getListOfKernelsWithCachedConnection(!1)}catch(s){C.warn(`Could not fetch kernels from the ${this.kind} server, falling back to cache: ${s}`),n=await this.getFromCache(i.token),n=n.filter(a=>a.kind==="connectToLiveRemoteKernel")}i.token.isCancellationRequested||await this.writeToCache(n)})();this.promiseMonitor.push(t),await t}async getRemoteConnectionInfo(t=!0){let n=[];return t&&n.push(Kt.createProgressReporter(void 0,W.connectingToJupyter)),this.jupyterConnection.createConnectionInfo(this.serverProviderHandle).finally(()=>Ce(n))}async getFromCache(t){try{if(t!=null&&t.isCancellationRequested)throw new Us.CancellationError;let n=this.cache;(!n||n.length===0)&&(n=await this.getCacheContents());let i=[],o=Promise.all(n.map(async s=>{await this.isValidCachedKernel(s)&&i.push(s)}));return await Ls(t,o),i}catch(n){C.error("UniversalRemoteKernelFinder: Failed to get from cache",n)}return[]}async getCacheContents(){try{let t=await this.fs.readFile(this.cacheFile),n=JSON.parse(t);if(n.extensionVersion!==this.env.extensionVersion)return[];let i=n.data[this.cacheKey]||[];return Array.isArray(i)?i.map(o=>Zc.fromJSON(o)):[]}catch(t){return[]}}async listKernelsFromConnection(t){let n=[];try{let i=Qf.create(t.settings);n.push({dispose:()=>Lg(i)});let[o,s,a,l]=await Promise.all([i.getRunningKernels(),i.getKernelSpecs(),i.getRunningSessions(),Hz(t.serverProviderHandle)]),u=s.map(f=>(sZ(f,"remote"),Yx.create({kernelSpec:f,id:SR(f,void 0,l),baseUrl:t.baseUrl,serverProviderHandle:t.serverProviderHandle})));return[...a.map(f=>{var P,D;let m=f.kernel,g=m.last_activity?new Date(Date.parse(m.last_activity.toString())):new Date,b=m.connections?parseInt(m.connections.toString(),10):0,v=o.find(K=>{var L;return K.id===((L=f.kernel)==null?void 0:L.id)})||{},k=s.find(K=>{var L;return K.name===((L=f.kernel)==null?void 0:L.name)})||{};return Gx.create({kernelModel:{...f.kernel,...k,...v,name:((P=f.kernel)==null?void 0:P.name)||"",lastActivityTime:g,numberOfConnections:b,model:f},baseUrl:t.baseUrl,id:((D=f.kernel)==null?void 0:D.id)||"",serverProviderHandle:t.serverProviderHandle})}).filter(f=>!this.kernelIdsToHide.has(f.kernelModel.id||"")),...u]}catch(i){throw C.error(`Error fetching kernels from ${t.baseUrl} (${t.displayName}):`,i),i}finally{await Promise.all(n.map(i=>i.dispose().catch(E)))}}async writeToCache(t){try{C.trace(`UniversalRemoteKernelFinder: Writing ${t.length} remote kernel connection metadata to cache`);let n=this.cache,i=new Map(n.map(f=>[f.id,f])),o=new Map(t.map(f=>[f.id,f])),s=t.filter(f=>!i.has(f.id)),a=t.filter(f=>i.has(f.id)&&!wB(f,i.get(f.id))),l=n.filter(f=>!o.has(f.id)),u=this.cacheKey;this.cache=n.filter(f=>o.has(f.id)).concat(s),this.cache.forEach(f=>{let m=o.get(f.id);f!==m&&m.kind==="connectToLiveRemoteKernel"&&f.kind==="connectToLiveRemoteKernel"&&f.updateModel(m.kernelModel)});let c=t.map(f=>f.toJSON()),d={extensionVersion:this.env.extensionVersion,data:{}};try{let f=await this.fs.readFile(this.cacheFile),m=JSON.parse(f);m.extensionVersion===this.env.extensionVersion&&(d=m)}catch(f){}d.data[u]=c,await this.fs.createDirectory(this.context.globalStorageUri).then(()=>this.fs.writeFile(this.cacheFile,JSON.stringify(d))).catch(f=>{C.error("Failed to cache the remote kernels.",f)}),(s.length||a.length||l.length)&&this._onDidChangeKernels.fire({removed:l})}catch(n){C.error("UniversalRemoteKernelFinder: Failed to write to cache",n)}}async isValidCachedKernel(t){switch(t.kind){case"startUsingRemoteKernelSpec":return!1;case"connectToLiveRemoteKernel":return this.cachedRemoteKernelValidator.isValid(t)}}};var kA=require("vscode");var Jd=class{constructor(e,t,n,i,o,s,a,l,u,c){this.serverUriStorage=e;this.env=t;this.cachedRemoteKernelValidator=n;this.kernelFinder=i;this.kernelProvider=o;this.jupyterConnection=s;this.disposables=a;this.fs=l;this.context=u;this.jupyterServerProviderRegistry=c;this.serverFinderMapping=new Map;this.handledProviders=new WeakSet;this.mappedProviders=new WeakSet;this.mappedServers=new Set}activate(){this.serverUriStorage.onDidAdd(e=>this.validateAndCreateFinder(e),this,this.disposables),this.serverUriStorage.onDidChange(this.buildListOfFinders,this,this.disposables),this.serverUriStorage.onDidLoad(this.handleProviderChanges,this,this.disposables),this.serverUriStorage.onDidLoad(this.buildListOfFinders,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderHandleChanges,this,this.disposables),this.serverUriStorage.onDidRemove(this.urisRemoved,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderChanges,this,this.disposables),this.buildListOfFinders(),this.handleProviderChanges().catch(E)}buildListOfFinders(){this.serverUriStorage.all.map(e=>this.validateAndCreateFinder(e).catch(E))}handleProviderHandleChanges(){this.jupyterServerProviderRegistry.jupyterCollections.forEach(e=>{this.handledProviders.has(e)||(this.handledProviders.add(e),e.serverProvider.onDidChangeServers&&e.serverProvider.onDidChangeServers(this.buildListOfFinders,this,this.disposables))}),this.buildListOfFinders()}async handleProviderChanges(){if(!this.serverUriStorage.all.length)return;let e=new kA.CancellationTokenSource;this.disposables.push(e),await Promise.all(this.jupyterServerProviderRegistry.jupyterCollections.map(t=>{let n=t.serverProvider;if(!(!n||this.mappedProviders.has(n)))return this.mappedProviders.add(n),n!=null&&n.onDidChangeServers&&(n==null||n.onDidChangeServers(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables)),this.serverUriStorage.onDidLoad(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables),this.lookForServersInCollectionAndRemoveOldServers(t).catch(E)})),e.dispose()}async lookForServersInCollectionAndRemoveOldServers(e){if(!this.serverUriStorage.all.length)return;let t=new Set(this.serverUriStorage.all.map(o=>Vt(o.provider))),n=e.serverProvider;if(!n)return;let i=new kA.CancellationTokenSource;try{let o=await Promise.resolve(n.provideJupyterServers(i.token)),s=new Set;(o||[]).forEach(a=>{let l={extensionId:e.extensionId,handle:a.id,id:e.id},u=Vt(l);s.add(u),xA(l,a.label),!(this.mappedServers.has(u)||!t.has(u))&&(this.mappedServers.add(u),this.createRemoteKernelFinder(l,a.label))}),this.serverFinderMapping.forEach((a,l)=>{a.serverProviderHandle.extensionId===e.extensionId&&a.serverProviderHandle.id===e.id&&!s.has(Vt(a.serverProviderHandle))&&(a.dispose(),this.serverFinderMapping.delete(l))})}catch(o){C.error(`Failed to get servers for Collection ${e.id} in ${e.extensionId}`,o)}finally{i.dispose()}}async validateAndCreateFinder(e){let t=Vt(e.provider);if(this.serverFinderMapping.has(t))return;let n=new kA.CancellationTokenSource,i=async()=>{var u;let s=this.jupyterServerProviderRegistry.jupyterCollections.find(c=>c.extensionId===e.provider.extensionId&&c.id===e.provider.id);if(!s||!s.serverProvider)return;let a=await Promise.resolve(s.serverProvider.provideJupyterServers(n.token)),l=(u=a==null?void 0:a.find(c=>c.id===e.provider.handle))==null?void 0:u.label;l&&this.createRemoteKernelFinder(e.provider,l)},o=async()=>{var a;let s=await((a=this.jupyterServerProviderRegistry.jupyterCollections.find(l=>l.extensionId===e.provider.extensionId&&l.extensionId===tc&&l.id===e.provider.id))==null?void 0:a.label);s&&this.createRemoteKernelFinder(e.provider,s)};await Promise.all([i().catch(E),o().catch(E)]),n.dispose()}getOrCreateRemoteKernelFinder(e,t){let n=Vt(e);if(!this.serverFinderMapping.has(n)){let i=new TA(`remote-${n}`,t,this.env,this.cachedRemoteKernelValidator,this.kernelFinder,this.kernelProvider,e,this.jupyterConnection,this.fs,this.context);this.disposables.push(i),this.serverFinderMapping.set(n,i),i.activate().then(E,E)}return this.serverFinderMapping.get(n)}createRemoteKernelFinder(e,t){this.getOrCreateRemoteKernelFinder(e,t)}urisRemoved(e){e.forEach(t=>{let n=Vt(t),i=this.serverFinderMapping.get(n);i&&i.dispose(),this.serverFinderMapping.delete(n)})}dispose(){this.serverFinderMapping.forEach(e=>e.dispose())}};U([gn("Handle Jupyter Provider Changes")],Jd.prototype,"handleProviderChanges",1),U([gn("Check Servers in Jupyter Server Provider")],Jd.prototype,"lookForServersInCollectionAndRemoveOldServers",1),U([gn("Failed to create a Remote Kernel Finder")],Jd.prototype,"validateAndCreateFinder",1),Jd=U([(0,Ws.injectable)(),x(0,(0,Ws.inject)(dr)),x(1,(0,Ws.inject)(KI)),x(2,(0,Ws.inject)(LR)),x(3,(0,Ws.inject)(ii)),x(4,(0,Ws.inject)(qe)),x(5,(0,Ws.inject)(fn)),x(6,(0,Ws.inject)(ve)),x(7,(0,Ws.inject)(Pt)),x(8,(0,Ws.inject)(st)),x(9,(0,Ws.inject)(sr))],Jd);p();var dm=oe(he());p();var WA=require("vscode");var VA=oe(Zg());var mu=oe(he());p();var NA=class extends ot{constructor(t){super("localjupyterserverconnection",W.jupyterNotebookFailure(t.message||t.toString()));this.originalError=t}};p();function fZ(r){if(hn()){let e=r;if(e&&e._futures){let t=e._futures;t.forEach&&t.forEach(n=>{n._status!==void 0&&(n._status|=4)})}e&&e._reconnectLimit&&(e._reconnectLimit=0)}}var DS=class extends Ln{constructor(e){super(e.message,e)}};p();var bP=require("vscode");p();var ev=class extends Ii{constructor(e){super("invalidkernel",W.kernelInvalid(ut(e)),e)}};p();var RA=class extends Ii{constructor(e){super("timeout",W.jupyterLaunchTimedOut,e)}};async function AA(r,e,t,n,i){var a;if(!t.kernel)throw new ev(r);let o=Kt.reportProgress(e,W.waitingForJupyterSessionToBeIdle),s=[];o&&s.push(o);try{C.trace(`Waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`);let l=Re();i.onCancellationRequested(()=>l.reject(new bP.CancellationError),void 0,s);let u=(m,g)=>{C.trace(`Got status ${g} in waitForIdleOnSession`),g=="idle"&&l.resolve(g)};(a=t.kernel.statusChanged)==null||a.connect(u),s.push(new bP.Disposable(()=>zs(()=>{var m,g;return(g=(m=t.kernel)==null?void 0:m.statusChanged)==null?void 0:g.disconnect(u)}))),t.kernel.status=="idle"&&l.resolve(t.kernel.status);let c=Re(),d=()=>c.resolve("");t.disposed.connect(d,c),s.push(new bP.Disposable(()=>zs(()=>t.disposed.disconnect(d,c)))),c.promise.catch(E),l.promise.catch(E);let f=await po(n,"",l.promise,c.promise);if(t.isDisposed)throw C.error("Session disposed while waiting for session to be idle."),new ev(r);if(C.trace(`Finished waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),f=="idle")return;throw C.error(`Shutting down after failing to wait for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),new RA(r)}catch(l){throw C.ci("Error waiting for idle",l),l}finally{Ce(s)}}p();var UA=require("vscode");p();p();p();var MA;(function(r){function e(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(y===0)return-1;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);var w;h<O?w=h+1+(y-O):w=h-O+1;for(var T=0;T<w;++T){var H=(O+T)%y;if(B[H]===N)return H}return-1}r.firstIndexOf=e;function t(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var y=B.length;if(y===0)return-1;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);var w;O<h?w=O+1+(y-h):w=O-h+1;for(var T=0;T<w;++T){var H=(O-T+y)%y;if(B[H]===N)return H}return-1}r.lastIndexOf=t;function n(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(y===0)return-1;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);var w;h<O?w=h+1+(y-O):w=h-O+1;for(var T=0;T<w;++T){var H=(O+T)%y;if(N(B[H],H))return H}return-1}r.findFirstIndex=n;function i(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var y=B.length;if(y===0)return-1;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);var w;O<h?w=O+1+(y-h):w=O-h+1;for(var T=0;T<w;++T){var H=(O-T+y)%y;if(N(B[H],H))return H}return-1}r.findLastIndex=i;function o(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=n(B,N,O,h);return y!==-1?B[y]:void 0}r.findFirstValue=o;function s(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var y=i(B,N,O,h);return y!==-1?B[y]:void 0}r.findLastValue=s;function a(B,N,O,h,y){h===void 0&&(h=0),y===void 0&&(y=-1);var w=B.length;if(w===0)return 0;h<0?h=Math.max(0,h+w):h=Math.min(h,w-1),y<0?y=Math.max(0,y+w):y=Math.min(y,w-1);for(var T=h,H=y-h+1;H>0;){var Y=H>>1,Z=T+Y;O(B[Z],N)<0?(T=Z+1,H-=Y+1):H=Y}return T}r.lowerBound=a;function l(B,N,O,h,y){h===void 0&&(h=0),y===void 0&&(y=-1);var w=B.length;if(w===0)return 0;h<0?h=Math.max(0,h+w):h=Math.min(h,w-1),y<0?y=Math.max(0,y+w):y=Math.min(y,w-1);for(var T=h,H=y-h+1;H>0;){var Y=H>>1,Z=T+Y;O(B[Z],N)>0?H=Y:(T=Z+1,H-=Y+1)}return T}r.upperBound=l;function u(B,N,O){if(B===N)return!0;if(B.length!==N.length)return!1;for(var h=0,y=B.length;h<y;++h)if(O?!O(B[h],N[h]):B[h]!==N[h])return!1;return!0}r.shallowEqual=u;function c(B,N){N===void 0&&(N={});var O=N.start,h=N.stop,y=N.step;if(y===void 0&&(y=1),y===0)throw new Error("Slice `step` cannot be zero.");var w=B.length;O===void 0?O=y<0?w-1:0:O<0?O=Math.max(O+w,y<0?-1:0):O>=w&&(O=y<0?w-1:w),h===void 0?h=y<0?-1:w:h<0?h=Math.max(h+w,y<0?-1:0):h>=w&&(h=y<0?w-1:w);var T;y<0&&h>=O||y>0&&O>=h?T=0:y<0?T=Math.floor((h-O+1)/y+1):T=Math.floor((h-O-1)/y+1);for(var H=[],Y=0;Y<T;++Y)H[Y]=B[O+Y*y];return H}r.slice=c;function d(B,N,O){var h=B.length;if(!(h<=1)&&(N<0?N=Math.max(0,N+h):N=Math.min(N,h-1),O<0?O=Math.max(0,O+h):O=Math.min(O,h-1),N!==O)){for(var y=B[N],w=N<O?1:-1,T=N;T!==O;T+=w)B[T]=B[T+w];B[O]=y}}r.move=d;function f(B,N,O){N===void 0&&(N=0),O===void 0&&(O=-1);var h=B.length;if(!(h<=1))for(N<0?N=Math.max(0,N+h):N=Math.min(N,h-1),O<0?O=Math.max(0,O+h):O=Math.min(O,h-1);N<O;){var y=B[N],w=B[O];B[N++]=w,B[O--]=y}}r.reverse=f;function m(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(!(y<=1)&&(O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1),!(O>=h))){var w=h-O+1;if(N>0?N=N%w:N<0&&(N=(N%w+w)%w),N!==0){var T=O+N;f(B,O,T-1),f(B,T,h),f(B,O,h)}}}r.rotate=m;function g(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(y!==0){O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);var w;h<O?w=h+1+(y-O):w=h-O+1;for(var T=0;T<w;++T)B[(O+T)%y]=N}}r.fill=g;function b(B,N,O){var h=B.length;N<0?N=Math.max(0,N+h):N=Math.min(N,h);for(var y=h;y>N;--y)B[y]=B[y-1];B[N]=O}r.insert=b;function v(B,N){var O=B.length;if(N<0&&(N+=O),!(N<0||N>=O)){for(var h=B[N],y=N+1;y<O;++y)B[y-1]=B[y];return B.length=O-1,h}}r.removeAt=v;function k(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=e(B,N,O,h);return y!==-1&&v(B,y),y}r.removeFirstOf=k;function R(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var y=t(B,N,O,h);return y!==-1&&v(B,y),y}r.removeLastOf=R;function P(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(y===0)return 0;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);for(var w=0,T=0;T<y;++T)O<=h&&T>=O&&T<=h&&B[T]===N||h<O&&(T<=h||T>=O)&&B[T]===N?w++:w>0&&(B[T-w]=B[T]);return w>0&&(B.length=y-w),w}r.removeAllOf=P;function D(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y,w=n(B,N,O,h);return w!==-1&&(y=v(B,w)),{index:w,value:y}}r.removeFirstWhere=D;function K(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var y,w=i(B,N,O,h);return w!==-1&&(y=v(B,w)),{index:w,value:y}}r.removeLastWhere=K;function L(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(y===0)return 0;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);for(var w=0,T=0;T<y;++T)O<=h&&T>=O&&T<=h&&N(B[T],T)||h<O&&(T<=h||T>=O)&&N(B[T],T)?w++:w>0&&(B[T-w]=B[T]);return w>0&&(B.length=y-w),w}r.removeAllWhere=L})(MA||(MA={}));function hZ(r){var e;return typeof r.iter=="function"?e=r.iter():e=new YSe(r),e}function OA(r,e){for(var t=0,n=hZ(r),i;(i=n.next())!==void 0;)if(e(i,t++)===!1)return}var YSe=function(){function r(e){this._index=0,this._source=e}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._source.length))return this._source[this._index++]},r}(),nut=function(){function r(e,t){t===void 0&&(t=Object.keys(e)),this._index=0,this._source=e,this._keys=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source,this._keys);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._keys.length)){var e=this._keys[this._index++];return e in this._source?e:this.next()}},r}(),iut=function(){function r(e,t){t===void 0&&(t=Object.keys(e)),this._index=0,this._source=e,this._keys=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source,this._keys);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._keys.length)){var e=this._keys[this._index++];return e in this._source?this._source[e]:this.next()}},r}(),out=function(){function r(e,t){t===void 0&&(t=Object.keys(e)),this._index=0,this._source=e,this._keys=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source,this._keys);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._keys.length)){var e=this._keys[this._index++];return e in this._source?[e,this._source[e]]:this.next()}},r}(),sut=function(){function r(e){this._fn=e}return r.prototype.iter=function(){return this},r.prototype.clone=function(){throw new Error("An `FnIterator` cannot be cloned.")},r.prototype.next=function(){return this._fn.call(void 0)},r}();var aut=function(){function r(e){this._cloned=!1,this._source=e,this._active=void 0}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source.clone());return e._active=this._active&&this._active.clone(),e._cloned=!0,this._cloned=!0,e},r.prototype.next=function(){if(this._active===void 0){var e=this._source.next();if(e===void 0)return;this._active=this._cloned?e.clone():e}var t=this._active.next();return t!==void 0?t:(this._active=void 0,this.next())},r}();var lut=function(){function r(){}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r},r.prototype.next=function(){},r}();var cut=function(){function r(e,t){this._source=e,this._index=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.clone(),this._index)},r.prototype.next=function(){var e=this._source.next();if(e!==void 0)return[this._index++,e]},r}();var uut=function(){function r(e,t){this._index=0,this._source=e,this._fn=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source.clone(),this._fn);return e._index=this._index,e},r.prototype.next=function(){for(var e=this._fn,t=this._source,n;(n=t.next())!==void 0;)if(e(n,this._index++))return n},r}();function gZ(r,e){for(var t=0,n=hZ(r),i;(i=n.next())!==void 0;)if(e(i,t++))return i}var dut=function(){function r(e,t){this._index=0,this._source=e,this._fn=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source.clone(),this._fn);return e._index=this._index,e},r.prototype.next=function(){var e=this._source.next();if(e!==void 0)return this._fn.call(void 0,e,this._index++)},r}();var put=function(){function r(e,t,n){this._index=0,this._start=e,this._stop=t,this._step=n,this._length=t9.rangeLength(e,t,n)}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._start,this._stop,this._step);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._length))return this._start+this._step*this._index++},r}(),t9;(function(r){function e(t,n,i){return i===0?1/0:t>n&&i>0||t<n&&i<0?0:Math.ceil((n-t)/i)}r.rangeLength=e})(t9||(t9={}));var fut=function(){function r(e,t){this._value=e,this._count=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._value,this._count)},r.prototype.next=function(){if(!(this._count<=0))return this._count--,this._value},r}();var mut=function(){function r(e){this._source=e,this._index=e.length-1}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index<0||this._index>=this._source.length))return this._source[this._index--]},r}();var hut=function(){function r(e,t){this._source=e,this._step=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.clone(),this._step)},r.prototype.next=function(){for(var e=this._source.next(),t=this._step-1;t>0;--t)this._source.next();return e},r}(),mZ;(function(r){function e(s,a,l){l===void 0&&(l=0);for(var u=new Array(a.length),c=0,d=l,f=a.length;c<f;++c,++d){if(d=s.indexOf(a[c],d),d===-1)return null;u[c]=d}return u}r.findIndices=e;function t(s,a,l){l===void 0&&(l=0);var u=e(s,a,l);if(!u)return null;for(var c=0,d=0,f=u.length;d<f;++d){var m=u[d]-l;c+=m*m}return{score:c,indices:u}}r.matchSumOfSquares=t;function n(s,a,l){l===void 0&&(l=0);var u=e(s,a,l);if(!u)return null;for(var c=0,d=l-1,f=0,m=u.length;f<m;++f){var g=u[f];c+=g-d-1,d=g}return{score:c,indices:u}}r.matchSumOfDeltas=n;function i(s,a,l){for(var u=[],c=0,d=0,f=a.length;c<f;){for(var m=a[c],g=a[c];++c<f&&a[c]===g+1;)g++;d<m&&u.push(s.slice(d,m)),m<g+1&&u.push(l(s.slice(m,g+1))),d=g+1}return d<s.length&&u.push(s.slice(d)),u}r.highlight=i;function o(s,a){return s<a?-1:s>a?1:0}r.cmp=o})(mZ||(mZ={}));var gut=function(){function r(e,t){this._source=e,this._count=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.clone(),this._count)},r.prototype.next=function(){if(!(this._count<=0)){var e=this._source.next();if(e!==void 0)return this._count--,e}},r}();var vut=function(){function r(e){this._source=e}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.map(function(e){return e.clone()}))},r.prototype.next=function(){for(var e=new Array(this._source.length),t=0,n=this._source.length;t<n;++t){var i=this._source[t].next();if(i===void 0)return;e[t]=i}return e},r}();p();var LA=function(){function r(e){this._pid=tv.nextPID(),this.name=e.name,this._create=e.create,this._coerce=e.coerce||null,this._compare=e.compare||null,this._changed=e.changed||null}return r.prototype.get=function(e){var t,n=tv.ensureMap(e);return this._pid in n?t=n[this._pid]:t=n[this._pid]=this._createValue(e),t},r.prototype.set=function(e,t){var n,i=tv.ensureMap(e);this._pid in i?n=i[this._pid]:n=i[this._pid]=this._createValue(e);var o=this._coerceValue(e,t);this._maybeNotify(e,n,i[this._pid]=o)},r.prototype.coerce=function(e){var t,n=tv.ensureMap(e);this._pid in n?t=n[this._pid]:t=n[this._pid]=this._createValue(e);var i=this._coerceValue(e,t);this._maybeNotify(e,t,n[this._pid]=i)},r.prototype._createValue=function(e){var t=this._create;return t(e)},r.prototype._coerceValue=function(e,t){var n=this._coerce;return n?n(e,t):t},r.prototype._compareValue=function(e,t){var n=this._compare;return n?n(e,t):e===t},r.prototype._maybeNotify=function(e,t,n){var i=this._changed;i&&!this._compareValue(t,n)&&i(e,t,n)},r}();(function(r){function e(t){tv.ownerData.delete(t)}r.clearData=e})(LA||(LA={}));var tv;(function(r){r.ownerData=new WeakMap,r.nextPID=function(){var t=0;return function(){var n=Math.random(),i=(""+n).slice(2);return"pid-"+i+"-"+t++}}();function e(t){var n=r.ownerData.get(t);return n||(n=Object.create(null),r.ownerData.set(t,n),n)}r.ensureMap=e})(tv||(tv={}));var Vs=function(){function r(e){this._blockedCount=0,this.sender=e}return r.prototype.block=function(e){this._blockedCount++;try{e()}finally{this._blockedCount--}},r.prototype.connect=function(e,t){return ps.connect(this,e,t)},r.prototype.disconnect=function(e,t){return ps.disconnect(this,e,t)},r.prototype.emit=function(e){this._blockedCount||ps.emit(this,e)},r}();(function(r){function e(u,c){var d=ps.blockedProperty;d.set(u,d.get(u)+1);try{c()}finally{d.set(u,d.get(u)-1)}}r.blockAll=e;function t(u,c){ps.disconnectBetween(u,c)}r.disconnectBetween=t;function n(u){ps.disconnectSender(u)}r.disconnectSender=n;function i(u){ps.disconnectReceiver(u)}r.disconnectReceiver=i;function o(u){ps.disconnectAll(u)}r.disconnectAll=o;function s(u){ps.disconnectAll(u)}r.clearData=s;function a(){return ps.exceptionHandler}r.getExceptionHandler=a;function l(u){var c=ps.exceptionHandler;return ps.exceptionHandler=u,c}r.setExceptionHandler=l})(Vs||(Vs={}));var ps;(function(r){r.exceptionHandler=function(R){console.error(R)};function e(R,P,D){D=D||void 0;var K=l.get(R.sender);if(K||(K=[],l.set(R.sender,K)),f(K,R,P,D))return!1;var L=D||P,B=u.get(L);B||(B=[],u.set(L,B));var N={signal:R,slot:P,thisArg:D};return K.push(N),B.push(N),!0}r.connect=e;function t(R,P,D){D=D||void 0;var K=l.get(R.sender);if(!K||K.length===0)return!1;var L=f(K,R,P,D);if(!L)return!1;var B=D||P,N=u.get(B);return L.signal=null,g(K),g(N),!0}r.disconnect=t;function n(R,P){var D=l.get(R);if(!(!D||D.length===0)){var K=u.get(P);!K||K.length===0||(OA(K,function(L){L.signal&&L.signal.sender===R&&(L.signal=null)}),g(D),g(K))}}r.disconnectBetween=n;function i(R){var P=l.get(R);!P||P.length===0||(OA(P,function(D){if(D.signal){var K=D.thisArg||D.slot;D.signal=null,g(u.get(K))}}),g(P))}r.disconnectSender=i;function o(R){var P=u.get(R);!P||P.length===0||(OA(P,function(D){if(D.signal){var K=D.signal.sender;D.signal=null,g(l.get(K))}}),g(P))}r.disconnectReceiver=o;function s(R){i(R),o(R)}r.disconnectAll=s;function a(R,P){if(!(r.blockedProperty.get(R.sender)>0)){var D=l.get(R.sender);if(!(!D||D.length===0))for(var K=0,L=D.length;K<L;++K){var B=D[K];B.signal===R&&m(B,P)}}}r.emit=a;var l=new WeakMap,u=new WeakMap,c=new Set,d=function(){var R=typeof requestAnimationFrame=="function";return R?requestAnimationFrame:setImmediate}();function f(R,P,D,K){return gZ(R,function(L){return L.signal===P&&L.slot===D&&L.thisArg===K})}function m(R,P){var D=R.signal,K=R.slot,L=R.thisArg;try{K.call(L,D.sender,P)}catch(B){r.exceptionHandler(B)}}function g(R){c.size===0&&d(b),c.add(R)}function b(){c.forEach(v),c.clear()}function v(R){MA.removeAllWhere(R,k)}function k(R){return R.signal===null}r.blockedProperty=new LA({name:"blocked",create:function(){return 0}})})(ps||(ps={}));var r9=require("vscode");var KA=class extends ac{constructor(t,n){super();this.kind=t;this.session=n;this.propertyChanged=new Vs(this);this.kernelChanged=new Vs(this);this.statusChanged=new Vs(this);this.connectionStatusChanged=new Vs(this);this.iopubMessage=new Vs(this);this.unhandledMessage=new Vs(this);this.anyMessage=new Vs(this);this.pendingInput=new Vs(this);this.disposed=new Vs(this);this.didShutdown=this._register(new r9.EventEmitter);this._onDidKernelSocketChange=this._register(new r9.EventEmitter);n.propertyChanged.connect(this.onPropertyChanged,this),n.kernelChanged.connect(this.onKernelChanged,this),n.statusChanged.connect(this.onStatusChanged,this),n.connectionStatusChanged.connect(this.onConnectionStatusChanged,this),n.iopubMessage.connect(this.onIOPubMessage,this),n.unhandledMessage.connect(this.onUnhandledMessage,this),n.pendingInput.connect(this.onPendingInput,this),n.anyMessage.connect(this.onAnyMessage,this),this._register({dispose:()=>{this.session.propertyChanged.disconnect(this.onPropertyChanged,this),this.session.kernelChanged.disconnect(this.onKernelChanged,this),this.session.statusChanged.disconnect(this.onStatusChanged,this),this.session.connectionStatusChanged.disconnect(this.onConnectionStatusChanged,this),this.session.iopubMessage.disconnect(this.onIOPubMessage,this),this.session.unhandledMessage.disconnect(this.onUnhandledMessage,this),this.session.pendingInput.disconnect(this.onPendingInput,this),this.session.anyMessage.disconnect(this.onAnyMessage,this)}})}get id(){return this.session.id}get path(){return this.session.path}get name(){return this.session.name}get type(){return this.session.type}get serverSettings(){return this.session.serverSettings}get model(){return this.session.model}get kernel(){return this.isDisposed||!this.session.kernel?null:this.session.kernel}get onDidShutdown(){return this.didShutdown.event}get kernelId(){var t,n;return((n=(t=this.session)==null?void 0:t.kernel)==null?void 0:n.id)||""}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}dispose(){this.isDisposed||(super.dispose(),this.statusChanged.emit("dead"),this.disposed.emit(),Vs.disconnectAll(this))}async restart(){var t,n,i;await((t=this.session.kernel)==null?void 0:t.restart()),this.initializeKernelSocket(),C.info(`Restarted ${(i=(n=this.session)==null?void 0:n.kernel)==null?void 0:i.id}`)}initializeKernelSocket(){var n,i,o,s,a,l;if(!this.session.kernel)throw new Error("Kernel not initialized in Session");let t={kernel:this.session.kernel,options:{clientId:this.session.kernel.clientId,id:this.session.kernel.id,model:{...this.session.kernel.model},userName:this.session.kernel.username},socket:Oo.get(this.session.kernel.id)};JSON.stringify((n=this.previousKernelSocketInformation)==null?void 0:n.kernel.model)===JSON.stringify(t.kernel.model)&&((i=this.previousKernelSocketInformation)==null?void 0:i.kernel)===t.kernel&&((o=this.previousKernelSocketInformation)==null?void 0:o.kernel.id)===t.kernel.id&&((s=this.previousKernelSocketInformation)==null?void 0:s.socket)===t.socket||(this.previousKernelSocketInformation=t,(a=this.session.kernel)==null||a.connectionStatusChanged.disconnect(this.onKernelConnectionStatusHandler,this),(l=this.session.kernel)==null||l.connectionStatusChanged.connect(this.onKernelConnectionStatusHandler,this),this._onDidKernelSocketChange.fire())}onPropertyChanged(t,n){this.propertyChanged.emit(n)}onKernelChanged(t,n){this.kernelChanged.emit(n)}onStatusChanged(t,n){this.statusChanged.emit(n);let i=this.status;C.ci(`Server Status = ${i}`)}onConnectionStatusChanged(t,n){this.connectionStatusChanged.emit(n)}onIOPubMessage(t,n){this.iopubMessage.emit(n)}onUnhandledMessage(t,n){C.warn(`Unhandled message found: ${n.header.msg_type}`),this.unhandledMessage.emit(n)}onAnyMessage(t,n){this.anyMessage.emit(n)}onPendingInput(t,n){this.pendingInput.emit(n)}setPath(t){return this.session.setPath(t)}setName(t){return this.session.setName(t)}setType(t){return this.session.setType(t)}changeKernel(t){return this.session.changeKernel(t)}onKernelConnectionStatusHandler(t,n){C.ci(`Server Kernel Status = ${n}`)}};var FA=class extends KA{constructor(t,n,i,o,s){super(Qt(i)?"localJupyter":"remoteJupyter",t);this.resource=n;this.kernelConnectionMetadata=i;this.kernelService=o;this.creator=s;this.isShuttingDown=!1;this.initializeKernelSocket()}get status(){var t,n;return this.isDisposed?"dead":(t=this.session)!=null&&t.kernel?this.session.kernel.status:(C.ci(`Kernel status not started because real session is ${this.session?"defined":"undefined"} & real kernel is ${(n=this.session)!=null&&n.kernel?"defined":"undefined"}`),"unknown")}dispose(){var t,n;(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!1).finally(()=>super.dispose())}async waitForIdle(t,n){try{await AA(this.kernelConnectionMetadata,this.resource,this.session,t,n)}catch(i){throw C.ci("Error waiting for idle",i),await this.shutdown().catch(E),i}}async restart(){let t=[],n=new UA.CancellationTokenSource;this.restartToken=n;let i=new pr(!1);t.push(i),t.push(n);try{await this.validateLocalKernelDependencies(n.token,i),await super.restart()}finally{Ce(t)}}async validateLocalKernelDependencies(t,n){var i;if(!(!((i=this.kernelConnectionMetadata)!=null&&i.interpreter)||!Qt(this.kernelConnectionMetadata)||!this.kernelService)){if(t.isCancellationRequested)throw new UA.CancellationError;await this.kernelService.ensureKernelIsUsable(this.resource,this.kernelConnectionMetadata,n,t,this.creator==="3rdPartyExtension")}}async shutdown(){var t,n;return(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!0)}async shutdownImplementation(t){var o;if(this.isDisposed||this.isShuttingDown)return;this.isShuttingDown=!0;let n=(new Error().stack||"").split(`
`).filter(s=>s.includes(Je));C.trace(`Shutdown session - current session, called from 
 ${n.map(s=>`    ${s}`).join(`
`)}`);let i=`${(o=this.session.kernel)==null?void 0:o.id}, ${this.kernelConnectionMetadata.id}`;C.debug(`shutdownSession ${i} - start`);try{if(t||this.canShutdownSession())try{C.debug(`Session can be shutdown ${this.kernelConnectionMetadata.id}`),fZ(this.session.kernel),this.session.isDisposed||await po(1e3,this.session.shutdown().catch(E))}catch(s){try{this.session.isDisposed||this.session.dispose()}catch(a){C.warn("Failures in disposing the session",a)}}finally{this.didShutdown.fire()}else C.debug(`Session cannot be shutdown ${this.kernelConnectionMetadata.id}`);try{this.session.isDisposed||this.session.dispose()}catch(s){C.warn("Failures in disposing the session",s)}super.dispose(),C.trace("Shutdown session -- complete")}catch(s){C.warn("Failures in disposing the session",s)}C.debug(`shutdownSession ${i} - shutdown complete`)}canShutdownSession(){return Qt(this.kernelConnectionMetadata)?!0:this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?!1:this.resource&&Al(this.resource)==="interactive"?!0:!(this.resource&&Al(this.resource)==="notebook"&&Wt(this.kernelConnectionMetadata))}};var Gd=class{constructor(e,t,n,i,o){this.jupyterNotebookProvider=e;this.jupyterConnection=t;this.asyncDisposables=n;this.kernelService=i;this.configService=o}async create(e){let t=[],n,i=()=>{e.ui.disableUI||n||(n=Kt.createProgressReporter(e.resource,Wt(e.kernelConnection)?W.connectingToJupyter:W.startingJupyter),t.push(n))};e.ui.disableUI&&e.ui.onDidChangeDisableUI(i,this,t),i();let o,s=[],a=this.configService.getSettings(e.resource).jupyterLaunchTimeout;try{o=Wt(e.kernelConnection)?await us(e.token,this.jupyterConnection.createConnectionInfo(e.kernelConnection.serverProviderHandle)):await this.jupyterNotebookProvider.getOrStartServer({resource:e.resource,token:e.token,ui:e.ui}),await us(e.token,this.validateLocalKernelDependencies(e));let l=Qf.create(o.settings);this.asyncDisposables.push({dispose:()=>Lg(l)}),s.push(l),await us(e.token,this.validateRemoteServer(e,l));let u=await this.connectToOrCreateSession({...e,contentsManager:l.contentsManager,sessionManager:l.sessionManager,kernelManager:l.kernelManager,kernelSpecManager:l.kernelSpecManager,idleTimeout:a,connection:o});e.token.isCancellationRequested&&(await u.shutdown().catch(E),zs(()=>u.dispose())),Fd.throwIfCanceled(e.token),C.info(`Started session for kernel ${e.kernelConnection.kind}:${e.kernelConnection.id}`);let c=new FA(u,e.resource,e.kernelConnection,this.kernelService,e.creator),d=u.disposed,f=()=>{l.dispose(),d.disconnect(f)};this.asyncDisposables.push({dispose:()=>c.shutdown().finally(()=>c.dispose())}),u.disposed.connect(f);let m=c.onDidDispose(f);return this.asyncDisposables.push(m),c}catch(l){throw Ce(s),Wt(e.kernelConnection)?o?Os.isSelfCertsError(l)?new Os(o.baseUrl):tu.isSelfCertsExpiredError(l)?new tu(o.baseUrl):new io(o.baseUrl,e.kernelConnection.serverProviderHandle,l):l:l instanceof ot?l:new NA(l)}finally{Ce(t)}}async validateRemoteServer(e,t){if(t.isDisposed)throw new Qr;if(!Qt(e.kernelConnection))try{await Promise.all([t.getRunningKernels(),t.getKernelSpecs()])}catch(n){throw C.error("Failed to fetch running kernels from remote server, connection may be outdated or remote server may be unreachable",n),new io(e.kernelConnection.baseUrl,e.kernelConnection.serverProviderHandle,n)}}async validateLocalKernelDependencies(e){var t;if(e.token.isCancellationRequested)throw new WA.CancellationError;(t=e.kernelConnection)!=null&&t.interpreter&&Qt(e.kernelConnection)&&this.kernelService&&await this.kernelService.ensureKernelIsUsable(e.resource,e.kernelConnection,e.ui,e.token,e.creator==="3rdPartyExtension")}async connectToOrCreateSession(e){var n;if(e.token.isCancellationRequested)throw new WA.CancellationError;let t;try{if(e.kernelConnection&&e.kernelConnection.kind==="connectToLiveRemoteKernel"&&e.kernelConnection.kernelModel.id&&e.kernelConnection.kernelModel.model){if(!e.kernelConnection.kernelModel.model)throw new Error("Kernel model not defined when connecting to an existing session");t=e.sessionManager.connectTo({...e.kernelConnection.kernelModel,model:e.kernelConnection.kernelModel.model}),await us(e.token,vD(async()=>{var i;return((i=t.kernel)==null?void 0:i.connectionStatus)==="connected"||e.token.isCancellationRequested},e.idleTimeout,100))}else C.trace(`createNewKernelSession ${(n=e.kernelConnection)==null?void 0:n.id}`),t=await this.createNewSession(e),await AA(e.kernelConnection,e.resource,t,e.idleTimeout,e.token).catch(E);if(e.token.isCancellationRequested)throw new WA.CancellationError;return t}catch(i){let o=e.ui.disableUI?C.debug:C.error;throw i instanceof ot?(o("Failed to change kernel, re-throwing",i),i):(o("Failed to change kernel",i),new ev(e.kernelConnection))}}async createNewSession(e){var a,l,u,c,d,f;let t=(e.connection,e.resource,void 0),n=t==null?void 0:t.path,i=(c=(u=iQ(e.kernelConnection))!=null?u:(l=(a=e.kernelSpecManager)==null?void 0:a.specs)==null?void 0:l.default)!=null?c:"",o;if(t!=null&&t.name)o=t.name;else{let m=e.resource?Zv(e.resource):"";o=`${e.resource?pi(e.resource,m):""}-${(0,VA.default)()}${m}`}let s={path:n||QSe(e.resource),kernel:{name:i},name:o,type:(((d=e.resource)==null?void 0:d.path)||"").toLowerCase().endsWith(".ipynb")?"notebook":"console"};try{let m=await us(e.token,e.sessionManager.startNew(s,{kernelConnectionOptions:{handleComms:!0}}));if(!m.kernel)throw new DS(new Error("No kernel created"));return C.info(W.createdNewKernel(e.connection.baseUrl,((f=m==null?void 0:m.kernel)==null?void 0:f.id)||"")),m}catch(m){throw m instanceof DS?m:new DS(m)}}};Gd=U([(0,mu.injectable)(),x(0,(0,mu.inject)(AR)),x(1,(0,mu.inject)(fn)),x(2,(0,mu.inject)(Vu)),x(3,(0,mu.inject)(MR)),x(3,(0,mu.optional)()),x(4,(0,mu.inject)(Ke))],Gd);function zSe(){return`${Yf}${(0,VA.default)()}`}function QSe(r){let e=`${zSe()}${(0,VA.default)()}.ipynb`;return r?`${pi(r,".ipynb")}${e}`:`${W.defaultNotebookName}${e}`}var TS=class{constructor(e,t,n){this.rawKernelSupported=e;this.newRawKernelSessionFactory=t;this.newJupyterSessionFactory=n}async create(e){let t=e.kernelConnection;return this.rawKernelSupported.isSupported&&Qt(t)&&this.newRawKernelSessionFactory?this.newRawKernelSessionFactory.create({...e,kernelConnection:t}):this.newJupyterSessionFactory.create(e)}};TS=U([(0,dm.injectable)(),x(0,(0,dm.inject)(qd)),x(1,(0,dm.inject)(HX)),x(1,(0,dm.optional)()),x(2,(0,dm.inject)(Gd))],TS);p();var IP=Symbol("RemoteKernelFinderController");function vZ(r,e){r.addSingleton(Kl,Kl),r.addSingleton(MR,Qg),r.addSingleton(dr,ES),r.addSingleton(zx,TS),r.addSingleton(Gd,Gd),r.addSingleton(AR,_S),r.addSingleton(Jg,xS),r.addSingleton(fn,fn),r.addSingleton(Gg,CS),r.addBinding(Gg,Ve),r.addSingleton(LR,SS),r.addSingleton(pn,IS),r.addSingleton(IP,Jd),r.addBinding(IP,Ve),r.addSingleton(sr,LI)}var AZ=oe(he());p();var mn=oe(he());p();var Mi=require("vscode");var jA=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.executions=new WeakMap;this.kernelsByNotebook=new WeakMap;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new Mi.EventEmitter;this._onDidStartKernel=new Mi.EventEmitter;this._onDidCreateKernel=new Mi.EventEmitter;this._onDidDisposeKernel=new Mi.EventEmitter;this._onKernelStatusChanged=new Mi.EventEmitter;this._onDidPostInitializeKernel=new Rg;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),Mi.workspace.onDidCloseNotebookDocument(n=>this.disposeOldKernel(n,"notebookClosed"),this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel),t.push(this._onDidPostInitializeKernel)}get kernels(){let e=new Set;return Mi.workspace.notebookDocuments.forEach(t=>{let n=this.get(t);n&&e.add(n)}),Array.from(e)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get onDidPostInitializeKernel(){return this._onDidPostInitializeKernel.event}get(e){var t,n;if(ui(e)){let i=Mi.workspace.notebookDocuments.find(o=>o.uri.toString()===e.toString());return i?this.get(i):void 0}else return typeof e=="string"?(t=this.kernelsById.get(e))==null?void 0:t.kernel:(n=this.kernelsByNotebook.get(e))==null?void 0:n.kernel}getKernelExecution(e){return this.executions.get(e)}getInternal(e){return this.kernelsByNotebook.get(e)}async dispose(){C.ci("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByNotebook.set(e,{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e){e.onDisposed(()=>{this.get(e.notebook)===e&&(this.kernelsByNotebook.delete(e.notebook),this.kernelsById.delete(e.id),C.debug(`Kernel got disposed, hence there is no longer a kernel associated with ${Ee(e.uri)}`)),this.pendingDisposables.delete(e)},this,this.disposables)}disposeOldKernel(e,t){let n=this.kernelsByNotebook.get(e);n&&(C.debug(`Disposing kernel associated with ${Ee(e.uri)}, isClosed=${e.isClosed}, reason = ${t}`),this.kernelsById.delete(n.kernel.id),this.pendingDisposables.add(n.kernel),n.kernel.dispose().catch(i=>C.warn("Failed to dispose old kernel",i)).finally(()=>this.pendingDisposables.delete(n.kernel)).catch(E)),this.kernelsByNotebook.delete(e)}handleServerRemoval(e){Mi.workspace.notebookDocuments.forEach(t=>{let n=this.kernelsByNotebook.get(t);if(n){let i=n.options.metadata;(i.kind==="connectToLiveRemoteKernel"||i.kind==="startUsingRemoteKernelSpec")&&e.find(s=>s.id===i.serverProviderHandle.id&&s.handle===i.serverProviderHandle.handle)&&(this.kernelsByNotebook.delete(t),this.kernelsById.delete(n.kernel.id))}})}},BA=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.kernelsByUri=new Map;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new Mi.EventEmitter;this._onDidStartKernel=new Mi.EventEmitter;this._onDidCreateKernel=new Mi.EventEmitter;this._onDidDisposeKernel=new Mi.EventEmitter;this._onDidPostInitializeKernel=new Rg;this._onKernelStatusChanged=new Mi.EventEmitter;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),Mi.workspace.onDidCloseNotebookDocument(n=>{C.debug(`Notebook document ${Ee(n.uri)} got closed`),this.disposeOldKernel(n.uri)},this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel),t.push(this._onDidPostInitializeKernel)}get kernels(){return Array.from(this.kernelsByUri.values()).map(e=>e.kernel)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get onDidPostInitializeKernel(){return this._onDidPostInitializeKernel.event}get(e){var t,n;return((t=this.kernelsByUri.get(e.toString()))==null?void 0:t.kernel)||((n=this.kernelsById.get(e.toString()))==null?void 0:n.kernel)}getInternal(e){return this.kernelsByUri.get(e.toString())}async dispose(){C.ci("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByUri.set(e.toString(),{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e,t){t.onDisposed(()=>{this.get(e)===t&&(this.kernelsByUri.delete(e.toString()),this.kernelsById.delete(t.id),C.debug(`Kernel got disposed, hence there is no longer a kernel associated with ${Ee(e)}`)),this.pendingDisposables.delete(t)},this,this.disposables)}disposeOldKernel(e){let t=this.kernelsByUri.get(e.toString());t&&(C.ci(`Disposing kernel associated with ${Ee(e)}`),this.kernelsById.delete(t.kernel.id),this.pendingDisposables.add(t.kernel),t.kernel.dispose().catch(n=>C.warn("Failed to dispose old kernel",n)).finally(()=>this.pendingDisposables.delete(t.kernel)).catch(E)),this.kernelsByUri.delete(e.toString())}};p();var i9=oe(Zg()),Lr=require("vscode");var IZ=oe(uA());p();var n9="KERNEL_INFO",XSe=1e3*60*60*24*2;async function bZ(r,e,t){var a;let n=[],i={banner:"",help_links:[],implementation:"",implementation_version:"",language_info:{name:"",version:""},protocol_version:"",status:"ok"};if(!r.kernel)return;(a=r.kernel)!=null&&a.info&&(n.push(r.kernel.info),r.kernel.info.then(l=>yZ(t,e,l)).catch(E));let o=r.kernel.requestKernelInfo().then(l=>l==null?void 0:l.content);if(n.push(o),o.then(l=>yZ(t,e,l)).catch(E),e.kind==="connectToLiveRemoteKernel"){let l=ZSe(t,e);l?n.push(Promise.resolve(l)):n.push(nc(5e3).then(()=>i))}let s=await Promise.race(n);return s===i?C.warn("Failed to Kernel info in a timely manner, defaulting to empty info!"):C.trace("Got Kernel info"),s}async function yZ(r,e,t){if(!t||!Wt(e))return;let n=r.get(n9,[]).filter(i=>Date.now()-i.age<XSe).filter(i=>i.id!==e.id);n.push({id:e.id,age:Date.now(),info:t}),await r.update(n9,n)}function ZSe(r,e){var t;if(Wt(e))return(t=r.get(n9,[]).find(n=>n.id===e.id))==null?void 0:t.info}p();var HA=class extends Ii{constructor(e){super("kernelpromisetimeout",W.interruptingKernelFailed,e)}};var qA="e976ee50-99ed-4aba-9b6b-9dcd5634d07d:IPyWidgets:";function SP(r){let e=typeof r=="string"?r:"";return typeof r!="string"&&"content"in r&&"code"in r.content&&typeof r.content.code=="string"&&(e=r.content.code),!e.includes(qA)}function $A(r){var e,t,n,i;return r.status==="dead"||r.status==="terminating"&&!r.disposed&&!r.disposing||!r.disposed&&!r.disposing&&(((e=r.session)==null?void 0:e.status)=="unknown"||((n=(t=r.session)==null?void 0:t.kernel)==null?void 0:n.status)=="unknown")&&(((i=r.session.kernel)==null?void 0:i.isDisposed)||r.session.isDisposed)}function SZ(r){var e,t;return r.status==="dead"||r.status==="terminating"&&!r.isDisposed||!r.isDisposed&&(r.status=="unknown"||((e=r.kernel)==null?void 0:e.status)=="unknown")&&(((t=r.kernel)==null?void 0:t.isDisposed)||r.isDisposed)}var JA=class{constructor(e,t,n,i,o,s,a,l,u){this.id=e;this.uri=t;this.resourceUri=n;this.kernelConnectionMetadata=i;this.sessionCreator=o;this.kernelSettings=s;this.startupCodeProviders=a;this._creator=l;this.workspaceMemento=u;this.disposables=[];this._onIPyWidgetVersionResolved=new Lr.EventEmitter;this._onDidKernelSocketChange=new Lr.EventEmitter;this._onStatusChanged=new Lr.EventEmitter;this._onRestarted=new Lr.EventEmitter;this._onStarted=new Lr.EventEmitter;this._onPostInitialized=new Rg;this._onDisposed=new Lr.EventEmitter;this.hookedSessionForEvents=new WeakSet;this.hooks=new Map;this.startCancellation=new Lr.CancellationTokenSource;this.startupUI=new pr(!0);this.disposables.push(this._onStatusChanged),this.disposables.push(this._onRestarted),this.disposables.push(this._onStarted),this.disposables.push(this._onDisposed),this.disposables.push(this._onIPyWidgetVersionResolved),this.disposables.push(this._onDidKernelSocketChange),nP(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,disableUI:this.startupUI.disableUI}).catch(E),this.startupUI.onDidChangeDisableUI(()=>{this.startupUI.disableUI||nP(this.resourceUri,{disableUI:!1}).catch(E)},this.disposables)}get ipywidgetsVersion(){return this._ipywidgetsVersion}get onIPyWidgetVersionResolved(){return this._onIPyWidgetVersionResolved.event}get onStatusChanged(){return this._onStatusChanged.event}get onRestarted(){return this._onRestarted.event}get onStarted(){return this._onStarted.event}get onPostInitialized(){return this._onPostInitialized.event}get onDisposed(){return this._onDisposed.event}get creator(){return this._creator}get startedAtLeastOnce(){return this._startedAtLeastOnce}get userStartedKernel(){return!this.startupUI.disableUI}get info(){return this._info}get status(){var e,t;return this._jupyterSessionPromise&&!this._session?"starting":(t=(e=this._session)==null?void 0:e.status)!=null?t:this.isKernelDead?"dead":"unknown"}get disposed(){var e;return this._disposed===!0||((e=this._session)==null?void 0:e.isDisposed)===!0}get disposing(){return this._disposing===!0}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}get session(){return this._session}get isPostInitializedInProgress(){return this._isPostInitializedInProgress===!0}get restarting(){return this._restartPromise||Promise.resolve()}addHook(e,t,n,i){let o=this.hooks.get(e)||new Set;this.hooks.set(e,o),t=n?t.bind(n):t,o.add(t);let s={dispose:()=>{o.delete(t)}};return i&&i.push(s),s}async start(e){this.startCancellation.token.isCancellationRequested&&(this.startCancellation.dispose(),this.startCancellation=new Lr.CancellationTokenSource);let t=await this.startJupyterSession(e);return e!=null&&e.ignoreTriggeringOnPostInitialized||await this.triggerOnDidStartKernel((e==null?void 0:e.disableUI)===!0,!1),t}async interrupt(){let e=Promise.all(Array.from(this.hooks.get("willInterrupt")||new Set).map(n=>n()));C.info(`Interrupt requested ${Ee(this.resourceUri||this.uri)}`);let t;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;C.info("Interrupt kernel execution"),n?(t=this._interruptPromise?await this._interruptPromise:await(this._interruptPromise=this.interruptExecution(n,e)),this._interruptPromise=void 0):(C.info("No kernel session to interrupt"),this._interruptPromise=void 0,t="success")}finally{await Promise.all(Array.from(this.hooks.get("interruptCompleted")||new Set).map(n=>n())).catch(E)}if(C.info(`Interrupt requested & sent for ${Ee(this.uri)} in notebookEditor.`),t==="timeout"){let n=W.restartKernelAfterInterruptMessage(ut(this.kernelConnectionMetadata)),i=W.restartKernelMessageYes;await Lr.window.showInformationMessage(n,{modal:!0},i)===i&&await this.restart()}}async dispose(){if(C.info(`Dispose Kernel '${Ee(this.uri)}' associated with '${Ee(this.resourceUri)}'`),this._disposing=!0,this.disposingPromise)return this.disposingPromise;this._ignoreJupyterSessionDisposedErrors=!0,this.startCancellation.cancel();let e=async()=>{let t=[];t.push(Promise.all(Array.from(this.hooks.get("willCancel")||new Set).map(n=>n())).then(E).catch(E)),this._session=this._session?this._session:this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0,this._jupyterSessionPromise=void 0,this._postInitializedOnStartPromise=void 0,this._session&&(t.push(Lg(this._session,this.disposables)),this._session=void 0),this._disposed=!0,this._onDisposed.fire(),this._onStatusChanged.fire("dead");try{await Promise.all(t)}finally{this.startCancellation.dispose(),Ce(this.disposables)}};this.disposingPromise=e(),await this.disposingPromise}async restart(){try{let e=Al(this.resourceUri);C.info(`Restart requested ${Ee(this.uri)}`),await Promise.all(Array.from(this.hooks.get("willRestart")||new Set).map(n=>n(this._jupyterSessionPromise))),this.startCancellation.cancel(),this.startCancellation.dispose();let t=new yt;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;n?(this._restartPromise||(this._restartPromise=n.restart(),this._restartPromise.finally(()=>this._restartPromise=void 0).catch(E)),await this._restartPromise,this.startCancellation=new Lr.CancellationTokenSource):await this.start(new pr(!1)),Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},{resourceType:e})}catch(n){C.error(`Restart failed ${Ee(this.uri)}`,n),this._ignoreJupyterSessionDisposedErrors=!0;let i=this._session;throw this._session=void 0,this._jupyterSessionPromise=void 0,this._postInitializedOnStartPromise=void 0,Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},void 0,n),i&&await Lg(i,this.disposables),this._ignoreJupyterSessionDisposedErrors=!1,n}await this.initializeAfterStart(this._session),this._onRestarted.fire(),await this.triggerOnDidStartKernel(!1,!0)}catch(e){throw C.error(`Failed to restart kernel ${Ee(this.uri)}`,e),e}finally{Promise.all(Array.from(this.hooks.get("restartCompleted")||new Set).map(e=>e())).catch(E)}}async startJupyterSession(e=new pr(!1)){if(this._startedAtLeastOnce=!0,e.disableUI||(this.startupUI.disableUI=!1),e.onDidChangeDisableUI(()=>{!e.disableUI&&this.startupUI.disableUI&&(this.startupUI.disableUI=!1)},this.disposables),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||Ll(this.resourceUri,this.kernelConnectionMetadata).catch(E)},this,this.disposables),this.disposing)throw new Lr.CancellationError;if(Fd.throwIfCanceled(this.startCancellation.token),!this._jupyterSessionPromise){let t=new yt;this._jupyterSessionPromise=this.createJupyterSession();try{let n=await this._jupyterSessionPromise;return Rr(this.resourceUri,"DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",{duration:t.elapsedTime}),n}catch(n){throw C.ci(`Failed to create Jupyter Session in Kernel.startNotebook for ${Ee(this.uri)}`),this.startCancellation.cancel(),this._jupyterSessionPromise=void 0,n}}return this._jupyterSessionPromise}async triggerOnDidStartKernel(e,t=!1){e||((!this._postInitializedOnStartPromise||t)&&(this._isPostInitializedInProgress=!0,this._postInitializedOnStartPromise=this._onPostInitialized.fireAsync({},this.startCancellation.token),this._postInitializedOnStartPromise.finally(()=>this._isPostInitializedInProgress=!1)),await this._postInitializedOnStartPromise)}async interruptExecution(e,t){let n=Re(),i=new yt,o=[],s=u=>{(u==="restarting"||u==="autorestarting")&&(C.warn("Kernel restarting during interrupt"),n.resolve(!0))},a=(u,c)=>s(c);return e.statusChanged.connect(a),o.push(new Lr.Disposable(()=>zs(()=>e.statusChanged.disconnect(a)))),e&&e.kernel&&(C.info(`Interrupting kernel: ${e.kernel.name}`),await Gv(this.kernelSettings.interruptTimeout,new HA(this.kernelConnectionMetadata),e.kernel.interrupt()).catch(u=>{C.warn(`Error during interrupt: ${u}`),n.resolve(!0)})),(async()=>{let u=Re();this.status==="busy"&&(this.onDisposed(()=>u.resolve("dead"),this,o),this.onStatusChanged(()=>this.status==="dead"?u.resolve("dead"):void 0,this,o));try{return await po(this.kernelSettings.interruptTimeout,"timeout",t.then(()=>"success"),n.promise.then(()=>"restart"),u.promise)}catch(c){if(n.completed)return"restart";throw Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},void 0,c),c}finally{Ce(o)}})().then(u=>(Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},{result:u}),u))}async createJupyterSession(){var i;let e=Lr.workspace.notebookDocuments.find(o=>o.uri.toString()===this.uri.toString()),t=e?(i=Vc(e))==null?void 0:i.jupyterSessionTelemetry():void 0;if(await nP(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,userExecutedCell:!this.startupUI.disableUI}),t==null||t.stop(),this.disposing)throw new Lr.CancellationError;Fd.throwIfCanceled(this.startCancellation.token);let n=[];try{C.info(`Starting Kernel ${t_e(this,this.startupUI)}`),this.createProgressIndicator(n),this.isKernelDead=!1,this._onStatusChanged.fire("starting");let o=await this.sessionCreator.create({resource:this.resourceUri,ui:this.startupUI,kernelConnection:this.kernelConnectionMetadata,token:this.startCancellation.token,creator:this.creator});if(this.disposing)throw new Lr.CancellationError;if(Fd.throwIfCanceled(this.startCancellation.token),await this.initializeAfterStart(o),this.disposing)throw new Lr.CancellationError;return this.sendKernelStartedTelemetry(),this._session=o,this._onStarted.fire(),C.info("Kernel successfully started"),o}catch(o){if(this.startupUI.disableUI?C.trace(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,o):!this.startCancellation.token&&!Yn(o)&&C.error(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,o),Fd.throwIfCanceled(this.startCancellation.token),o instanceof Mp)throw o;let s=W.sessionStartFailedWithKernel(ut(this.kernelConnectionMetadata));throw Ln.from(s+" "+("message"in o?o.message:o.toString()),o)}finally{Ce(n)}}sendKernelStartedTelemetry(){this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent&&this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent===this.startupUI.disableUI||this.startTelemetrySent&&!this.startupUI.disableUI||(this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent=this.startupUI.disableUI===!0,this.startTelemetrySent=!0,Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:this.startupUI.disableUI}))}createProgressIndicator(e){let t=Kt.createProgressReporter(this.resourceUri,W.connectingToKernel(ut(this.kernelConnectionMetadata)),this.startupUI.disableUI);e.push(t),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||t.show&&t.show()},this,e)}async initializeAfterStart(e){var o;let t=Lr.workspace.notebookDocuments.find(s=>s.uri.toString()===this.uri.toString()),n=Vc(t),i=t?n==null?void 0:n.postKernelStartup():void 0;try{if(await Promise.all(Array.from(this.hooks.get("didStart")||new Set).map(l=>l(e,this.startCancellation.token).catch(E))),C.trace(`Started running kernel initialization for ${Ee(this.uri)}`),!e){C.trace("Not running kernel initialization");return}if(!this.hookedSessionForEvents.has(e)){this.hookedSessionForEvents.add(e),e.onDidKernelSocketChange(u=>this._onDidKernelSocketChange.fire(u)),e.onDidDispose(()=>{if(C.ci(`Kernel got disposed as a result of session.onDisposed (1) ${Ee(this.resourceUri||this.uri)}`),!this._ignoreJupyterSessionDisposedErrors){C.info(`Kernel got disposed as a result of session.onDisposed ${Ee(this.resourceUri||this.uri)} & _ignoreJupyterSessionDisposedErrors = false.`);let u=this._session===e;this._jupyterSessionPromise=void 0,this._postInitializedOnStartPromise=void 0,this._session=void 0,u&&(this.isKernelDead=!0,this._onStatusChanged.fire("dead"))}});let l=(u,c)=>this._onStatusChanged.fire(c);e.statusChanged.connect(l),this.disposables.push(new Lr.Disposable(()=>zs(()=>e.statusChanged.disconnect(l))))}if((o=e.kernel)==null||o.registerCommTarget(nt.DefaultCommTarget,E),this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel")this.determineVersionOfIPyWidgets(e).catch(l=>C.error("Failed to determine IPyWidget version",l)),this.gatherInternalStartupCode().then(l=>this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"})).catch(l=>C.error("Failed to execute internal startup code",l));else{await this.determineVersionOfIPyWidgets(e);let l=await this.gatherInternalStartupCode();await this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"}),await this.executeSilently(e,this.getUserStartupCommands(),{traceErrors:!1})}i==null||i.stop();let s=n==null?void 0:n.kernelInfo();try{C.debug("Requesting Kernel info"),this._info=await bZ(e,this.kernelConnectionMetadata,this.workspaceMemento)}catch(l){C.warn("Failed to request KernelInfo",l)}s==null||s.stop();let a=n==null?void 0:n.kernelIdle();this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&(C.trace("End running kernel initialization, now waiting for idle"),await e.waitForIdle(this.kernelSettings.launchTimeout,this.startCancellation.token),C.trace("End running kernel initialization, session is idle")),a==null||a.stop()}finally{i==null||i.stop()}}async determineVersionOfIPyWidgets(e){var n;if(!jt(this.kernelConnectionMetadata)){this._ipywidgetsVersion==HE,this._onIPyWidgetVersionResolved.fire(HE);return}let t=async()=>{let i=IZ.default`
        try:
            import ipywidgets as _VSCODE_ipywidgets
            print("${qA}" + _VSCODE_ipywidgets.__version__)
            del _VSCODE_ipywidgets
        except:
            pass
        `,o=await this.executeSilently(e,[i]).catch(s=>C.error("Failed to determine version of IPyWidgets",s));if(Array.isArray(o)){let s=o.some(u=>{var c;return(c=u.text||"")==null?void 0:c.toString().includes(`${qA}8.`)}),a=o.some(u=>{var c;return(c=u.text||"")==null?void 0:c.toString().includes(`${qA}7.`)}),l=this._ipywidgetsVersion=a?7:s?8:void 0;C.trace(`Determined IPyWidgets Version as ${l}`),this._ipywidgetsVersion==l,this._onIPyWidgetVersionResolved.fire(l)}else C.warn("Failed to determine IPyKernel Version",JSON.stringify(o))};if(await t(),!this._ipywidgetsVersion&&((n=this.session)!=null&&n.kernel)){let i=(o,s)=>{var l;if(s.direction==="send")return;let a=s.msg;a.content&&"data"in a.content&&a.content.data&&(a.content.data[uo]||"target_name"in a.content&&a.content.target_name===nt.DefaultCommTarget)&&(this._ipywidgetsVersion||(t().catch(E),(l=this.session)!=null&&l.kernel&&this.session.kernel.anyMessage.disconnect(i,this)))};this.session.kernel.anyMessage.connect(i,this)}}async gatherInternalStartupCode(){let e=[],t=await Promise.all(this.startupCodeProviders.sort((n,i)=>i.priority-n.priority).map(n=>n.getCode(this)));for(let n of t)e.push(...n);if(jt(this.kernelConnectionMetadata)&&this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"){let n=ct(this.resourceUri);n&&e.push(`__vsc_ipynb_file__ = "${n.replace(/\\/g,"\\\\")}"`),this.kernelSettings.enableExtendedPythonKernelCompletions||e.push(WE.DisableJedi),e.push(...e_e(this.getMatplotLibInitializeCode(),"Failed to initialize matplotlib startup code. Matplotlib might be missing."))}return e}getMatplotLibInitializeCode(){let e=[];if(this.kernelSettings.themeMatplotlibPlots){C.ci(`Initialize config for plots for ${Ee(this.resourceUri||this.uri)}`);let t=WE.MatplotLibInit;C.trace(`Initialize matplotlib for ${Ee(this.resourceUri||this.uri)}`),e.push(...lt(t,{trim:!1}));let n=Lr.window.activeColorTheme.kind===Lr.ColorThemeKind.Dark;e.push(n?"matplotlib.style.use('dark_background')":`matplotlib.rcParams.update(${nt.MatplotLibDefaultParams})`)}return e}getUserStartupCommands(){let e=this.kernelSettings.runStartupCommands;if(Array.isArray(e)&&(e=e.join(`
`)),e){let t=e.replace(/\\n/g,`
`);return lt(t,{trim:!1})}return[]}async executeSilently(e,t,n){if(t.join("").trim().length!==0){if(!e.kernel){C.trace(`Not executing startup as there is no session, code: ${t}`);return}return Ai(e.kernel,t.join(`
`),n)}}},GA=class extends JA{get creator(){return"3rdPartyExtension"}constructor(e,t,n,i,o,s,a){super(`3rdPartyKernel_${(0,i9.default)()}`,e,t,n,i,o,s,"3rdPartyExtension",a)}},YA=class extends JA{constructor(t,n,i,o,s,a,l,u){super((0,i9.default)(),n.uri,t,i,o,s,l,"jupyterExtension",u);this.notebook=n;this.controller=a}get creator(){return"jupyterExtension"}};function e_e(r,e){return!r||r.length===0||(r=r.map(t=>`    ${t}`),r.unshift("try:"),r.push("except:",`    print('${e}')`)),r}function t_e(r,e){let t=r.kernelConnectionMetadata.interpreter,n=[];if(t){n.push(`Python Path: ${Ee(t.uri)}`),n.push(t?_r(t):"");let i=Uu(t);i&&n.push(`${i.major}.${i.minor}.${i.micro}`)}else(r.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||r.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec")&&n.push(r.kernelConnectionMetadata.kernelSpec.display_name);return`(${n.filter(i=>i).join(", ")}) for '${Ee(r.uri)}' (disableUI=${e.disableUI})`}p();function o9(r,e){return{get enableExtendedPythonKernelCompletions(){return r.getSettings(e).enableExtendedPythonKernelCompletions},get interruptTimeout(){return r.getSettings(e).jupyterInterruptTimeout},get launchTimeout(){return r.getSettings(e).jupyterLaunchTimeout},get runStartupCommands(){return r.getSettings(e).runStartupCommands},get themeMatplotlibPlots(){return r.getSettings(e).themeMatplotlibPlots}}}p();var rv=require("vscode");p();var a9=require("vscode");p();var s9=oe(ij()),yr=require("vscode");p();var zA=oe(he()),_Z=require("vscode");var nn=class{static dispose(){Ce(nn.disposables)}constructor(e){e.push({dispose:()=>{nn.dispose()}})}activate(){_Z.workspace.onDidChangeNotebookDocument(e=>{hr(e.notebook)&&e.cellChanges.filter(t=>{var n;return((n=t.outputs)==null?void 0:n.length)===0}).map(t=>{var i;let n=nn.cellToDisplayIdMapping.get(t.cell);n&&(nn.cellToDisplayIdMapping.delete(t.cell),(i=nn.displayIdCellOutputMappingPerDocument.get(e.notebook))==null||i.delete(n))})})}static trackOutputByDisplayId(e,t,n,i){let o=nn.displayIdCellOutputMappingPerDocument.get(e.notebook);o||(o=new Map,nn.displayIdCellOutputMappingPerDocument.set(e.notebook,o)),o.set(t,{outputContainer:n,cell:e,outputItems:i}),nn.cellToDisplayIdMapping.set(e,t)}static getMappedOutput(e,t){let n=nn.displayIdCellOutputMappingPerDocument.get(e);if(!n)return;let i=n.get(t);return i!=null&&i.cell.document.isClosed?void 0:i}};nn.displayIdCellOutputMappingPerDocument=new WeakMap,nn.cellToDisplayIdMapping=new WeakMap,nn.disposables=[],nn=U([(0,zA.injectable)(),x(0,(0,zA.inject)(ve))],nn);var QA=oe(GN());var kS=new WeakMap;function Yd(r){if(r.parent_header&&"msg_id"in r.parent_header)return r.parent_header.msg_id}var hu=class hu{constructor(e,t,n,i,o,s,a,l){this.cell=e;this.controller=t;this.context=n;this.formatters=i;this.kernel=o;this.request=s;this._onErrorHandlingIOPubMessage=new yr.EventEmitter;this.onErrorHandlingExecuteRequestIOPubMessage=this._onErrorHandlingIOPubMessage.event;this.outputsAreSpecificToAWidget=[];this.commIdsMappedToParentWidgetModel=new Map;this.disposables=[];this.prompts=new Set;this.ownedCommIds=new Set;this.commIdsMappedToWidgetOutputModels=new Set;this.ownedRequestMsgIds=new Set;this._completed=Re();this.gotIdleIOPubStatus=!1;this.gotShellReply=!1;this.streamsReAttachedToExecutingCell=!1;this._completed.promise.catch(E),this.executeRequestMessageId=l,this.ownedRequestMsgIds.add(l),yr.workspace.onDidChangeNotebookDocument(u=>{var d;if(!hr(u.notebook))return;let c=u.cellChanges.find(({cell:f})=>f===this.cell);c&&((d=c.outputs)==null?void 0:d.length)===0&&(this.clearLastUsedStreamOutput(),this.cellHasErrorsInOutput=!1)},this,this.disposables),this.execution=a,this.kernel.anyMessage.connect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.connect(this.onKernelIOPubMessage,this),s&&(s.onIOPub=()=>{this.cell.document.isClosed&&!this.completedExecution&&s.dispose()},s.onReply=u=>{if(this.cell.document.isClosed){s.dispose();return}this.handleReply(u)},s.onStdin=this.handleInputRequest.bind(this),s.done.finally(()=>{this.completedExecution=!0,this.endCellExecution()}).catch(E))}get hasErrorOutput(){return this.cellHasErrorsInOutput===!0}get completed(){return this._completed.promise}dispose(){this.disposed||(this.disposed=!0,it(this.cell,"Execution Message Handler disposed"),Ce(this.disposables),this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this.kernel.anyMessage.disconnect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.disconnect(this.onKernelIOPubMessage,this),this._onErrorHandlingIOPubMessage.dispose())}endCellExecution(){this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this._completed.resolve()}onKernelAnyMessage(e,{direction:t,msg:n}){if(this.cell.document.isClosed)return this.endCellExecution();let i=Jn();if(!this.request&&t==="recv"){let o=Yd(n);i.KernelMessage.isStatusMsg(n)&&n.content.execution_state==="idle"&&o===this.executeRequestMessageId&&(this.gotIdleIOPubStatus=!0),n.channel==="shell"&&o===this.executeRequestMessageId&&(this.gotShellReply=!0);let s=i.KernelMessage.isStatusMsg(n)&&n.content.execution_state!=="idle"&&o!==this.executeRequestMessageId;typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type;let a=o?o!==this.executeRequestMessageId&&!s:!1,l=typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type==="interrupt_request",u=this.gotIdleIOPubStatus&&this.gotShellReply,c=["kernel_info_reply","execute_input","execute_reply"],d="msg_type"in n&&typeof n.msg_type=="string"&&c.includes(n.msg_type);if(!this.completedExecution&&u)return this.completedExecution=!0,this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endCellExecution();if(!this.completedExecution&&(d||a)){this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=setTimeout(()=>(this.completedExecution=!0,this.endAbnormallyTimeout=void 0,this.endCellExecution()),l?1e3:100),this.disposables.push(new yr.Disposable(()=>{clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=void 0}));return}}t!=="send"||!this.completedExecution||i.KernelMessage.isCommMsgMsg(n)&&this.ownedCommIds.has(n.content.comm_id)&&this.ownedRequestMsgIds.add(n.header.msg_id)}onKernelIOPubMessage(e,t){if(this.cell.document.isClosed)return this.endCellExecution();if(!(!t.parent_header||!("msg_id"in t.parent_header)||!this.ownedRequestMsgIds.has(t.parent_header.msg_id)||t.channel!=="iopub"))try{this.handleIOPub(t)}catch(n){C.error("Failed to handle iopub message as a result of some comm message",t,n),!this.completedExecution&&!this.cell.document.isClosed&&this._onErrorHandlingIOPubMessage.fire(n)}}clearLastUsedStreamOutput(){this.lastUsedStreamOutput=void 0}createTemporaryTask(e){var n,i;if(this.cell.document.isClosed)return;let t=kS.get(this.cell.notebook);return t&&(!e||e&&t.cell.index===this.cell.index)?t:(this.previousResultsToRestore={...this.cell.executionSummary||{}},this.temporaryExecution=no.getOrCreate(this.cell,this.controller),(n=this.temporaryExecution)==null||n.start(),(i=this.previousResultsToRestore)!=null&&i.executionOrder&&this.temporaryExecution&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution)}endTemporaryTask(){var e,t,n;(e=this.previousResultsToRestore)!=null&&e.executionOrder&&this.execution&&(this.execution.executionOrder=this.previousResultsToRestore.executionOrder),this.previousResultsToRestore&&this.temporaryExecution?(this.previousResultsToRestore.executionOrder&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution.end(this.previousResultsToRestore.success,(t=this.previousResultsToRestore.timing)==null?void 0:t.endTime)):(n=this.temporaryExecution)==null||n.end(void 0),this.previousResultsToRestore=void 0,this.temporaryExecution=void 0}handleIOPub(e){var n;this.startTime||(this.startTime=new Date().getTime(),(n=this.execution)==null||n.start(this.startTime),C.debug(`Kernel acknowledged execution of cell ${this.cell.index} @ ${this.startTime}`));let t=Jn();if(t.KernelMessage.isCommOpenMsg(e))this.handleCommOpen(e);else if(t.KernelMessage.isExecuteResultMsg(e))this.handleExecuteResult(e);else if(t.KernelMessage.isExecuteInputMsg(e))this.handleExecuteInput(e);else if(t.KernelMessage.isStatusMsg(e)){let i=e;this.handleStatusMessage(i)}else t.KernelMessage.isStreamMsg(e)?this.handleStreamMessage(e):t.KernelMessage.isDisplayDataMsg(e)?this.handleDisplayData(e):t.KernelMessage.isUpdateDisplayDataMsg(e)?this.handleUpdateDisplayDataMessage(e):t.KernelMessage.isClearOutputMsg(e)?this.handleClearOutput(e):t.KernelMessage.isErrorMsg(e)?this.handleError(e):t.KernelMessage.isCommOpenMsg(e)||(t.KernelMessage.isCommMsgMsg(e)?this.handleCommMsg(e):t.KernelMessage.isCommCloseMsg(e)||C.warn(`Unknown message ${e.header.msg_type} : hasData=${"data"in e.content}`));"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleCommOpen(e){var n;this.ownedCommIds.add(e.content.comm_id);let t=((n=e.content.data)==null?void 0:n.state)||void 0;e.content.target_name===nt.DefaultCommTarget&&t&&t._model_module==="@jupyter-widgets/output"&&this.commIdsMappedToWidgetOutputModels.add(e.content.comm_id)}handleCommMsg(e){let t=e.content.data;if(!(!t||t.method!=="update"||typeof t.state!="object")){if("msg_id"in t.state&&typeof t.state.msg_id=="string"){let n="msg_id"in e.parent_header?e.parent_header:void 0;(this.ownedRequestMsgIds.has(e.content.comm_id)||n&&this.ownedRequestMsgIds.has(n.msg_id))&&(t.state.msg_id?this.outputsAreSpecificToAWidget.push({handlingCommId:e.content.comm_id,msgIdsToSwallow:t.state.msg_id}):this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId===e.content.comm_id&&this.outputsAreSpecificToAWidget.pop())}else if("children"in t.state&&Array.isArray(t.state.children)&&this.ownedCommIds.has(e.content.comm_id)){let n="IPY_MODEL_";t.state.children.forEach(i=>{if(typeof i!="string")return C.warn("Came across a comm update message a child that isn't a string",i);if(!i.startsWith(n))return C.warn(`Came across a comm update message a child that start start with ${n}`,i);let o=i.substring(n.length);this.ownedCommIds.add(o),this.commIdsMappedToParentWidgetModel.set(o,e.content.comm_id)})}}}clearOutputIfNecessary(e){return this.clearOutputOnNextUpdateToOutput?(it(this.cell,"Clear cell output"),this.clearLastUsedStreamOutput(),e==null||e.clearOutput().then(E,E),this.clearOutputOnNextUpdateToOutput=!1,{previousValueOfClearOutputOnNextUpdateToOutput:!0}):{previousValueOfClearOutputOnNextUpdateToOutput:!1}}addToCellData(e,t){var l,u;if(e.data&&typeof e.data=="object"&&uo in e.data){let c=e.data[uo];if(c&&this.context.extensionMode===yr.ExtensionMode.Test&&(c._vsc_test_cellIndex=this.cell.index),c&&"model_id"in c){let d=hu.modelIdsOwnedByCells.get(this.cell)||new Set;d.add(c.model_id),hu.modelIdsOwnedByCells.set(this.cell,d)}}let n=ls(e),i="transient"in e&&typeof e.transient=="object"&&e.transient&&"display_id"in e.transient&&typeof((l=e.transient)==null?void 0:l.display_id)=="string"?(u=e.transient)==null?void 0:u.display_id:void 0;if(this.cell.document.isClosed)return;it(this.cell,()=>`Update output with mimes ${n.items.map(c=>c.mime).toString()}`);let o=this.getOrCreateExecutionTask(!0);this.clearOutputIfNecessary(o),i&&nn.trackOutputByDisplayId(this.cell,i,n,n.items),this.clearLastUsedStreamOutput(),it(this.cell,"Append output in addToCellData");let s=!0,a=Yd(t);if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a&&n.items.every(c=>this.canMimeTypeBeRenderedByWidgetManager(c)))s=!1;else if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a){let c=this.updateJupyterOutputWidgetWithOutput({commId:this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId,outputToAppend:n},o);c!=null&&c.outputAdded&&(s=!1)}s&&(o==null||o.appendOutput([n]).then(E,E)),this.endTemporaryTask()}canMimeTypeBeRenderedByWidgetManager(e){let t=e.mime;if(t=="application/vnd.code.notebook.stderr"||t=="application/vnd.code.notebook.stdout"||t=="application/vnd.code.notebook.error")return!0;if(t===uo){let n=JSON.parse(new TextDecoder().decode(e.data));return typeof n.model_id=="string"&&this.commIdsMappedToWidgetOutputModels.has(n.model_id)?EZ():!0}return t.startsWith("application/vnd")?EZ():!0}updateJupyterOutputWidgetWithOutput(e,t){let n=this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId:void 0,i="commId"in e?e.commId:n;if(!i)return;let o="outputToAppend"in e?e.outputToAppend:void 0,s=this.commIdsMappedToParentWidgetModel.get(i)||i,a=this.cell.notebook.getCells().find(v=>{var k;return(k=hu.modelIdsOwnedByCells.get(v))==null?void 0:k.has(s)});if(!a){C.warn(`Unable to find a cell that owns the model ${s}`);return}let l=a.outputs.find(v=>v.items.find(k=>{if(k.mime!==uo)return!1;try{return JSON.parse(new TextDecoder().decode(k.data)).model_id===s}catch(R){C.warn("Failed to deserialize the widget data",R)}return!1}));if(!l)return;let u=hu.outputsOwnedByWidgetModel.get(s)||new Set,d=("clearOutput"in e?e.clearOutput:!1)||(this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput===!0:!1);this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!1);let f=a.outputs.slice().filter(v=>d?!u.has(v.id):!0),m=f.slice(0,f.indexOf(l)+1),g=f.slice(f.indexOf(l)+1);hu.outputsOwnedByWidgetModel.set(s,u),o&&u.add(o.id);let b=o?m.concat(o).concat(g):m.concat(g);return g.length===0&&o?t==null||t.appendOutput(o,a).then(E,E):d&&!o&&g.length===0||t==null||t.replaceOutput(b,a).then(E,E),{outputAdded:!0}}async handleInputRequest(e){if(e.content&&"prompt"in e.content){let t=new yr.CancellationTokenSource;this.prompts.add(t);let n=e.content.password!==null&&e.content.password;await yr.window.showInputBox({prompt:e.content.prompt?e.content.prompt.toString():"",ignoreFocusOut:!0,password:n},t.token).then(i=>{this.kernel.sendInputReply({value:i||"",status:"ok"},e.header)},E),this.prompts.delete(t)}}handleExecuteResult(e){this.addToCellData({output_type:"execute_result",data:e.content.data,metadata:e.content.metadata,transient:e.content.transient,execution_count:e.content.execution_count},e)}handleExecuteReply(e){let t=e.content;t.payload&&t.payload.forEach(n=>{n.source&&n.source==="set_next_input"&&"text"in n&&"replace"in n&&this.handleSetNextInput(n),n.data&&n.data.hasOwnProperty("text/plain")&&this.addToCellData({output_type:"stream",text:n.data["text/plain"].toString(),name:"stdout",metadata:{},execution_count:t.execution_count},e)})}handleSetNextInput(e){let t=new yr.WorkspaceEdit;if(e.replace)t.replace(this.cell.document.uri,new yr.Range(this.cell.document.lineAt(0).range.start,this.cell.document.lineAt(this.cell.document.lineCount-1).range.end),e.text);else{it(this.cell,"Create new cell after current");let n=new yr.NotebookCellData(yr.NotebookCellKind.Code,e.text,this.cell.document.languageId);n.outputs=[],n.metadata={};let i=yr.NotebookEdit.insertCells(this.cell.index+1,[n]);t.set(this.cell.notebook.uri,[i])}yr.workspace.applyEdit(t).then(E,E)}handleExecuteInput(e){e.content.execution_count&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleStatusMessage(e){it(this.cell,`Kernel switching to ${e.content.execution_state}`)}getOrCreateExecutionTask(e){var t;return!e&&this.execution?this.execution:((t=this.execution)==null?void 0:t.cell)===this.cell?this.execution:this.createTemporaryTask(e)}handleStreamMessage(e){var o;if(Yd(e)&&this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow==Yd(e)||e.parent_header.msg_type==="comm_msg"&&e.header.msg_type==="stream")return;it(this.cell,`Update streamed output, new output '${e.content.text.substring(0,100)}'`);let t=this.getOrCreateExecutionTask(!0),n=e.content.name==="stdout"?yr.NotebookCellOutputItem.stdout("").mime:yr.NotebookCellOutputItem.stderr("").mime;!this.request&&!this.streamsReAttachedToExecutingCell&&!this.lastUsedStreamOutput&&this.cell.outputs.length&&this.cell.outputs[this.cell.outputs.length-1].items.length>=1&&this.cell.outputs[this.cell.outputs.length-1].items.every(s=>s.mime===n)&&(this.lastUsedStreamOutput={output:this.cell.outputs[0],stream:e.content.name}),this.streamsReAttachedToExecutingCell=!0;let{previousValueOfClearOutputOnNextUpdateToOutput:i}=this.clearOutputIfNecessary(t);if(((o=this.lastUsedStreamOutput)==null?void 0:o.stream)===e.content.name){let s=ls({output_type:"stream",name:e.content.name,text:e.content.text});it(this.cell,`Append output items '${e.content.text.substring(0,100)}`),t==null||t.appendOutputItems(s.items,this.lastUsedStreamOutput.output).then(E,E)}else if(i){let s=Wc(e.content.text),a=ls({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},it(this.cell,`Replace output with '${s.substring(0,100)}'`),t==null||t.replaceOutput([a]).then(E,E)}else{let s=pY(Wc(e.content.text)),a=ls({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},it(this.cell,`Append new output '${s.substring(0,100)}'`),t==null||t.appendOutput([a]).then(E,E)}this.endTemporaryTask()}handleDisplayData(e){let t={output_type:"display_data",data:Qx(e.content.data),metadata:e.content.metadata,transient:e.content.transient};this.addToCellData(t,e)}handleClearOutput(e){if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===Yd(e)){if(e.content.wait)this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!0);else{let t=this.getOrCreateExecutionTask(!0);this.updateJupyterOutputWidgetWithOutput({clearOutput:!0},t),this.endTemporaryTask()}return}if(e.content.wait)this.clearOutputOnNextUpdateToOutput=!0;else{let t=this.getOrCreateExecutionTask(!0);this.clearLastUsedStreamOutput(),t==null||t.clearOutput().then(E,E),this.endTemporaryTask()}}handleError(e){let t=e.content.traceback;C.ci(`Traceback for error ${t}`),this.formatters.forEach(i=>{t=i.format(this.cell,t)}),C.ci(`Traceback for error after formatting ${t}`);let n={output_type:"error",ename:e.content.ename,evalue:e.content.evalue,traceback:t};if(this.cell.notebook.notebookType!=="interactive"){let i=no.get(this.cell);i&&e.content.ename!=="KeyboardInterrupt"&&(i.errorInfo={name:e.content.ename,message:e.content.evalue,location:rQ(e.content.traceback,this.cell),uri:this.cell.document.uri,stack:e.content.traceback.join(`
`)})}this.addToCellData(n,e),this.cellHasErrorsInOutput=!0}handleReply(e){Jn().KernelMessage.isExecuteReplyMsg(e)&&(this.handleExecuteReply(e),"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count))}handleUpdateDisplayDataMessage(e){let t=e.content.transient.display_id;if(!t){C.warn("Update display data message received, but no display id",e.content);return}let n=nn.getMappedOutput(this.cell.notebook,t);if(!n){C.trace("Update display data message received, but no output found to update",e.content);return}if(n.cell.document.isClosed){C.warn("Update display data message received, but output cell is closed",e.content);return}let i=aj(new yr.NotebookCellOutput(n.outputItems,n.outputContainer.metadata)),o=ls({...i,data:e.content.data,metadata:e.content.metadata});if(n.outputItems.length===0&&o.items.length===0){C.trace("Update display data message received, but no output to update",e.content);return}let s=!1;if(n.outputItems.length===o.items.length){let a=!0;if((0,s9.default)(n.outputContainer.metadata||{},o.metadata||{})||(s=!0,a=!1),a){for(let l=0;l<n.outputItems.length;l++)if(!(0,s9.default)(n.outputItems[l],o.items[l])){a=!1;break}}if(a){C.trace("Update display data message received, but no output to update (data is the same)",e.content);return}}if(it(this.cell,`Replace output items in display data ${o.items.length}`),s){let a=n.cell.outputs.map(u=>{let c=aj(u);return c.output_type==="display_data"&&"transient"in c&&c.transient&&typeof c.transient=="object"&&"display_id"in c.transient&&typeof c.transient.display_id=="string"&&c.transient.display_id===t?o:u}),l=this.getOrCreateExecutionTask(!1);l==null||l.replaceOutput(a,n.cell).then(E,E),nn.trackOutputByDisplayId(n.cell,t,o,o.items)}else{let a=this.getOrCreateExecutionTask(!1);a==null||a.replaceOutputItems(o.items,n.outputContainer).then(E,E),nn.trackOutputByDisplayId(n.cell,t,n.outputContainer,o.items)}this.endTemporaryTask()}};hu.modelIdsOwnedByCells=new WeakMap,hu.outputsOwnedByWidgetModel=new Map,U([gn()],hu.prototype,"handleReply",1);var _P=hu;function EZ(){let r=yr.extensions.getExtension(vp);if(!r)return!1;let e=(0,QA.coerce)(r.packageJSON.version);return e?e.compare(new QA.SemVer("1.1.0"))>=0:!1}p();var $d=class extends Error{constructor(t){super(t.evalue||t.ename);this.ename=t.ename,this.evalue=t.evalue,this.traceback=t.traceback}};var XA=class{constructor(e,t){this.controller=e;this.requestListener=t}create(e,t,n,i){return l9.fromCell(e,t,n,this.controller,this.requestListener,i)}},l9=class r{constructor(e,t,n,i,o,s){this.cell=e;this.codeOverride=t;this.kernelConnection=n;this.controller=i;this.requestListener=o;this.resumeExecution=s;this.type="cell";this._result=Re();this.cancelHandled=!1;this.disposables=[];if(a9.workspace.onDidCloseTextDocument(a=>{var l;if(a===this.cell.document){C.info(`Disposing request as the cell (${this.cell.index}) was deleted ${Ee(this.cell.notebook.uri)}`);try{(l=this.request)==null||l.dispose()}catch(u){C.error(`Error during cell execution dispose: ${u}`)}this.started&&!this._completed&&this.completedDueToCancellation()}},this,this.disposables),this.canExecuteCell())this.execution=no.getOrCreate(e,this.controller,!(s!=null&&s.msg_id)),Gf.setCellState(e,2);else{let a=no.get(e);a&&(a.start(),a.end(void 0))}}get result(){return this._result.promise}get executionOrder(){return this._executionOrder}static fromCell(e,t,n,i,o,s){return new r(e,t,n,i,o,s)}async start(e){var t,n,i,o;if(this.session=e,(t=this.resumeExecution)!=null&&t.msg_id)return this.resume(e,this.resumeExecution);if(this.cancelHandled){it(this.cell,"Not starting as it was cancelled");return}if(it(this.cell,"Start execution"),C.ci(`Cell Exec contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return e.kind==="remoteJupyter"&&e.status==="unknown"&&(!e.kernel||e.kernel.isDisposed||e.isDisposed)?((i=this.execution)==null||i.start(),(o=this.execution)==null||o.clearOutput().then(E,E),this.completedWithErrors(new Qr),this.result):this.started?(it(this.cell,"Cell has already been started yet CellExecution.Start invoked again"),C.error(`Cell has already been started yet CellExecution.Start invoked again ${this.cell.index}`),this.result):(this.started=!0,kS.set(this.cell.notebook,this.execution),Gf.setCellState(this.cell,3),this.execute(this.codeOverride||this.cell.document.getText().replace(/\r\n/g,`
`),e).catch(s=>this.completedWithErrors(s)).catch(E),this.result)}async resume(e,t){var n,i;if(this.cancelHandled){it(this.cell,"Not resuming as it was cancelled");return}if(!e.kernel)throw new Error("Kernel not available to resume execution");if(it(this.cell,"Start resuming execution"),C.ci(`Cell Exec (resuming) contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return this.started?(C.error(`Cell has already been started yet CellExecution.resume invoked again ${this.cell.index}`),this.result):(this.started=!0,kS.set(this.cell.notebook,this.execution),(i=this.execution)==null||i.start(t.startTime),t.executionCount&&this.execution&&(this.execution.executionOrder=t.executionCount),Gf.setCellState(this.cell,3),this.cellExecutionHandler=this.requestListener.registerListenerForResumingExecution(this.cell,{kernel:e.kernel,cellExecution:this.execution,msg_id:t.msg_id}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(o=>{C.error(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,o),this.completedWithErrors(o.error)},this,this.disposables),this.cellExecutionHandler.completed.finally(()=>this.completedSuccessfully()).catch(E),this.result)}async cancel(e=!1){var t;if(!this.cancelHandled){if(this.cancelRequested=!0,this.started&&!e&&((t=this.execution)!=null&&t.started)){it(this.cell,"Cell is already running, waiting for it to finish or kernel to start"),await this.result.catch(E);return}this.cancelHandled||this._completed||(it(this.cell,"Execution cancelled"),this.cancelHandled=!0,this.completedDueToCancellation(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,it(this.cell,"Execution disposed"),Ce(this.disposables))}completedWithErrors(e,t,n=!0){var i,o;if(!this.cancelHandled){if(!this.disposed&&!this.cancelRequested?C.warn("Cell completed with errors",e):C.warn(`Cell completed with errors (${this.disposed?"disposed":"cancelled"})`),it(this.cell,"Completed with errors"),n){let s,a;if(e&&!(e instanceof ot)&&((i=e.message)!=null&&i.includes("Canceled future for execute_request message before replies were done"))&&this.session&&SZ(this.session)&&(e=new Qr),e)if(!(e instanceof ot))s=e.message||e.name||e.stack;else{let l=Bm(a9.workspace.workspaceFolders||[],e,ut(this.kernelConnection),k7(this.kernelConnection.interpreter));s=l==null?void 0:l.message}a=Iy(s||""),a&&((o=this.execution)==null||o.appendOutput(a).then(E,E))}this.endCellTask("failed",t),it(this.cell,"Completed with errors, & resolving"),this._result.reject(e)}}get isEmptyCodeCell(){return this.cell.document.getText().trim().length===0}completedSuccessfully(e){it(this.cell,"Completed successfully");let t="success";this.endCellTask("success",e),it(this.cell,`Completed successfully & resolving with status = ${t}`),this._result.resolve()}endCellTask(e,t=new Date().getTime()){var n,i,o,s,a;if(!this._completed){if(this._completed=!0,this.isEmptyCodeCell)this.execution&&(this.execution.executionOrder=void 0),(n=this.execution)==null||n.end(void 0);else if(e==="success"||e==="failed")this.endTime=t,(i=this.execution)==null||i.end(e==="success",this.endTime);else{try{(o=this.request)==null||o.dispose()}catch(l){}(s=this.execution)==null||s.end(void 0)}kS.get(this.cell.notebook)===this.execution&&kS.set(this.cell.notebook,void 0),this._executionOrder=(a=this.execution)==null?void 0:a.executionOrder,Gf.setCellState(this.cell,1),this.execution=void 0}}completedDueToCancellation(){it(this.cell,"Completed due to cancellation"),this.endCellTask("cancelled"),it(this.cell,"Cell cancelled & resolving"),this._result.resolve()}canExecuteCell(){return this.cell.document.languageId==="raw"?!1:!this.cell.document.isClosed}async execute(e,t){var o,s,a,l;if(!t.kernel)throw new Error("No kernel available to execute code");if(it(this.cell,"Send code for execution"),e.trim().length===0||this.cell.document.isClosed)return e.trim().length===0&&((s=this.execution)==null||s.start((o=this.resumeExecution)==null?void 0:o.startTime),(l=(a=this.execution)==null?void 0:a.clearOutput())==null||l.then(E,E)),it(this.cell,"Empty cell execution"),this.completedSuccessfully();let n={cellId:this.cell.document.uri.toString(),...Of(this.cell).metadata},i=t.kernel;try{Mr.changeCellState(this.cell,3),C.trace(`Cell Index:${this.cell.index} sent to kernel`),this.request=i.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!0},!1,n),this.request.done.then(E,E)}catch(u){return C.error(`Cell execution failed without request, for cell Index ${this.cell.index}`,u),this.completedWithErrors(u)}this.cellExecutionHandler=this.requestListener.registerListenerForExecution(this.cell,{kernel:i,cellExecution:this.execution,request:this.request}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(u=>{C.error(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,u),this.completedWithErrors(u.error)},this,this.disposables);try{it(this.cell,"Wait for jupyter execution");let u=await this.request.done,c=new Date().getTime();it(this.cell,"Jupyter execution completed"),u.content.status==="error"?this.completedWithErrors(new $d(u.content),c,!1):this.completedSuccessfully(c),it(this.cell,"Executed successfully in executeCell")}catch(u){if(this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&C.error("Error in waiting for cell to complete",u),it(this.cell,"Some other execution error"),u&&u instanceof Error&&Yn(u,!0)?this.completedWithErrors({message:u.message}):this.completedWithErrors(u)}}};p();var CZ=require("vscode");var ZA=class{constructor(e,t,n,i){this.controller=e;this.context=t;this.formatters=n;this.notebook=i;this.disposables=[];this.messageHandlers=new WeakMap;CZ.workspace.onDidChangeNotebookDocument(o=>{o.notebook===this.notebook&&o.contentChanges.forEach(s=>s.removedCells.forEach(a=>{var l;return(l=this.messageHandlers.get(a))==null?void 0:l.dispose()}))},this,this.disposables)}dispose(){Ce(this.disposables),this.notebook&&this.notebook.getCells().forEach(e=>{var t;return(t=this.messageHandlers.get(e))==null?void 0:t.dispose()})}registerListenerForExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new _P(e,this.controller,this.context,this.formatters,t.kernel,t.request,t.cellExecution,t.request.msg.header.msg_id);return this.messageHandlers.set(e,n),n}registerListenerForResumingExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new _P(e,this.controller,this.context,this.formatters,t.kernel,void 0,t.cellExecution,t.msg_id);return this.messageHandlers.set(e,n),n}};p();p();var eM=require("vscode");function gu(r,e,t){r!==Je&&C.trace(`Execution Id:${e}. ${t}.`)}var wZ=new Map,NS=class r{constructor(e,t){this.code=e;this.extensionId=t;this.type="code";this._onDidEmitOutput=new eM.EventEmitter;this.onDidEmitOutput=this._onDidEmitOutput.event;this._onRequestSent=new eM.EventEmitter;this.onRequestSent=this._onRequestSent.event;this._onRequestAcknowledge=new eM.EventEmitter;this.onRequestAcknowledged=this._onRequestAcknowledge.event;this._done=Re();this.cancelHandled=!1;this.disposables=[];let n=wZ.get(t)||0;n+=1,wZ.set(t,n),this.executionId=`${t}-${n}`,this.disposables.push(this._onDidEmitOutput)}get done(){return this._done.promise}get result(){return this._done.promise}static fromCode(e,t){return new r(e,t)}async start(e){if(this.session=e,this.cancelHandled){gu(this.extensionId,this.executionId,"Not starting as it was cancelled");return}if(gu(this.extensionId,this.executionId,"Start Code execution"),C.ci(`Code Exec contents ${this.code.substring(0,50)}...`),!e.kernel||e.kernel.isDisposed||e.isDisposed){this._done.reject(new Qr);return}if(this.started)return gu(this.extensionId,this.executionId,"Code has already been started yet CodeExecution.Start invoked again"),C.error(`Code has already been started yet CodeExecution.Start invoked again ${this.executionId}`),this.done;await this.execute(this.code.replace(/\r\n/g,`
`),e).catch(E)}async cancel(){var e,t,n;if(!(this.cancelHandled||this._completed)){if(this.cancelRequested=!0,this.started){gu(this.extensionId,this.executionId,"Code is already running, interrupting and waiting for it to finish or kernel to start");let i=(e=this.session)==null?void 0:e.kernel;i&&this.extensionId!==Je&&await i.interrupt().catch(E),(t=this.request)==null||t.dispose(),await((n=this.request)==null?void 0:n.done.catch(E))}this.cancelHandled||this._completed||(gu(this.extensionId,this.executionId,"Execution cancelled"),this.cancelHandled=!0,this._done.resolve(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,this._completed||gu(this.extensionId,this.executionId,"Execution disposed"),Ce(this.disposables))}async execute(e,t){if(!t.kernel){let i=new Error("No kernel available to execute code");throw this._done.resolve(),i}gu(this.extensionId,this.executionId,"Send code for execution");let n=t.kernel;try{this.started=!0,this._onRequestSent.fire(),gu(this.extensionId,this.executionId,"Execution Request Sent to Kernel"),this.request=uQ(n,e,()=>this._onRequestAcknowledge.fire(),i=>this._onDidEmitOutput.fire(i)),this.request.done.then(E,E)}catch(i){C.error(`Code execution failed without request, for exec ${this.executionId}`,i),this._completed=!0,this._done.reject(i);return}try{let i=await this.request.done;this._completed=!0,i.content.status==="error"?(gu(this.extensionId,this.executionId,"Executed with errors"),this._done.reject(new $d(i.content))):(gu(this.extensionId,this.executionId,"Executed successfully"),this._done.resolve())}catch(i){if(this._completed=!0,this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&C.error(`Error in waiting for code ${this.executionId} to complete`,i),this._done.reject(i)}}};var tM=class{constructor(e,t,n,i){this.session=e;this.executionFactory=t;this.metadata=n;this.resourceUri=i;this.queueOfItemsToExecute=[];this.cancelledOrCompletedWithErrors=!1;this.startedRunningCells=!1;this.disposables=[]}get queueOfCellsToExecute(){return this.queueOfItemsToExecute.filter(e=>e.type==="cell").map(e=>e)}get isEmpty(){return this.queueOfItemsToExecute.length===0}get failed(){return this.cancelledOrCompletedWithErrors}get queue(){return this.queueOfCellsToExecute.map(e=>e.cell)}dispose(){var e;this.disposables.forEach(t=>t.dispose()),(e=this.lastCellExecution)==null||e.dispose()}queueCell(e,t){this.enqueue({cell:e,codeOverride:t})}queueCode(e,t,n){return this.enqueue({code:e,extensionId:t,token:n})}enqueue(e){let t;if("cell"in e){let{cell:n,codeOverride:i}=e,o=this.queueOfCellsToExecute.find(a=>a.cell===n);if(o)return it(n,"Use existing cell execution"),o;let s=this.executionFactory.create(n,i,this.metadata);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),it(n,"User queued cell for execution")}else{let{code:n,extensionId:i,token:o}=e,s=NS.fromCode(n,i);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),this.disposables.push(Ag(o.onCancellationRequested)(()=>s.cancel()))}return this.startExecutingCells(),t}resumeCell(e,t){if(this.queueOfCellsToExecute.find(o=>o.cell===e)){it(e,"Use existing cell execution");return}let i=this.executionFactory.create(e,"",this.metadata,t);this.disposables.push(i),this.queueOfItemsToExecute.push(i),it(e,"User queued cell for execution"),this.startExecutingCells()}async cancel(e){var t;this.cancelledOrCompletedWithErrors=!0,C.debug("Cancel pending cells"),await Promise.all(this.queueOfItemsToExecute.map(n=>n.cancel(e))),(t=this.lastCellExecution)==null||t.dispose(),this.queueOfItemsToExecute.splice(0,this.queueOfItemsToExecute.length)}async cancelQueuedCells(){var e,t;this.cancelledOrCompletedWithErrors=!0,C.debug("Cancel pending cells"),await Promise.all(this.queueOfCellsToExecute.map(n=>n.cancel())),((e=this.lastCellExecution)==null?void 0:e.type)==="cell"&&((t=this.lastCellExecution)==null||t.dispose()),this.queueOfItemsToExecute.push(...this.queueOfItemsToExecute.filter(n=>n.type==="code"))}async waitForCompletion(e){let t=e?this.queueOfCellsToExecute.filter(n=>e===n.cell):this.queueOfItemsToExecute;await Promise.all(t.map(n=>n.result))}startExecutingCells(){this.startedRunningCells||this.start().catch(E),this.startedRunningCells=!0}async start(){try{await this.executeQueuedCells()}catch(e){C.error("Failed to execute cells in CellExecutionQueue",e),this.cancelledOrCompletedWithErrors=!0,await this.cancelQueuedCells()}}async executeQueuedCells(){var n,i,o;let e,t=await this.session;for(this.queueOfItemsToExecute.forEach(s=>s.type==="cell"&&it(s.cell,"Ready to execute"));this.queueOfItemsToExecute.length;){(n=this.lastCellExecution)==null||n.dispose();let s=this.queueOfItemsToExecute[0];this.lastCellExecution=s,s.type==="cell"&&it(s.cell,"Before Execute individual cell");let a=!0;try{s.type==="cell"&&s.cell.notebook.isClosed?e=!0:s.type==="cell"&&this.cancelledOrCompletedWithErrors||(a=await s.start(t).then(()=>!0).catch(()=>!1))}finally{s.type==="cell"&&it(s.cell,`After Execute individual cell ${a}`);let u=this.queueOfItemsToExecute.indexOf(s);u>=0&&this.queueOfItemsToExecute.splice(u,1),s.type==="cell"&&Mr.changeCellState(s.cell,1,s.executionOrder)}let l=!1;if(s.type==="cell"&&((o=(i=Of(s.cell).metadata)==null?void 0:i.tags)!=null&&o.includes("raises-exception"))&&(l=!0),e||this.cancelledOrCompletedWithErrors||!a&&!l){this.cancelledOrCompletedWithErrors=!0;let u=[];if(this.cancelledOrCompletedWithErrors&&u.push("cancellation or failure in execution"),e&&u.push("Notebook being closed"),typeof a=="number"&&!a&&u.push("failure in cell execution"),u.length===0&&u.push("an unknown reason"),this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length===this.queueOfItemsToExecute.length){C.warn(`Cancel all remaining cells due to ${u.join(" or ")}`),await this.cancel();break}else if(this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length!==this.queueOfItemsToExecute.length)C.warn(`Cancel all remaining cells due to ${u.join(" or ")}`),await this.cancelQueuedCells();else if(e){C.warn(`Cancel all remaining cells due to ${u.join(" or ")}`),await this.cancel();break}}if(t.status==="dead"||t.status==="terminating"){this.cancelledOrCompletedWithErrors=!0,C.warn("Cancel all remaining cells due to dead kernel"),await this.cancel();break}}}};var rM=class{constructor(e,t,n,i){this.kernel=e;this.notebook=i;this.disposables=[];this._visibleExecutionCount=0;this.documentExecutions=new WeakMap;this._onDidReceiveDisplayUpdate=new rv.EventEmitter;this.onDidReceiveDisplayUpdate=this._onDidReceiveDisplayUpdate.event;this.hookedSesions=new WeakSet;let o=new ZA(e.controller,t,n,i);this.disposables.push(o),this.executionFactory=new XA(e.controller,o),Mr.onDidChangeNotebookCellExecutionState(s=>{var a;s.cell.notebook===e.notebook&&s.state===1&&((a=s.cell.executionSummary)!=null&&a.executionOrder)&&(this._visibleExecutionCount=Math.max(this._visibleExecutionCount,s.cell.executionSummary.executionOrder))}),e.onRestarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.onStarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.addHook("willInterrupt",this.onWillInterrupt,this,this.disposables),e.addHook("willCancel",this.onWillCancel,this,this.disposables),e.addHook("willRestart",s=>this.onWillRestart(s),this,this.disposables),e.onStatusChanged(this.hookupIOPubHandler,this,this.disposables),e.onRestarted(this.hookupIOPubHandler,this,this.disposables),this.hookupIOPubHandler()}get executionCount(){return this._visibleExecutionCount}hookupIOPubHandler(){let e=this.kernel.session;if(!e||this.hookedSesions.has(e))return;this.hookedSesions.add(e);let t=(n,i)=>{var l;if(i.header.msg_type!=="update_display_data"&&i.header.msg_type!=="display_data")return;let o=i,s=(l=o.content.transient)==null?void 0:l.display_id;if(!s||!fQ(e,s))return;let a=ls({output_type:"display_data",data:o.content.data,metadata:o.content.metadata,transient:o.content.transient});this._onDidReceiveDisplayUpdate.fire(a)};e.iopubMessage.connect(t),this.disposables.push({dispose:()=>{e==null||e.iopubMessage.disconnect(t)}})}get pendingCells(){var e;return((e=this.documentExecutions.get(this.notebook))==null?void 0:e.queue)||[]}async resumeCellExecution(e,t){if(it(e,`NotebookKernelExecution.resumeCellExecution (start), ${Ee(e.notebook.uri)}`),e.kind==rv.NotebookCellKind.Markup)return;Rr(this.kernel.resourceUri,"DATASCIENCE.RESUME_EXECUTE_CELL");let n=this.kernel.start(new pr(!1)),i=this.getOrCreateCellExecutionQueue(e.notebook,n);i.resumeCell(e,t);let o=await i.waitForCompletion(e).then(()=>!0).catch(()=>!1);it(e,`NotebookKernelExecution.resumeCellExecution (completed), ${Ee(e.notebook.uri)}`),C.trace(`Cell ${e.index} executed ${o?"successfully":"with an error"}`)}async executeCell(e,t){it(e,`NotebookKernelExecution.executeCell (1), ${Ee(e.notebook.uri)}`);let n=new yt;if(e.kind==rv.NotebookCellKind.Markup)return;it(e,`NotebookKernelExecution.executeCell (2), ${Ee(e.notebook.uri)}`);let i=this.kernel.restarting.then(()=>this.kernel.start(new pr(!1)));it(e,`NotebookKernelExecution.executeCell (3), ${Ee(e.notebook.uri)}`),await i;let o=this.getOrCreateCellExecutionQueue(e.notebook,i);o.queueCell(e,t);let s=!0;try{it(e,`NotebookKernelExecution.executeCell (4), ${Ee(e.notebook.uri)}`),await o.waitForCompletion(e)}catch(a){throw s=!1,a}finally{it(e,`NotebookKernelExecution.executeCell completed (5), ${Ee(e.notebook.uri)}`),C.trace(`Cell ${e.index} executed ${s?"successfully":"with an error"}`),Rr(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CELL",{duration:n.elapsedTime})}}async*executeCode(e,t,n,i){let o=new yt,s;if(t===Je||t===mD){let f=this.kernel.restarting.then(()=>this.kernel.start(new pr(!0)));s=NS.fromCode(e,t),f.then(m=>s.start(m))}else{let f=this.kernel.restarting.then(()=>this.kernel.start(new EA(!1,this.kernel.isPostInitializedInProgress)));s=this.getOrCreateCellExecutionQueue(this.notebook,f).queueCode(e,t,i)}t!==Je&&C.trace(`Queue code ${s.executionId} from ${t} after ${o.elapsedTime}ms:
${e}`);let a=!1,l=[];s.result.finally(()=>{a=!0,!i.isCancellationRequested&&C.debug(`Execution of code ${s.executionId} completed in ${o.elapsedTime}ms`),t!==Je&&Rr(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CODE",{duration:o.elapsedTime},{extensionId:t}),Ce(l)}).catch(E);let u=La(s.result),c=[],d=Re();for(l.push(s.onRequestSent(()=>n.started.fire())),l.push(s.onRequestAcknowledged(()=>n.executionAcknowledged.fire())),s.onDidEmitOutput(f=>{c.push(f),d.resolve(),d=Re()},this,l),i.onCancellationRequested(()=>{a||C.debug(`Code execution cancelled by extension ${t}`)},this,l);;){await Promise.race([d.promise,u.promise]),a&&(d=Re());let f=this.kernel.session;for(;c.length;){let m=c.shift();f&&ER(t,f,m),yield m}if(u.completed)break}}executeHidden(e){return this.kernel.start().then(n=>n.kernel?Ai(n.kernel,e):Promise.reject(new Qr))}async onWillInterrupt(){let e=this.documentExecutions.get(this.notebook);!e&&this.kernel.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||(C.info("Interrupt kernel execution"),e&&(await e.cancel(),await e.waitForCompletion().catch(E)))}async onWillCancel(){let e=this.documentExecutions.get(this.notebook);e&&await e.cancel(!0)}async onWillRestart(e){let t=this.documentExecutions.get(this.notebook),n=e?await e.catch(()=>{}):void 0,i=t?t.cancel(!0).then(()=>t.waitForCompletion().catch(E)):Promise.resolve();n||(C.info("No kernel session to interrupt"),await i)}getOrCreateCellExecutionQueue(e,t){let n=this.documentExecutions.get(e);if(n&&!n.isEmpty&&!n.failed)return n;let i=new tM(t,this.executionFactory,this.kernel.kernelConnectionMetadata,this.kernel.resourceUri);return this.disposables.push(i),rv.workspace.onDidCloseNotebookDocument(async o=>{o===e&&(C.debug(`Cancel executions after closing notebook ${Ee(o.uri)}`),(!i.failed||!i.isEmpty)&&await i.cancel(!0))},this,this.disposables),this.documentExecutions.set(e,i),i}};var RS=class extends jA{constructor(t,n,i,o,s,a,l,u,c){super(t,n);this.sessionCreator=i;this.configService=o;this.context=s;this.formatters=l;this.startupCodeProviders=u;this.workspaceStorage=c;n.push(a.onDidRemove(this.handleServerRemoval.bind(this)))}getOrCreate(t,n){var u;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;i&&C.trace(`Kernel for ${Ee(t.uri)} with id ${i.options.metadata.id} is being replaced with ${n.metadata.id}`),this.disposeOldKernel(t,"createNewKernel");let o=(t==null?void 0:t.notebookType)===vr?n.resourceUri:t.uri,s=o9(this.configService,o),a=t.uri.path.endsWith(".interactive")||(u=n.resourceUri)!=null&&u.path.endsWith(".interactive")?vr:St,l=new YA(o,t,n.metadata,this.sessionCreator,s,n.controller,this.startupCodeProviders.getProviders(a),this.workspaceStorage);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onPostInitialized(c=>c.waitUntil(this._onDidPostInitializeKernel.fireAsync({kernel:l},c.token)),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(c=>this._onKernelStatusChanged.fire({kernel:l,status:c}),this,this.disposables),this.executions.set(l,new rM(l,this.context,this.formatters,t)),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(l),l}};RS=U([(0,mn.injectable)(),x(0,(0,mn.inject)(Vu)),x(1,(0,mn.inject)(ve)),x(2,(0,mn.inject)(zx)),x(3,(0,mn.inject)(Ke)),x(4,(0,mn.inject)(st)),x(5,(0,mn.inject)(dr)),x(6,(0,mn.multiInject)(xI)),x(7,(0,mn.inject)(Od)),x(8,(0,mn.inject)(Et)),x(8,(0,mn.named)(_s))],RS);var AS=class extends BA{constructor(t,n,i,o,s,a){super(t,n);this.sessionCreator=i;this.configService=o;this.startupCodeProviders=s;this.workspaceStorage=a}getOrCreate(t,n){var u;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;this.disposeOldKernel(t);let o=t,s=o9(this.configService,o),a=t.path.endsWith(".interactive")||(u=n.resourceUri)!=null&&u.path.endsWith(".interactive")?vr:St,l=new GA(t,o,n.metadata,this.sessionCreator,s,this.startupCodeProviders.getProviders(a),this.workspaceStorage);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onPostInitialized(c=>c.waitUntil(this._onDidPostInitializeKernel.fireAsync({kernel:l},c.token)),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(c=>this._onKernelStatusChanged.fire({kernel:l,status:c}),this,this.disposables),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(t,l),l}};AS=U([(0,mn.injectable)(),x(0,(0,mn.inject)(Vu)),x(1,(0,mn.inject)(ve)),x(2,(0,mn.inject)(zx)),x(3,(0,mn.inject)(Ke)),x(4,(0,mn.inject)(Od)),x(5,(0,mn.inject)(Et)),x(5,(0,mn.named)(_s))],AS);p();var nM=oe(he()),OS=require("vscode");var MS=class extends Pr{constructor(t){super();this._onDidChangeRegistrations=this._register(new OS.EventEmitter);this.onDidChangeRegistrations=this._onDidChangeRegistrations.event;this._finders=[];this.connectionFinderMapping=new Map;this._onDidChangeKernels=this._register(new OS.EventEmitter);this.onDidChangeKernels=this._onDidChangeKernels.event;this._status="idle";this._onDidChangeStatus=this._register(new OS.EventEmitter);t.push(this),this._register(this._onDidChangeStatus),this._register(this._onDidChangeRegistrations)}get status(){return this._status}set status(t){this._status!=t&&(this._status=t,this._onDidChangeStatus.fire())}get onDidChangeStatus(){return this._onDidChangeStatus.event}registerKernelFinder(t){this._finders.push(t);let n=()=>{this.status=this._finders.every(s=>s.status==="idle")?"idle":"discovering"};n();let i=this._register(new En),o=()=>{let s=this._finders.findIndex(a=>a===t);s>=0&&this._finders.splice(s,1),i.dispose(),n(),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[],removed:[t]})};return i.add(t.onDidChangeStatus(n,this)),i.add(t.onDidChangeKernels(()=>this._onDidChangeKernels.fire())),i.add(t.onDidDispose(()=>o())),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[t],removed:[]}),new OS.Disposable(()=>o())}get kernels(){let t=[];this.connectionFinderMapping.clear();let n=new Set;this._finders.filter(o=>o.kind==="localPythonEnvironment").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.add(s.kernelSpec.specFile),t.push(s),this.connectionFinderMapping.set(s.id,o)})}),this._finders.filter(o=>o.kind==="localKernelSpec").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.has(s.kernelSpec.specFile)||(t.push(s),this.connectionFinderMapping.set(s.id,o))})});let i=this._finders.filter(o=>o.kind==="remote");for(let o of i){let s=o.kernels;s.forEach(a=>{this.connectionFinderMapping.set(a.id,o)}),t.push(...s)}return t}getFinderForConnection(t){return this.connectionFinderMapping.get(t.id)}get registered(){return this._finders}};MS=U([(0,nM.injectable)(),x(0,(0,nM.inject)(ve))],MS);p();var nv=oe(he());var c9="Active_Kernel_Id_List",r_e=100,js=class{constructor(e,t){this.globalMemento=e;this.crypto=t}async getPreferredRemoteKernelId(e){let t=this.globalMemento.get(c9,[]);if(t.length){let n=e.uri,i=await this.crypto.createHash(n.toString()),o=t.find(s=>s.fileHash===i);return C.trace(`Preferred Remote kernel for ${Ee(n)} is ${o==null?void 0:o.kernelId}`),o==null?void 0:o.kernelId}}async clearPreferredRemoteKernelId(e){await this.updatePreferredRemoteKernelIdInternal(e)}async storePreferredRemoteKernelId(e,t){await this.updatePreferredRemoteKernelIdInternal(e,t)}async updatePreferredRemoteKernelIdInternal(e,t){let n=!1,i=JSON.parse(JSON.stringify(this.globalMemento.get(c9,[]))),o=await this.crypto.createHash(e.toString()),s=i.findIndex(a=>a.fileHash===o);for(s>=0&&(n=!0,i.splice(s,1)),t&&(n=!0,i.push({fileHash:o,kernelId:t}),C.trace(`Storing Preferred remote kernel for ${Ee(e)} is ${t}`));i.length>r_e;)n=!0,i.shift();n&&await this.globalMemento.update(c9,i)}};js=U([(0,nv.injectable)(),x(0,(0,nv.inject)(Et)),x(0,(0,nv.named)(rr)),x(1,(0,nv.inject)(dy))],js);p();var Oi=Symbol("IJupyterVariables"),iM=Symbol("IKernelVariableRequester"),oM=Symbol("IJupyterVariablesProvider");p();var Qd=oe(he()),xZ=require("vscode");var iv=class{constructor(e,t,n){this.kernelVariables=t;this.debuggerVariables=n;this.refreshEventEmitter=new xZ.EventEmitter;e.push(n.refreshRequired(this.fireRefresh.bind(this))),e.push(t.refreshRequired(this.fireRefresh.bind(this)))}get refreshRequired(){return this.refreshEventEmitter.event}getAllVariableDiscriptions(e,t,n,i){return this.variableHandler.getAllVariableDiscriptions(e,t,n,i)}async getVariables(e,t){return this.variableHandler.getVariables(e,t)}async getFullVariable(e,t){return this.variableHandler.getFullVariable(e,t)}async getMatchingVariable(e,t,n){return this.variableHandler.getMatchingVariable(e,t,n)}async getDataFrameInfo(e,t,n,i){return this.variableHandler.getDataFrameInfo(e,t,n,i)}async getVariableValueSummary(e,t,n){return this.variableHandler.getVariableValueSummary(e,t,n)}async getDataFrameRows(e,t,n,i,o){return this.variableHandler.getDataFrameRows(e,t,n,i,o)}get variableHandler(){return this.debuggerVariables.active?this.debuggerVariables:this.kernelVariables}fireRefresh(){this.refreshEventEmitter.fire()}};U([Nr("DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME")],iv.prototype,"getVariables",1),iv=U([(0,Qd.injectable)(),x(0,(0,Qd.inject)(ve)),x(1,(0,Qd.inject)(Oi)),x(1,(0,Qd.named)(nt.KERNEL_VARIABLES)),x(2,(0,Qd.inject)(Oi)),x(2,(0,Qd.named)(nt.DEBUGGER_VARIABLES))],iv);p();var ov=oe(he()),Xd=require("vscode");var LS=class{constructor(e,t,n,i){this.disposableRegistry=e;this.kernelProvider=t;this.serverUriStorage=n;this.jupyterUriProviderRegistration=i;this.kernelsStartedSuccessfully=new WeakSet;this.kernelDisposables=new WeakMap;this.kernelConnectionToKernelMapping=new WeakMap;this.kernelsRestarting=new WeakSet;this.kernelReconnectProgress=new WeakMap;this.lastExecutedCellPerKernel=new WeakMap}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry),this.disposableRegistry.push(this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.kernelDisposables.get(e))==null||t.dispose(),this.kernelDisposables.delete(e),(n=this.kernelReconnectProgress.get(e))==null||n.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(this.kernelProvider.onDidRestartKernel(e=>{var t;(t=this.kernelReconnectProgress.get(e))==null||t.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(Mr.onDidChangeNotebookCellExecutionState(e=>{if(!hr(e.cell.notebook)||e.state!==1)return;let t=this.kernelProvider.get(e.cell.notebook);!t||this.lastExecutedCellPerKernel.get(t)!==e.cell||this.lastExecutedCellPerKernel.delete(t)}))}getKernelSpecificDisposables(e){let t=this.kernelDisposables.get(e)||new En;return this.disposableRegistry.push(t),this.kernelDisposables.set(e,t),t}onDidStartKernel(e){var n,i,o;if(this.kernelsStartedSuccessfully.has(e)||!((n=e.session)!=null&&n.kernel))return;let t=this.getKernelSpecificDisposables(e);t.add(Mr.onDidChangeNotebookCellExecutionState(s=>{s.cell.notebook===e.notebook&&this.kernelProvider.get(s.cell.notebook)===e&&s.state===3&&this.lastExecutedCellPerKernel.set(e,s.cell)},this)),this.kernelsStartedSuccessfully.add(e),this.kernelConnectionToKernelMapping.set(e.session.kernel,e),(o=(i=e.session)==null?void 0:i.kernel)==null||o.connectionStatusChanged.connect(this.onKernelStatusChanged,this),t.add(e.addHook("willRestart",async()=>{var s;(s=this.kernelReconnectProgress.get(e))==null||s.dispose(),this.kernelReconnectProgress.delete(e),this.kernelsRestarting.add(e)},this)),t.add(e.onRestarted(()=>this.kernelsRestarting.delete(e),this))}onKernelStatusChanged(e,t){var i,o,s,a;let n=this.kernelConnectionToKernelMapping.get(e);if(n&&!this.kernelsRestarting.has(n))switch(t){case"connected":{(i=this.kernelReconnectProgress.get(n))==null||i.dispose(),this.kernelReconnectProgress.delete(n);return}case"disconnected":{this.kernelReconnectProgress.has(n)&&((o=this.kernelReconnectProgress.get(n))==null||o.dispose(),this.kernelReconnectProgress.delete(n),(s=this.onKernelDisconnected(n))==null||s.catch(E));return}case"connecting":this.kernelReconnectProgress.has(n)||(a=this.onKernelConnecting(n))==null||a.catch(E);return;default:return}}async onKernelConnecting(e){let t=this.getKernelSpecificDisposables(e),n=Re(),i=new Xd.Disposable(()=>n.resolve());if(this.kernelReconnectProgress.set(e,i),Wt(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata))return;let o=W.automaticallyReconnectingToAKernelProgressMessage(ut(e.kernelConnectionMetadata));Xd.window.withProgress({location:Xd.ProgressLocation.Notification,title:o},async()=>n.promise).then(E,E),t.add(i)}async onKernelDisconnected(e){var n;if(e.disposed||e.disposing||(Rr(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),Wt(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata)))return;let t=Qt(e.kernelConnectionMetadata)?W.kernelDisconnected(ut(e.kernelConnectionMetadata)):W.remoteJupyterConnectionFailedWithServer(e.kernelConnectionMetadata.baseUrl);Xd.window.showErrorMessage(t).then(E,E);try{let i=this.lastExecutedCellPerKernel.get(e);if(!i||i.document.isClosed||i.notebook.isClosed||((n=i.executionSummary)==null?void 0:n.success)===!1)return;await Ld(i,e.controller,t,!1)}finally{await e.dispose()}}async handleRemoteServerShutdown(e,t){var o;let n=this.jupyterUriProviderRegistration.jupyterCollections.find(s=>s.extensionId===t.serverProviderHandle.extensionId&&s.id===t.serverProviderHandle.id);if(!n)return!1;let i=new Xd.CancellationTokenSource;try{return(await Promise.resolve(n.serverProvider.provideJupyterServers(i.token))||[]).map(l=>l.id).includes(t.serverProviderHandle.handle)?!1:(await this.serverUriStorage.remove(t.serverProviderHandle),(o=this.kernelReconnectProgress.get(e))==null||o.dispose(),this.kernelReconnectProgress.delete(e),!0)}catch(s){return!1}finally{i.dispose()}}};LS=U([(0,ov.injectable)(),x(0,(0,ov.inject)(ve)),x(1,(0,ov.inject)(qe)),x(2,(0,ov.inject)(dr)),x(3,(0,ov.inject)(sr))],LS);p();var PZ=oe(he());var KS=class{isTrusted(e){return!0}};KS=U([(0,PZ.injectable)()],KS);p();var FS=Symbol("ITrustedKernelPaths");p();var EP=oe(he());var DZ=require("vscode");var US=class{constructor(e,t){this.kernelProvider=e;this.disposables=[];this.restartProgress=new WeakMap;this.interruptProgress=new WeakMap;t.push(this)}dispose(){Ce(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables)}onDidCreateKernel(e){e.addHook("willRestart",async()=>{var n;(n=this.restartProgress.get(e))==null||n.dispose();let t=Kt.createProgressReporter(e.resourceUri,W.restartingKernelStatus(`: ${ut(e.kernelConnectionMetadata)}`));this.restartProgress.set(e,t)},this,this.disposables),e.addHook("restartCompleted",async()=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables),e.addHook("willInterrupt",async()=>{let t=new En,n=setTimeout(()=>{t.isDisposed||t.add(Kt.createProgressReporter(e.resourceUri,W.interruptKernelStatus(ut(e.kernelConnectionMetadata))))},1e3);t.add(new DZ.Disposable(()=>clearTimeout(n))),this.interruptProgress.set(e,t)},this,this.disposables),e.addHook("interruptCompleted",async()=>{var t;return(t=this.interruptProgress.get(e))==null?void 0:t.dispose()},this,this.disposables)}};US=U([(0,EP.injectable)(),x(0,(0,EP.inject)(qe)),x(1,(0,EP.inject)(ve))],US);p();var CP=oe(he()),u9=require("vscode");var WS=class{constructor(e,t){this.kernelFinder=t;this.disposables=[];e.push(this)}dispose(){Ce(this.disposables)}activate(){this.startRefresh()}startRefresh(){if(!this.refreshedOnceBefore){if(this.kernelFinder.status==="discovering")return this.displayProgressIndicator();this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="discovering"&&this.displayProgressIndicator()},this,this.disposables)}}displayProgressIndicator(){let e=Date.now().toString();C.debug(`Start refreshing Kernel Picker (${e})`);let t=u9.notebooks.createNotebookControllerDetectionTask(St),n=u9.notebooks.createNotebookControllerDetectionTask(vr);this.disposables.push(t),this.disposables.push(n),this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="idle"&&(C.debug(`End refreshing Kernel Picker (${e})`),t.dispose(),n.dispose())},this,this.disposables)}};WS=U([(0,CP.injectable)(),x(0,(0,CP.inject)(ve)),x(1,(0,CP.inject)(ii))],WS);p();var jS=oe(he());var n_e=1e3,VS=class{constructor(e,t,n){this.serverStorage=e;this.kernelProvider=t;this.disposables=[];this.timeouts=new Set;this.kernelSpecificUpdates=new WeakMap;n.push(this)}dispose(){Ce(this.disposables),Ce(Array.from(this.timeouts.values()))}activate(){this.disposables.push(Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this))}onDidChangeNotebookCellExecutionState(e){let t=this.kernelProvider.get(e.cell.notebook);if(!t)return;let n=t.kernelConnectionMetadata;if(!Wt(n))return;let i=this.kernelSpecificUpdates.get(t)||new rc(n_e);this.kernelSpecificUpdates.set(t,i),i.trigger(()=>{t.disposed||t.disposing||this.serverStorage.update(n.serverProviderHandle).catch(E)})}};VS=U([(0,jS.injectable)(),x(0,(0,jS.inject)(dr)),x(1,(0,jS.inject)(qe)),x(2,(0,jS.inject)(ve))],VS);p();var TZ=oe(he());var BS=class{async installMissingDependencies(e){return 1}async areDependenciesInstalled(e,t,n){return!1}};BS=U([(0,TZ.injectable)()],BS);p();var kZ=oe(he());var HS=class{constructor(){this.providers=new Map}getProviders(e){return(this.providers.get(e)||[]).slice()}register(e,t){this.providers.set(t,this.providers.get(t)||[]),this.providers.get(t).push(e)}};HS=U([(0,kZ.injectable)()],HS);p();var sv=oe(he());var RZ=require("vscode");var NZ=1e3*60*60*24*2,Wl=class extends Pr{constructor(t,n,i,o){super();this.serverStorage=n;this.context=i;this.fs=o;this.executedCells=new WeakMap;this.chainedPromises=Promise.resolve();i.globalStorageUri,t.push(this),this.storageFile=RZ.Uri.joinPath(this.context.globalStorageUri,"lastExecutedRemoteCell.json")}activate(){this._register(this.serverStorage.onDidRemove(this.onDidRemoveServers,this))}async getLastTrackedCellExecution(t,n){var s;if(t.isUntitled||!Wt(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;if(this.staleState&&this.staleState[t.uri.toString()])return this.staleState[t.uri.toString()];let i=await this.getStorageFile(),o={};try{let a=await this.fs.readFile(i);o=JSON.parse(a.toString()),this.staleState=o}catch(a){return}return o[t.uri.toString()]}trackCellExecution(t,n){if(!Wt(n.kernelConnectionMetadata)||t.document.isUntitled)return;this.executedCells.delete(t);let i=[],o=(a,l)=>{var u,c;if(l.direction==="send"){let d=l.msg;if(d.header.msg_type==="execute_request"&&d.metadata&&typeof d.metadata=="object"&&d.metadata&&"cellId"in d.metadata&&typeof d.metadata.cellId=="string"&&d.metadata.cellId===t.document.uri.toString()){let f=d.header.msg_id;this.executedCells.set(t,{msg_id:f,kernelId:((c=(u=n.session)==null?void 0:u.kernel)==null?void 0:c.id)||"",cellIndex:t.index})}}else if(l.direction==="recv"){let d=l.msg,f=this.executedCells.get(t);if(f!=null&&f.msg_id&&Yd(d)===f.msg_id){if(!f.startTime){f.startTime=new Date().getTime();try{f.startTime=new Date(d.header.date).getTime()}catch(m){}this.executedCells.set(t,f)}"execution_count"in d.content&&typeof d.content.execution_count=="number"&&!f.executionCount&&f.executionCount!==d.content.execution_count&&(f.executionCount=d.content.execution_count,this.executedCells.set(t,f),this.trackLastExecution(t,n,f),Ce(i))}}},s=()=>{let a=n.session;a&&(a.anyMessage.connect(o),i.push({dispose:()=>zs(()=>{var l;return(l=a.anyMessage)==null?void 0:l.disconnect(o)})}))};n.onStarted(()=>s(),i),n.session&&s()}deleteTrackedCellExecution(t,n){var i;t.notebook.isUntitled||!Wt(n.kernelConnectionMetadata)||!((i=n.session)!=null&&i.id)||(this.chainedPromises=this.chainedPromises.finally(async()=>{let o={};try{let a=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));o=JSON.parse(a.toString())}catch(a){return}let s=t.notebook.uri.toString();o[s].cellIndex===t.index&&(delete o[s],this.staleState=o,await this.fs.writeFile(this.storageFile,JSON.stringify(o)))}))}getStorageFile(){return this.ensureStorageExistsPromise=this.ensureStorageExistsPromise||(async()=>(await this.fs.createDirectory(this.context.globalStorageUri),this.storageFile))(),this.ensureStorageExistsPromise}trackLastExecution(t,n,i){var s,a,l,u;if(!i.executionCount||!i.msg_id||!i.startTime||!Wt(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;let o={cellIndex:t.index,executionCount:i.executionCount,kernelId:((l=(a=n.session)==null?void 0:a.kernel)==null?void 0:l.id)||"",msg_id:i.msg_id,serverId:Vt(n.kernelConnectionMetadata.serverProviderHandle),sessionId:(u=n.session)==null?void 0:u.id,startTime:i.startTime};this.chainedPromises=this.chainedPromises.finally(async()=>{let c={};try{let f=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));c=JSON.parse(f.toString())}catch(f){}let d=t.notebook.uri.toString();c[d]=o,this.removeOldItems(c),this.staleState=c,await this.fs.writeFile(this.storageFile,JSON.stringify(c))})}onDidRemoveServers(t){t.length!==0&&(this.chainedPromises=this.chainedPromises.finally(async()=>{await this.getStorageFile();let n={};try{let s=await this.fs.readFile(this.storageFile);n=JSON.parse(s.toString())}catch(s){}let i=!1,o=new Set(t.map(s=>Vt(s)));Object.keys(n).forEach(s=>{let a=n[s];(o.has(a.serverId)||Date.now()-a.startTime>NZ)&&(delete n[s],i=!0)}),i&&(this.removeOldItems(n),this.staleState=n,await this.fs.writeFile(this.storageFile,JSON.stringify(n)))}))}removeOldItems(t){Object.keys(t).forEach(n=>{let i=t[n];i&&Date.now()-i.startTime>NZ&&delete t[n]})}};Wl=U([(0,sv.injectable)(),x(0,(0,sv.inject)(ve)),x(1,(0,sv.inject)(dr)),x(2,(0,sv.inject)(st)),x(3,(0,sv.inject)(Pt))],Wl);p();var JS=oe(he());var wP=require("vscode");var qS=class{constructor(e,t,n){this.serverUriStorage=e;this.registrations=t;this.disposables=n}activate(){this.disposables.push(wP.commands.registerCommand(le.ClearSavedJupyterUris,async()=>{await this.serverUriStorage.clear().catch(E),await Promise.all(this.registrations.jupyterCollections.filter(e=>e.id.startsWith("_builtin")||e.extensionId===Je).map(async e=>{if(!e.serverProvider||!e.serverProvider.removeJupyterServer)return;let t=new wP.CancellationTokenSource,n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await Promise.all((n||[]).map(i=>e.serverProvider.removeJupyterServer(i).catch(E)))})).catch(E),await wP.commands.executeCommand("dataScience.ClearUserProviderJupyterServerCache").then(E,E)},this))}};qS=U([(0,JS.injectable)(),x(0,(0,JS.inject)(dr)),x(1,(0,JS.inject)(sr)),x(2,(0,JS.inject)(ve))],qS);p();var sM=oe(he());var GS=class{constructor(e){this.registry=e;this.priority=0}activate(){this.registry.register(this,St),this.registry.register(this,vr)}async getCode(e){return jt(e.kernelConnectionMetadata)?[dQ]:[]}};GS=U([(0,sM.injectable)(),x(0,(0,sM.inject)(Od))],GS);var xP=class{constructor(){this.isSupported=!1}};xP=U([(0,AZ.injectable)()],xP);function MZ(r,e){r.addSingleton(qd,xP),Xb("isInsiderExtension",jv()?"true":"false");let t=r.get(vo);Xb("isPythonExtensionInstalled",t.isPythonExtensionInstalled?"true":"false");let n=r.get(qd);Xb("rawKernelSupported",n.isSupported?"true":"false"),r.addSingleton(Od,HS),r.addSingleton(Oi,iv,nt.ALL_VARIABLES),r.addSingleton(Ve,zg),r.addSingleton(Ve,WS),r.addSingleton(Ve,US),r.addSingleton(Ve,LS),r.addSingleton(Ve,VS),r.addSingleton(qe,RS),r.addSingleton(FS,KS),r.addSingleton(jg,AS),r.addSingleton(js,js),r.addSingleton(ii,MS),r.addSingleton(wI,BS),r.addSingleton(Ve,qS),r.addSingleton(Wl,Wl),r.addBinding(Wl,Ve),vZ(r,e),r.addSingleton(Ve,nn),r.addSingleton(Ve,GS)}p();p();var YS=oe(he()),lv=require("vscode");var av=class{constructor(e,t,n){this.disposables=e;this.controllerRegistration=t;this.preferredRemoteKernelIdProvider=n}activate(){lv.workspace.onDidOpenNotebookDocument(this.onDidOpenNotebook,this,this.disposables),lv.workspace.notebookDocuments.forEach(e=>this.onDidOpenNotebook(e))}async onDidOpenNotebook(e){if(!hr(e))return;let t=await this.preferredRemoteKernelIdProvider.getPreferredRemoteKernelId(e);if(!t)return;let n=()=>{let o=this.controllerRegistration.getSelected(e),s=this.controllerRegistration.registered.find(a=>a.id===t);return s&&(o==null?void 0:o.id)!==s.id?(this.switchKernel(e,s.connection).catch(E),!0):!1};if(n())return;let i=this.controllerRegistration.onDidChange(o=>{o.added.length&&n()&&i.dispose()},this,this.disposables);this.controllerRegistration.onControllerSelected(o=>{o.notebook===e&&i.dispose()},this,this.disposables)}async switchKernel(e,t){C.debug(`Using notebook.selectKernel to force remote kernel for ${Ee(e.uri)} to ${t.id}`),await lv.commands.executeCommand("notebook.selectKernel",{id:t.id,extension:Je}),await vD(async()=>{var i;if(((i=lv.window.activeNotebookEditor)==null?void 0:i.notebook)===e){let o=this.controllerRegistration.getSelected(e);if((o==null?void 0:o.connection.id)===t.id)return o.restoreConnection(e).catch(E),!0}return!1},2e3,100)?C.debug(`Successfully switched remote kernel for ${Ee(e.uri)} to ${t.id}`):C.warn(`Failed to switch remote kernel for ${Ee(e.uri)} to ${t.id}`)}};U([gn()],av.prototype,"onDidOpenNotebook",1),av=U([(0,YS.injectable)(),x(0,(0,YS.inject)(ve)),x(1,(0,YS.inject)(Nt)),x(2,(0,YS.inject)(js))],av);p();var $S=oe(he()),fm=require("vscode");p();var OZ=Symbol("IServiceManager"),Ar=Symbol("IServiceContainer");p();var ms=require("vscode");p();function vu(r){if(typeof r!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof r}\``);var e=KZ();let t=e;return t.default&&(t=t.default),r.replace(t(),"")}p();p();var DP=oe(he()),h9=require("vscode");p();var f9=oe(Zg()),m9=require("vscode");p();function d9(r){if(!r||!Array.isArray(r)||r.length===0)return;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=Array.apply(null,new Uint8Array(n.buffer));e.push({...n,byteLength:n.byteLength,byteOffset:n.byteOffset,buffer:i})}else e.push([...new Uint8Array(n)])}return e}function p9(r){if(!Array.isArray(r)||r.length===0)return r;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=new Uint8Array(n.buffer).buffer,o=new DataView(i,n.byteOffset,n.byteLength);e.push(o)}else{let i=new Uint8Array(n).buffer;e.push(i)}}return e}var PP=new WeakMap;function FZ(r,e){let t=PP.get(r);t&&(t.targets.add(e),t.registerCommTarget(e))}function UZ(r,e){var t,n,i;(i=(n=(t=PP.get(r))==null?void 0:t.targets)==null?void 0:n.delete)==null||i.call(n,e)}var aM=class{constructor(e,t){this.kernelProvider=e;this.document=t;this.commTargetsRegistered=new Set;this.pendingTargetNames=new Set;this._postMessageEmitter=new m9.EventEmitter;this._onDisplayMessage=new m9.EventEmitter;this.onDisplayMessage=this._onDisplayMessage.event;this.messageHooks=new Map;this.pendingHookRemovals=new Map;this.messageHookRequests=new Map;this.disposables=[];this.disposed=!1;this.pendingMessages=[];this.subscribedToKernelSocket=!1;this.waitingMessageIds=new Map;this.outputWidgetIds=new Set;this.isUsingIPyWidgets=!1;this.kernelSocketHandlers=new WeakMap;this.pendingTargetNames.add("jupyter.widget"),e.onDidStartKernel(i=>{i.notebook===t&&this.initialize()},this,this.disposables),this.mirrorSend=this.mirrorSend.bind(this),this.onKernelSocketMessage=this.onKernelSocketMessage.bind(this);let n=iV();this.deserialize=n.deserialize}get postMessage(){return this._postMessageEmitter.event}dispose(){for(this.disposed=!0;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}receiveMessage(e){switch(e.message){case"IPyWidgets_logMessage":{let t=e.payload;t.category==="error"?C.error(`Widget Error: ${t.message}`):C.trace(`Widget Message: ${t.message}`);break}case"IPyWidgets_Ready":this.sendKernelOptions(),this.initialize();break;case"IPyWidgets_msg":this.sendRawPayloadToKernelSocket(e.payload);break;case"IPyWidgets_binary_msg":this.sendRawPayloadToKernelSocket(p9(e.payload)[0]);break;case"IPyWidgets_msg_received":this.onKernelSocketResponse(e.payload);break;case"IPyWidgets_registerCommTarget":this.registerCommTarget(e.payload);break;case"IPyWidgets_RegisterMessageHook":this.registerMessageHook(e.payload);break;case"IPyWidgets_RemoveMessageHook":this.possiblyRemoveMessageHook(e.payload);break;case"IPyWidgets_MessageHookResult":this.handleMessageHookResponse(e.payload);break;case"IPyWidgets_iopub_msg_handled":this.iopubMessageHandled(e.payload);break;default:break}}sendRawPayloadToKernelSocket(e){this.pendingMessages.push(e),this.sendPendingMessages()}registerCommTarget(e){this.pendingTargetNames.add(e),this.initialize()}initialize(){this.jupyterLab||(this.jupyterLab=Jn());let e=this.getKernel();e&&(this.subscribeToKernelSocket(e),this.registerCommTargets(e))}raisePostMessage(e,t){this._postMessageEmitter.fire({message:e,payload:t})}subscribeToKernelSocket(e){var n;if(this.subscribedToKernelSocket||!e.session)return;this.subscribedToKernelSocket=!0,this.subscribeToKernelSocketImpl(e);let t=(n=e.session.kernel)==null?void 0:n.id;e.session.onDidKernelSocketChange(()=>{var i,o;this.subscribeToKernelSocketImpl(e,t),t=((o=(i=e.session)==null?void 0:i.kernel)==null?void 0:o.id)||""})}subscribeToKernelSocketImpl(e,t){var l,u,c,d,f;let n=t?Oo.get(t):void 0,i=n?this.kernelSocketHandlers.get(n):void 0;if(i!=null&&i.receiveHook&&(n==null||n.removeReceiveHook(i.receiveHook)),i!=null&&i.sendHook&&(n==null||n.removeSendHook(i.sendHook)),this.kernelWasConnectedAtLeastOnce){for(;this.pendingMessages.length;)this.pendingMessages.shift();this.waitingMessageIds.forEach(m=>m.resultPromise.resolve()),this.waitingMessageIds.clear(),this.messageHookRequests.forEach(m=>m.resolve(!1)),this.messageHookRequests.clear(),this.messageHooks.clear(),this.sendRestartKernel()}if(!((u=(l=e.session)==null?void 0:l.kernel)!=null&&u.id)||!Oo.get((d=(c=e.session)==null?void 0:c.kernel)==null?void 0:d.id))return;PP.has(e.session.kernel)||PP.set(e.session.kernel,{targets:new Set,registerCommTarget:m=>{this.raisePostMessage("IPyWidgets_registerCommTarget",m)}}),this.kernelWasConnectedAtLeastOnce=!0;let o=(f=e.session.kernel)==null?void 0:f.id,s=o?Oo.get(o):void 0,a=(s==null?void 0:s.protocol)||"";if(s){let m=this.onKernelSocketMessage.bind(this,a),g=this.mirrorSend.bind(this,a);s.addReceiveHook(m),s.addSendHook(g),this.kernelSocketHandlers.set(s,{receiveHook:m,sendHook:g})}this.sendKernelOptions(a),this.registerCommTargets(e),this.sendPendingMessages(a)}sendKernelOptions(e=""){var n,i,o;let t=(i=(n=this.kernel)==null?void 0:n.session)==null?void 0:i.kernel;t&&(e||(e=((o=Oo.get(t.id))==null?void 0:o.protocol)||""),this.raisePostMessage("IPyWidgets_kernelOptions",{id:t.id,clientId:t.clientId||"",userName:t.username||"",model:t.model||{id:"",name:""},protocol:e}))}async mirrorSend(e,t,n){if(typeof t=="string"&&t.includes("shell")&&t.includes("execute_request")){let i=typeof t=="string"?JSON.parse(t):this.deserialize(t);if(i.channel==="shell"&&i.header.msg_type==="execute_request"){if(!SP(i))return;let o=this.mirrorExecuteRequest(i);this.isUsingIPyWidgets&&await o}}else if(typeof t!="string")try{let i=this.deserialize(t,e);if(i.channel==="shell"&&i.header.msg_type==="execute_request"){if(!SP(i))return;let o=this.mirrorExecuteRequest(i);this.isUsingIPyWidgets&&await o}}catch(i){C.error("Failed to mirror message to kernel",i)}}sendRestartKernel(){this.raisePostMessage("IPyWidgets_onRestartKernel",void 0)}mirrorExecuteRequest(e){let t=Re();return this.waitingMessageIds.set(e.header.msg_id,{startTime:Date.now(),resultPromise:t}),this.raisePostMessage("IPyWidgets_mirror_execute",{id:e.header.msg_id,msg:e}),t.promise}messageNeedsFullHandle(e){var t,n,i,o;return e.channel==="iopub"&&((t=e.header)==null?void 0:t.msg_type)==="comm_msg"&&((i=(n=e.content)==null?void 0:n.data)==null?void 0:i.method)==="update"&&this.outputWidgetIds.has((o=e.content)==null?void 0:o.comm_id)}iopubMessageHandled(e){let t=e.id;this.fullHandleMessage&&this.fullHandleMessage.id===t&&(this.fullHandleMessage.promise.resolve(),this.fullHandleMessage=void 0)}async onKernelSocketMessage(e,t){var a,l,u,c,d,f,m,g,b;let n=(0,f9.default)(),i=Re();this.waitingMessageIds.set(n,{startTime:Date.now(),resultPromise:i});let o;if(typeof t=="string")SP(t)&&(this.raisePostMessage("IPyWidgets_msg",{id:n,data:t}),t.includes("display_data")&&(o=this.deserialize(t,e),Jn().KernelMessage.isDisplayDataMsg(o)&&this._onDisplayMessage.fire(o)));else{let v=d9([t]),k=p9(v);console.error(v,k),this.raisePostMessage("IPyWidgets_binary_msg",{id:n,data:d9([t])})}if(typeof t!="string"||t.includes(uo)||t.includes(nt.DefaultCommTarget)||t.includes("comm_open")||t.includes("comm_close")||t.includes("comm_msg")){let v=o||this.deserialize(t,e);if(!SP(v))return;v&&v.content&&v.content.data&&(v.content.data[uo]||v.content.target_name===nt.DefaultCommTarget)&&(this.isUsingIPyWidgets=!0);let k=((a=v.header)==null?void 0:a.msg_type)==="comm_open"&&((c=(u=(l=v.content)==null?void 0:l.data)==null?void 0:u.state)==null?void 0:c._model_module)==="@jupyter-widgets/output"&&((m=(f=(d=v.content)==null?void 0:d.data)==null?void 0:f.state)==null?void 0:m._model_name)==="OutputModel",R=((g=v.header)==null?void 0:g.msg_type)==="comm_close"&&this.outputWidgetIds.has((b=v.content)==null?void 0:b.comm_id);k?this.outputWidgetIds.add(v.content.comm_id):R?this.outputWidgetIds.delete(v.content.comm_id):this.messageNeedsFullHandle(v)&&(this.fullHandleMessage={id:v.header.msg_id,promise:Re()},await i.promise,await this.fullHandleMessage.promise.promise,this.fullHandleMessage=void 0)}}onKernelSocketResponse(e){let t=this.waitingMessageIds.get(e.id);t&&(this.waitingMessageIds.delete(e.id),t.resultPromise.resolve())}sendPendingMessages(e=""){var t,n,i,o;if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel)for(e||(e=((i=Oo.get(this.kernel.session.kernel.id))==null?void 0:i.protocol)||"");this.pendingMessages.length;)try{let s=this.pendingMessages[0],a=typeof s=="string"?JSON.parse(s):this.deserialize(s,e);(o=a.buffers)!=null&&o.length&&(a.buffers=a.buffers.map(l=>l instanceof DataView?l.buffer:l)),a.channel==="control"?this.kernel.session.kernel.sendControlMessage(a):this.kernel.session.kernel.sendShellMessage(a),this.pendingMessages.shift()}catch(s){C.error("Failed to send message to Kernel",s);return}}registerCommTargets(e){var t,n,i;for(;this.pendingTargetNames.size>0;){let s=Array.from([...this.pendingTargetNames.values()]).shift();if(s){if(this.commTargetsRegistered.has(s))return;C.trace(`Registering commtarget ${s}`),this.commTargetsRegistered.add(s),this.pendingTargetNames.delete(s),(t=e.session)!=null&&t.kernel&&s!==nt.DefaultCommTarget&&!((i=(n=PP.get(e.session.kernel))==null?void 0:n.targets)!=null&&i.has(s))&&e.session.kernel.registerCommTarget(s,E)}}}getKernel(){var e,t;return this.document&&!((e=this.kernel)!=null&&e.session)&&(this.kernel=this.kernelProvider.get(this.document),(t=this.kernel)==null||t.onDisposed(()=>this.kernel=void 0)),this.kernel&&!this.kernelRestartHandlerAttached&&(this.kernelRestartHandlerAttached=!0,this.disposables.push(this.kernel.onRestarted(this.handleKernelRestarts,this))),this.kernel}async handleKernelRestarts(){var e;this.disposed||this.commTargetsRegistered.size===0||!((e=this.kernel)!=null&&e.session)||(Array.from(this.commTargetsRegistered.keys()).forEach(t=>{this.commTargetsRegistered.delete(t),this.pendingTargetNames.add(t)}),this.subscribeToKernelSocket(this.kernel),this.registerCommTargets(this.kernel))}registerMessageHook(e){var t,n;try{if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&!this.messageHooks.has(e)){let i=this.messageHookCallback.bind(this);this.messageHooks.set(e,i),this.kernel.session.kernel.registerMessageHook(e,i)}}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e,type:"IPyWidgets_RegisterMessageHook"})}}possiblyRemoveMessageHook(e){try{e.lastHookedMsgId?this.pendingHookRemovals.set(e.lastHookedMsgId,e.hookMsgId):this.removeMessageHook(e.hookMsgId)}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e.hookMsgId,type:"IPyWidgets_RemoveMessageHook"})}}removeMessageHook(e){var t,n;if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&this.messageHooks.has(e)){let i=this.messageHooks.get(e);this.messageHooks.delete(e),this.kernel.session.kernel.removeMessageHook(e,i)}}async messageHookCallback(e){let t=Re(),n=(0,f9.default)(),i=e.parent_header.msg_id;if(this.messageHooks.has(i)?(this.messageHookRequests.set(n,t),this.raisePostMessage("IPyWidgets_MessageHookCall",{requestId:n,parentId:i,msg:e})):t.resolve(!0),this.pendingHookRemovals.has(e.header.msg_id)){let o=this.pendingHookRemovals.get(e.header.msg_id);this.pendingHookRemovals.delete(e.header.msg_id),this.removeMessageHook(o)}return t.promise}handleMessageHookResponse(e){let t=this.messageHookRequests.get(e.requestId);t&&(this.messageHookRequests.delete(e.requestId),t.resolve(e.msgType.includes("comm")?!0:e.result))}};var g9=class{constructor(e,t){this.baseMulticaster=e;this.oldMessages=t;this._postMessageEmitter=new h9.EventEmitter;this._onDisplayMessage=new h9.EventEmitter;this.onDisplayMessage=this._onDisplayMessage.event;this.disposables=[];e.postMessage(this.raisePostMessage,this,this.disposables),e.onDisplayMessage(n=>{this._onDisplayMessage.fire(n)},this,this.disposables)}get postMessage(){return this._postMessageEmitter.event}dispose(){for(;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}initialize(){return this.baseMulticaster.initialize()}receiveMessage(e){this.baseMulticaster.receiveMessage(e)}raisePostMessage(e){this.oldMessages.forEach(t=>{this._postMessageEmitter.fire(t)}),this.oldMessages=[],this._postMessageEmitter.fire(e)}},Vl=class{constructor(e,t){this.kernelProvider=t;this.messageDispatchers=new WeakMap;this.messagesPerNotebook=new WeakMap;this.disposed=!1;this.disposables=[];e.push(this),t.onDidDisposeKernel(this.trackDisposingOfKernels,this,e)}dispose(){var e;for(this.disposed=!0;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}create(e){let t=this.messageDispatchers.get(e);t||(t=new aM(this.kernelProvider,e),this.messageDispatchers.set(e,t),this.disposables.push(t.postMessage(o=>this.onMessage(o,e),this)));let n=[];e&&this.messagesPerNotebook.get(e)&&(n=this.messagesPerNotebook.get(e)||[]);let i=new g9(t,n);return this.disposables.push(i),i}trackDisposingOfKernels(e){if(this.disposed)return;let t=e.notebook,n=this.messageDispatchers.get(t);this.messageDispatchers.delete(t),n==null||n.dispose()}onMessage(e,t){t&&(this.messagesPerNotebook.set(t,this.messagesPerNotebook.get(t)||[]),(e.message==="IPyWidgets_kernelOptions"||e.message==="IPyWidgets_registerCommTarget")&&this.messagesPerNotebook.get(t).push(e))}};Vl=U([(0,DP.injectable)(),x(0,(0,DP.inject)(ve)),x(1,(0,DP.inject)(qe))],Vl);p();var jZ=require("vscode");p();var WZ=require("vscode");var cv=class cv extends Pr{constructor(t,n,i,o,s,a){super();this.kernel=t;this.localResourceUriConverter=n;this.configurationSettings=i;this.sourceProviderFactory=o;this.isWebViewOnline=s;this.cdnScriptProvider=a;this.id="all";this.scriptProviders=this.sourceProviderFactory.getProviders(this.kernel,this.localResourceUriConverter),this.scriptProviders.forEach(l=>this._register(l)),this.monitorKernel()}get configuredScriptSources(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}async getBaseUrl(){let t=this.scriptProviders.find(n=>n.getBaseUrl);if(t)return t.getBaseUrl()}async getWidgetScriptSources(){let t=[];return await Promise.all(this.scriptProviders.map(async n=>{n.getWidgetScriptSources&&t.push(...await n.getWidgetScriptSources())})),t}async getWidgetScriptSource(t,n){let i=await this.isWebViewOnline,o=this.scriptProviders.slice(),s={moduleName:t};for(;o.length;){let a=o.shift();if(!a)continue;let l=await a.getWidgetScriptSource(t,n,i);if(l.scriptUri){s=l;break}else C.warn(`Widget Script Source not found for ${t}@${n} from ${a.id}`)}return this.sendTelemetryForWidgetModule(t,n,"",s.source).catch(E),s.scriptUri?C.trace(`Script source for Widget ${t}@${n} was found from source ${s.source} and ${s.scriptUri}`):C.error(`Script source for Widget ${t}@${n} not found in ${this.scriptProviders.map(a=>a.id).join(", ")}`),s}async sendTelemetryForWidgetModule(t,n,i,o){let s=`${t}.${t}@${n}`;if(cv.trackedWidgetModuleNames.has(s))return;cv.trackedWidgetModuleNames.add(s);let a=t.toLowerCase().startsWith("@jupyter-widgets"),l=o==="cdn"||a||await this.cdnScriptProvider.isOnCDN(t),u=l?t.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0,c=l?i.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0;ne("DS_INTERNAL.IPYWIDGET_USED_BY_USER",void 0,{hashedName:await Rt(t),moduleName:u,modelName:c,source:o,moduleVersion:l?n:void 0,cdnSearched:this.configuredScriptSources.length>0})}monitorKernel(){this.hookKernelEvents(),this._register(this.kernel.onStarted(this.hookKernelEvents,this)),this._register(this.kernel.onRestarted(this.hookKernelEvents,this)),this._register(this.kernel.onDidKernelSocketChange(()=>this.hookKernelEvents(),this))}hookKernelEvents(){var n;let t=(n=this.kernel.session)==null?void 0:n.kernel;t&&(t.anyMessage.connect(this.onAnyMessage,this),this._register(new WZ.Disposable(()=>t.anyMessage.disconnect(this.onAnyMessage,this))))}onAnyMessage(t,n){var i,o,s,a;if(n.direction==="recv"&&n.msg.header.msg_type==="comm_open"){let u=n.msg.content.data;(i=u.state)!=null&&i._model_module&&u.state._model_name&&this.sendTelemetryForWidgetModule((o=u.state)==null?void 0:o._model_module,((s=u.state)==null?void 0:s._model_module_version)||"",(a=u.state)==null?void 0:a._model_name).catch(E)}}};cv.trackedWidgetModuleNames=new Set,U([gn()],cv.prototype,"sendTelemetryForWidgetModule",1),U([gn()],cv.prototype,"onAnyMessage",1);var cM=cv;p();var uM=class{constructor(e,t){this.isWebExtension=e;this.converter=t}async asWebviewUri(e){return this.isWebExtension?e:this.converter(e)}};p();var v9=class{constructor(e,t){this.uri=e;this.value=t}};function o_e(r){return Array.isArray(r)}var s_e,uv=class uv{constructor(e,t){this[s_e]="ResourceMap";if(e instanceof uv)this.map=new Map(e.map),this.toKey=t!=null?t:uv.defaultToKey;else if(o_e(e)){this.map=new Map,this.toKey=t!=null?t:uv.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e!=null?e:uv.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new v9(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t!="undefined"&&(e=e.bind(t));for(let[,n]of this.map)e(n.value,n.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(s_e=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}};uv.defaultToKey=e=>e.toString();var yu=uv,a_e,dM=class{constructor(e,t){this[a_e]="ResourceSet";!e||typeof e=="function"?this._map=new yu(e):(this._map=new yu(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(a_e=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var l_e,VZ=class{constructor(){this[l_e]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}[(l_e=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}};var pM=class{constructor(e,t,n,i,o,s){this.document=e;this.kernelProvider=t;this.configurationSettings=i;this.sourceProviderFactory=o;this.cdnScriptProvider=s;this.postEmitter=new jZ.EventEmitter;this.disposables=[];this.isWebViewOnline=Re();this.widgetSources=new Map;this.pendingModuleRequests=new Map;this.uriTranslationRequests=new yu;this.uriConverter=new uM(zr(),a=>(this.uriTranslationRequests.has(a)||this.uriTranslationRequests.set(a,Re()),this.postEmitter.fire({message:"ConvertUriForUseInWebViewRequest",payload:a}),this.uriTranslationRequests.get(a).promise)),this.isWebViewOnline.promise.catch(E),n.push(this),this.kernelProvider.onDidStartKernel(a=>{a.notebook===this.document&&this.initialize()},this,this.disposables)}get postMessage(){return this.postEmitter.event}dispose(){var e;for(;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}onMessage(e,t){if(e==="ConvertUriForUseInWebViewResponse"){let n=t;n&&this.uriTranslationRequests.has(n.request)&&this.uriTranslationRequests.get(n.request).resolve(n.response)}else if(e==="IPyWidgets_Ready")this.sendBaseUrl(),this.sendWidgetScriptSources().catch(E);else if(e==="IPyWidgets_IsOnline"){let n=t.isOnline;this.isWebViewOnline.resolve(n)}else e==="IPyWidgets_WidgetScriptSourceRequest"&&t&&this.onRequestWidgetScript(t).catch(E)}initialize(){var e;this.jupyterLab||(this.jupyterLab=Jn()),this.kernel||(this.kernel=this.kernelProvider.get(this.document)),(e=this.kernel)!=null&&e.session&&(this.scriptProvider&&!this.scriptProvider.isDisposed||(this.scriptProvider=new cM(this.kernel,this.uriConverter,this.configurationSettings,this.sourceProviderFactory,this.isWebViewOnline.promise,this.cdnScriptProvider),this.kernel.onDisposed(()=>this.dispose()),this.handlePendingRequests(),this.sendBaseUrl(),C.trace("IPyWidgetScriptSource.initialize")))}sendBaseUrl(){this.scriptProvider&&this.scriptProvider.getBaseUrl().then(e=>{e&&this.postEmitter.fire({message:"IPyWidgets_BaseUrl_Response",payload:e.toString()})}).catch(e=>C.error("Failed to get baseUrl",e))}async sendWidgetScriptSources(){if(this.scriptProvider&&!this.allWidgetScriptsSent)try{(await this.scriptProvider.getWidgetScriptSources()).forEach(t=>{var n;((n=this.widgetSources.get(t.moduleName))==null?void 0:n.source)!=="cdn"&&this.widgetSources.set(t.moduleName,t),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:t})})}catch(e){C.warn("Failed to fetch script sources",e)}finally{this.allWidgetScriptsSent=!0}}async onRequestWidgetScript(e){let{moduleName:t,moduleVersion:n,requestId:i}=e;if(C.trace(`\x1B[32mFetch Script for ${JSON.stringify(e)}`),await this.sendWidgetSource(t,n,i).catch(o=>C.error("Failed to send widget sources upon ready",o)),this.scriptProvider&&!this.allWidgetScriptsSent)try{await this.sendWidgetScriptSources()}finally{this.sendWidgetSource(t,n,i).catch(o=>C.error("Failed to send widget sources upon ready",o))}}async sendWidgetSource(e,t="*",n){var o;if(!e||e.startsWith("@jupyter"))return;if(!this.kernel||!this.scriptProvider){this.pendingModuleRequests.set(e,{moduleVersion:t,requestId:n});return}let i={moduleName:e,requestId:n};try{C.trace(`\x1B[32mFetch Script for ${e}`),i=await this.scriptProvider.getWidgetScriptSource(e,t),((o=this.widgetSources.get(i.moduleName))==null?void 0:o.source)!=="cdn"&&this.widgetSources.set(i.moduleName,i)}catch(s){C.error("Failed to get widget source due to an error",s),ne("DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED")}finally{C.trace(`\x1B[32mScript for ${e}, is ${i.scriptUri} from ${i.source}`),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:i})}}handlePendingRequests(){let e=Array.from(this.pendingModuleRequests.keys());for(;e.length;){let t=e.shift();if(t){let{moduleVersion:n,requestId:i}=this.pendingModuleRequests.get(t);this.pendingModuleRequests.delete(t),this.sendWidgetSource(t,n,i).catch(o=>C.error(`Failed to send WidgetScript for ${t}`,o))}}}};p();var mM=Symbol("IWidgetScriptSourceProviderFactory"),BZ=Symbol("INbExtensionsPathProvider"),hM=Symbol("IIPyWidgetScriptManagerFactory"),dIt=Symbol("IIPyWidgetScriptManager");p();var dv=oe(he()),fs=require("vscode");var JZ="https://unpkg.com/",b9="https://cdn.jsdelivr.net/npm/",gM="IPYWidgetCDNConfigured",HZ="IPYWidgetNotFoundOnCDN",qZ="IPYWidgetNoNetWorkAccess";function c_e(r,e,t){let n=e,i="index",o=e.indexOf("/");return o!==-1&&e[0]==="@"&&(o=e.indexOf("/",o+1)),o!==-1&&(i=e.substr(o+1),n=e.substr(0,o)),r===b9&&(t.startsWith("^")&&(t=t.slice(1)),i.endsWith(".js")||(i=i.concat(".js"))),`${r}${n}@${t}/dist/${i}`}function u_e(r){switch(r){case"unpkg.com":return JZ;case"jsdelivr.com":return b9;default:break}}var jl=class{constructor(e,t){this.globalMemento=e;this.configurationSettings=t;this.id="cdn";this.cache=new Map;this.isOnCDNCache=new Map;this.notifiedUserAboutWidgetScriptNotFound=new Set}get cdnProviders(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}dispose(){this.cache.clear()}async isOnCDN(e){let t=`MODULE_VERSION_ON_CDN_${e}`;if(this.isOnCDNCache.has(t))return this.isOnCDNCache.get(t);if(this.globalMemento.get(t,!1))return!0;let n=(async()=>{let i=new du,o=La(i.exists(`${JZ}${e}`)),s=La(i.exists(`${b9}${e}`));return await Promise.race([o.promise,s.promise]),o.value||s.value?!0:(await Promise.all([o.promise,s.promise]),!!(o.value||s.value))})();return n.then(i=>{if(i)return this.globalMemento.update(t,!0)}).then(E,E),this.isOnCDNCache.set(t,n),n}async getWidgetScriptSource(e,t,n){if(n===!1)return C.ci(`Webview is offline, cannot use CDN for ${e}`),this.warnIfNoAccessToInternetFromWebView(e).catch(E),{moduleName:e};if(this.cdnProviders.length===0&&this.globalMemento.get(gM,!1))return C.ci("No CDN providers and user configured CDN"),{moduleName:e};let i=this.getModuleKey(e,t);return this.cache.get(i)||this.cache.set(i,this.getWidgetScriptSourceImplementation(e,t)),this.cache.get(i)}async generateDownloadUri(e,t,n){let i=u_e(n);if(i)return c_e(i,e,t)}getModuleKey(e,t){return`${e}${t}`}async getWidgetScriptSourceImplementation(e,t){if(C.trace(`\x1B[32mSearching for Widget Script ${e}#${t} using cdns ${this.cdnProviders.join(" ")}`),await this.configureWidgets(),this.cdnProviders.length===0)return{moduleName:e};let i=(await Promise.all(this.cdnProviders.map(o=>this.getValidUri(e,t,o)))).find(o=>o);return i?(C.trace(`\x1B[32mWidget Script ${e}#${t} found at URI: ${i}`),{moduleName:e,scriptUri:i,source:"cdn"}):(C.error(`Widget Script ${e}#${t} was not found on on any cdn`),this.handleWidgetSourceNotFound(e,t).catch(E),{moduleName:e})}async getValidUri(e,t,n){try{let i=await this.generateDownloadUri(e,t,n),o=new du;if(i&&await o.exists(i))return i}catch(i){C.trace(`Failed downloading ${e}:${t} from ${n}`);return}}async warnIfNoAccessToInternetFromWebView(e){if(this.globalMemento.get(qZ,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await fs.window.showWarningMessage(W.cdnWidgetScriptNotAccessibleWarningMessage(e,JSON.stringify(this.cdnProviders)),Ue.ok,Ue.doNotShowAgain,Ue.moreInfo)){case Ue.doNotShowAgain:return this.globalMemento.update(qZ,!0);case Ue.moreInfo:return fs.env.openExternal(fs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));default:}}async configureWidgets(){if(this.cdnProviders.length!==0||this.globalMemento.get(gM,!1))return;if(this.configurationPromise)return this.configurationPromise.promise;this.configurationPromise=Re(),ne("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN");let e=await fs.window.showInformationMessage(W.useCDNForWidgetsNoInformation,{modal:!0},Ue.ok,Ue.doNotShowAgain,Ue.moreInfo),t="dismissed";switch(e){case Ue.ok:{t="ok",await Promise.all([this.updateScriptSources(["jsdelivr.com","unpkg.com"]),this.globalMemento.update(gM,!0)]);break}case Ue.doNotShowAgain:{t="doNotShowAgain",await Promise.all([this.updateScriptSources([]),this.globalMemento.update(gM,!0)]);break}case Ue.moreInfo:{fs.env.openExternal(fs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break}default:t=e===Ue.cancel?"cancel":"dismissed";break}ne("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",void 0,{selection:t}),this.configurationPromise.resolve()}async updateScriptSources(e){let t="widgetScriptSources";await this.configurationSettings.updateSetting(t,e,void 0,fs.ConfigurationTarget.Global)}async handleWidgetSourceNotFound(e,t){if(this.globalMemento.get(HZ,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await fs.window.showWarningMessage(W.widgetScriptNotFoundOnCDNWidgetMightNotWork(e,t,JSON.stringify(this.cdnProviders)),Ue.ok,Ue.doNotShowAgain,Ue.reportThisIssue)){case Ue.doNotShowAgain:return this.globalMemento.update(HZ,!0);case Ue.reportThisIssue:return fs.env.openExternal(fs.Uri.parse("https://aka.ms/CreatePVSCDataScienceIssue"));default:}}};jl=U([(0,dv.injectable)(),x(0,(0,dv.inject)(Et)),x(0,(0,dv.named)(rr)),x(1,(0,dv.inject)(Ke))],jl);var TP=class{constructor(e,t){this.document=e;this.serviceContainer=t;this.cachedMessages=[];this.postEmitter=new ms.EventEmitter;this.attachedWebviews=new WeakSet;this.modulesForWhichWeHaveDisplayedWidgetErrorMessage=new Set;this.queuedMessages=[];this.disposables=this.serviceContainer.get(ve),this.jupyterOutput=this.serviceContainer.get(jm,qv),this.configService=this.serviceContainer.get(Ke),this.initialize()}get postMessage(){return this.listeningToPostMessageEvent=!0,this.postEmitter.event}dispose(){var e,t;this.cachedMessages=[],(e=this.ipyWidgetMessageDispatcher)==null||e.dispose(),(t=this.ipyWidgetScriptSource)==null||t.dispose()}attach(e){if(this.attachedWebviews.has(e))return;this.attachedWebviews.add(e),this.postMessage(i=>{if(C.ci(`\x1B[32mWidget Coordinator sent ${i.message}`),i.message==="ConvertUriForUseInWebViewRequest")this.onMessage(e,"ConvertUriForUseInWebViewResponse",{request:i.payload,response:e.asWebviewUri(i.payload)});else{if(!this.readyMessageReceived){this.queuedMessages.push({type:i.message,payload:i.payload});return}this.sendPendingWebViewMessages(e),e.postMessage({type:i.message,payload:i.payload}).then(E,E)}},this,this.disposables);let t=Re(),n=async()=>{let i=new yt;if(!t.completed){let s=[],a=this.serviceContainer.get(qe),l=Re();a.get(this.document)?l.resolve(a.get(this.document)):a.onDidCreateKernel(c=>{c.notebook===this.document&&l.resolve(c)},this,s);let u=await l.promise;u&&(jt(u.kernelConnectionMetadata)?u.ipywidgetsVersion?t.completed||t.resolve(u.ipywidgetsVersion):u.onIPyWidgetVersionResolved(()=>{u.ipywidgetsVersion&&(t.completed||t.resolve(u.ipywidgetsVersion),Ce(s))},this,s):t.completed||t.resolve(HE)),s.length&&this.disposables.push(...s)}let o=await t.promise;C.trace(`Version of IPyWidgets ${o} determined after ${i.elapsedTime/1e3}s`),e.postMessage({type:"IPyWidgets_Reply_Widget_Version",payload:o}).then(E,E)};e.onDidReceiveMessage(async i=>{C.ci(`\x1B[32mWidget Coordinator received ${i.type}`),this.onMessage(e,i.type,i.payload),i.type==="IPyWidgets_Request_Widget_Version"&&await n(),i.type==="IPyWidgets_Window_Alert"&&ms.window.showInformationMessage(i.message),i.type==="IPyWidgets_Window_Open"&&ms.env.openExternal(ms.Uri.parse(i.url)),i.type==="IPyWidgets_Ready"&&(C.trace("Web view is ready to receive widget messages"),this.readyMessageReceived=!0,this.sendPendingWebViewMessages(e))},this,this.disposables),e.postMessage({type:"IPyWidgets_IsReadyRequest",payload:void 0}).then(E,E),n().catch(E)}onMessage(e,t,n){t==="ipywidget_load_success"?this.sendLoadSucceededTelemetry(n).catch(E):t==="ipywidget_load_failure"?this.handleWidgetLoadFailure(e,n).catch(E):t==="ipywidget_widget_version_not_supported"?this.sendUnsupportedWidgetVersionFailureTelemetry(n).catch(E):t==="ipywidget_render_failure"?this.sendRenderFailureTelemetry(n):t==="ipywidget_unhandled_kernel_message"&&this.handleUnhandledMessage(n),this.getIPyWidgetMessageDispatcher().receiveMessage({message:t,payload:n}),this.getIPyWidgetScriptSource().onMessage(t,n)}sendPendingWebViewMessages(e){if(this.readyMessageReceived)for(;this.queuedMessages.length;)e.postMessage(this.queuedMessages.shift()).then(E,E)}initialize(){this.getIPyWidgetScriptSource().initialize(),this.getIPyWidgetMessageDispatcher().initialize()}async sendLoadSucceededTelemetry(e){try{ne("DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",0,{moduleHash:await Rt(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}async handleWidgetLoadFailure(e,t){try{let n=t.error.toString(),i=this.configService.getSettings(void 0).widgetScriptSources,o=i.length>0,s=`${t.moduleName}:${t.moduleVersion}`;if(!t.isOnline)n=W.loadClassFailedWithNoInternet(t.moduleName,t.moduleVersion),ms.window.showErrorMessage(n).then(E,E);else if(!o&&!this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.has(s)){this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.add(s);let a=Ue.moreInfo,l=W.enableCDNForWidgetsButton;n=W.enableCDNForWidgetsSetting(t.moduleName,t.moduleVersion),ms.window.showErrorMessage(n,{modal:!0},l,a).then(u=>{switch(u){case a:ms.env.openExternal(ms.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break;case l:this.enableCDNForWidgets(e).catch(E);break;default:break}},E)}C.error(`Widget load failure ${n}`,i,t),ne("DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",0,{isOnline:t.isOnline,moduleHash:await Rt(t.moduleName),moduleVersion:t.moduleVersion,timedout:t.timedout})}catch(n){}}async enableCDNForWidgets(e){await ms.commands.executeCommand(le.EnableLoadingWidgetsFrom3rdPartySource),await e.postMessage({type:"IPyWidgets_AttemptToDownloadFailedWidgetsAgain"})}async sendUnsupportedWidgetVersionFailureTelemetry(e){try{ne("DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",0,{moduleHash:await Rt(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}sendRenderFailureTelemetry(e){try{C.error("Error rendering a widget: ",e),ne("DS_INTERNAL.IPYWIDGET_RENDER_FAILURE")}catch(t){}}handleUnhandledMessage(e){if(e.header.msg_type!=="status")try{if(e.header.msg_type==="error"){let t=e;t.content.traceback=t.content.traceback.map(vu)}C.trace(`Unhandled widget kernel message: ${e.header.msg_type} ${e.content}`),this.jupyterOutput.appendLine(W.unhandledMessage(e.header.msg_type,JSON.stringify(e.content))),ne("DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",void 0,{msg_type:e.header.msg_type})}catch(t){}}getIPyWidgetMessageDispatcher(){return this.ipyWidgetMessageDispatcher||(this.ipyWidgetMessageDispatcher=this.serviceContainer.get(Vl).create(this.document),this.disposables.push(this.ipyWidgetMessageDispatcher.postMessage(this.cacheOrSend,this))),this.ipyWidgetMessageDispatcher}getIPyWidgetScriptSource(){return this.ipyWidgetScriptSource||(this.ipyWidgetScriptSource=new pM(this.document,this.serviceContainer.get(qe),this.serviceContainer.get(ve),this.serviceContainer.get(Ke),this.serviceContainer.get(mM),this.serviceContainer.get(jl)),this.disposables.push(this.ipyWidgetScriptSource.postMessage(this.cacheOrSend,this))),this.ipyWidgetScriptSource}cacheOrSend(e){if(!this.listeningToPostMessageEvent){C.ci("\x1B[32mQueuing messages (no listeners)"),this.cachedMessages.push(e);return}this.cachedMessages.forEach(t=>this.postEmitter.fire(t)),this.cachedMessages=[],this.postEmitter.fire(e)}};U([gn()],TP.prototype,"enableCDNForWidgets",1);var I9=class{constructor(e,t){this.editor=e;this.pendingMessages=[];this.disposables=[];this._onDidReceiveMessage=new fm.EventEmitter;this.changeController(t)}get controller(){if(!this._controller)throw new Error("No controller defined");return this._controller.controller}changeController(e){var t,n;((t=this._controller)==null?void 0:t.id)!==e.id&&((n=this.controllerMessageHandler)==null||n.dispose(),this._controller=e,this.controllerMessageHandler=e.onDidReceiveMessage(i=>{var o;i.editor===this.editor&&((o=this.controller)==null?void 0:o.id)===e.id&&(this.eventHandlerListening?(this.sendPendingMessages(),this._onDidReceiveMessage.fire(i.message)):this.pendingMessages.push(i.message))},this,this.disposables))}dispose(){Ce(this.disposables)}get onDidReceiveMessage(){return this.eventHandlerListening=!0,setTimeout(()=>this.sendPendingMessages(),0),this._onDidReceiveMessage.event}postMessage(e){return this.controller.postMessage(e,this.editor)}asWebviewUri(e){return this.controller.asWebviewUri(e)}sendPendingMessages(){if(this.pendingMessages.length){let e=this.pendingMessages.shift();for(;e;)this._onDidReceiveMessage.fire(e),e=this.pendingMessages.shift()}}},pm=class{constructor(e,t,n){this.serviceContainer=e;this.disposableRegistry=t;this.controllerManager=n;this.messageCoordinators=new WeakMap;this.notebookDisposables=new WeakMap;this.notebookCommunications=new WeakMap;this.notebookEditors=new WeakMap}activate(){fm.window.onDidChangeVisibleNotebookEditors(this.onDidChangeVisibleNotebookEditors,this,this.disposableRegistry),fm.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebookDocument,this,this.disposableRegistry),this.controllerManager.onControllerSelected(this.onDidSelectController,this,this.disposableRegistry)}onDidSelectController(e){let t=this.messageCoordinators.get(e.notebook);t&&(this.messageCoordinators.delete(e.notebook),fm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>{let i=this.notebookCommunications.get(n);this.notebookCommunications.delete(n),i&&i.controller!==e.controller.controller&&(this.notebookCommunications.delete(n),i&&i.dispose())}),t==null||t.dispose()),fm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>this.initializeNotebookCommunication(n,e.controller))}initializeNotebookCommunication(e,t){if(e.notebook.isClosed||!hr(e.notebook))return;let n=e.notebook;if(!t){C.trace(`No controller, hence notebook communications cannot be initialized for editor ${Ee(e.notebook.uri)}`);return}if(this.notebookCommunications.has(e))return;let i=new I9(e,t);this.addNotebookDisposables(n,[i]),this.notebookCommunications.set(e,i);let o=this.messageCoordinators.get(n);o||(o=new TP(n,this.serviceContainer),this.messageCoordinators.set(n,o)),o.attach(i)}addNotebookDisposables(e,t){let n=this.notebookDisposables.get(e)||[];n.push(...t),this.notebookDisposables.set(e,n)}async onDidChangeVisibleNotebookEditors(e){e.forEach(t=>{let n=this.controllerManager.getSelected(t.notebook);this.initializeNotebookCommunication(t,n)})}onDidCloseNotebookDocument(e){var n;let t=this.notebookEditors.get(e)||[];Ce(this.notebookDisposables.get(e)||[]),t.forEach(i=>{var o;return(o=this.notebookCommunications.get(i))==null?void 0:o.dispose()}),(n=this.messageCoordinators.get(e))==null||n.dispose(),this.messageCoordinators.delete(e)}};pm=U([(0,$S.injectable)(),x(0,(0,$S.inject)(Ar)),x(1,(0,$S.inject)(ve)),x(2,(0,$S.inject)(Nt))],pm);p();var mm=oe(he());var zS=class{constructor(e,t,n,i,o){this.disposables=e;this.kernelProvider=t;this.controllers=n;this.liveKernelTracker=i;this.preferredRemoteKernelIdProvider=o}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables),this.controllers.onControllerSelectionChanged(this.onNotebookControllerSelectionChanged,this,this.disposables)}onNotebookControllerSelectionChanged({selected:e,notebook:t,controller:n}){t.isClosed||(n.connection.kind==="connectToLiveRemoteKernel"&&n.connection.kernelModel.id&&(e?this.liveKernelTracker.trackKernelIdAsUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id):this.liveKernelTracker.trackKernelIdAsNotUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id)),Qt(n.connection)&&this.preferredRemoteKernelIdProvider.clearPreferredRemoteKernelId(t.uri).catch(E))}onDidStartKernel(e){if(!e.resourceUri)return;let t=e.resourceUri;if(e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")return;let n=e.kernelConnectionMetadata.serverProviderHandle,i=()=>{var s,a;let o=(a=(s=e.session)==null?void 0:s.kernel)==null?void 0:a.id;!e.disposed&&!e.disposing&&o&&(C.debug(`Updating preferred kernel for remote notebook ${o}`),this.preferredRemoteKernelIdProvider.storePreferredRemoteKernelId(t,o).catch(E),this.liveKernelTracker.trackKernelIdAsUsed(t,n,o))};i(),e.onDidKernelSocketChange(i,this,this.disposables)}};zS=U([(0,mm.injectable)(),x(0,(0,mm.inject)(ve)),x(1,(0,mm.inject)(qe)),x(2,(0,mm.inject)(Nt)),x(3,(0,mm.inject)(Gg)),x(4,(0,mm.inject)(js))],zS);p();var fv=oe(he());var GZ=require("vscode");var pv=class{constructor(e,t,n,i){this.disposables=e;this.uriStorage=t;this.controllers=n;this.serverProviderRegistry=i;this.handledServerProviderChanges=new WeakSet}activate(){this.serverProviderRegistry.jupyterCollections.forEach(e=>this.checkExpiredServersInJupyterCollection(e)),this.serverProviderRegistry.onDidChangeCollections(({added:e,removed:t})=>{e.forEach(n=>this.checkExpiredServersInJupyterCollection(n)),t.forEach(n=>this.removeControllersBelongingToDisposedProvider(n.extensionId,n.id))},this,this.disposables)}async checkExpiredServersInJupyterCollection(e){!this.handledServerProviderChanges.has(e.serverProvider)&&e.serverProvider.onDidChangeServers&&(this.handledServerProviderChanges.add(e.serverProvider),e.serverProvider.onDidChangeServers(()=>this.checkExpiredServersInJupyterCollection(e).catch(E),this,this.disposables));let t=new GZ.CancellationTokenSource;this.disposables.push(t);try{let n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await this.removeControllersAndUriStorageBelongingToInvalidServers(e.extensionId,e.id,(n||[]).map(i=>i.id))}finally{t.dispose()}}async removeControllersAndUriStorageBelongingToInvalidServers(e,t,n){let i=this.uriStorage.all;await Promise.all(i.filter(o=>o.provider.extensionId===e&&o.provider.id===t).map(async o=>{n.includes(o.provider.handle)||await this.uriStorage.remove(o.provider)})),this.controllers.registered.forEach(o=>{let s=o.connection;Qt(s)||s.serverProviderHandle.extensionId!==e||s.serverProviderHandle.id!==t||n.includes(s.serverProviderHandle.handle)||(C.warn(`Deleting controller ${o.id} as it is associated with a server Id that has been removed`),o.dispose())})}removeControllersBelongingToDisposedProvider(e,t){this.controllers.registered.forEach(n=>{let i=n.connection;Qt(i)||i.serverProviderHandle.extensionId!==e||i.serverProviderHandle.id!==t||(C.warn(`Deleting controller ${n.id} as it is associated with a Provider Id that has been removed`),n.dispose())})}};U([gn("Failed to check what servers were shutdown in Controller Watcher")],pv.prototype,"checkExpiredServersInJupyterCollection",1),pv=U([(0,fv.injectable)(),x(0,(0,fv.inject)(ve)),x(1,(0,fv.inject)(dr)),x(2,(0,fv.inject)(Nt)),x(3,(0,fv.inject)(sr))],pv);p();p();var XS=oe(he());p();var YZ=require("vscode");var vM=class{constructor(e,t,n,i,o,s){this.label=e;this._description=t;this.detail=n;this.category=i;this.serverDisplayName=o;this.getDescription=s;this._onDidChange=new YZ.EventEmitter;this.onDidChange=this._onDidChange.event}get description(){var e;return((e=this.getDescription)==null?void 0:e.call(this))||this._description}set description(e){this._description=e}dispose(){this._onDidChange.dispose()}triggerChange(){this._onDidChange.fire(this)}};function $Z(r){switch(r.kind){case"connectToLiveRemoteKernel":return W.kernelCategoryForJupyterSession;case"startUsingRemoteKernelSpec":return W.kernelCategoryForRemoteJupyterKernel;default:return S9(r)}}function S9(r){switch(r.kind){case"startUsingLocalKernelSpec":return W.kernelCategoryForJupyterKernel;case"startUsingPythonInterpreter":{if(Hg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return W.kernelCategoryForJupyterKernel;switch(_r(r.interpreter)){case"Conda":return Tp(r.interpreter)?W.kernelCategoryForCondaWithoutPython:W.kernelCategoryForConda;case"PipEnv":return W.kernelCategoryForPipEnv;case"Poetry":return W.kernelCategoryForPoetry;case"Pyenv":return W.kernelCategoryForPyEnv;case"Venv":case"VirtualEnv":case"VirtualEnvWrapper":return W.kernelCategoryForVirtual;default:return W.kernelCategoryForGlobal}}default:return""}}var QS=class{constructor(e,t,n){this.platform=e;this.jupyterUriProviderRegistration=t;this.disposables=n;this.details=new Map}getDisplayData(e){if(!this.details.get(e.id)){let i=ut(e),o=oQ(e,this.platform);e.kind==="connectToLiveRemoteKernel"&&(o=cj(e));let s=e.kind==="connectToLiveRemoteKernel"?()=>cj(e):void 0,a=S9(e),l=new vM(i,o,"",a,void 0,s);this.disposables.push(l),this.details.set(e.id,l)}let t=this.details.get(e.id);if(this.details.set(e.id,t),e.kind==="connectToLiveRemoteKernel"||e.kind==="startUsingRemoteKernelSpec"){let i=vS(e.serverProviderHandle,this.jupyterUriProviderRegistration,W.kernelDefaultRemoteDisplayName);t.serverDisplayName!==i&&(t.serverDisplayName=i,t.triggerChange())}let n=$Z(e);return t.category!==n&&(t.category=n,t.triggerChange()),t}};QS=U([(0,XS.injectable)(),x(0,(0,XS.inject)(ds)),x(1,(0,XS.inject)(sr)),x(2,(0,XS.inject)(ve))],QS);p();var Zd=oe(he()),e_=require("vscode");p();var hm=oe(he()),XZ=require("vscode");p();var zZ=require("vscode");function yM(r){var e;try{return aQ(_a(r))||((e=r.getCells().find(n=>n.kind===zZ.NotebookCellKind.Code))==null?void 0:e.document.languageId)}catch(t){C.warn("Failed to determine language of first cell",t)}}var QZ="DATASCIENCE.LAST_SAVED_CELL_LANGUAGE",Bs=class{constructor(e,t,n){this.disposables=e;this.globalMemento=t;this.pythonExtensionChecker=n}getPreferredLanguage(e){var i,o;let t=((i=e==null?void 0:e.language_info)==null?void 0:i.name)||((o=e==null?void 0:e.kernelspec)==null?void 0:o.language)||this.lastSavedNotebookCellLanguage,n=this.pythonExtensionChecker.isPythonExtensionInstalled?Ye:"plaintext";return Uc(t||n)}activate(){XZ.workspace.onDidSaveNotebookDocument(this.onDidSaveNotebookDocument,this,this.disposables)}getSupportedLanguages(e){if(jt(e))return yB;{let t=Uc(eu(e)||"");return t&&IB.includes(t.toLowerCase())?[t,"raw"]:[]}}get lastSavedNotebookCellLanguage(){return this.globalMemento.get(QZ)}async onDidSaveNotebookDocument(e){if(!hr(e))return;let t=yM(e);t&&t!==this.lastSavedNotebookCellLanguage&&await this.globalMemento.update(QZ,t)}};U([gn("Saving last saved cell language")],Bs.prototype,"onDidSaveNotebookDocument",1),Bs=U([(0,hm.injectable)(),x(0,(0,hm.inject)(ve)),x(1,(0,hm.inject)(Et)),x(1,(0,hm.named)(rr)),x(2,(0,hm.inject)(vo))],Bs);p();function ZZ(r){let e={kernelSpecCount:0,localKernelSpecCount:0,remoteKernelSpecCount:0,kernelInterpreterCount:0,kernelLiveCount:0};r.forEach(t=>{switch(t.kind){case"connectToLiveRemoteKernel":e.kernelLiveCount+=1;break;case"startUsingRemoteKernelSpec":e.localKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingLocalKernelSpec":e.remoteKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingPythonInterpreter":{e.kernelInterpreterCount+=1;break}default:break}}),ne("DS_INTERNAL.KERNEL_COUNT",{...e})}p();var Xt=require("vscode");p();var bu=require("vscode");p();var eee=require("vscode");async function tee(r,e){let t=e==null?void 0:e.findNotebookEditor(r);return t?eee.commands.executeCommand("notebook.selectKernel",{notebookEditor:t}):(C.error("Unable to select kernel as the Notebook document could not be identified"),!1)}p();var ree=require("vscode");var bM=class extends ru{constructor(e){super(W.failedToStartAnUntrustedKernelSpec(ut(e),e.kernelSpec.specFile?Ee(ree.Uri.file(e.kernelSpec.specFile)):""),void 0,e)}};var qr=class qr{static async switchController(e,t){let i=t.get(Ao).findNotebookEditor(e),o=t.get(Nt),s,a=Re(),l=o.onControllerSelected(c=>a.resolve(c.controller));return await tee(e,t.get(Ao))&&i&&(s=await a.promise),l.dispose(),s?{controller:s.controller,metadata:s.connection}:void 0}static async notifyAndRestartDeadKernel(e){let t=await bu.window.showErrorMessage(W.cannotRunCellKernelIsDead(ut(e.kernelConnectionMetadata)),{modal:!0},W.showJupyterLogs,W.restartKernel),n=!1;switch(t){case W.restartKernel:{await e.restart(),n=!0;break}case W.showJupyterLogs:bu.commands.executeCommand(le.ViewJupyterOutput).then(E,E)}return n}static async handleKernelError(e,t,n,i,o,s,a,l){let u=e.get(Et,rr),c=e.get(pn);a.interpreter&&n==="start"&&GX(u,19,a.interpreter).catch(E);let d=await c.handleKernelError(t,n,a,i,l),f=Qt(a),m=e.tryGet(qd);switch((m==null?void 0:m.isSupported)&&f&&n==="start"&&Rr(i,"DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",{reason:d}),o.dispose().catch(E),d){case 1:case 2:throw t;case 3:{let b=await qr.switchController(i,e);if(!b)throw t;s=b.controller,a=b.metadata;break}}return{controller:s,metadata:a}}static convertContextToFunction(e,t){switch(e){case"start":case"execution":return n=>n.start(t);case"interrupt":return n=>n.interrupt();case"restart":return n=>n.restart()}}static async verifyKernelState(e,t,n,i,o,s,a,l){let u=await i,{kernel:c,deadKernelAction:d}=u;if($A(c)){if(this.deleteKernelInfo(t,i),d==="deadKernelWasNoRestarted")throw new Ul(c.kernelConnectionMetadata);if(d==="deadKernelWasRestarted")throw new Ul(c.kernelConnectionMetadata);if((l==null?void 0:l.kernelWasRestartedDueToDeadKernel.value)===!0)throw new Ul(c.kernelConnectionMetadata);u.deadKernelAction="deadKernelWasRestarted";let f=Re();return f.resolve(!0),l=l||{kernelWasRestartedDueToDeadKernel:f},qr.wrapKernelMethod(c.kernelConnectionMetadata,"start",o,e,t,n,a,s,l)}return c}static async wrapKernelMethod(e,t,n,i,o,s,a,l=()=>void 0,u){var m,g,b,v;let c=this.getKernelInfo(o);if(!s.disableUI&&(c!=null&&c.options.disableUI)&&(c.options.disableUI=!1),!s.disableUI&&(c!=null&&c.kernel.resolved)&&((g=(m=c==null?void 0:c.kernel.value)==null?void 0:m.kernel)!=null&&g.disposed||(v=(b=c==null?void 0:c.kernel.value)==null?void 0:b.kernel)!=null&&v.disposing)&&(this.deleteKernelInfo(o),c=void 0),c&&t!=="restart"&&t!=="interrupt")return qr.verifyKernelState(i,o,s,c.kernel.promise,n,l,a);C.debug(`${t} the kernel, options.disableUI=${s.disableUI} for ${Ee("notebook"in o?o.notebook.uri:o.resource)}`),u=u||{kernelWasRestartedDueToDeadKernel:Re()};let d=qr.wrapKernelMethodImpl(e,t,i,o,s,n,l,u);u!=null&&u.kernelWasRestartedDueToDeadKernel.resolved&&u.kernelWasRestartedDueToDeadKernel.resolve(!0);let f=La(d);return f.promise.catch(E),d.then(k=>{k.kernel.onDisposed(()=>{this.deleteKernelInfo(o,f.promise)},void 0,a)}).catch(()=>{this.deleteKernelInfo(o,f.promise)}),this.setKernelInfo(o,f,s),qr.verifyKernelState(i,o,s,f.promise,n,l,a,u)}static getKernelInfo(e){return"notebook"in e?qr.connectionsByNotebook.get(e.notebook):qr.connectionsByUri.get(e.resource.toString())}static setKernelInfo(e,t,n){"notebook"in e?qr.connectionsByNotebook.set(e.notebook,{kernel:t,options:n}):qr.connectionsByUri.set(e.resource.toString(),{kernel:t,options:n})}static deleteKernelInfo(e,t){var n,i;if(!t){"notebook"in e?qr.connectionsByNotebook.delete(e.notebook):qr.connectionsByUri.delete(e.resource.toString());return}"notebook"in e&&((n=qr.connectionsByNotebook.get(e.notebook))==null?void 0:n.kernel.promise)===t?qr.connectionsByNotebook.delete(e.notebook):e.resource&&((i=qr.connectionsByUri.get(e.resource.toString()))==null?void 0:i.kernel.promise)===t&&qr.connectionsByUri.delete(e.resource.toString())}static verifyWeCanStartKernel(e,t){if(!Qt(e)||!e.kernelSpec.specFile)return;if(!t.get(FS).isTrusted(bu.Uri.file(e.kernelSpec.specFile)))throw new bM(e)}static async wrapKernelMethodImpl(e,t,n,i,o,s,a,l){let u=n.get(qe),c=n.get(jg),d,f=qr.convertContextToFunction(t,o),m=t,g="controller"in i?i.controller:void 0;for(t==="start"&&qr.verifyWeCanStartKernel(e,n);d===void 0;){if("notebook"in i&&i.notebook.isClosed)throw new bu.CancellationError;d="notebook"in i?u.getOrCreate(i.notebook,{metadata:e,controller:g||i.controller,resourceUri:i.resource}):c.getOrCreate(i.resource,{metadata:e,resourceUri:i.resource});let b=!1;try{if(t!=="restart"&&$A(d)&&!o.disableUI){b=!0;let v=await qr.notifyAndRestartDeadKernel(d);return v&&l&&l.kernelWasRestartedDueToDeadKernel.resolve(!0),{kernel:d,deadKernelAction:v?"deadKernelNeedsToBeRestarted":"deadKernelWasNoRestarted"}}else{if(a(m,d),await f(d),"notebook"in i&&i.notebook.isClosed)throw new bu.CancellationError;$A(d)&&!o.disableUI&&m!=="interrupt"&&await qr.notifyAndRestartDeadKernel(d)}}catch(v){if(b&&l&&l.kernelWasRestartedDueToDeadKernel.resolve(!0),Yn(v)||C.warn(`Error occurred while trying to ${m} the kernel, options.disableUI=${o.disableUI}`,v),o.disableUI)throw v;if("notebook"in i&&i.notebook.isClosed)throw new bu.CancellationError;let k=await qr.handleKernelError(n,v,m,i.resource,d,g,e,s);if(g=k.controller,e=k.metadata,f=R=>R.start(o),m="start",s==="3rdPartyExtension")throw v;d=void 0}}return{kernel:d}}static async connectToNotebookKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return qr.wrapKernelMethod(e,"start",s,t,n,i,o,a)}static async connectToKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return qr.wrapKernelMethod(e,"start",s,t,n,i,o,a)}};qr.connectionsByNotebook=new WeakMap,qr.connectionsByUri=new Map;var Ta=qr;p();var mv=class{constructor(e){this.controller=e}get id(){return this.controller.id}createNotebookCellExecution(e){return this.controller.createNotebookCellExecution(e)}};p();var SM=require("vscode");var IM=class extends Pr{constructor(t,n,i){super();this.kernel=t;this.controller=n;this.notebook=i}initialize(){let t=this.kernel,n=this.controller,i=this.notebook;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||t.status!=="busy"&&t.status!=="unknown"||!n.createNotebookExecution)return;this._register(SM.workspace.onDidCloseNotebookDocument(s=>{s===i&&this.dispose()},this)),this._register(n.onDidChangeSelectedNotebooks(s=>{s.notebook===i&&s.selected===!1&&this.dispose()},this)),this._register(t.onStatusChanged(s=>{s!=="busy"&&s!=="unknown"&&this.dispose()},this));let o=n.createNotebookExecution(i);o.start(),this._register(new SM.Disposable(()=>o.end()))}};var _M=class r{constructor(e,t,n,i,o,s,a,l,u,c,d){this.kernelConnection=e;this._viewType=n;this.kernelProvider=i;this.context=o;this.languageService=a;this.configuration=l;this.extensionChecker=u;this.serviceContainer=c;this.displayDataProvider=d;this._onNotebookControllerSelectionChanged=new Xt.EventEmitter;this._onConnecting=new Xt.EventEmitter;this.pendingCellAdditions=new WeakMap;this._onDidDispose=new Xt.EventEmitter;this.disposables=[];this.notebookKernels=new WeakMap;this.isDisposed=!1;this.runningCellExecutions=new WeakMap;this.associatedDocuments=new WeakMap;this.restoredConnections=new WeakSet;this.cellQueue=new WeakMap;var f;EY(e.id,(f=e.interpreter)==null?void 0:f.id),s.push(this),this.displayData=this.displayDataProvider.getDisplayData(this.connection),this.controller=Xt.notebooks.createNotebookController(t,n,this.displayData.label,this.handleExecution.bind(this),this.getRendererScripts()),this.displayData.onDidChange(this.updateDisplayData,this,this.disposables),this.updateDisplayData(),this.controller.interruptHandler=this.handleInterrupt.bind(this),this.controller.supportsExecutionOrder=!0,this.controller.supportedLanguages=this.languageService.getSupportedLanguages(e),this.controller.onDidChangeSelectedNotebooks(this.onDidChangeSelectedNotebooks,this,this.disposables),Xt.workspace.onDidCloseNotebookDocument(m=>{this.associatedDocuments.delete(m)},this,this.disposables)}get id(){return this.controller.id}get label(){return this.controller.label}get connection(){return this.kernelConnection}get viewType(){return this._viewType}get onNotebookControllerSelectionChanged(){return this._onNotebookControllerSelectionChanged.event}get onConnecting(){return this._onConnecting.event}get onDidReceiveMessage(){return this.controller.onDidReceiveMessage}get onDidDispose(){return this._onDidDispose.event}isAssociatedWithDocument(e){return this.associatedDocuments.has(e)}static create(e,t,n,i,o,s,a,l,u,c,d,f){let m=new r(e,t,n,i,o,s,a,l,u,c,d);try{m.controller.variableProvider=f}catch(g){C.warn("Failed to attach variable provider",g)}return m}async restoreConnection(e){var c;if(this.restoredConnections.has(e))return;this.restoredConnections.add(e);let t=await this.connectToKernel(e,new pr(!0));if(this.kernelConnection.kind==="connectToLiveRemoteKernel"){let d=new IM(t,this.controller,e);this.disposables.push(d),d.initialize()}let n=this.kernelProvider.getKernelExecution(t),o=await this.serviceContainer.get(Wl).getLastTrackedCellExecution(e,t);if(!((c=t.session)!=null&&c.kernel)||n.pendingCells.length||!o||e.cellCount<o.cellIndex||e.cellAt(o.cellIndex).kind!==Xt.NotebookCellKind.Code)return;Ll(t.resourceUri,t.kernelConnectionMetadata);let s=!1,a=[],l,u=(d,f)=>{if(!(f.direction==="send"||s)&&Yd(f.msg)===o.msg_id){if("msg_type"in f.msg&&f.msg.msg_type==="status"&&"execution_state"in f.msg.content&&f.msg.content.execution_state==="idle")return;s=!0,n.resumeCellExecution(e.cellAt(o.cellIndex),{msg_id:o.msg_id,startTime:o.startTime,executionCount:o.executionCount}).catch(E),Ce(a)}};t.session.kernel.anyMessage.connect(u),l=new Xt.Disposable(()=>{zs(()=>{var d,f;return(f=(d=t.session)==null?void 0:d.kernel)==null?void 0:f.anyMessage.disconnect(u)})}),a.push(l),this.disposables.push(l)}updateConnection(e){e.kind!=="connectToLiveRemoteKernel"&&(this.controller.label=ut(e))}asWebviewUri(e){return this.controller.asWebviewUri(e)}postMessage(e,t){let n=e&&"message"in e?e.message:"";return C.ci(`\x1B[32mPosting message to Notebook UI ${n}`),this.controller.postMessage(e,t)}setPendingCellAddition(e,t){if(this.viewType!==vr)throw new Error("setPendingCellAddition only applies to the Interactive Window");this.pendingCellAdditions.set(e,t)}dispose(){if(this.isDisposed)return;let e=Xt.workspace.notebookDocuments.filter(t=>this.associatedDocuments.has(t)).map(t=>t.uri.toString());C.debug(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""}`),C.ci(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""} called from ${new Error("").stack}`),this.isDisposed=!0,this._onNotebookControllerSelectionChanged.dispose(),this._onConnecting.dispose(),this.controller.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose(),Ce(this.disposables)}updateDisplayData(){this.controller.label=this.displayData.label;let e=this.connection.kind==="connectToLiveRemoteKernel"?"":this.displayData.description;this.controller.description=e,this.displayData.serverDisplayName&&(this.controller.description=e?`${e} (${this.displayData.serverDisplayName})`:this.displayData.serverDisplayName)}async handleExecution(e,t){if(e.length<1)return;let n=Vc(t);n==null||n.cellExecutionCount(e.length);let i=n==null?void 0:n.preExecuteCellTelemetry();if(this.pendingCellAdditions.has(t)&&await this.pendingCellAdditions.get(t),e=e.filter(s=>s.index<0?(C.warn(`Attempting to run a cell with index ${s.index}, kind ${s.kind}, text = ${s.document.getText()}`),!1):!0),!Xt.workspace.isTrusted)return;C.debug(`Handle Execution of Cells ${e.map(s=>s.index)} for ${Ee(t.uri)}`),await Ll(t.uri,this.connection),i==null||i.stop();let o=this.cellQueue.get(t)||[];this.cellQueue.set(t,o.concat(e)),await this.executeQueuedCells(t)}async onDidChangeSelectedNotebooks(e){var n,i;if(C.ci(`NotebookController selection event called for notebook ${e.notebook.uri.toString()} & controller ${this.connection.kind}:${this.id}. Selected ${e.selected} `),this.associatedDocuments.has(e.notebook)&&e.selected)return;if(!e.selected){let o=this.kernelProvider.get(e.notebook);(o==null?void 0:o.kernelConnectionMetadata.id)===this.kernelConnection.id&&(C.info(`Disposing kernel ${this.kernelConnection.id} for notebook ${Ee(e.notebook.uri)} due to selection of another kernel or closing of the notebook`),o.dispose().catch(E)),this.associatedDocuments.delete(e.notebook),this._onNotebookControllerSelectionChanged.fire({controller:this,notebook:e.notebook,selected:e.selected});return}if(!hr(e.notebook)&&e.notebook.notebookType!==vr||!Xt.workspace.isTrusted)return;(i=Vc(e.notebook))==null||i.kernelSelected(this.kernelConnection.id,(n=this.kernelConnection.interpreter)==null?void 0:n.id),d_e(this.kernelConnection);let t=Re();C.ci(`Controller ${this.connection.kind}:${this.id} associated with nb ${Ee(e.notebook.uri)}`),this.associatedDocuments.set(e.notebook,t.promise),await this.onDidSelectController(e.notebook),await this.updateCellLanguages(e.notebook),this._onNotebookControllerSelectionChanged.fire({controller:this,notebook:e.notebook,selected:e.selected}),C.debug("Controller selection change completed"),t.resolve()}async updateCellLanguages(e){let t=this.controller.supportedLanguages;if(!t||(t==null?void 0:t.length)===0)return;let i=jt(this.kernelConnection)?Ye:t[0];await Promise.all(e.getCells().filter(o=>o.kind===Xt.NotebookCellKind.Code).map(async o=>{t.includes(o.document.languageId)||await Xt.languages.setTextDocumentLanguage(o.document,i).then(E,E)}))}getRendererScripts(){return this.context.extensionMode===Xt.ExtensionMode.Development||this.context.extensionMode===Xt.ExtensionMode.Test?[new Xt.NotebookRendererScript(Xt.Uri.joinPath(this.context.extensionUri,"dist","webviews","webview-side","widgetTester","widgetTester.js"))]:[]}handleInterrupt(e){C.debug(`VS Code interrupted kernel for ${Ee(e.uri)}`),e.getCells().forEach(t=>it(t,"Cell cancellation requested")),Xt.commands.executeCommand(le.InterruptKernel,{notebookEditor:{notebookUri:e.uri}}).then(E,t=>C.error("Failed to interrupt",t))}createCellExecutionIfNecessary(e,t){let n=this.runningCellExecutions.get(e.notebook);if(!n||n.cell===e){n==null||n.end(void 0,void 0),n=no.getOrCreate(e,t,!0),this.runningCellExecutions.set(e.notebook,n);let i=n.end.bind(n);n.end=(o,s)=>{this.runningCellExecutions.delete(e.notebook),i(o,s)}}return n}async executeQueuedCells(e){if(!this.cellQueue.has(e))return;let t=(this.cellQueue.get(e)||[]).map(c=>{let d=this.createCellExecutionIfNecessary(c,new mv(this.controller));return{cell:c,exec:d}});this.cellQueue.delete(e);let n=t.length?t[0].cell:void 0;if(!n)return;C.trace(`Execute Notebook ${Ee(e.uri)}. Step 1`);let i="start",o=new mv(this.controller),s=this.serviceContainer.get(Wl),a;try{if(C.trace(`Connect to Kernel ${Ee(e.uri)}. Step 2`),a=await this.connectToKernel(e,new pr(!1)),C.trace(`Connected to Kernel ${Ee(e.uri)}. Step 3`),a.disposing)throw new Xt.CancellationError;a&&a.controller.id!==o.id&&(o=a.controller,t.forEach(c=>c.exec=this.createCellExecutionIfNecessary(c.cell,o))),i="execution",a.controller.id===this.id&&this.updateKernelInfoInNotebookWhenAvailable(a,e)}catch(c){if(c instanceof $d)return;Yn(c)||C.error("Error in notebook cell execution",c),t.forEach(({cell:m,exec:g})=>{g.start(),g.clearOutput(m).then(E,E)});let d=this.serviceContainer.get(pn);c=Ln.unwrap(c);let f=Yn(c)||c instanceof Ul;await Ld(n,o,await d.getErrorMessageForDisplayInCellOutput(c,i,e.uri),f)}if(!a)return;let l=this.kernelProvider.getKernelExecution(a),u=new En;await Promise.all(t.map(async({cell:c})=>{var d;try{let f=(d=Vc(e))==null?void 0:d.executeCell();f&&u.add(new Xt.Disposable(()=>f.stop())),s.trackCellExecution(c,a),C.trace(`executeCell ${c.index}. Step 4`),await l.executeCell(c),FE.isExiting||s.deleteTrackedCellExecution(c,a)}catch(f){if(f instanceof $d)return;Yn(f)||C.error("Error in cell execution",f);let m=this.serviceContainer.get(pn);f=Ln.unwrap(f);let g=Yn(f)||f instanceof Ul;await Ld(c,o,await m.getErrorMessageForDisplayInCellOutput(f,i,e.uri),g)}})).catch(E)}async connectToKernel(e,t){var i;let n=(i=Vc(e))==null?void 0:i.startKernel();return this._onConnecting.fire(),Ta.connectToNotebookKernel(this.kernelConnection,this.serviceContainer,{resource:e.uri,notebook:e,controller:this.controller},t,this.disposables).finally(()=>n==null?void 0:n.stop())}updateKernelInfoInNotebookWhenAvailable(e,t){if(this.notebookKernels.get(t)===e)return;this.notebookKernels.set(t,e);let n=[];Xt.workspace.onDidCloseNotebookDocument(s=>{s===t&&Ce(n)},this,n);let i=e.onDisposed(()=>Ce(n)),o=e.onStatusChanged(async()=>{e.disposed||!e.info||this.associatedDocuments.has(t)&&(await nee(t,e.kernelConnectionMetadata,e.info),e.info.status==="ok"&&Ce(n))});n.push({dispose:()=>o.dispose()}),n.push({dispose:()=>i==null?void 0:i.dispose()})}async onDidSelectController(e){let t=this.connection,n=this.kernelProvider.get(e);if(n&&cQ(n.kernelConnectionMetadata,t)){C.info("Switch kernel did not change kernel.");return}if(Rr(e.uri,"DS_INTERNAL.SWITCH_KERNEL"),n&&Xt.window.visibleNotebookEditors.filter(s=>s.notebook===e).forEach(s=>this.postMessage({message:"IPyWidgets_onKernelChanged",payload:void 0},s)),await nee(e,t),e.notebookType===vr)return;let i=this.kernelProvider.getOrCreate(e,{metadata:t,controller:this.controller,resourceUri:e.uri});if(C.debug(`KernelProvider switched kernel to id = ${i.kernelConnectionMetadata.id}`),jt(this.kernelConnection)&&!this.extensionChecker.isPythonExtensionInstalled)return;let o=this.serviceContainer.get(FS);!this.configuration.getSettings(void 0).disableJupyterAutoStart&&Qt(this.kernelConnection)&&this.kernelConnection.kernelSpec.specFile&&o.isTrusted(Xt.Uri.file(this.kernelConnection.kernelSpec.specFile))&&this.connectToKernel(e,new pr(!0))}};async function nee(r,e,t){let n=_a(r)||{},{changed:i}=await tQ(n,e,t);i&&await dY(r,n)}async function d_e(r){let e=await kp(r.interpreter,!0),t=(e==null?void 0:e.major)||0,n=(e==null?void 0:e.minor)||0;!e||t>=4||t<=0||n<=-1||r.kind!=="startUsingLocalKernelSpec"&&r.kind!=="startUsingPythonInterpreter"||(t<3||t===3&&n<=5)&&Xt.window.showWarningMessage(W.warnWhenSelectingKernelWithUnSupportedPythonVersion,Ue.learnMore).then(i=>{if(i===Ue.learnMore)return GI("https://aka.ms/jupyterUnSupportedPythonKernelVersions")},E)}var ZS=class{constructor(e,t,n,i,o,s){this.disposables=e;this.pythonEnvFilter=t;this.extensionChecker=n;this.serviceContainer=i;this.serverUriStorage=o;this.kernelFinder=s;this.registeredControllers=new Map;this.changeEmitter=new e_.EventEmitter;this.registeredMetadatas=new Map;this.selectedEmitter=new e_.EventEmitter;this.selectionChangedEmitter=new e_.EventEmitter;this.selectedControllers=new WeakMap;this._activeInterpreterControllerIds=new Set}get onDidChange(){return this.changeEmitter.event}get registered(){return[...this.registeredControllers.values()]}get all(){return this.metadatas}get metadatas(){return[...this.registeredMetadatas.values()]}get onControllerSelected(){return this.selectedEmitter.event}get onControllerSelectionChanged(){return this.selectionChangedEmitter.event}activate(){this.kernelFinder.onDidChangeKernels(()=>this.loadControllers(),this,this.disposables),this.kernelFinder.registered.forEach(e=>this.monitorDeletionOfConnections(e)),this.kernelFinder.onDidChangeRegistrations(e=>e.added.forEach(t=>this.monitorDeletionOfConnections(t)),this,this.disposables),this.pythonEnvFilter.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeUri,this,this.disposables),this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables),this.loadControllers()}loadControllers(){this.controllersPromise=this.loadControllersImpl(),ZZ(this.registered.map(e=>e.connection)),C.ci(`Providing notebook controllers with length ${this.registered.length}.`)}get loaded(){return this.controllersPromise}async loadControllersImpl(){let e=this.kernelFinder.kernels;this.createNotebookControllers(e),Array.from(this.registered).filter(n=>{let i=e.some(o=>o.id===n.connection.id)||ci&&this._activeInterpreterControllerIds.has(n.id);return!i&&n.connection.kind==="connectToLiveRemoteKernel"?!0:this.canControllerBeDisposed(n)?(i||C.debug(`Controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}' is no longer a valid`),!i):!1}).forEach(n=>{C.warn(`Disposing old controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}'`),n.dispose()})}createNotebookControllers(e){if(e.length!==0)try{this.batchAdd(e,[St,vr])}catch(t){if(!Yn(t,!0))throw t}}async monitorDeletionOfConnections(e){let t=e.onDidChangeKernels(({removed:n})=>{let i=new Set((n||[]).map(o=>o.id));this.registered.filter(o=>i.has(o.connection.id)).forEach(o=>{C.warn(`Deleting controller ${o.id} as it is associated with a connection that has been deleted ${o.connection.kind}:${o.id}`),o.dispose()})},this,this.disposables);this.kernelFinder.onDidChangeRegistrations(n=>{n.removed.includes(e)&&t.dispose()})}onDidChangeUri(){this.onDidChangeFilter()}async onDidRemoveServers(e){e.forEach(t=>{this.registered.forEach(n=>{Wt(n.connection)&&n.connection.serverProviderHandle.id===t.id&&n.connection.serverProviderHandle.handle===t.handle&&(C.warn(`Deleting controller ${n.id} as it is associated with a connection that has been removed`),n.dispose())})}),this.onDidChangeFilter()}onDidChangeFilter(){this.all.forEach(t=>this.addOrUpdate(t,[St,vr]))}batchAdd(e,t){let n=[];e.forEach(i=>{let{added:o}=this.addImpl(i,t,!1);n.push(...o)}),n.length&&this.changeEmitter.fire({added:n,removed:[]})}trackActiveInterpreterControllers(e){e.forEach(t=>this._activeInterpreterControllerIds.add(t.id))}canControllerBeDisposed(e){return!this._activeInterpreterControllerIds.has(e.id)&&!this.isControllerAttachedToADocument(e)}getSelected(e){return this.selectedControllers.get(e)}addOrUpdate(e,t){let{added:n,existing:i}=this.addImpl(e,t,!0);return n.concat(i)}addImpl(e,t,n){let i=[],o=[];C.ci(`Create Controller for ${e.kind} and id '${e.id}' for view ${t.join(", ")}`);try{t.map(s=>{let a=this.getControllerId(e,s);return this.registeredMetadatas.set(e.id,e),[a,s]}).filter(([s])=>{let a=this.registeredControllers.get(s);return a?(a.updateConnection(e),o.push(a),C.ci(`Found existing controller '${a.id}', not creating a new one just updating it`),!1):(C.ci(`Existing controller not found for '${s}', hence creating a new one`),!0)}).forEach(([s,a])=>{let l=_M.create(e,s,a,this.serviceContainer.get(qe),this.serviceContainer.get(st),this.disposables,this.serviceContainer.get(Bs),this.serviceContainer.get(Ke),this.extensionChecker,this.serviceContainer,this.serviceContainer.get(RI),this.serviceContainer.get(oM)),u=[];l.onDidDispose(()=>{C.trace(`Deleting controller '${l.id}' associated with view ${a} from registration as it was disposed`),this.registeredControllers.delete(l.id),u.forEach(c=>c.dispose())},this,this.disposables),this.disposables.push(l),this.registeredControllers.set(l.id,l),i.push(l),l.onNotebookControllerSelectionChanged(c=>{var d;c.selected&&(C.ci(`Controller ${(d=c.controller)==null?void 0:d.id} selected for ${c.notebook.uri.toString()}`),this.selectedControllers.set(c.notebook,c.controller),this.selectedEmitter.fire(c))},this,u),l.onNotebookControllerSelectionChanged(c=>this.selectionChangedEmitter.fire({...c,controller:l}),this,u)}),n&&i.length&&this.changeEmitter.fire({added:i,removed:[]})}catch(s){if(Yn(s,!0))return C.warn(`Cancel creation of notebook controller for ${e.id}`,s),{added:i,existing:o};C.error(`Failed to create notebook controller for ${e.id}`,s)}return{added:i,existing:o}}get(e,t){let n=this.getControllerId(e,t);return this.registeredControllers.get(n)}getControllerId(e,t){return t===St?e.id:`${e.id}${SQ}`}isControllerAttachedToADocument(e){return e_.workspace.notebookDocuments.some(t=>e.isAssociatedWithDocument(t))}};ZS=U([(0,Zd.injectable)(),x(0,(0,Zd.inject)(ve)),x(1,(0,Zd.inject)(Bd)),x(2,(0,Zd.inject)(vo)),x(3,(0,Zd.inject)(Ar)),x(4,(0,Zd.inject)(dr)),x(5,(0,Zd.inject)(ii))],ZS);p();p();var gm=oe(he());p();var iee=require("vscode"),kP=class{constructor(e,t){this.id="remote";if(e.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage of this class, can only be used with remtoe kernels");this.kernelConnection=e.kernelConnectionMetadata,this.scriptManager=t.getOrCreate(e)}dispose(){}async getBaseUrl(){return iee.Uri.parse(this.kernelConnection.baseUrl)}async getWidgetScriptSource(e){let n=(await this.getWidgetScriptSources()).find(i=>i.moduleName.toLowerCase()===e.toLowerCase());if(!n&&e.includes("/")){let i=await this.getBaseUrl();return{moduleName:e,scriptUri:`${i.toString()}${e}`,source:"remote"}}return n||{moduleName:e}}async getWidgetScriptSources(){let e=await this.scriptManager.getWidgetModuleMappings();return e&&Object.keys(e).length?await Promise.all(Object.keys(e).map(async n=>({moduleName:n,scriptUri:e[n].toString(),source:"remote"}))):[]}};kP.validUrls=new Map;var t_=class{constructor(e,t,n){this.configurationSettings=e;this.globalMemento=t;this.widgetScriptManagerFactory=n}getProviders(e,t){let n=[];switch(n.push(new jl(this.globalMemento,this.configurationSettings)),e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":n.push(new kP(e,this.widgetScriptManagerFactory));break}return n}};t_=U([(0,gm.injectable)(),x(0,(0,gm.inject)(Ke)),x(1,(0,gm.inject)(Et)),x(1,(0,gm.named)(rr)),x(2,(0,gm.inject)(hM))],t_);p();var gv=oe(he());p();var hv=require("vscode");p();var C9=require("vscode");var vee=oe(hee());var gee=["require.config({","requirejs?.config({","window.requirejs?.config({","requirejs.config({",'["require"].config({',"['require'].config({",'["requirejs"].config({',"['requirejs'].config({",'["require"]["config"]({',"['require']['config']({",'["requirejs"]["config"]({',"['requirejs']['config']({"];async function h_e(r,e,t){let n=[...gee],i=await Rt(e),o=0,s;for(;o<=0&&n.length&&(s=n.pop(),!!s);)o=t.indexOf(s);if(o<0){let f=[...gee].map(m=>m.substring(0,m.length-2));for(;o<=0&&f.length&&(s=f.pop(),!!s);)o=t.indexOf(s)}if(o<0){ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigStart"});return}let a=t.indexOf(")",o);if(a<=0||!s){ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigEnd"});return}let l=t.indexOf("{",o),u=t.substring(l,a);u=(0,vee.default)(u,{language:"javascript"}),u=lt(u,{trim:!0,removeEmptyEntries:!0}).join("");let c=u.split("{")[u.split("{").length-1].split("}")[0].split(",").map(f=>f.trim()).filter(f=>f.length&&f.includes(":")),d={};if(c.forEach(f=>{let m=f.split(":"),g=qE(m[0].replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim(),b=qE(f.substring(f.indexOf(":")+1).replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim();d[g]=b.startsWith("http")?C9.Uri.parse(b):C9.Uri.joinPath(r,b)}),!d||!Object.keys(d).length){ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"noRequireConfigEntries"});return}return ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",{requireEntryPointCount:Object.keys(d).length},{widgetFolderNameHash:i,patternUsedToRegisterRequireConfig:s}),d}var xM=class{constructor(e){this.kernel=e;this.disposables=[];e.onRestarted(this.onKernelRestarted,this,this.disposables)}dispose(){Ce(this.disposables)}async getWidgetModuleMappings(){return this.widgetModuleMappings||(this.widgetModuleMappings=this.getWidgetModuleMappingsImpl()),this.widgetModuleMappings}onKernelRestarted(){this.widgetModuleMappings=void 0}async getConfigFromWidget(e,t,n){let i=await this.getWidgetScriptSource(t);try{let o=await h_e(e,n,i);if(!o){let s=`Failed to extract require.config from widget for ${n} from ${Ee(t)}`;ci&&(s+=`with contents ${i}`),C.warn(s)}return o}catch(o){C.error(`Failed to extract require.config entry for ${n} from ${Ee(t)}`,o)}}async getWidgetModuleMappingsImpl(){let e=new yt,[t,n]=await Promise.all([this.getWidgetEntryPoints(),this.getNbExtensionsParentPath()]);if(!n)return;let o=(await Promise.all(t.map(s=>this.getConfigFromWidget(n,s.uri,s.widgetFolderName)))).reduce((s,a)=>Object.assign(s||{},a),{});return o&&Object.keys(o).length&&(delete o["jupyter-js-widgets"],delete o["@jupyter-widgets/base"],delete o["@jupyter-widgets/controls"],delete o["@jupyter-widgets/output"]),ne("DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",{duration:e.elapsedTime},{type:Qt(this.kernel.kernelConnectionMetadata)?"local":"remote"}),o&&Object.keys(o).length?o:void 0}};var PM=class extends xM{constructor(t,n,i,o){super(t);this.context=n;this.fs=i;this.connection=o;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&t.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage, can only be used for remote kernels");this.kernelConnection=t.kernelConnectionMetadata,this.getWidgetEntryPoints().catch(E)}getBaseUrl(){return this.getNbExtensionsParentPath()}async getNbExtensionsParentPath(){return hv.Uri.parse(this.kernelConnection.baseUrl)}onKernelRestarted(){this.widgetEntryPointsPromise=void 0,super.onKernelRestarted()}async getWidgetEntryPoints(){return this.widgetEntryPointsPromise||(this.widgetEntryPointsPromise=this.getWidgetEntryPointsImpl()),this.widgetEntryPointsPromise}getCodeToExecute(){return this.code||(this.code=this.fs.readFile(hv.Uri.joinPath(this.context.extensionUri,"pythonFiles","printJupyWidgetEntryPoints.py"))),this.code}async getWidgetEntryPointsImpl(){var s;if(!jt(this.kernelConnection))return[];let t=await this.getCodeToExecute();if(!((s=this.kernel.session)!=null&&s.kernel))return C.ci("No Kernel session to get list of widget entry points"),[];let n=[];n.push(Ai(this.kernel.session.kernel,t,{traceErrors:!0,traceErrorsMessage:"Failed to get widget entry points from remote kernel"})),!ci&&this.context.extensionMode===hv.ExtensionMode.Production&&n.push(nc(1e4).then(()=>[])),n.forEach(a=>a.catch(E));let i=await Promise.race(n);if(i.length===0)return C.ci("Unable to get widget entry points, no outputs after running the code"),[];let o=i[0];if(o.output_type!=="stream"||o.name!=="stdout")return C.ci("Unable to get widget entry points, no stream/stdout outputs after running the code"),[];try{return C.trace(`Widget Outputs include, ${o.text}`),o.text.trim().substring(1).slice(0,-1).split(",").map(l=>qE(l.trim()).replace(/\\\\/g,"/").replace(/\\/g,"/")).map(l=>({uri:hv.Uri.joinPath(hv.Uri.parse(this.kernelConnection.baseUrl),"nbextensions",l),widgetFolderName:Ci(l)}))}catch(a){return C.error(`Failed to parse output to get list of IPyWidgets, output is ${o.text}`,a),[]}}async getWidgetScriptSource(t){let n=this.getWidgetScriptSourceUsingHttpClient(t),i=this.getWidgetScriptSourceUsingFetch(t),o=n.catch(()=>i);return o.catch(s=>{n.catch(a=>C.error(`Failed to download widget script source from ${t.toString(!0)}`,a)),C.error(`Failed to download widget script source from ${t.toString(!0)}`,s)}),o}async getWidgetScriptSourceUsingHttpClient(t){let n=t.toString(!0),o=await new du().downloadFile(n);if(o.status===200)return o.text();throw new Error(`Error downloading from ${n}: ${o.statusText}`)}async getWidgetScriptSourceUsingFetch(t){let n=await this.connection.createConnectionInfo(this.kernelConnection.serverProviderHandle),i=t.toString(!0),s=await new du(n.settings.fetch).downloadFile(i);if(s.status===200)return s.text();throw new Error(`Error downloading from ${i} using custom fetch: ${s.statusText}`)}};var r_=class{constructor(e,t,n,i){this.context=e;this.fs=t;this.disposables=n;this.connection=i;this.managers=new WeakMap}getOrCreate(e){if(!this.managers.has(e))if(e.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"||e.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec"){let t=new PM(e,this.context,this.fs,this.connection);this.managers.set(e,t),e.onDisposed(()=>t.dispose(),this,this.disposables)}else throw new Error("Cannot enumerate Widget Scripts using local kernels on the Web");return this.managers.get(e)}};r_=U([(0,gv.injectable)(),x(0,(0,gv.inject)(st)),x(1,(0,gv.inject)(Pt)),x(2,(0,gv.inject)(ve)),x(3,(0,gv.inject)(fn))],r_);p();var yee=oe(he()),bee=require("vscode");var n_=class{async getNbExtensionsParentPath(e){switch(e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":return bee.Uri.parse(e.kernelConnectionMetadata.baseUrl);default:return}}};n_=U([(0,yee.injectable)()],n_);p();var DM=oe(he()),Bl=require("vscode");var ka=class{constructor(e){this.disposables=[];e.push(this)}dispose(){Ce(this.disposables)}activate(){let e=new rc(1e3);this.disposables.push(e),Bl.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>this.onDidChangeNotebookDocument(t))},this,this.disposables)}onDidChangeNotebookDocument(e){hr(e.notebook)&&e.cellChanges.some(t=>t.outputs&&t.outputs.some(n=>n.items&&n.items.some(i=>i.mime===uo)))&&this.checkRendererExtensionVersion()}checkRendererExtensionVersion(){if(!Bl.workspace.isTrusted)return;let e=Bl.extensions.getExtension(vp);if(!e){this.displayNotInstalledMessage();return}let t=e.packageJSON.version;if(!t){this.displayUpdateMessage();return}let n=t.split("."),i=parseInt(n[0],10),o=parseInt(n[1],10),s=parseInt(n[2],10);(i<1||i===1&&o===0&&s<15)&&this.displayUpdateMessage()}displayNotInstalledMessage(){ka.messageDisplayed||(ka.messageDisplayed=!0,Bl.window.showInformationMessage(W.rendererExtensionRequired,{modal:!0},Ue.bannerLabelYes).then(e=>{e===Ue.bannerLabelYes&&Bl.commands.executeCommand("extension.open",vp).then(E,E)}).then(E,E))}displayUpdateMessage(){ka.messageDisplayed||(ka.messageDisplayed=!0,Bl.window.showInformationMessage(W.rendererExtension1015Required,{modal:!0},Ue.bannerLabelYes).then(e=>{e===Ue.bannerLabelYes&&Bl.commands.executeCommand("extension.open",vp).then(E,E)}).then(E,E))}};ka.messageDisplayed=!1,ka=U([(0,DM.injectable)(),x(0,(0,DM.inject)(ve))],ka);function Iee(r,e){r.addSingleton(Vl,Vl),r.addSingleton(mM,t_),r.addSingleton(hM,r_),r.addSingleton(BZ,n_),r.addSingleton(jl,jl),r.addSingleton(Ve,ka)}p();var ym=oe(he()),Jr=require("vscode");var i_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.kernelFinder=t;this.notebookEditorProvider=n;this.kernelDependency=i;this.localDisposables=[];this.providerMappings=new Map;this.kernelSpecsSourceRegistered=!1;o.push(this)}dispose(){Ce(this.localDisposables)}activate(){if(!zr()){this.localDisposables.push(Jr.notebooks.registerKernelSourceActionProvider(St,{provideNotebookKernelSourceActions:()=>[{label:W.localPythonEnvironments,documentation:Jr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]})),this.localDisposables.push(Jr.notebooks.registerKernelSourceActionProvider(vr,{provideNotebookKernelSourceActions:()=>[{label:W.localPythonEnvironments,documentation:Jr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]}));let t=[],n=new Jr.EventEmitter;this.localDisposables.push(Jr.notebooks.registerKernelSourceActionProvider(St,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t})),this.localDisposables.push(Jr.notebooks.registerKernelSourceActionProvider(vr,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t}));let i=()=>{this.kernelSpecsSourceRegistered||this.kernelFinder.kernels.some(o=>sQ(o))&&(this.kernelSpecsSourceRegistered=!0,t=[{label:W.localKernelSpecs,documentation:Jr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerJupyterKernels"),command:"jupyter.kernel.selectLocalKernelSpec"}],n.fire())};i(),this.kernelFinder.onDidChangeKernels(()=>i(),this,this.localDisposables),this.localDisposables.push(Jr.commands.registerCommand("jupyter.kernel.selectLocalKernelSpec",this.onSelectLocalKernel.bind(this,"localKernelSpec"),this)),this.localDisposables.push(Jr.commands.registerCommand("jupyter.kernel.selectLocalPythonEnvironment",this.onSelectLocalKernel.bind(this,"localPythonEnvironment"),this))}this.localDisposables.push(Jr.commands.registerCommand("jupyter.kernel.selectJupyterServerKernel",this.onSelectRemoteKernel,this)),tt.instance.get(sr).onDidChangeCollections(this.registerUriCommands,this,this.localDisposables),this.registerUriCommands()}registerUriCommands(){let e=tt.instance.get(sr),t=new Set;e.jupyterCollections.map(n=>{let i=`${n.extensionId}:${n.id}`;if(n.id===cD||(t.add(i),this.providerMappings.has(i)))return;let o=Jr.notebooks.registerKernelSourceActionProvider(St,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]}),s=Jr.notebooks.registerKernelSourceActionProvider(vr,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]});this.localDisposables.push(o),this.localDisposables.push(s),this.providerMappings.set(i,{disposables:[o,s],provider:n})}),this.providerMappings.forEach(({disposables:n},i)=>{t.has(i)||(Ce(n),this.providerMappings.delete(i))})}async onSelectLocalKernel(e,t){var n;if(t=t||((n=Jr.window.activeNotebookEditor)==null?void 0:n.notebook),!!t)if(e==="localPythonEnvironment"){let o=await tt.instance.get(DR).selectLocalKernel(t);return this.getSelectedController(t,o)}else{let o=await tt.instance.get(_Q).selectLocalKernel(t);return this.getSelectedController(t,o)}}async onSelectRemoteKernel(e,t,n){var l,u,c;if(n=n||((l=Jr.window.activeNotebookEditor)==null?void 0:l.notebook),!n&&Jr.window.activeTextEditor&&(n=(u=this.notebookEditorProvider.findNotebookEditor(Jr.window.activeTextEditor.document.uri))==null?void 0:u.notebook),!n)return;let i=`${e}:${t}`,o=(c=this.providerMappings.get(i))==null?void 0:c.provider;if(!o)return;let a=await tt.instance.get(PR).selectRemoteKernel(n,o);return this.getSelectedController(n,a)}async getSelectedController(e,t){var o;if(!t)return;let n=this.controllerRegistration.addOrUpdate(t,[e.notebookType]);if(!Array.isArray(n)||n.length===0){C.warn(`No controller created for selected kernel connection ${t.kind}:${t.id}`);return}Ll(e.uri,t).finally(()=>Rr(e.uri,"DS_INTERNAL.SWITCH_KERNEL",void 0,{newKernelPicker:!0})).catch(E),(o=n.find(s=>s.viewType===e.notebookType))==null||o.controller.updateNotebookAffinity(e,Jr.NotebookControllerAffinity.Preferred);let i=n[0];return await this.onControllerSelected(e,i),i.controller.id}async onControllerSelected(e,t){if(IY(e),Qt(t.connection)&&jt(t.connection)&&Tp(t.connection.interpreter)&&!zr()){let n=[];try{let i=new Jr.CancellationTokenSource;n.push(i);let o=new pr(!1);n.push(o),await this.kernelDependency.installMissingDependencies({resource:e.uri,kernelConnection:t.connection,token:i.token,ui:o,cannotChangeKernels:!0,ignoreCache:!0,installWithoutPrompting:!0})}catch(i){C.error(`Failed to install missing dependencies for Conda kernel ${t.connection.id}`,i)}finally{Ce(n)}}}};i_=U([(0,ym.injectable)(),x(0,(0,ym.inject)(Nt)),x(1,(0,ym.inject)(ii)),x(2,(0,ym.inject)(Ao)),x(3,(0,ym.inject)(wI)),x(4,(0,ym.inject)(ve))],i_);p();var Iu=oe(he()),si=require("vscode");p();var Lo=require("vscode");var w9=class{constructor(e){this.label=e}},TM=class extends w9{constructor(t,n){super(t);this.sortKey=n;this.kind=Lo.QuickPickItemKind.Separator}},kM=class extends Pr{constructor(t,n,i,o,s,a){super();this.provider=t;this.createQuickPickItem=n;this.getCategory=i;this.options=o;this.createErrorQuickPickItem=s;this._title=a;this.categories=new Map;this.quickPickItems=[];this.previouslyEnteredValue="";this.commands=[];this._placeholder="";this.quickPickItemMap=new WeakSet;this.errorQuickPickItemMap=new WeakSet}set recommended(t){var i;let n=((i=this._recommended)==null?void 0:i.id)!==(t==null?void 0:t.id);this._recommended=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get recommended(){return this._recommended}set placeholder(t){this.quickPick&&(this.quickPick.placeholder=t),this._placeholder=t}get placeholder(){return this._placeholder}set selected(t){let n=this._selected!==t;this._selected=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get selected(){return this._selected}createQuickPick(){let t=[],n={iconPath:new Lo.ThemeIcon("refresh"),tooltip:Ue.refresh},i=this.quickPick=Lo.window.createQuickPick();return t.push(i),this.quickPickItems=[],i.placeholder=this.placeholder,i.matchOnDescription=!0,i.buttons=this.options.supportsBack?[Lo.QuickInputButtons.Back,n]:[n],i.ignoreFocusOut=!0,i.busy=!0,i.value=this.previouslyEnteredValue,i.onDidChangeValue(o=>this.previouslyEnteredValue=o,this,t),i.onDidHide(()=>Ce(t),this,t),i.title=this._title||W.kernelPickerSelectKernelFromRemoteTitleWithoutName,this.provider.then(o=>{this.resolvedProvider=o,this._title||(i.title=W.kernelPickerSelectKernelFromRemoteTitle(o.title)),i.busy=o.status==="discovering",o.onDidChange(()=>this.updateQuickPickItems(i,o),this,t),i.onDidTriggerButton(async a=>{a===n&&(i.busy=!0,await o.refresh().catch(E),this.updateQuickPickItems(i,o),i.busy=!1)},this,t);let s;o.onDidChangeStatus(()=>{switch(s&&clearTimeout(s),o.status){case"discovering":i.busy=!0;break;case"idle":s=setTimeout(()=>i.busy=!1,500),t.push(new Lo.Disposable(()=>s&&clearTimeout(s)));break}},this,t),See(o.items.map(a=>this.toQuickPickItem(a)),(a,l)=>_ee(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{let l=this.connectionToCategory(a[0].item);this.quickPickItems.push(l),a.sort((u,c)=>u.label.localeCompare(c.label)),this.quickPickItems.push(...a),this.categories.set(l,new Set(a))}),this.updateQuickPickItems(i,o)}).catch(o=>C.error(`Failed to get quick pick items for ${i.title}`,o)),t.forEach(o=>this._register(o)),{quickPick:i,disposables:t}}isCommandQuickPickItem(t){return this.commands.indexOf(t)>=0}addCommand(t,n,i){let o;i&&(o={execute:()=>Promise.resolve(void 0),label:W.recommendedItemCategoryInQuickPick,kind:Lo.QuickPickItemKind.Separator},this.commands.push(o));let s=t;return s.execute=n,this.commands.push(s),this.quickPick&&this.rebuildQuickPickItems(this.quickPick),{dispose:()=>{if(o){let l=this.commands.indexOf(o);l>=0&&this.commands.splice(l,1)}let a=this.commands.indexOf(s);a>=0&&this.commands.splice(a,1)}}}async selectItem(t){for(;!t.isCancellationRequested;){let{quickPick:n,disposables:i}=this.createQuickPick();n.show();try{this.previouslySelectedItem=void 0;let o=await new Promise((s,a)=>{n.onDidChangeSelection(l=>{if(l.length){let u=l[0];this.isSelectorQuickPickItem(u)?s(u.item):this.isCommandQuickPickItem(u)?s(u):this.isErrorQuickPickItem(u)}}),n.onDidTriggerButton(l=>l===Lo.QuickInputButtons.Back?s(ze.back):void 0,this,i),n.onDidHide(()=>s(void 0),this,i)});if(t.isCancellationRequested||!o)return;if(o instanceof ze)return o===ze.back?ze.back:void 0;if(o&&"label"in o&&this.isCommandQuickPickItem(o)){this.previouslySelectedItem=o;let s=await o.execute();if(!s||s===ze.back)continue;return s instanceof ze,s}return o||void 0}finally{Ce(i)}}}updateQuickPickItems(t,n){let i=new Map(t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>[a.item.id,a.item])),o=new Map(n.items.map(a=>[a.id,a]));this.quickPickItems=this.quickPickItems.map(a=>{if(this.isSelectorQuickPickItem(a)){let l=i.get(a.item.id);if(l&&l!==a.item)return this.toQuickPickItem(l);let u=o.get(a.item.id);if(u){let c=this.toQuickPickItem(u);if(JSON.stringify({...a,item:""})!==JSON.stringify({...c,item:""}))return this.toQuickPickItem(u)}}return a});let s=n.items.filter(a=>!i.has(a.id)).map(a=>this.toQuickPickItem(a));this.removeOutdatedQuickPickItems(t,n),See(s,(a,l)=>_ee(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{a.sort((c,d)=>c.label.localeCompare(d.label));let l=this.connectionToCategory(a[0].item),u=this.quickPickItems.find(c=>c.kind===Lo.QuickPickItemKind.Separator&&c.label===l.label);if(u){let c=this.quickPickItems.indexOf(u),d=this.categories.get(u),f=new Map(Array.from(d).map(b=>[b.item.id,b])),m=d.size;a.forEach(b=>{let v=f.get(b.item.id);v&&d.delete(v),d.add(b)});let g=Array.from(d);g.sort((b,v)=>b.label.localeCompare(v.label)),this.quickPickItems.splice(c+1,m,...g)}else{let c=this.quickPickItems.filter(m=>m instanceof TM).map((m,g)=>[m,g]);c.push([l,-1]),c.sort((m,g)=>m[0].sortKey.localeCompare(g[0].sortKey));let d=c.findIndex(m=>m[1]===-1),f=0;d>0&&(f=c.length===d+1?this.quickPickItems.length:c[d+1][1]),a.sort((m,g)=>m.label.localeCompare(g.label)),this.quickPickItems.splice(f,0,l,...a),this.categories.set(l,new Set(a))}}),this.rebuildQuickPickItems(t)}rebuildQuickPickItems(t){var m;let n=this.recommended?this.toQuickPickItem(this.recommended):void 0,i=[];n&&i.push({label:W.recommendedItemCategoryInQuickPick,kind:Lo.QuickPickItemKind.Separator},n);let o=this.commands.findIndex(g=>g.kind===Lo.QuickPickItemKind.Separator&&g.label===W.recommendedItemCategoryInQuickPick),s=o>=0&&o+1<this.commands.length?this.commands[o+1]:void 0,a=n||s;a=this.selected?this.quickPickItems.filter(g=>this.isSelectorQuickPickItem(g)).map(g=>g).find(g=>{var b;return g.item.id===((b=this.selected)==null?void 0:b.id)}):a;let l=this.quickPickItems.filter(g=>{var b;return!this.isSelectorQuickPickItem(g)||g.item.id!==((b=n==null?void 0:n.item)==null?void 0:b.id)}),u=t.activeItems.length?t.activeItems[0]:void 0;a&&u&&(this.isSelectorQuickPickItem(u)?!s&&a&&"item"in a&&u.item.id!==a.item.id&&(a=void 0):s&&(s==null?void 0:s.label)===u.label||(a=void 0));let c=(m=this.resolvedProvider)!=null&&m.lastError?this.toErrorQuickPickItem(this.resolvedProvider.lastError):void 0,d=[].concat(Array.from(this.commands)).concat(i).concat(l).concat(c?[c]:[]),f=a?[a]:t.activeItems.length?[t.activeItems[0]]:[];if(f.length&&!d.includes(f[0])){let g=f[0],b=this.isSelectorQuickPickItem(g)&&d.find(v=>this.isSelectorQuickPickItem(v)&&v.item.id===g.item.id);b?f[0]=b:f.length=0}t.items=d,t.activeItems=f,!t.activeItems.length&&this.previouslySelectedItem&&d.includes(this.previouslySelectedItem)&&(t.activeItems=[this.previouslySelectedItem])}isErrorQuickPickItem(t){return this.errorQuickPickItemMap.has(t)}toErrorQuickPickItem(t){if(!this.createErrorQuickPickItem)return;let n=this.createErrorQuickPickItem(t,this);return this.errorQuickPickItemMap.add(n),n}isSelectorQuickPickItem(t){return this.quickPickItemMap.has(t)}toQuickPickItem(t){let n=this.createQuickPickItem(t,this);return n.item=t,this.quickPickItemMap.add(n),n}removeOutdatedQuickPickItems(t,n){let i=t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>a.item.id),o=new Map(n.items.map(a=>[a.id,a])),s=i.filter(a=>!o.has(a));if(s.length){let a=[];this.categories.forEach((l,u)=>{l.forEach(c=>{s.includes(c.item.id)&&(l.delete(c),a.push(c))}),l.size||(a.push(u),this.categories.delete(u))}),this.quickPickItems=this.quickPickItems.filter(l=>!a.includes(l)),this.rebuildQuickPickItems(t)}}connectionToCategory(t){let n=this.getCategory(t,this);return new TM(n.label,n.sortKey||n.label)}};function See(r,e){let t=[],n;for(let i of r.slice(0).sort(e))!n||e(n[0],i)!==0?(n=[i],t.push(n)):n.push(i);return t}function _ee(r,e){return(r.sortKey||r.label).localeCompare(e.sortKey||e.label,void 0,{sensitivity:"accent"})}p();var NM=require("vscode");var o_=class{constructor(e){this.jupyterConnection=e;this.disposables=[]}dispose(){Ce(this.disposables)}async findPreferredRemoteKernelConnection(e,t,n){return this.findPreferredRemoteKernelConnectionImpl(e,t,n,!1)}async findPreferredRemoteKernelConnectionImpl(e,t,n,i){var l;let o=await tt.instance.get(js).getPreferredRemoteKernelId(e),s=async()=>{let u=t.kernels.find(d=>d.kind==="connectToLiveRemoteKernel"&&d.id===o);if(u)return u;if(t.status==="idle")return;let c=await new Promise(d=>t.onDidChangeKernels(()=>{let f=t.kernels.find(m=>m.kind==="connectToLiveRemoteKernel"&&m.id===o);f&&d(f),(t.status==="idle"||n.isCancellationRequested)&&d(void 0)},this,this.disposables));if(c)return c};if(o){let u=await s();if(u||i)return u}let a=(l=t.kernels.find(u=>Wt(u)))==null?void 0:l.serverProviderHandle;if(a){let u=await this.jupyterConnection.createConnectionInfo(a),c=(e.uri,void 0),d=c&&t.kernels.find(f=>Wt(f)&&f.kind==="connectToLiveRemoteKernel"&&f.kernelModel.model&&f.kernelModel.model.path===c.path&&f.kernelModel.model.name===c.name);if(d)return d}return this.findPreferredKernelSpecConnection(e,t,n,i)}async findPreferredLocalKernelSpecConnection(e,t,n){return this.findPreferredKernelSpecConnection(e,t,n,!1)}async findPreferredKernelSpecConnection(e,t,n,i){var c;let o=_a(e),s=(c=o==null?void 0:o.kernelspec)==null?void 0:c.name,a=()=>{let d=s?t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.name===s):[];if(d.length||i)return d;let f=yM(e);if(f)return t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.language&&(m.kernelSpec.language===f||Uc(m.kernelSpec.language)===Uc(f)))},l=a();if(Array.isArray(l)&&l.length)return i&&l.length>1?void 0:l[0];if(t.status==="idle")return;let u=[];return new Promise(d=>t.onDidChangeKernels(()=>{if(n.isCancellationRequested)return d(void 0);let f=a();if(Array.isArray(f)&&f.length)return i&&f.length>1?d(void 0):d(f[0]);t.status==="idle"&&d(void 0)},this,this.disposables)).finally(()=>Ce(u))}async findPreferredPythonKernelConnection(e,t,n){return this.findPreferredPythonKernelConnectionImpl(e,t,n)}async findPreferredPythonKernelConnectionImpl(e,t,n){t=t||tt.instance.get(ii).registered.find(u=>u.kind==="localPythonEnvironment");let i=tt.instance.get(cm),o=x9(e,t);if(o)return o;let s=await i.getActiveInterpreter(e.uri);if(!s)return;let a=()=>{if(!n.isCancellationRequested)return t.kernels.filter(u=>u.kind==="startUsingPythonInterpreter").map(u=>u).find(u=>u.interpreter.id===s.id)},l=a();if(l)return l;if(t.status==="discovering")return await new Promise(u=>{t.onDidChangeStatus(()=>t.status==="idle"&&u(),this,this.disposables),t.onDidChangeKernels(()=>(x9(e,t)||a())&&u(),this,this.disposables)}),x9(e,t)||a()}};function x9(r,e){var i,o;let t=((i=NM.workspace.getWorkspaceFolder(r.uri))==null?void 0:i.uri)||(((o=NM.workspace.workspaceFolders)==null?void 0:o.length)===1?NM.workspace.workspaceFolders[0].uri:void 0),n=Eee(Km(r.uri),e);if(n)return n;if(t)return Eee(t,e)}function Eee(r,e){let n=e.kernels.filter(a=>a.kind==="startUsingPythonInterpreter").map(a=>a).filter(a=>{var l,u,c;return t1(((c=(u=(l=Bi(a.interpreter))==null?void 0:l.environment)==null?void 0:u.folderUri)==null?void 0:c.fsPath)||a.interpreter.uri.fsPath,r.fsPath)}),i=n.find(a=>{var l;return _r(a.interpreter)==="Venv"&&((l=Ss(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(i)return i;let o=n.find(a=>{var l;return _r(a.interpreter)==="Conda"&&((l=Ss(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(o)return o;let s=n.find(a=>{var l;return((l=Ss(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});return s||(n.length?n[0]:void 0)}function RM(r){return r===Je||r===Hv}var s_=class{constructor(e,t,n,i,o,s,a){this.kernelFinder=e;this.serverUriStorage=t;this.serverSelector=n;this.jupyterConnection=i;this.displayDataProvider=o;this.kernelFinderController=s;this.jupyterServerRegistry=a;this.localDisposables=[]}async selectRemoteKernel(e,t){var o,s,a,l;if(e.notebookType!==St&&e.notebookType!==vr)return;this.localDisposables.forEach(u=>u.dispose()),this.localDisposables=[],(o=this.cancellationTokenSource)==null||o.cancel(),(s=this.cancellationTokenSource)==null||s.dispose(),this.cancellationTokenSource=new si.CancellationTokenSource;let n=new lP,i={disposables:[],notebook:e};try{if(await n.run(this.getRemoteServersFromProvider.bind(this,t,this.cancellationTokenSource.token),i)===ze.cancel||((a=i.selection)==null?void 0:a.type)==="userPerformedSomeOtherAction")throw new si.CancellationError;if(this.cancellationTokenSource.token.isCancellationRequested){Ce(i.disposables);return}if(((l=i.selection)==null?void 0:l.type)==="connection")return i.selection.connection}finally{Ce(i.disposables)}}async getRemoteServersFromProvider(e,t,n,i){var P;let o=this.kernelFinder.registered.filter(D=>D.kind==="remote"),s=[],a=[],l=[],u=(P=this.jupyterServerRegistry.jupyterCollections.find(D=>D.extensionId===e.extensionId&&D.id===e.id))==null?void 0:P.serverProvider,c=u!=null&&u.provideJupyterServers?Promise.resolve(u.provideJupyterServers.bind(u)(t)).then(D=>D||[]):Promise.resolve([]),d=new Set,f=await c,m=new Set(f.map(D=>D.id));if(o.filter(D=>D.serverProviderHandle.id===e.id).filter(D=>m.has(D.serverProviderHandle.id)).map(D=>{let K=this.serverUriStorage.all.find(L=>Vt(L.provider)===Vt(D.serverProviderHandle));d.add(Vt(D.serverProviderHandle)),l.push({server:D,time:K==null?void 0:K.time})}),l.sort((D,K)=>!D.time&&!K.time?D.server.displayName.localeCompare(K.server.displayName):!D.time&&K.time?1:D.time&&!K.time||(D.time||0)>(K.time||0)?-1:1),l.filter(({time:D})=>(D||0)>0).forEach(({server:D,time:K})=>{s.push({type:"finder",kernelFinderInfo:D,idAndHandle:D.serverProviderHandle,label:D.displayName,description:K?W.jupyterServerLastConnectionForQuickPickDescription(new Date(K)):void 0,buttons:u!=null&&u.removeJupyterServer&&RM(e.extensionId)?[{iconPath:new si.ThemeIcon("close"),tooltip:W.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),l.filter(({time:D})=>!D).forEach(({server:D})=>{s.push({type:"finder",kernelFinderInfo:D,idAndHandle:D.serverProviderHandle,label:D.displayName,buttons:u!=null&&u.removeJupyterServer&&RM(e.extensionId)?[{iconPath:new si.ThemeIcon("close"),tooltip:W.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),f.sort((D,K)=>D.label.localeCompare(K.label)).forEach(D=>{let K=Vt({extensionId:e.extensionId,id:e.id,handle:D.id});d.has(K)||s.push({type:"jupyterServer",label:D.label,idAndHandle:{extensionId:e.extensionId,id:e.id,handle:D.id},server:D,buttons:u!=null&&u.removeJupyterServer&&RM(e.extensionId)?[{iconPath:new si.ThemeIcon("close"),tooltip:W.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),e.commandProvider){let D=(await Promise.resolve(e.commandProvider.provideCommands(void 0,t))||[]).map(K=>({...K,provider:e,type:"uriProviderQuickPick",command:K}));s.length>0&&D.length&&a.push({label:"",kind:si.QuickPickItemKind.Separator}),a.push(...D)}let g=s.concat(a),b=new si.EventEmitter,v=g.length===1&&"command"in g[0]&&g[0].command.canBeAutoSelected?g[0]:void 0;if(u){let D=g.filter(K=>"type"in K);D.length===1&&D.every(K=>K.type!=="uriProviderQuickPick")?v=D[0]:D.every(K=>K.type==="uriProviderQuickPick")&&D.filter(K=>K.picked).length===1&&(v=g.filter(K=>K.picked)[0])}let k,R;if(v)R=v;else{let{quickPick:D,selection:K}=n.showLazyLoadQuickPick({items:g,placeholder:e.extensionId===Je||e.extensionId===Hv?W.enterOrSelectRemoteJupyterPlaceholder:W.selectRemoteJupyterPlaceholder,title:W.quickPickTitleForSelectionOfJupyterServer,supportBackInFirstStep:!0,onDidTriggerItemButton:async L=>{if("type"in L.item&&(L.item.type==="finder"||L.item.type==="jupyterServer")){let B=L.item.idAndHandle.handle,N=f.find(O=>O.id===B);u!=null&&u.removeJupyterServer&&N&&RM(e.extensionId)&&(D.busy=!0,this.serverUriStorage.remove({extensionId:e.extensionId,id:e.id,handle:B}).catch(E),await u.removeJupyterServer(N),D.busy=!1,g.splice(g.indexOf(L.item),1),b.fire(g.concat([])))}},onDidChangeItems:b.event});D.onDidChangeValue(async L=>{var h;if(!((h=e.commandProvider)!=null&&h.provideCommands))return;let B=[];s.length>0&&B.push({label:"",kind:si.QuickPickItemKind.Separator});let O=(await Promise.resolve(e.commandProvider.provideCommands(L,t))||[]).map(y=>({...y,provider:e,type:"uriProviderQuickPick",command:y}));D.items=s.concat(B).concat(O)},this),k=D,R=await K}if(!t.isCancellationRequested&&R&&"type"in R)switch(R.type){case"finder":{let D=await this.selectRemoteKernelFromPicker(i.notebook,Promise.resolve(R.kernelFinderInfo),t).catch(K=>C.error("Failed to select a kernel",K));if(D&&D===ze.back){if(R===v)throw ze.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!D||D instanceof ze)throw new si.CancellationError;i.selection={type:"connection",connection:D};return}case"jupyterServer":{let D=(async()=>{let L={id:e.id,handle:R.server.id,extensionId:e.extensionId};return e.extensionId.toLowerCase()===tc.toLowerCase()&&await us(t,this.serverSelector.addJupyterServer(L)),this.kernelFinderController.getOrCreateRemoteKernelFinder(L,R.server.label)})(),K=await this.selectRemoteKernelFromPicker(i.notebook,D,t).catch(L=>C.error("Failed to select a kernel",L));if(K&&K===ze.back){if(R===v)throw ze.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!K||K instanceof ze)throw new si.CancellationError;i.selection={type:"connection",connection:K};return}case"uriProviderQuickPick":{let D=si.notebooks.createNotebookControllerDetectionTask(St);try{k&&(k.busy=!0);let K=await this.selectRemoteServerFromRemoteKernelFinder(R,i,t);return k&&(k.busy=!1),K}catch(K){if(K===ze.back&&!v)return this.getRemoteServersFromProvider(e,t,n,i);throw K}finally{D.dispose()}}default:break}}async selectRemoteServerFromRemoteKernelFinder(e,t,n){var a;if(!((a=e.provider.commandProvider)!=null&&a.handleCommand)||n.isCancellationRequested)return;let i=await Promise.resolve(e.provider.commandProvider.handleCommand(e.command,n));if(!i)throw ze.back;if(n.isCancellationRequested)throw new si.CancellationError;let o=(async()=>{let l={id:e.provider.id,handle:i.id,extensionId:e.provider.extensionId};return l.extensionId.toLowerCase()===tc.toLowerCase()&&await us(n,this.serverSelector.addJupyterServer(l)),this.kernelFinderController.getOrCreateRemoteKernelFinder(l,i.label)})(),s=await this.selectRemoteKernelFromPicker(t.notebook,o,n).catch(l=>C.error("Failed to select a kernel",l));if(s&&s===ze.back)throw ze.back;if(!s||s instanceof ze)throw new si.CancellationError;t.selection={type:"connection",connection:s}}async selectRemoteKernelFromPicker(e,t,n){let i,o=c=>{let d=this.displayDataProvider.getDisplayData(c);return{label:`${c===i?"$(star-full) ":""}${d.label}`,description:d.description,detail:d.detail}},s=c=>({label:this.displayDataProvider.getDisplayData(c).category||"Other"}),a=c=>({label:W.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel,detail:W.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail}),l=new kM(t,o,s,{supportsBack:!0},a),u=new o_(this.jupyterConnection);return t.then(c=>u.findPreferredRemoteKernelConnection(e,c,n)).then(c=>{i=c,(c==null?void 0:c.kind)==="startUsingRemoteKernelSpec"&&(l.recommended=c),l.selected=c}).catch(c=>C.error("Failed to determine preferred remote kernel",c)),l.selectItem(n)}};s_=U([(0,Iu.injectable)(),x(0,(0,Iu.inject)(ii)),x(1,(0,Iu.inject)(dr)),x(2,(0,Iu.inject)(Kl)),x(3,(0,Iu.inject)(fn)),x(4,(0,Iu.inject)(RI)),x(5,(0,Iu.inject)(IP)),x(6,(0,Iu.inject)(sr))],s_);function Cee(r,e){r.addSingleton(Nt,ZS),r.addBinding(Nt,Ve),r.addSingleton(RI,QS),r.addSingleton(PR,s_),r.addSingleton(Ve,i_),Iee(r,e)}p();var RP=oe(he()),vv=require("vscode");p();var a_=Symbol("IJupyterDebugService"),bm=Symbol("INotebookDebuggingManager");var AM=Symbol("IDebugLocationTrackerFactory"),MM=Symbol("IDebugLocationTracker");var l_=class{constructor(e,t){this.debuggingManager=e;this.disposables=t}activate(){this.disposables.push(vv.commands.registerCommand(le.RunByLine,this.runByLine,this)),this.disposables.push(vv.commands.registerCommand(le.RunByLineNext,this.runByLineNext,this)),this.disposables.push(vv.commands.registerCommand(le.RunByLineStop,this.runByLineStop,this)),this.disposables.push(vv.commands.registerCommand(le.RunAndDebugCell,this.runAndDebugCell,this))}async runByLine(e){ne("DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(0,e)}async runByLineNext(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineNext(e)}async runByLineStop(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineStop(e)}async runAndDebugCell(e){ne("DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(1,e)}getCellFromActiveEditor(){let e=vv.window.activeNotebookEditor;if(e){let t=e.selections[0];if(t)return e.notebook.cellAt(t.start)}}dispose(){this.disposables.forEach(e=>e.dispose())}};l_=U([(0,RP.injectable)(),x(0,(0,RP.inject)(bm)),x(1,(0,RP.inject)(ve))],l_);p();var Hl=oe(he());var AP=require("vscode");p();var P9=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]);function LM(r){var e;return{name:(e=r.evaluateName)!=null?e:r.name,type:r.type,count:0,shape:"",size:0,supportsDataExplorer:P9.has(r.type||""),value:r.value,truncated:!0,frameId:r.variablesReference}}function KM(r){let e=r.index,t=r.columns;return{data:r.data.map((o,s)=>{let a={index:e[s]};return t.forEach((l,u)=>{a[l]=o[u]}),a})}}p();var D9=require("vscode"),c_=class{constructor(e){this._sessionId=e;this.topMostFrameId=0;this.sequenceNumbersOfRequestsPendingResponses=new Set;this.waitingForStackTrace=!1;this.debugLocationUpdatedEvent=new D9.EventEmitter;this.sessionEndedEmitter=new D9.EventEmitter;this.DebugLocation=void 0}get sessionId(){return this._sessionId}get sessionEnded(){return this.sessionEndedEmitter.event}get debugLocationUpdated(){return this.debugLocationUpdatedEvent.event}get debugLocation(){return this._debugLocation}onDidSendMessage(e){var t,n;if(this.isResponseForRequestToFetchAllFrames(e)){let i=(t=e.body)==null?void 0:t.stackFrames[0];this.topMostFrameId=i==null?void 0:i.id,this.sequenceNumbersOfRequestsPendingResponses.delete(e.request_seq),this.waitingForStackTrace&&(this.DebugLocation={lineNumber:i==null?void 0:i.line,fileName:this.normalizeFilePath((n=i==null?void 0:i.source)==null?void 0:n.path),column:i.column},this.waitingForStackTrace=!1)}this.isStopEvent(e)&&(this.waitingForStackTrace=!0),this.isContinueEvent(e)&&(this.DebugLocation=void 0,this.waitingForStackTrace=!1)}onWillStopSession(){this.sessionEndedEmitter.fire(this)}onWillReceiveMessage(e){this.isRequestToFetchAllFrames(e)&&this.sequenceNumbersOfRequestsPendingResponses.add(e.seq)}set DebugLocation(e){let t=this._debugLocation;this._debugLocation=e,this._debugLocation!==t&&this.debugLocationUpdatedEvent.fire()}normalizeFilePath(e){return process.platform!=="win32"?e.replace(/\\/g,"/"):e}isStopEvent(e){return e.type==="event"&&e.event==="stopped"}isContinueEvent(e){if(e.type==="event"){if(e.event==="continue")return!0}else if(e.type==="response"&&e.command==="continue")return!0;return!1}isResponseForRequestToFetchAllFrames(e){var t;return e.type==="response"&&e.command==="stackTrace"&&((t=e.body)==null?void 0:t.stackFrames[0])&&this.sequenceNumbersOfRequestsPendingResponses.has(e.request_seq)}isRequestToFetchAllFrames(e){return e.type==="request"&&e.command==="stackTrace"&&(e.arguments.startFrame===0||e.arguments.startFrame===void 0)}};var g_e=new Set(["In","Out","exit","quit"]),FM=100,u_=class extends c_{constructor(t,n,i,o,s,a){super(void 0);this.debugService=t;this.debuggingManager=n;this.configService=i;this.varScriptGenerator=o;this.dfScriptGenerator=s;this.kernelProvider=a;this.refreshEventEmitter=new AP.EventEmitter;this.lastKnownVariables=[];this.importedGetVariableInfoScriptsIntoKernel=new Set;this.watchedNotebooks=new Map;this.debuggingStarted=!1;this.currentVariablesReference=0;this.currentSeqNumsForVariables=new Set;this.debuggingManager.onDoneDebugging(()=>this.refreshEventEmitter.fire(),this)}get refreshRequired(){return this.refreshEventEmitter.event}get active(){return(this.debugService.activeDebugSession!==void 0||this.activeNotebookIsDebugging())&&this.debuggingStarted}getAllVariableDiscriptions(){throw new Error("Method not implemented.")}async getVariables(t,n){n&&this.watchKernel(n);let i=n&&this.kernelProvider.getKernelExecution(n),o={executionCount:i?i.executionCount:t.executionCount,pageStartIndex:0,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(this.active){let s=t.sortColumn,a=(c,d)=>{let f=c[s]?c[s]:"",m=d[s]?d[s]:"";return t.sortAscending?f.localeCompare(m,void 0,{sensitivity:"base"}):m.localeCompare(f,void 0,{sensitivity:"base"})};this.lastKnownVariables.sort(a);let l=t.startIndex?t.startIndex:0,u=t.pageSize?t.pageSize:FM;o.pageStartIndex=l;for(let c=l;c<l+u&&c<this.lastKnownVariables.length;c+=1){let d=this.lastKnownVariables[c].truncated?await this.getFullVariable(this.lastKnownVariables[c]):this.lastKnownVariables[c];this.lastKnownVariables[c]=d,o.pageResponse.push(d)}o.totalCount=this.lastKnownVariables.length}return o}async getMatchingVariable(t,n){if(this.active){let i=this.lastKnownVariables.find(o=>o.name===t);return i&&(n!=null&&n.resourceUri)&&Zv(n==null?void 0:n.resourceUri).toLowerCase()===".ipynb"&&ne("DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER"),i}}async getVariableValueSummary(t){}async getDataFrameInfo(t,n,i,o){var m;if(!this.active)return t;o&&(t=await this.getFullVariable(t)),n&&this.watchKernel(n);let s=t.name;i&&(s=`${t.name}${i}`);let{cleanupCode:a,initializeCode:l,code:u}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!0,variableName:s}),c=await this.evaluate({code:u,cleanupCode:a,initializeCode:l,frameId:t.frameId}),d=n==null?void 0:n.notebook,f=d?Ht(d.uri.path):"";return!f&&((m=this.debugLocation)!=null&&m.fileName)&&(f=Ht(this.debugLocation.fileName)),c?{...t,...JSON.parse(c.result),maximumRowChunkSize:FM,fileName:f}:t}async getDataFrameRows(t,n,i,o,s){if(i-n>FM)throw new Error(`Debugger cannot provide more than ${FM} rows at once`);if(!this.debugService.activeDebugSession||t.columns===void 0)return{data:[]};o&&this.watchKernel(o);let a=t.name;s&&(a=`${t.name}${s}`);let{cleanupCode:l,initializeCode:u,code:c}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!0,variableName:a,startIndex:n,endIndex:i}),d=await this.evaluate({code:c,cleanupCode:l,initializeCode:u,frameId:t.frameId});return KM(JSON.parse(d.result))}onWillReceiveMessage(t){super.onWillReceiveMessage(t),t.type==="request"&&t.command==="variables"&&t.arguments&&this.currentVariablesReference===t.arguments.variablesReference&&this.currentSeqNumsForVariables.add(t.seq)}onDidSendMessage(t){var n;if(super.onDidSendMessage(t),t.type==="response"&&t.command==="initialize")this.debuggingStarted=!0;else if(t.type==="event"&&t.event==="stopped"&&this.activeNotebookIsDebugging())this.handleNotebookVariables(t).catch(E);else if(t.type==="response"&&t.command==="scopes"&&t.body&&t.body.scopes){let o=t.body.scopes[0].variablesReference;o!==this.currentVariablesReference&&(this.currentVariablesReference=o,this.currentSeqNumsForVariables.clear())}else if(t.type==="response"&&t.command==="variables"&&t.body)this.currentSeqNumsForVariables.has(t.request_seq)&&this.updateVariables(void 0,t),this.monkeyPatchDataViewableVariables(t);else if(t.type==="event"&&t.event==="terminated"){this.lastKnownVariables=[],this.topMostFrameId=0,this.debuggingStarted=!1,this.refreshEventEmitter.fire();let i=(n=this.debugService.activeDebugSession)==null?void 0:n.id;i&&this.importedGetVariableInfoScriptsIntoKernel.delete(i)}}watchKernel(t){var i;let n=(i=t.notebook)==null?void 0:i.uri.toString();if(n&&!this.watchedNotebooks.has(n)){let o=[];o.push(t.onRestarted(this.resetImport.bind(this,n))),o.push(t.onDisposed(()=>{this.resetImport(n),o.forEach(s=>s.dispose()),this.watchedNotebooks.delete(n)})),this.watchedNotebooks.set(n,o)}}resetImport(t){this.importedGetVariableInfoScriptsIntoKernel.delete(t)}async evaluate({code:t,cleanupCode:n,frameId:i,initializeCode:o}){if(this.debugService.activeDebugSession){i=this.topMostFrameId||i;let s={frameId:i,context:"repl",format:{rawString:!0}};C.debug(`Evaluating in debugger : ${this.debugService.activeDebugSession.id}: ${t}`);try{o&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:o});let a=await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:t});if(a&&a.result!=="None")return a;C.error(`Cannot evaluate ${t}`);return}finally{n&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:n})}}throw Error("Debugger is not active, cannot evaluate.")}async getFullVariable(t){let{initializeCode:n,code:i,cleanupCode:o}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!0,variableName:t.name}),s=await this.evaluate({code:i,initializeCode:n,cleanupCode:o,frameId:t.frameId});return s&&s.result?{...t,truncated:!1,...JSON.parse(s.result)}:t}monkeyPatchDataViewableVariables(t){t.body.variables.forEach(n=>{n.type&&P9.has(n.type)&&n.evaluateName&&(n.__vscodeVariableMenuContext="viewableInDataViewer")})}updateVariables(t,n){var s;let i=this.configService.getSettings(t).variableExplorerExclude?(s=this.configService.getSettings().variableExplorerExclude)==null?void 0:s.split(";"):[],o=n.body.variables.filter(a=>!(!a.name||!a.type||!a.value||i&&i.includes(a.type)||a.name.startsWith("_")||g_e.has(a.name)||a.type==="NoneType"));this.lastKnownVariables=o.map(a=>LM(a)),this.refreshEventEmitter.fire()}activeNotebookIsDebugging(){let t=AP.window.activeNotebookEditor;return!!t&&this.debuggingManager.isDebugging(t.notebook)}async handleNotebookVariables(t){var o;let n=(o=AP.window.activeNotebookEditor)==null?void 0:o.notebook,i=t.body.threadId;if(n){let s=this.debuggingManager.getDebugSession(n);if(s){let a=await s.customRequest("stackTrace",{threadId:i,startFrame:0,levels:1});if(a&&a.stackFrames[0]){let l=a.stackFrames[0],u=this.debuggingManager.getDebugMode(n),c;if(u===0){let d=this.debuggingManager.getDebugCell(n);l.source&&d&&l.source.path===d.document.uri.toString()&&(c=await s.customRequest("scopes",{frameId:l.id}))}else{let d=Ht(n.uri.toString());l.source&&l.source.path&&l.source.path.includes(d)&&(c=await s.customRequest("scopes",{frameId:l.id}))}c&&(c.scopes.forEach(d=>{s.customRequest("variables",{variablesReference:d.variablesReference}).then(E,E)}),this.refreshEventEmitter.fire())}}}}};u_=U([(0,Hl.injectable)(),x(0,(0,Hl.inject)(a_)),x(0,(0,Hl.named)(nt.MULTIPLEXING_DEBUGSERVICE)),x(1,(0,Hl.inject)(bm)),x(2,(0,Hl.inject)(Ke)),x(3,(0,Hl.inject)(my)),x(4,(0,Hl.inject)(hy)),x(5,(0,Hl.inject)(qe))],u_);p();var ep=oe(he()),Im=require("vscode");p();var wee=require("vscode"),fr=class{constructor(e){this.name=e}get value(){return this.lastValue}async set(e){this.lastValue!==e&&(this.lastValue=e,await wee.commands.executeCommand("setContext",this.name,this.lastValue))}};p();var Nee=require("vscode");p();var MP=(o=>(o[o.Unknown=0]="Unknown",o[o.Ok=1]="Ok",o[o.Outdated=2]="Outdated",o[o.NotInstalled=3]="NotInstalled",o[o.ControllerNotSelected=4]="ControllerNotSelected",o))(MP||{});async function xee(r){var o,s;let e="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",t=`import builtins
import ipykernel
builtins.print("${e}" + ipykernel.__version__ + "${e}")`,n=await r.executeHidden(t),i=/^(\d+)\.\d+\.\d+$/;for(let a of n){if(a.output_type!=="stream")continue;let l=(s=(o=a.text)==null?void 0:o.toString().trim())!=null?s:"";if(!l.includes(e))continue;let u=l.split(e)[1].trim().match(i);if(u){let c=u[1];return Number(c)>=6?1:2}}return 0}function OP(r){let e=r;if(typeof e.__notebookUri=="undefined"||typeof e.__mode=="undefined"||(e.__mode===1||e.__mode===2||e.__mode===0)&&typeof e.__cellIndex=="undefined")throw new Error("Invalid launch configuration")}function Pee(r){if(OP(r),r.__mode!==2)throw new Error("Invalid launch configuration")}function UM(r,e){switch(r.type){case"event":let t=r;switch(t.event){case"output":e(t.body);break;case"loadedSource":e(t.body);break;case"breakpoint":e(t.body.breakpoint);break;default:break}break;case"request":let n=r;switch(n.command){case"setBreakpoints":let o=n.arguments,s=o.breakpoints;if(s&&s.length){let a=s[0].line;s.forEach(u=>{e(u,{...o.source})});let l={source:o.source,line:a};e(l),o.source=l.source}break;case"breakpointLocations":e(n.arguments);break;case"source":e(n.arguments);break;case"gotoTargets":e(n.arguments);break;default:break}break;case"response":let i=r;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(o=>{e(o)});break;case"loadedSources":i.body.sources.forEach(o=>{let s={source:o};e(s),o.path=s.source.path});break;case"scopes":i.body.scopes.forEach(o=>{e(o)});break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;case"setBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;default:break}break}}function Dee(r){return/~\d+\\/.test(r)}function Tee(r,e){return new RegExp(r.replace(/\\/g,"\\\\").replace(/~\d+\\\\/g,"[^\\\\]+\\\\"),"i").test(e)}async function yv(r,e){let t=`import debugpy
debugpy.debug_this_thread()`;await r.executeHidden(t),await e.dumpAllCells()}function kee(r){return!!r.header&&r.header.msg_type==="debug_event"}function LP(r){return r.includes("Frame skipped from debugging during step-in")}function T9(r){return r.event==="debugpyAttach"}var WM=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;ne("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){C.debug(`[Debug-Cell] ${e}: ${t}`)}async willSendEvent(e){return T9(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&LP(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){e.command==="configurationDone"&&(await yv(this.execution,this.debugAdapter),Nee.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(E,E))}};p();var KP=class{constructor(e,t,n,i){this.mode=e;this.debugAdapter=t;this.debugCell=n;this.serviceContainer=i;this.debuggingManager=this.serviceContainer.get(bm)}trace(e,t){C.debug(`[Debug-Restart] ${e}: ${t}`)}error(e,t){C.error(`[Debug-Restart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Handling restart request"),setTimeout(()=>{this.debugAdapter.disconnect().then(()=>(this.trace("restart","doRestart"),this.debuggingManager.tryToStartDebugging(this.mode,this.debugCell,!0))).catch(t=>{this.error("restart",`Error restarting: ${t}`)})},0),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};p();var FP=require("vscode");var VM=class{constructor(e,t,n,i){this.debugAdapter=e;this.debugCell=t;this.execution=n;this.settings=i;ne("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE")}continue(){if(typeof this.lastPausedThreadId!="number"){C.debug("No paused thread, can't do RBL"),this.stop();return}this.debugAdapter.stepIn(this.lastPausedThreadId).then(E,E)}stop(){C.ci("RunbylineController::stop()"),this.execution.executeHidden("pass").then(E,E),this.debugAdapter.disconnect().then(E,E)}getMode(){return this.debugAdapter.getConfiguration().__mode}async willSendEvent(e){return e.event==="stopped"&&(this.lastPausedThreadId=e.body.threadId,await this.handleStoppedEvent(this.lastPausedThreadId))?(this.trace("intercepted","handled stop event"),!0):e.event==="output"&&LP(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){C.ci(`willSendRequest: ${e.command}`),e.command==="configurationDone"&&await this.initializeExecute()}async handleStoppedEvent(e){return await this.shouldStepIn(e)?(this.debugAdapter.stepIn(e).then(E,E),!0):!1}async shouldStepIn(e){var n;let t=await this.debugAdapter.stackTrace({threadId:e,startFrame:0,levels:1});if(t&&t.stackFrames[0]){let i=t.stackFrames[0],o=new FP.Position(i.line,i.column);return(n=this.lastPausePosition)!=null&&n.isEqual(o)?(this.trace("intercept","working around duplicate stop event"),!0):(this.lastPausePosition=o,!!i.source&&i.source.path!==this.debugCell.document.uri.toString())}return!1}trace(e,t){C.debug(`[Debug-RBL] ${e}: ${t}`)}async initializeExecute(){await yv(this.execution,this.debugAdapter);let e=lt(this.debugCell.document.getText(),{trim:!1,removeEmptyEntries:!1}),t=[];if(Og(e,()=>void 0,(n,i)=>{n.trim().length!==0&&t.push(i)}),t.sort(),t.length!==0){let n={line:t[0]+1};await this.debugAdapter.setBreakpoints({source:{name:Ht(this.debugCell.notebook.uri.path),path:this.debugCell.document.uri.toString()},breakpoints:[n],sourceModified:!1}),this.settings.getSettings(this.debugCell.notebook.uri).showVariableViewWhenDebugging&&FP.commands.executeCommand(le.OpenVariableView).then(E,E)}FP.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(E,E)}};p();var d_=class{constructor(e,t,n){this.document=e;this.config=t;this.session=n}};p();var ai=require("vscode");var p_=class{constructor(e,t,n){this.kernelProvider=e;this.controllerRegistration=t;this.serviceContainer=n;this.notebookToDebugger=new Map;this.notebookToDebugAdapter=new Map;this.notebookInProgress=new Set;this.disposables=[];this._doneDebugging=new ai.EventEmitter}activate(){this.disposables.push(ai.debug.onDidTerminateDebugSession(this.endSession.bind(this)),ai.workspace.onDidCloseNotebookDocument(async e=>{let t=this.notebookToDebugger.get(e);t&&(await ai.debug.stopDebugging(t.session),this.onDidStopDebugging(e))}))}getDebugCell(e){var t;return(t=this.notebookToDebugAdapter.get(e))==null?void 0:t.debugCell}get onDoneDebugging(){return this._doneDebugging.event}dispose(){this.disposables.forEach(e=>e.dispose())}isDebugging(e){return this.notebookToDebugger.has(e)}getDebugSession(e){let t=this.notebookToDebugger.get(e);if(t)return t.session}getDebugAdapter(e){return this.notebookToDebugAdapter.get(e)}onDidStopDebugging(e){}async startDebuggingConfig(e,t){C.ci(`Attempting to start debugging with config ${JSON.stringify(e)}`);try{await ai.debug.startDebugging(void 0,e,t)}catch(n){C.error(`Can't start debugging (${n})`),ai.window.showErrorMessage(W.cantStartDebugging).then(E,E)}}trackDebugAdapter(e,t){this.notebookToDebugAdapter.set(e,t),this.disposables.push(t.onDidEndSession(this.endSession.bind(this)))}async endSession(e){C.info(`Ending debug session ${e.id}`),this._doneDebugging.fire();for(let[t,n]of this.notebookToDebugger.entries())if(n&&e.id===n.session.id){this.notebookToDebugger.delete(t),this.notebookToDebugAdapter.delete(t),this.onDidStopDebugging(t);break}}getDebuggerByUri(e){for(let[t,n]of this.notebookToDebugger.entries())if(e===t)return n}async ensureKernelIsRunning(e){let t=this.controllerRegistration.getSelected(e),n=this.kernelProvider.get(e);return t&&(!n||n&&n.status==="unknown")&&(n=await Ta.connectToNotebookKernel(t.connection,this.serviceContainer,{notebook:e,controller:t.controller,resource:e.uri},new pr(!1),this.disposables,"jupyterExtension")),n}findEditorForCell(e){let t=e.notebook.uri.toString();return ai.window.visibleNotebookEditors.find(n=>n.notebook.uri.toString()===t)}async checkIpykernelAndPrompt(e,t=!0){let n=this.findEditorForCell(e);if(!n)return ai.window.showErrorMessage(W.noNotebookToDebug).then(E,E),0;let i=await this.checkForIpykernel6(n.notebook);switch(i){case 3:break;case 2:case 0:{this.promptInstallIpykernel6().then(E,E);break}case 4:if(t)return await ai.commands.executeCommand("notebook.selectKernel",{notebookEditor:n}),await this.checkIpykernelAndPrompt(e,!1)}return i}async checkForIpykernel6(e){var t,n;try{let i=this.kernelProvider.get(e);if(!i){let l=this.controllerRegistration.getSelected(e);if(!l)return 4;i=this.kernelProvider.getOrCreate(e,{metadata:l.connection,controller:l==null?void 0:l.controller,resourceUri:e.uri})}let o=i.kernelConnectionMetadata;if(Wt(o)){if(o.kind==="startUsingRemoteKernelSpec"&&((t=o.kernelSpec.metadata)!=null&&t.debugger))return 1;if(o.kind==="connectToLiveRemoteKernel"&&((n=o.kernelModel.metadata)!=null&&n.debugger))return 1}let s=this.kernelProvider.getKernelExecution(i),a=await xee(s);return ne("DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",void 0,{status:a===1?"installed":"notInstalled"}),a}catch(i){C.error("Debugging: Could not check for ipykernel 6",i)}return 0}async promptInstallIpykernel6(){await ai.window.showInformationMessage(W.needIpykernel6,{modal:!0},W.setup)===W.setup?(ne("DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP"),ai.env.openExternal(ai.Uri.parse("https://github.com/microsoft/vscode-jupyter/wiki/Setting-Up-Run-by-Line-and-Debugging-for-Notebooks"))):ne("DATASCIENCE.DEBUGGING.CLOSED_MODAL")}};p();p();var ql=require("vscode");p();var jM=class{constructor(e){this.debugAdapter=e}trace(e,t){C.debug(`[Debug-Reset] ${e}: ${t}`)}async willSendRequest(e){e.command==="attach"&&(this.trace("attach","Continuing paused kernel threads if needed"),(await this.debugAdapter.debugInfo()).stoppedThreads.forEach(n=>this.debugAdapter.continueDirect(n)))}};var f_=class{constructor(e,t,n,i,o,s){this.session=e;this.notebookDocument=t;this.jupyterSession=n;this.kernel=i;this.platformService=o;this.debugService=s;this.fileToCell=new Map;this.sendMessage=new ql.EventEmitter;this.endSession=new ql.EventEmitter;this.disposables=[];this.delegates=[];this.onDidSendMessage=this.sendMessage.event;this.onDidEndSession=this.endSession.event;this.disconnected=!1;var l;C.ci("Creating kernel debug adapter for debugging notebooks");let a=this.session.configuration;OP(a),this.configuration=a,this.debugCell=t.cellAt(a.__cellIndex),this.addDebuggingDelegates([new jM(this)]),(l=this.jupyterSession.kernel)==null||l.iopubMessage.connect(this.onIOPubMessage,this),this.disposables.push(new ql.Disposable(()=>{var u;return(u=this.jupyterSession.kernel)==null?void 0:u.iopubMessage.disconnect(this.onIOPubMessage,this)})),this.kernel&&(this.kernel.addHook("willRestart",()=>this.disconnect(),this,this.disposables),this.kernel.addHook("interruptCompleted",()=>this.disconnect(),this,this.disposables),this.disposables.push(this.kernel.onDisposed(()=>{this.disconnected||(ql.debug.stopDebugging(this.session).then(E,E),this.disconnect().catch(E),ne("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"onKernelDisposed"}))}))),this.disposables.push(Mr.onDidChangeNotebookCellExecutionState(u=>{this.configuration.__cellIndex===u.cell.index&&u.state===1&&!this.disconnected&&(ne("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"normally"}),this.disconnect().catch(E))},this,this.disposables)),this.disposables.push(ql.workspace.onDidChangeNotebookDocument(u=>{u.contentChanges.forEach(c=>{c.removedCells.forEach(d=>{d===this.debugCell&&this.disconnect().catch(E)})})},this,this.disposables)),this.disposables.push(this.debugService.onDidTerminateDebugSession(u=>{(u===this.session||u===this.session)&&this.disconnect().catch(E)}))}addDebuggingDelegates(e){this.delegates.push(...e)}trace(e,t){C.debug(`[Debug] ${e}: ${t}`)}async onIOPubMessage(e,t){var n,i;if(C.ci(`Debug IO Pub message: ${JSON.stringify(t)}`),kee(t)){this.trace("event",JSON.stringify(t));for(let o of(n=this.delegates)!=null?n:[])if(await((i=o==null?void 0:o.willSendEvent)==null?void 0:i.call(o,t.content)))return;this.sendMessage.fire(t.content)}}handleMessage(e){this.handleClientMessageAsync(e).catch(E)}async handleClientMessageAsync(e){var t,n;try{if(C.ci(`KernelDebugAdapter::handleMessage ${JSON.stringify(e,void 0," ")}`),e.type==="request"&&e.command==="setBreakpoints"){let i=e.arguments;if(i.source&&i.source.path&&i.source.path.indexOf("vscode-notebook-cell:")===0){let o=this.notebookDocument.getCells().find(s=>s.document.uri.toString()===i.source.path);o&&await this.dumpCell(o.index)}}if(e.type==="request")for(let i of(t=this.delegates)!=null?t:[]){let o=await((n=i==null?void 0:i.willSendRequest)==null?void 0:n.call(i,e));if(o){this.trace("response",JSON.stringify(o)),this.sendMessage.fire(o);return}}await this.sendMessageToJupyterSession(e)}catch(i){C.error(`KernelDebugAdapter::handleMessage failure: ${i}`)}}getConfiguration(){return this.configuration}stepIn(e){return this.session.customRequest("stepIn",{threadId:e})}async debugInfo(){return await this.session.customRequest("debugInfo")}continueDirect(e){if(!this.jupyterSession.kernel)throw new Qr;this.jupyterSession.kernel.requestDebug({seq:0,type:"request",command:"continue",arguments:{threadId:e}})}async disconnect(){var e;if(!this.disconnected){if(this.disconnected=!0,this.debugService.activeDebugSession===this.session||((e=this.debugService.activeDebugSession)==null?void 0:e.id)===this.session.id)try{await Promise.all([this.deleteDumpedFiles().catch(t=>C.warn("Error deleting temporary debug files.",t)),this.session.customRequest("disconnect",{restart:!1})])}catch(t){C.error("Failed to disconnect debug session",t)}this.endSession.fire(this.session)}}dispose(){this.disposables.forEach(e=>e.dispose())}stackTrace(e){return this.session.customRequest("stackTrace",e)}setBreakpoints(e){return this.session.customRequest("setBreakpoints",e)}async dumpAllCells(){await Promise.all(this.notebookDocument.getCells().map(async e=>{e.kind===ql.NotebookCellKind.Code&&await this.dumpCell(e.index)}))}lookupCellByLongName(e){if(this.platformService.isWindows){e=Is(e);for(let[t,n]of this.fileToCell.entries())if(Dee(t)&&Tee(t,e))return n}}async sendMessageToJupyterSession(e){if(this.jupyterSession.isDisposed||this.jupyterSession.status==="dead"||!this.jupyterSession.kernel){C.info(`Skipping sending message ${e.type} because session is disposed`);return}if(this.trace("to kernel",JSON.stringify(e)),e.type==="request"){let t=await this.sendRequestToJupyterSession(e);t&&this.sendMessage.fire(t)}else if(e.type==="response"){UM(e,this.translateRealLocationToDebuggerLocation.bind(this));let t=e;return this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command},!0).done}else C.error(`Unknown message type to send ${e.type}`)}async sendRequestToJupyterSession(e){var s,a;if(UM(e,this.translateRealLocationToDebuggerLocation.bind(this)),!this.jupyterSession.kernel)throw new Qr;this.trace("to kernel, mapped",JSON.stringify(e));let t=e,o=(await this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command,arguments:t.arguments},!0).done).content;UM(o,this.translateDebuggerLocationToRealLocation.bind(this));for(let l of(s=this.delegates)!=null?s:[])await((a=l==null?void 0:l.willSendResponse)==null?void 0:a.call(l,o));return this.trace("response",JSON.stringify(o)),o}translateDebuggerLocationToRealLocation(e,t){var n,i;if(t=(n=e==null?void 0:e.source)!=null?n:t,t&&t.path){let o=(i=this.fileToCell.get(t.path))!=null?i:this.lookupCellByLongName(t.path);o&&(t.name=Ht(o.path),t.path=o.toString())}}async deleteDumpedFiles(){let e=this.getDumpFilesForDeletion();if(this.jupyterSession.kernel&&e.length){let n=`import os as _VSCODE_os
_VSCODE_fileList = [${e.map(i=>'"'+i.replace(/\\/g,"\\\\")+'"').join(",")}]
for file in _VSCODE_fileList:
    try:
        _VSCODE_os.remove(file)
    except:
        pass
del _VSCODE_fileList
del _VSCODE_os`;await Ai(this.jupyterSession.kernel,n,{traceErrors:!0,traceErrorsMessage:"Error deleting temporary debugging files"})}}};var BM=class extends f_{constructor(){super(...arguments);this.cellToFile=new Map;this.lineOffsets=new WeakMap}async dumpCell(t){let n=this.notebookDocument.cellAt(t);try{let i=await this.session.customRequest("dumpCell",{code:n.document.getText().replace(/\r\n/g,`
`)}),o=Is(i.sourcePath);this.fileToCell.set(o,n.document.uri),this.cellToFile.set(n.document.uri.toString(),o),this.lineOffsets.set(n,v_e(n))}catch(i){C.error(i)}}translateDebuggerLocationToRealLocation(t,n){var a,l,u;if(n=(a=t==null?void 0:t.source)!=null?a:n,!(n!=null&&n.path)||!this.fileToCell.size)return;let i=(l=this.fileToCell.get(n.path))!=null?l:this.lookupCellByLongName(n.path);if(!i)return;let o=this.notebookDocument.getCells().find(c=>c.document.uri.toString()===i.toString()),s=o&&(u=this.lineOffsets.get(o))!=null?u:0;n.name=Ht(i.path),n.path=i.toString(),s&&typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine+s),s&&typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line+s)}translateRealLocationToDebuggerLocation(t,n){var a,l;if(n=(a=t==null?void 0:t.source)!=null?a:n,!(n!=null&&n.path)||!this.cellToFile.size)return;let i=this.cellToFile.get(n.path);if(!i)return;let o=this.notebookDocument.getCells().find(u=>u.document.uri.toString()===n.path),s=o&&(l=this.lineOffsets.get(o))!=null?l:0;n.path=i,s&&typeof t.line=="number"&&(t.line<s?t.line=s:t.line>s&&(t.line-=s)),s&&typeof t.endLine=="number"&&(t.endLine<s?t.endLine=s:t.endLine>s&&(t.endLine-=s))}getDumpFilesForDeletion(){return Array.from(this.cellToFile.values())}};function v_e(r){for(let e=0;e<r.document.lineCount;e+=1)if(r.document.lineAt(e).text.trim().length>0)return e;return 0}var m_=class extends p_{constructor(t,n,i,o,s,a){super(t,n,a);this.configurationService=i;this.platform=o;this.debugService=s;this.notebookToRunByLineController=new Map;this.runByLineCells=new fr(gr.RunByLineCells),this.runByLineDocuments=new fr(gr.RunByLineDocuments),this.debugDocuments=new fr(gr.DebugDocuments)}activate(){super.activate(),this.disposables.push(Im.debug.registerDebugAdapterDescriptorFactory(gK,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){let n=this.notebookToRunByLineController.get(t);return n==null?void 0:n.getMode()}onDidStopDebugging(t){super.onDidStopDebugging(t),this.notebookToRunByLineController.delete(t),this.updateRunByLineContextKeys(),this.updateDebugContextKey()}updateRunByLineContextKeys(){let t=[],n=[];this.notebookToRunByLineController.forEach(i=>{t.push(i.debugCell.document.uri),n.push(i.debugCell.notebook.uri)}),this.runByLineCells.set(t).catch(E),this.runByLineDocuments.set(n).catch(E)}updateDebugContextKey(){let t=new dM;this.notebookToDebugAdapter.forEach((n,i)=>t.add(i.uri)),this.notebookInProgress.forEach(n=>t.add(n.uri)),this.debugDocuments.set(Array.from(t.values())).catch(E)}async tryToStartDebugging(t,n,i=!1){if(C.info(`Starting debugging with mode ${t}`),!i){let o=await this.checkIpykernelAndPrompt(n);if(o!==1){C.info(`Ipykernel check failed: ${MP[o]}`);return}}(t===0||t===1)&&await this.startDebuggingCell(t,n)}runByLineNext(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&n.debugCell.document.uri.toString()===t.document.uri.toString()&&n.continue()}runByLineStop(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&(ne("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"withKeybinding"}),n.stop())}async startDebuggingCell(t,n){let i=n.notebook,o=this.configurationService.getSettings(i.uri),s={type:gK,name:Ht(i.uri.toString()),request:"attach",justMyCode:t===1?o.debugJustMyCode:!0,__mode:t,__cellIndex:n.index,__notebookUri:i.uri.toString()},a=t===0?{suppressDebugStatusbar:!0,suppressDebugToolbar:!0,suppressDebugView:!0,suppressSaveBeforeStart:!0}:{suppressSaveBeforeStart:!0};return this.startDebuggingConfig(s,a)}async createDebugAdapterDescriptor(t){let n=t.configuration;OP(n);let i=n.__notebookUri,o=Im.workspace.notebookDocuments.find(s=>s.uri.toString()===i);if(!o){C.info(`Cannot start debugging. Notebook ${i} not found.`);return}if(this.notebookInProgress.has(o)){C.info("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(o)){C.info("Cannot start debugging. Already debugging this notebook document.");return}this.notebookToDebugger.set(o,new d_(o,n,t));try{return this.notebookInProgress.add(o),this.updateDebugContextKey(),await this.doCreateDebugAdapterDescriptor(n,t,o)}finally{this.notebookInProgress.delete(o),this.updateDebugContextKey()}}async doCreateDebugAdapterDescriptor(t,n,i){let o=await this.ensureKernelIsRunning(i);if(o!=null&&o.session){let s=new BM(n,i,o.session,o,this.platform,this.debugService);if(t.__mode===0&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new VM(s,a,this.kernelProvider.getKernelExecution(o),this.configurationService);s.addDebuggingDelegates([l,new KP(0,s,a,this.serviceContainer)]),this.notebookToRunByLineController.set(i,l),this.updateRunByLineContextKeys()}else if(t.__mode===1&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new WM(s,a,this.kernelProvider.getKernelExecution(o));s.addDebuggingDelegates([l,new KP(1,s,a,this.serviceContainer)])}return this.trackDebugAdapter(i,s),this.updateDebugContextKey(),new Im.DebugAdapterInlineImplementation(s)}else Im.window.showInformationMessage(W.kernelWasNotStarted).then(E,E)}};m_=U([(0,ep.injectable)(),x(0,(0,ep.inject)(qe)),x(1,(0,ep.inject)(Nt)),x(2,(0,ep.inject)(Ke)),x(3,(0,ep.inject)(ds)),x(4,(0,ep.inject)(oo)),x(5,(0,ep.inject)(Ar))],m_);p();var UP=oe(he()),Ree=require("vscode");var h_=class{constructor(e,t){this.disposableRegistry=t;this.activeTrackers=new WeakMap;this.activeTrackersById=new Map;this.updatedEmitter=new Ree.EventEmitter;t.push(e.registerDebugAdapterTrackerFactory("python",this))}createDebugAdapterTracker(e){let t=new c_(e.id);return this.activeTrackers.set(e,t),this.activeTrackersById.set(e.id,t),t.sessionEnded(()=>{this.activeTrackers.delete(e),this.activeTrackersById.delete(e.id)},this,this.disposableRegistry),t.debugLocationUpdated(this.onLocationUpdated,this,this.disposableRegistry),this.onLocationUpdated(),t}get updated(){return this.updatedEmitter.event}getLocation(e){let t=this.activeTrackers.get(e)||this.activeTrackersById.get(e.id);if(t)return t.debugLocation}onLocationUpdated(){this.updatedEmitter.fire()}};h_=U([(0,UP.injectable)(),x(0,(0,UP.inject)(oo)),x(1,(0,UP.inject)(ve))],h_);p();var Su=oe(he()),bv=require("vscode");var g_=class{constructor(e,t,n){this.vscodeDebugService=t;this.jupyterDebugService=n;this.sessionChangedEvent=new bv.EventEmitter;this.sessionStartedEvent=new bv.EventEmitter;this.sessionTerminatedEvent=new bv.EventEmitter;this.sessionCustomEvent=new bv.EventEmitter;e.push(t.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(t.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(t.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(t.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))),n&&(e.push(n.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(n.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(n.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(n.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))))}get activeDebugSession(){return this.activeService.activeDebugSession}get activeDebugConsole(){return this.activeService.activeDebugConsole}get breakpoints(){return this.activeService.breakpoints}get onDidChangeActiveDebugSession(){return this.sessionChangedEvent.event}get onDidStartDebugSession(){return this.sessionStartedEvent.event}get onDidReceiveDebugSessionCustomEvent(){return this.sessionCustomEvent.event}get onDidTerminateDebugSession(){return this.sessionTerminatedEvent.event}get onDidChangeBreakpoints(){return this.activeService.onDidChangeBreakpoints}get onBreakpointHit(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.onBreakpointHit}startRunByLine(e){if(this.lastStartedService=this.jupyterDebugService,!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.startRunByLine(e)}registerDebugConfigurationProvider(e,t){let n=this.vscodeDebugService.registerDebugConfigurationProvider(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugConfigurationProvider(e,t);return this.combineDisposables(n,i)}return n}registerDebugAdapterTrackerFactory(e,t){let n=this.vscodeDebugService.registerDebugAdapterTrackerFactory(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugAdapterTrackerFactory(e,t);return this.combineDisposables(n,i)}return n}startDebugging(e,t,n){return this.lastStartedService=this.vscodeDebugService,this.vscodeDebugService.startDebugging(e,t,n)}addBreakpoints(e){return this.activeService.addBreakpoints(e)}removeBreakpoints(e){return this.activeService.removeBreakpoints(e)}getStack(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.getStack();throw new Error("Requesting jupyter specific stack when not debugging.")}step(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.step();throw new Error("Requesting jupyter specific step when not debugging.")}continue(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.continue();throw new Error("Requesting jupyter specific step when not debugging.")}requestVariables(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.requestVariables();throw new Error("Requesting jupyter specific variables when not debugging.")}stop(){this.jupyterDebugService&&this.lastStartedService===this.jupyterDebugService?this.jupyterDebugService.stop():bv.commands.executeCommand("workbench.action.debug.stop").then(E,E)}get activeService(){return this.lastStartedService?this.lastStartedService:this.vscodeDebugService}combineDisposables(e,t){return{dispose:()=>{e.dispose(),t.dispose()}}}endedDebugSession(e){this.sessionTerminatedEvent.fire(e),this.lastStartedService=void 0}startedDebugSession(e){this.sessionStartedEvent.fire(e)}changedDebugSession(e){this.sessionChangedEvent.fire(e)}gotCustomEvent(e){this.sessionCustomEvent.fire(e)}};g_=U([(0,Su.injectable)(),x(0,(0,Su.inject)(ve)),x(1,(0,Su.inject)(oo)),x(2,(0,Su.optional)()),x(2,(0,Su.inject)(a_)),x(2,(0,Su.named)(nt.RUN_BY_LINE_DEBUGSERVICE))],g_);p();var k9=oe(Zg()),Sv=oe(he());p();var v_=Symbol("IFileConverter"),Sm=Symbol("IExportBase"),P0t=Symbol("IExport"),_m=Symbol("IExportUtil");function y_e(){return`${Yf}${(0,k9.default)()}`}function b_e(r){let e=`${y_e()}${(0,k9.default)()}.ipynb`;return r?`${pi(r,".ipynb")}${e}`:`${W.defaultNotebookName}${e}`}var Iv=class{constructor(e,t,n,i){this.kernelProvider=e;this.fs=t;this.jupyterConnection=n;this.exportUtil=i}async export(e,t,n,i){}async executeCommand(e,t,n,i,o){var R;let s=this.kernelProvider.get(e);if(!s||(s.session||await s.start(new pr(!1)),!((R=s.session)!=null&&R.kernel)))return;let a=s.kernelConnectionMetadata,l=s.resourceUri;if(!Wt(a)||l)return;let u=s.session.kernel,d=(await this.jupyterConnection.createConnectionInfo(a.serverProviderHandle)).settings,f=Jn(),m=new f.ContentsManager({serverSettings:d}),g=await this.exportUtil.getContent(e),b="";switch(n){case"html":b=".html";break;case"pdf":b=".pdf";break;case"python":b=".py";break}let v=await this.createBackingFile(l,m);if(!v)return;await m.save(v.filePath,{content:JSON.parse(g),type:"notebook"}).catch(E);let k;try{let P=await this.getCWD(s);k=(await m.newUntitled({type:"file",ext:b})).path;let K=`${P}/${v.filePath}`,L=await Ai(u,`!jupyter nbconvert ${K} --to ${n} --output ${Ht(k)}`),B=this.parseStreamOutput(L);if(this.isExportFailed(B))throw new Error(B||`Failed to export to ${n}`);if(B&&C.debug(B),n==="pdf"){let N=await m.get(k,{type:"file",format:"base64",content:!0}),h=await this.b64toBlob(N.content,"application/pdf").arrayBuffer();await this.fs.writeFile(t,new Uint8Array(h))}else{let N=await m.get(k,{type:"file",format:"text",content:!0});await this.fs.writeFile(t,N.content)}}finally{k&&await m.delete(k),await v.dispose(),await m.delete(v.filePath).catch(E),m.dispose()}}async createBackingFile(e,t){let n,i={type:"notebook"},o=b_e(e);try{n=await t.newUntitled(i);let s=Ci(n.path);n=await t.rename(n.path,s.length&&s!=="."?`${s}/${o}`:o)}catch(s){C.error(`Backing file not supported: ${s}`)}if(n){let s=n.path;return{filePath:s,dispose:()=>t.delete(s)}}}async getContents(e,t,n){return await n.get(e,{type:"file",format:t,content:!0})}b64toBlob(e,t){t=t||"";let n=512;e=e.replace(/^[^,]+,/,""),e=e.replace(/\s/g,"");let i=atob(e),o=[];for(let a=0;a<i.length;a+=n){let l=i.slice(a,a+n),u=new Array(l.length);for(let d=0;d<l.length;d++)u[d]=l.charCodeAt(d);let c=new Uint8Array(u);o.push(c)}return new Blob(o,{type:t})}isExportFailed(e){return e?/Traceback \(most recent call last\)/g.exec(e):!0}parseStreamOutput(e){if(e.length===0)return;let t=e[0];return t.name!=="stdout"&&t.output_type!=="stream"?void 0:Wc(t.text).trim()}async getCWD(e){var i;if(!((i=e.session)!=null&&i.kernel))throw new Qr;let t=await Ai(e.session.kernel,"import os;os.getcwd();");if(t.length===0)return;let n=t[0];if(n.output_type==="execute_result")return n.data["text/plain"]}};U([TX("PerformingExport")],Iv.prototype,"executeCommand",1),Iv=U([(0,Sv.injectable)(),x(0,(0,Sv.inject)(qe)),x(1,(0,Sv.inject)(Pt)),x(2,(0,Sv.inject)(fn)),x(3,(0,Sv.inject)(_m))],Iv);p();var Aee=oe(he());p();var y_=require("vscode");p();var WP=require("vscode");var I_e={PDF:["pdf"]},S_e={HTML:["html","htm"]},__e={Python:["py"]},rp=class{async showDialog(e,t,n){let i={},o;switch(e){case"python":i=__e,o=".py";break;case"pdf":o=".pdf",i=I_e;break;case"html":o=".html",i=S_e;break;case"ipynb":o=".ipynb";let l=W.exportDialogFilter;i[l]=["ipynb"];break;default:return}let s=n||!t?n||"":`${Ht(t.path,Ep(t.path))}${o}`,a={defaultUri:await this.getDefaultUri(t,s),saveLabel:W.exportButtonTitle,filters:i};return WP.window.showSaveDialog(a)}async getDefaultUri(e,t){if(e&&e.scheme==="untitled"&&zr())return;if(!e||e.scheme==="file"||e.scheme==="untitled"||e.scheme==="vscode-interactive"){let i=tt.instance.get(WR);return WP.Uri.file(YE(await i.computeWorkingDirectory(e),t))}let n=YE(Ci(e.path),t);return WP.Uri.parse(`${e.scheme}://${n}`).with({authority:e.authority})}};var HM=class{async getContent(e){let t=y_.extensions.getExtension("vscode.ipynb");if(!t)throw new Error("Unable to export notebook as the built-in vscode.ipynb extension is currently unavailable.");t.isActive||await t.activate();let i=e.getCells().map(s=>{let a=new y_.NotebookCellData(s.kind,s.document.getText(),s.document.languageId);return a.metadata=s.metadata,a.mime=s.mime,a.outputs=[...s.outputs],a}),o=new y_.NotebookData(i);return o.metadata=JSON.parse(JSON.stringify(e.metadata)),t.exports.exportNotebook(o)}async getTargetFile(e,t,n){return await new rp().showDialog(e,t,n)}};var b_=class extends HM{};b_=U([(0,Aee.injectable)()],b_);p();var __=oe(he());p();var zM=oe(he()),QM=require("vscode");p();var np=require("vscode");var qM=class{constructor(){this.fs=tt.instance.get(Pt)}async openFile(e,t,n=!1){if(e==="python")await this.openPythonFile(t,n),ne("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:!0});else{let i=await this.askOpenFile(t,n);ne("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:i})}}async openPythonFile(e,t){let n;if(t)n=await np.window.showTextDocument(e);else{let i=await this.fs.readFile(e);await this.fs.delete(e);let o=await np.workspace.openTextDocument({language:Ye,content:i});n=await np.window.showTextDocument(o)}await n.edit(i=>{i.insert(new np.Position(n.document.lineCount,0),`
`)})}async askOpenFile(e,t){let n=W.openExportFileYes,i=W.openExportFileNo,o=[n,i];return await np.window.showInformationMessage(W.openExportedFileMessage,...o).then(a=>a)===n?(t?np.window.showTextDocument(e).then(E,E):GI(e.toString()),!0):!1}};p();var JM=class{async export(e,t,n,i){await tt.instance.get(Sm).executeCommand(e,t,"python",n,i)}};p();var GM=class{async export(e,t,n,i){await tt.instance.get(Sm).executeCommand(e,t,"pdf",n,i)}};p();var YM=class{async export(e,t,n,i){await tt.instance.get(Sm).executeCommand(e,t,"html",n,i)}};p();var N9=require("vscode");var $M=class{constructor(){this.fs=tt.instance.get(Pt),this.configuration=tt.instance.get(Ke),this.platform=tt.instance.get(ds)}async writeFile(e,t){await this.fs.writeFile(e,t)}getEOL(){return this.platform.isWindows?`\r
`:`
`}async export(e,t,n){if(n.isCancellationRequested)return;let i=this.exportDocument(e);await this.writeFile(t,i)}exportDocument(e){return e.getCells().filter(t=>{var n;return!((n=t.metadata)!=null&&n.isInteractiveWindowMessageCell)}).reduce((t,n)=>t+this.exportCell(n),"")}exportCell(e){if(e.document.lineCount){let t=this.cellMarker(e),n=this.getEOL();switch(e.kind){case N9.NotebookCellKind.Code:return`${t}${n}${this.exportCodeCell(e)}${n}${n}`;case N9.NotebookCellKind.Markup:return`${t} [markdown]${n}${this.exportMarkdownCell(e)}${n}${n}`}}return""}exportCodeCell(e){let t=lt(e.document.getText(),{trim:!1,removeEmptyEntries:!1}),n=this.configuration.getSettings(e.notebook.uri).pythonExportMethod==="commentMagics";return dI(t,this.getEOL(),n?E_e:void 0).join("")}exportMarkdownCell(e){let t=lt(e.document.getText(),{trim:!1,removeEmptyEntries:!1});return dI(t,this.getEOL(),C_e).join("")}cellMarker(e){var n;let t=this.configuration.getSettings(e.notebook.uri);return(n=e.metadata.interactiveWindowCellMarker)!=null?n:t.defaultCellMarker}};function E_e(r){return/^\s*!/.test(r)||/^\s*%/.test(r)?`# ${r}`:r}function C_e(r){return`# ${r}`}var I_=class{constructor(e,t,n){this.exportUtil=e;this.progressReporter=t;this.configuration=n}async importIpynb(e){let t=this.progressReporter.createProgressIndicator(W.importingIpynb,!0);try{let n=await QM.workspace.openNotebookDocument(e);await this.exportImpl("python",n,void 0,t.token)}finally{t.dispose()}}async export(e,t,n,i){let o=this.progressReporter.createProgressIndicator(W.exportingToFormat(e.toString()),!0);try{await this.exportImpl(e,t,n,o.token,i)}finally{o.dispose()}if(o.token.isCancellationRequested){ne("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,cancelled:!0});return}}async exportImpl(e,t,n,i,o){try{let s=await this.exportUtil.getTargetFile(e,t.uri,n);if(!s)return;await this.performExport(e,t,s,i,o)}catch(s){C.error("Export failed",s),ne("DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",void 0,{format:e}),e==="pdf"&&C.error(W.exportToPDFDependencyMessage),this.showExportFailed(W.exportFailedGeneralMessage)}}async performExport(e,t,n,i,o){e==="python"&&this.configuration.getSettings(t.uri).pythonExportMethod!=="nbconvert"?await this.performPlainExport(e,t,n,i):await this.performNbConvertExport(t,e,n,o,i),n&&this.openExportedFile(e,n).catch(E)}async openExportedFile(e,t){await new qM().openFile(e,t,!0).catch(E)}async performPlainExport(e,t,n,i){if(n)switch(e){case"python":await new $M().export(t,n,i);break}return n}async performNbConvertExport(e,t,n,i,o){try{return await this.exportToFormat(e,n,t,i,o)}finally{}}async exportToFormat(e,t,n,i,o){switch(n){case"python":return new JM().export(e,t,i,o);case"pdf":return new GM().export(e,t,i,o);case"html":return new YM().export(e,t,i,o);default:break}}showExportFailed(e){QM.window.showErrorMessage(`${W.failedExportMessage} ${e}`)}};I_=U([x(0,(0,zM.inject)(_m)),x(1,(0,zM.inject)(Fl)),x(2,(0,zM.inject)(Ke))],I_);var S_=class extends I_{constructor(t,n,i){super(t,n,i);this.exportUtil=t}};S_=U([(0,__.injectable)(),x(0,(0,__.inject)(_m)),x(1,(0,__.inject)(Fl)),x(2,(0,__.inject)(Ke))],S_);p();var jP=oe(he()),_v=require("vscode");p();var VP=require("vscode");var R9=new WeakMap;async function _u(r,e){let t=r;if(r.isClosed)return!0;let n=R9.has(t)?R9.get(t):Promise.resolve(),i=Re(),o=n.finally(async()=>{let s=new VP.WorkspaceEdit,a=e(s);Yv(a)&&await a,await VP.workspace.applyEdit(s).then(l=>i.resolve(l),l=>i.reject(l))}).catch(E);return R9.set(t,o),i.promise}var E_=class{constructor(e,t){this.disposables=e;this.controllerRegistration=t}activate(){this.controllerRegistration.onControllerSelected(this.onDidChangeNotebookController,this,this.disposables)}async onDidChangeNotebookController(e){let t=e.notebook,n=e.controller.connection;if(!hr(t))return;let i=_v.window.visibleNotebookEditors.find(c=>c.notebook===t);if(!i)return;let o=t.getCells().filter(c=>c.kind===_v.NotebookCellKind.Code&&c.document.getText().trim().length===0),s=t.getCells().filter(c=>c.kind===_v.NotebookCellKind.Code).length;if(o.length===0||o.length!==s)return;let a,l=n.kind;switch(n.kind){case"connectToLiveRemoteKernel":{a=n.kernelModel.language;break}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":{a=n.kernelSpec.language;break}case"startUsingPythonInterpreter":{a=Ye;break}default:{C.error(`Unsupported kernel kind encountered ${l}`);return}}if(!a)return;let u=Uc(a);_u(i.notebook,async()=>{await o.map(async c=>{if(u.toLowerCase()!==c.document.languageId)return _v.languages.setTextDocumentLanguage(c.document,u).then(E,E)})}).then(E,E)}};E_=U([(0,jP.injectable)(),x(0,(0,jP.inject)(ve)),x(1,(0,jP.inject)(Nt))],E_);p();var Jl=oe(he()),br=require("vscode");var C_=class{constructor(e,t,n,i,o,s,a,l){this.disposableRegistry=e;this.languageService=t;this.configurationService=n;this.kernelProvider=i;this.controllerRegistration=o;this.errorHandler=s;this.notebookEditorProvider=a;this.serviceContainer=l;this.kernelInterruptedDontAskToRestart=!1;this.pendingRestartInterrupt=new WeakMap}register(){this.disposableRegistry.push(br.commands.registerCommand(le.NotebookEditorRemoveAllCells,()=>this.removeAllCells())),this.disposableRegistry.push(br.commands.registerCommand(le.NotebookEditorRunAllCells,()=>this.runAllCells())),this.disposableRegistry.push(br.commands.registerCommand(le.NotebookEditorAddCellBelow,()=>this.addCellBelow())),this.disposableRegistry.push(br.commands.registerCommand(le.RestartKernelAndRunUpToSelectedCell,()=>this.restartKernelAndRunUpToSelectedCell())),this.disposableRegistry.push(br.commands.registerCommand(le.RestartKernel,e=>{var t;return e&&"notebookEditor"in e?this.restartKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(E):this.restartKernel(e).catch(E)})),this.disposableRegistry.push(br.commands.registerCommand(le.InterruptKernel,e=>{var t;return this.interruptKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)})),this.disposableRegistry.push(br.commands.registerCommand(le.RestartKernelAndRunAllCells,e=>{var t;e&&"notebookEditor"in e?this.restartKernelAndRunAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(E):this.restartKernelAndRunAllCells(e).catch(E)}))}runAllCells(){br.window.activeNotebookEditor&&br.commands.executeCommand("notebook.execute").then(E,E)}addCellBelow(){br.window.activeNotebookEditor&&br.commands.executeCommand("notebook.cell.insertCodeCellBelow").then(E,E)}removeAllCells(){var n;let e=(n=br.window.activeNotebookEditor)==null?void 0:n.notebook;if(!e)return;let t=this.languageService.getPreferredLanguage(_a(e));_u(e,i=>{let o=br.NotebookEdit.replaceCells(new br.NotebookRange(0,e.cellCount),[new br.NotebookCellData(br.NotebookCellKind.Code,"",t)]);i.set(e.uri,[o])}).then(E,E)}async interruptKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=br.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;C.debug(`Command interrupted kernel for ${Ee(n.uri)}`);let i=this.kernelProvider.get(n);if(!i){C.info("Interrupt requested & no kernel.");return}await this.wrapKernelMethod("interrupt",i)}async restartKernelAndRunAllCells(e){await this.restartKernel(e),this.runAllCells()}async restartKernelAndRunUpToSelectedCell(){let e=this.notebookEditorProvider.activeNotebookEditor;e&&(await this.restartKernel(e.notebook.uri),br.commands.executeCommand("notebook.cell.execute",{ranges:[{start:0,end:e.selection.end}],document:e.notebook.uri}).then(E,E))}async restartKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=br.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;let i=this.kernelProvider.get(n);if(i)if(C.debug(`Restart kernel command handler for ${Ee(n.uri)}`),await this.shouldAskForRestart(n.uri)){let s=W.restartKernelMessage,a=W.restartKernelMessageYes,l=W.restartKernelMessageDontAskAgain,u=await br.window.showInformationMessage(s,{modal:!0},a,l);u===l?(await this.disableAskForRestart(n.uri),this.wrapKernelMethod("restart",i).catch(E)):u===a&&this.wrapKernelMethod("restart",i).catch(E)}else this.wrapKernelMethod("restart",i).catch(E)}async wrapKernelMethod(e,t){let n=t.notebook,i=this.pendingRestartInterrupt.get(t);if(i)return i;let o=(async()=>{let s=this.kernelProvider.getKernelExecution(t).pendingCells[0],a=this.controllerRegistration.getSelected(n);try{if(!a)throw new Error("No kernel associated with the notebook");await Ta.wrapKernelMethod(a.connection,e,t.creator,this.serviceContainer,{resource:t.resourceUri,notebook:n,controller:a.controller},new pr(!1),this.disposableRegistry)}catch(l){s?await Ld(s,t.controller,await this.errorHandler.getErrorMessageForDisplayInCellOutput(l,e,t.resourceUri),!1):br.window.showErrorMessage(l.toString()).then(E,E)}})();return o.finally(()=>{this.pendingRestartInterrupt.get(t)===o&&this.pendingRestartInterrupt.delete(t)}).catch(E),this.pendingRestartInterrupt.set(t,o),o}async shouldAskForRestart(e){if(this.kernelInterruptedDontAskToRestart)return!1;let t=this.configurationService.getSettings(e);return t&&t.askForKernelRestart===!0}async disableAskForRestart(e){this.configurationService.getSettings(e)&&this.configurationService.updateSetting("askForKernelRestart",!1,void 0,br.ConfigurationTarget.Global).catch(E)}};C_=U([(0,Jl.injectable)(),x(0,(0,Jl.inject)(ve)),x(1,(0,Jl.inject)(Bs)),x(2,(0,Jl.inject)(Ke)),x(3,(0,Jl.inject)(qe)),x(4,(0,Jl.inject)(Nt)),x(5,(0,Jl.inject)(pn)),x(6,(0,Jl.inject)(Ao)),x(7,(0,Jl.inject)(Ar))],C_);p();var Mee=oe(he()),Em=require("vscode");var w_=class{constructor(){this.providers=new Set}registerEmbedNotebookProvider(e){this.providers.add(e)}findNotebookEditor(e){var o;let t=e?Ua(e,!0):"false",n=Al(e)==="notebook"?Em.workspace.notebookDocuments.find(s=>Ua(s.uri,!0)===t):void 0,i=n&&((o=Em.window.activeNotebookEditor)==null?void 0:o.notebook)===n?Em.window.activeNotebookEditor:void 0;if(i)return i;for(let s of this.providers){let a=s.findNotebookEditor(e);if(a)return a}}get activeNotebookEditor(){var e,t;return this.findNotebookEditor((e=Em.window.activeNotebookEditor)==null?void 0:e.notebook.uri)||this.findNotebookEditor((t=Em.window.activeTextEditor)==null?void 0:t.document.uri)}findAssociatedNotebookDocument(e){let t=xi()==="Windows",n=Em.workspace.notebookDocuments.find(i=>t?i.uri.path.toLowerCase()===e.path.toLowerCase():i.uri.path===e.path);if(n)return n;for(let i of this.providers){let o=i.findAssociatedNotebookDocument(e);if(o)return o}}};w_=U([(0,Mee.injectable)()],w_);p();var Oee=oe(he()),Lee=require("vscode");var x_=class extends Pr{constructor(){super(...arguments);this._onDidChangeEnvironment=this._register(new Lee.EventEmitter);this.onDidChangeEnvironment=this._onDidChangeEnvironment.event}getPythonEnvironment(t){}};x_=U([(0,Oee.injectable)()],x_);p();var XM=oe(he()),D_=require("vscode");var P_=class{constructor(e){this.sentMimeTypes=new Set;this.disposables=[];e.push(this)}activate(){this.isTelemetryDisabled=MN(),D_.workspace.onDidOpenNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),D_.workspace.onDidCloseNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),D_.workspace.onDidSaveNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables),this.disposables.push(ON(e=>this.isTelemetryDisabled=e))}dispose(){Ce(this.disposables)}async onDidChangeNotebookCellExecutionState(e){!hr(e.cell.notebook)||this.isTelemetryDisabled||e.state!==1||this.checkCell(e.cell,"onExecution")}onDidOpenCloseDocument(e){!hr(e)||this.isTelemetryDisabled||e.getCells().forEach(t=>this.checkCell(t,"onOpenCloseOrSave"))}checkCell(e,t){if(e.kind===D_.NotebookCellKind.Markup||e.document.languageId==="raw")return;let n=e.notebook.notebookType===St?"notebook":"interactive";e.outputs.map(i=>i.items.map(o=>o.mime)).flat().map(i=>this.sendTelemetry(i,t,n))}sendTelemetry(e,t,n){let i=`${e}-${t}`;this.sentMimeTypes.has(i)||(this.sentMimeTypes.add(i),e=e.replace(/\//g,"_").replace(/\\/g,"_"),ne("DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",void 0,{mimeType:e,when:t,resourceType:n}))}};P_=U([(0,XM.injectable)(),x(0,(0,XM.inject)(ve))],P_);p();var ZM=oe(he());var w_e=/(;32m[ ->]*?)(\d+)(.*)/g,T_=class{constructor(e){this.configurationService=e}format(e,t){return e.notebook.notebookType!==St?t:t.map(n=>this.modifyTracebackFrameIPython(e,n))}modifyTracebackFrameIPython(e,t){var o;let n=this.configurationService.getSettings(e.document.uri);return((o=n==null?void 0:n.formatStackTraces)!=null?o:!1)&&/^[Cell|Input|File].*?\n.*/.test(t)?this.modifyTracebackFrameIPython8(e,t):t}modifyTracebackFrameIPython8(e,t){t=t.replace(/\u001b\[4\dm/g,""),t=t.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),t=t.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(s,a,l,u)=>(u=u.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${a}${l}${u}
`)),C.ci(`Trace frame to match: ${t}`);let n=(s,a)=>{let l=s.replace(w_e,(c,d,f,m)=>{let g=parseInt(f,10);return`${d}<a href='${e.document.uri.toString()}?line=${g-1}'>${g}</a>${m}`}),u=W.cellAtFormat(ct(e.document.uri),e.index+1);return l.replace(/.*?\n/,`\x1B[1;32m${u}\x1B[0m line \x1B[0;36m${a}
`)},i=/^Input.*?\[.*32mIn\s+\[(\d+).*?0;36m(.*?)\n.*/.exec(t);if(i&&i.length>1)return n(t,i[2]);let o=/Cell.*?\[.*32mIn\s*\[(\d+)\]\,\s+line\s+([(\d+)])(.*?)\n.*/gm.exec(t);return o&&o.length>1?n(t,o[2]):t}};T_=U([(0,ZM.injectable)(),x(0,(0,ZM.inject)(Ke))],T_);function Kee(r,e){Cee(r,e),r.addSingleton(Ve,av),r.addSingleton(Ao,w_),r.addSingleton(Ve,pv),r.addSingleton(xI,T_),r.addSingleton(pm,pm),r.addBinding(pm,Ve),r.addSingleton(Ve,zS),r.addSingleton(fy,C_),r.addSingleton(Bs,Bs),r.addBinding(Bs,Ve),r.addSingleton(Ve,E_),r.addSingleton(bm,m_,void 0,[Ve]),r.addSingleton(a_,g_,nt.MULTIPLEXING_DEBUGSERVICE),r.addSingleton(MM,h_,void 0,[AM]),r.addSingleton(Oi,u_,nt.DEBUGGER_VARIABLES),r.addSingleton(Ve,l_),r.addSingleton(Ve,P_),r.addSingleton(Sm,Iv),r.addSingleton(v_,S_),r.addSingleton(_m,b_),r.addSingleton(UR,x_)}p();p();var Nn=oe(he()),Xe=require("vscode");p();var Cm=Symbol("IDataScienceCodeLensProvider"),eO=Symbol("ICodeWatcher"),tO=Symbol("ICodeLensFactory"),wm=Symbol("ICellRangeCache"),hAt=Symbol("IGeneratedCodeStore"),Na=Symbol("IGeneratedCodeStorageFactory"),k_=Symbol("ICodeGeneratorFactory");p();var Fee=Symbol("IInteractiveWindowDebugger"),ao=Symbol("IInteractiveWindowProvider"),rO=Symbol("IInteractiveControllerHelper"),nO=Symbol("IInteractiveWindowDebuggingManager");p();var iO=require("vscode");async function oO(r){let e=await iO.workspace.openNotebookDocument(r);await iO.window.showNotebookDocument(e)}p();var Ra=require("vscode");p();var hs=class{constructor(e){this.codeMatchRegEx=this.createRegExp(e?e.codeRegularExpression:void 0,VE.PythonCellMarker),this.markdownMatchRegEx=this.createRegExp(e?e.markdownRegularExpression:void 0,VE.PythonMarkdownCellMarker),this.codeExecRegEx=new RegExp(`${this.codeMatchRegEx.source}(.*)`),this.markdownExecRegEx=new RegExp(`${this.markdownMatchRegEx.source}(.*)`),this.defaultCellMarker=e!=null&&e.defaultCellMarker?e.defaultCellMarker:"# %%"}isCell(e){return this.isCode(e)||this.isMarkdown(e)}isMarkdown(e){return this.markdownMatchRegEx.test(e.trim())}isCode(e){return this.codeMatchRegEx.test(e.trim())||e.trim()===this.defaultCellMarker}getCellType(e){return this.isMarkdown(e)?"markdown":"code"}isEmptyCell(e){return this.stripFirstMarker(e).trim().length===0}stripFirstMarker(e){let t=lt(e,{trim:!1,removeEmptyEntries:!1});return t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0]))?t.slice(1).join(`
`):e}stripFirstMarkerNoConcat(e){return e.length>0&&(this.isCode(e[0])||this.isMarkdown(e[0]))?e.slice(1):e}getFirstMarker(e){let t=lt(e,{trim:!1,removeEmptyEntries:!1});if(t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0])))return t[0]}createRegExp(e,t){try{if(e)return new RegExp(e)}catch(n){}return t}};p();var Hs=require("vscode");function Uee(r,e){let t=ut(r);return t?e==1?W.restartingKernelCustomHeader(t):W.startingNewKernelCustomHeader(t):e==1?W.restartingKernelHeader:W.startingNewKernelHeader}function Wee(r,e){let t=ut(r);return e==1?W.restartedKernelHeader(t||""):W.connectedKernelHeader(t||"")}function BP(r){var e;return r.kind===Hs.NotebookCellKind.Markup&&((e=r.metadata)==null?void 0:e.isInteractiveWindowMessageCell)===!0}var sO=class{constructor(e,t,n){this.interactiveWindow=e;this.notebookDocument=t;this.isDeleted=!1;this.sysInfoCellPromise=this.getOrUpdate(n)}async resolveCell(){return await this.sysInfoCellPromise}async getOrUpdate(e){let t=await this.interactiveWindow.getAppendIndex()-1;if(t>=0){let n=this.notebookDocument.cellAt(t);if(BP(n))return this.updateMessage(e)}return this.sysInfoCellPromise=this.createCell(e)}async createCell(e){let t;return await _u(this.notebookDocument,async n=>{let i=new Hs.NotebookCellData(Hs.NotebookCellKind.Markup,e,jE);i.metadata={isInteractiveWindowMessageCell:!0},t=await this.interactiveWindow.getAppendIndex();let o=Hs.NotebookEdit.insertCells(t,[i]);n.set(this.notebookDocument.uri,[o])}),this.notebookDocument.cellAt(t)}async updateMessage(e){let t=await this.sysInfoCellPromise;return await _u(this.notebookDocument,n=>{if(t.index>=0&&!this.isDeleted&&BP(t)){n.replace(t.document.uri,new Hs.Range(0,0,t.document.lineCount,0),e),n.set(this.notebookDocument.uri,[Hs.NotebookEdit.updateCellMetadata(t.index,{isInteractiveWindowMessageCell:!0})]);return}}),t}async deleteCell(){this.isDeleted=!0;let e=await this.sysInfoCellPromise;await _u(this.notebookDocument,t=>{if(e.index>=0&&BP(e)){let n=Hs.NotebookEdit.deleteCells(new Hs.NotebookRange(e.index,e.index+1));t.set(this.notebookDocument.uri,[n]);return}})}};function aO(r){return/^#\s*!/.test(r)?/^#\s*!\s*%%?/.test(r)?r.replace(/^#\s*!\s*/,""):r.replace(/^#\s*/,""):r}function Vee(r,e){let t=e.isCell(r[0])&&r.length>1?r.slice(1):r;return new Ra.NotebookCellData(Ra.NotebookCellKind.Code,t.join(`
`),"python")}function jee(r){return new Ra.NotebookCellData(Ra.NotebookCellKind.Markup,QN(r).join(`
`),"markdown")}function P_e(r,e,t){let n=lt(e,{trim:!1}),i=n[0],o=new hs(r);if(o.isMarkdown(i)){let s=-1;return Og(n,(a,l)=>void 0,(a,l)=>{a&&a.length>0&&s===-1&&(s=t?l:-1)}),s>=0?[jee(n.slice(0,s)),Vee(n.slice(s),o)]:[jee(n)]}else return[Vee(n,o)]}function A9(r,e){let t=new hs(e),n=[];for(let i=0;i<r.lineCount;i+=1){let o=r.lineAt(i);if(t.isCell(o.text)){if(n.length>0){let s=n[n.length-1];s.range=new Ra.Range(s.range.start,r.lineAt(i-1).range.end)}n.push({range:o.range,cell_type:t.getCellType(o.text)})}}if(n.length>=1){let i=r.lineAt(r.lineCount-1),o=n[n.length-1];o.range=new Ra.Range(o.range.start,i.range.end)}return n}function M9(r,e){let t=A9(r,e);return Array.prototype.concat(...t.map(n=>{let i=r.getText(n.range);return P_e(e,i,!1)}))}function Bee(r){return r.getCells().filter(e=>!BP(e)).map(e=>{let t=lt(e.document.getText(),{trim:!1,removeEmptyEntries:!1});e.metadata.interactiveWindowCellMarker!==void 0&&t.unshift(e.metadata.interactiveWindowCellMarker+`
`);let n=new Ra.NotebookCellData(e.kind,t.join(`
`),e.kind===Ra.NotebookCellKind.Code?e.document.languageId:"markdown");return e.kind===Ra.NotebookCellKind.Code&&(n.outputs=[...e.outputs]),n.metadata=Of(e),n})}p();var HP=require("vscode");var O9=class{constructor(e,t,n){this.disposed=!1;this.dispose=()=>{this.disposed||(this.disposed=!0,this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.disposeCallback(),this.deferred.completed||this.deferred.resolve())};this.promise=()=>this.deferred.promise;this.reject=()=>{this.deferred.reject(),this.dispose()};this.deferred=Re(),this.disposeCallback=t,n&&(this.timeout=setTimeout(this.dispose,n))}},lO=class{constructor(){this.statusCount=0;this.incrementCount=()=>{this.statusCount+=1};this.decrementCount=()=>{let e=this.statusCount-1;this.statusCount=Math.max(e,0)}}set(e,t,n){this.incrementCount();let i=new O9(e,()=>this.decrementCount(),t),o={location:n?HP.ProgressLocation.Notification:HP.ProgressLocation.Window,title:e,cancellable:n!==void 0};return HP.window.withProgress(o,(s,a)=>(a&&n&&a.onCancellationRequested(()=>{n(),i.reject()}),i.promise())).then(E,E),i}async waitWithStatus(e,t,n,i){let o=this.set(t,n,i),s;try{s=await e()}finally{o.dispose()}return s}};var gs=class{constructor(e,t,n,i,o,s,a,l,u,c,d,f,m){this.disposables=e;this.jupyterExporter=t;this.jupyterServerHelper=n;this.fileSystem=i;this.configuration=o;this.dataScienceCodeLensProvider=s;this.debugService=a;this.configService=l;this.interactiveWindowProvider=u;this.kernelProvider=c;this.dataScienceErrorHandler=d;this.ipynbProvider=f;this.fileConverter=m;this.statusProvider=new lO,Xe.workspace.isTrusted||Xe.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted(),this.registerCommand(le.InsertCellBelowPosition,this.insertCellBelowPosition),this.registerCommand(le.InsertCellBelow,this.insertCellBelow),this.registerCommand(le.InsertCellAbove,this.insertCellAbove),this.registerCommand(le.DeleteCells,this.deleteCells),this.registerCommand(le.SelectCell,this.selectCell),this.registerCommand(le.SelectCellContents,this.selectCellContents),this.registerCommand(le.ExtendSelectionByCellAbove,this.extendSelectionByCellAbove),this.registerCommand(le.ExtendSelectionByCellBelow,this.extendSelectionByCellBelow),this.registerCommand(le.MoveCellsUp,this.moveCellsUp),this.registerCommand(le.MoveCellsDown,this.moveCellsDown),this.registerCommand(le.ChangeCellToMarkdown,this.changeCellToMarkdown),this.registerCommand(le.ChangeCellToCode,this.changeCellToCode),this.registerCommand(le.GotoNextCellInFile,this.gotoNextCellInFile),this.registerCommand(le.GotoPrevCellInFile,this.gotoPrevCellInFile),this.registerCommand(le.AddCellBelow,this.addCellBelow),this.registerCommand(le.CreateNewNotebook,this.createNewNotebook),this.registerCommand(le.LatestExtension,this.openPythonExtensionPage),this.registerCommand(le.EnableLoadingWidgetsFrom3rdPartySource,this.enableLoadingWidgetScriptsFromThirdParty),this.registerCommand(le.CreateNewInteractive,e=>this.createNewInteractiveWindow(e)),this.registerCommand(le.ImportNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),this.registerCommand(le.ImportNotebookFile,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),Xe.commands.registerCommand(le.ExportFileAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFile(e);{let n=Xe.window.activeTextEditor;if(n&&n.document.languageId===Ye)return this.exportFile(n.document.uri)}return Promise.resolve()})),this.registerCommand(le.ExportFileAndOutputAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFileAndOutput(e);{let n=Xe.window.activeTextEditor;if(n&&n.document.languageId===Ye)return this.exportFileAndOutput(n.document.uri)}return Promise.resolve()})),this.registerCommand(le.ExpandAllCells,async e=>{var t;return this.expandAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(le.CollapseAllCells,async e=>{var t;return this.collapseAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(le.ExportOutputAsNotebook,()=>this.exportCells()),this.registerCommand(le.InteractiveExportAsNotebook,e=>{var t;return this.export((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(le.InteractiveExportAs,e=>{var t;return this.exportAs((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(le.ScrollToCell,(e,t)=>this.scrollToCell(e,t)),this.registerCommand(le.InteractiveClearAll,this.clearAllCellsInInteractiveWindow),this.registerCommand(le.InteractiveGoToCode,this.goToCodeInInteractiveWindow),this.registerCommand(le.InteractiveCopyCell,this.copyCellInInteractiveWindow)}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){Xe.workspace.isTrusted&&(this.registerCommand(le.RunAllCells,this.runAllCells),this.registerCommand(le.RunCell,this.runCell),this.registerCommand(le.RunCurrentCell,this.runCurrentCell),this.registerCommand(le.RunCurrentCellAdvance,this.runCurrentCellAndAdvance),this.registerCommand(le.ExecSelectionInInteractiveWindow,e=>{this.runSelectionOrLine(e).catch(E)}),this.registerCommand(le.RunAllCellsAbove,this.runAllCellsAbove),this.registerCommand(le.RunCellAndAllBelow,this.runCellAndAllBelow),this.registerCommand(le.RunAllCellsAbovePalette,this.runAllCellsAboveFromCursor),this.registerCommand(le.RunCellAndAllBelowPalette,this.runCellAndAllBelowFromCursor),this.registerCommand(le.RunCurrentCellAndAddBelow,this.runCurrentCellAndAddBelow),this.registerCommand(le.DebugCell,this.debugCell),this.registerCommand(le.DebugStepOver,this.debugStepOver),this.registerCommand(le.DebugContinue,this.debugContinue),this.registerCommand(le.DebugStop,this.debugStop),this.registerCommand(le.DebugCurrentCellPalette,this.debugCurrentCellFromCursor),this.registerCommand(le.OpenVariableView,this.openVariableView),this.registerCommand(le.OpenOutlineView,this.openOutlineView),this.registerCommand(le.RunToLine,this.runToLine),this.registerCommand(le.RunFromLine,this.runFromLine),this.registerCommand(le.RunFileInInteractiveWindows,this.runFileInteractive),this.registerCommand(le.DebugFileInInteractiveWindows,this.debugFileInteractive))}registerCommand(e,t){let n=Xe.commands.registerCommand(e,t,this);this.disposables.push(n)}getCodeWatcher(e){if(e&&this.dataScienceCodeLensProvider){let t=Xe.workspace.textDocuments.filter(n=>Xs(n.uri,e));if(t&&t.length===1)return this.dataScienceCodeLensProvider.getCodeWatcher(t[0]);if(t&&t.length>1)throw new Error(W.documentMismatch(ct(e)))}}async enableLoadingWidgetScriptsFromThirdParty(){this.configService.getSettings(void 0).widgetScriptSources.length>0||await this.configService.updateSetting("widgetScriptSources",["jsdelivr.com","unpkg.com"],void 0,Xe.ConfigurationTarget.Global).catch(E)}async runAllCells(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runAllCells()}async runFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runFileInteractive()}async debugFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.debugFileInteractive()}async runCell(e,t,n,i,o){let s=this.getCodeWatcher(e);if(s)return s.runCell(new Xe.Range(t,n,i,o))}async runAllCellsAbove(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runAllCellsAbove(t,n)}}async runCellAndAllBelow(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runCellAndAllBelow(t,n)}}async runToLine(){let e=this.getCurrentCodeWatcher(),t=Xe.window.activeTextEditor;if(e&&t&&t.selection)return e.runToLine(t.selection.start.line)}async runFromLine(){let e=this.getCurrentCodeWatcher(),t=Xe.window.activeTextEditor;if(e&&t&&t.selection)return e.runFromLine(t.selection.start.line)}async runCurrentCell(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCell()}async runCurrentCellAndAdvance(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCellAndAdvance()}async runSelectionOrLine(e){let t=this.getCurrentCodeWatcher();if(t)return t.runSelectionOrLine(Xe.window.activeTextEditor,ui(e)?void 0:e)}async debugCell(e,t,n,i,o){if(e){let s=this.getCodeWatcher(e);if(s)return s.debugCell(new Xe.Range(t,n,i,o))}}async debugStepOver(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&Xe.commands.executeCommand("workbench.action.debug.stepOver").then(E,E)}async debugStop(e){var t;if((t=this.debugService)!=null&&t.activeDebugSession&&this.interactiveWindowProvider){let n=this.interactiveWindowProvider.get(e);if(n&&n.notebookDocument){let i=this.kernelProvider.get(n.notebookDocument);i&&(C.debug(`Interrupt kernel due to debug stop of IW ${e.toString()}`),await i.interrupt())}Xe.commands.executeCommand("workbench.action.debug.stop").then(E,E)}}async debugContinue(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&Xe.commands.executeCommand("workbench.action.debug.continue").then(E,E)}async addCellBelow(){var e;await((e=this.getCurrentCodeWatcher())==null?void 0:e.addEmptyCellToBottom())}async runCurrentCellAndAddBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.runCurrentCellAndAddBelow()}async insertCellBelowPosition(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelowPosition()}async insertCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelow()}async insertCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellAbove()}async deleteCells(){var e;(e=this.getCurrentCodeWatcher())==null||e.deleteCells()}async selectCell(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCell()}async selectCellContents(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCellContents()}async extendSelectionByCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellAbove()}async extendSelectionByCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellBelow()}async moveCellsUp(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsUp()}async moveCellsDown(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsDown()}async changeCellToMarkdown(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToMarkdown()}async changeCellToCode(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToCode()}async gotoNextCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoNextCell()}async gotoPrevCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoPreviousCell()}async runAllCellsAboveFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runAllCellsAbove(e.range.start.line,e.range.start.character)}else return}async runCellAndAllBelowFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runCellAndAllBelow(e.range.start.line,e.range.start.character)}else return}async debugCurrentCellFromCursor(){if(this.getCurrentCodeLens()){let t=this.getCurrentCodeWatcher();if(t)return t.debugCurrentCell()}else return}async createNewNotebook(){Xe.window.showInformationMessage('This command has been deprecated and will eventually be removed, please use ["Create: New Jupyter Notebook"](command:workbench.action.openGlobalKeybindings?%5B%22@command:ipynb.newUntitledIpynb%22%5D) instead.').then(E,E),await Xe.commands.executeCommand("ipynb.newUntitledIpynb")}getCurrentCodeLens(){let e=Xe.window.activeTextEditor,t=this.getCurrentCodeWatcher();if(e&&t)return t.getCodeLenses().find(n=>n.range.end.line>=e.selection.anchor.line&&n.range.start.line<=e.selection.anchor.line)}getCurrentCodeWatcher(){let e=Xe.window.activeTextEditor;if(!(!e||!e.document||!this.dataScienceCodeLensProvider))return this.dataScienceCodeLensProvider.getCodeWatcher(e.document)}openPythonExtensionPage(){Xe.env.openExternal(Xe.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter")).then(E,E)}async openVariableView(){return Xe.commands.executeCommand("jupyterViewVariables.focus")}async openOutlineView(){return Xe.commands.executeCommand("outline.focus")}async listenForErrors(e){let t;try{return t=await e(),t}catch(n){C.error("listenForErrors",n),this.dataScienceErrorHandler.handleError(n).then(E,E)}return t}async exportFile(e){let t=ct(e);if(t&&t.length>0&&this.jupyterExporter){let n=Xe.window.activeTextEditor;if(n&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=M9(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new rp().showDialog("ipynb",e);if(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},W.exportingFormat,Ee(e)),o&&t){let s=W.exportOpenQuestion1;await Xe.window.showInformationMessage(W.exportDialogComplete(Ee(e)),s)===s&&await oO(o)}}}}}async exportFileAndOutput(e){let t=ct(e);if(t&&t.length>0&&this.jupyterExporter&&this.jupyterServerHelper&&await this.jupyterServerHelper.isJupyterServerSupported()){let n=Xe.window.activeTextEditor;if(n&&n.document&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=M9(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new rp().showDialog("ipynb",e);return o?(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},W.exportingFormat,Ee(e)),await Xe.workspace.openNotebookDocument(o).then(s=>Xe.window.showNotebookDocument(s)),await Xe.commands.executeCommand("notebook.execute"),o):void 0}}}else this.jupyterServerHelper&&await this.dataScienceErrorHandler.handleError(new am(W.jupyterNotSupported(await this.jupyterServerHelper.getJupyterServerError())))}async expandAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);C.info(`Expanding all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.expandAllCells()}async collapseAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);C.info(`Collapsing all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.collapseAllCells()}exportCells(){var t;let e=(t=this.interactiveWindowProvider)==null?void 0:t.activeWindow;e&&e.export()}exportAs(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.exportAs()}export(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.export()}async createNewInteractiveWindow(e){var t;await((t=this.interactiveWindowProvider)==null?void 0:t.getOrCreate(void 0,e))}waitForStatus(e,t,n,i){let o=t(n||"");return this.statusProvider.waitWithStatus(e,o,void 0,i)}async importNotebook(){let e=W.importDialogFilter,t={};t[e]=["ipynb"];let n=await Xe.window.showOpenDialog({openLabel:W.importDialogTitle,filters:t});n&&n.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(n[0])},W.importingFormat,Ee(n[0]))}async importNotebookOnFile(e){let t=ct(e);t&&t.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(e)},W.importingFormat,Ee(e))}async scrollToCell(e,t){if(t&&e){let n=this.interactiveWindowProvider.getInteractiveWindowsWithSubmitter(e);for(let i=0;i<n.length;i+=1)if(await n[i].hasCell(t)){n[i].scrollToCell(t);break}}}async clearAllCellsInInteractiveWindow(e){var s,a;let t=(a=this.interactiveWindowProvider.getInteractiveWindowWithNotebook((s=e==null?void 0:e.notebookEditor)==null?void 0:s.notebookUri))==null?void 0:a.notebookUri;if(!t)return;let n=Xe.workspace.notebookDocuments.find(l=>l.uri.toString()===t.toString());if(!n)return;let i=new Xe.WorkspaceEdit,o=Xe.NotebookEdit.deleteCells(new Xe.NotebookRange(0,n.cellCount));i.set(n.uri,[o]),await Xe.workspace.applyEdit(i)}async goToCodeInInteractiveWindow(e){var t;if(e&&((t=e.metadata)!=null&&t.interactive)){let n=Xe.Uri.parse(e.metadata.interactive.uristring),i=e.metadata.interactive.lineIndex,o=await Xe.window.showTextDocument(n,{viewColumn:Xe.ViewColumn.One});o&&(o.revealRange(new Xe.Range(i,0,i,0)),o.selection=new Xe.Selection(new Xe.Position(i,0),new Xe.Position(i,0)))}}async copyCellInInteractiveWindow(e){var t;if(e){let n=this.configuration.getSettings(e.notebook.uri),i=[(t=e.metadata.interactiveWindowCellMarker)!=null?t:n.defaultCellMarker,e.document.getText()].join(`
`);await Xe.env.clipboard.writeText(i)}}};U([Tn("DATASCIENCE.DEBUG_STEP_OVER")],gs.prototype,"debugStepOver",1),U([Tn("DATASCIENCE.DEBUG_STOP")],gs.prototype,"debugStop",1),U([Tn("DATASCIENCE.DEBUG_CONTINUE")],gs.prototype,"debugContinue",1),U([Nr("DATASCIENCE.ADD_CELL_BELOW")],gs.prototype,"addCellBelow",1),U([Tn("DATASCIENCE.EXPORT_PYTHON_FILE")],gs.prototype,"exportFile",1),U([Tn("DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT")],gs.prototype,"exportFileAndOutput",1),U([Tn("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"command"})],gs.prototype,"importNotebook",1),U([Tn("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"file"})],gs.prototype,"importNotebookOnFile",1),gs=U([(0,Nn.injectable)(),x(0,(0,Nn.inject)(ve)),x(1,(0,Nn.inject)(MI)),x(1,(0,Nn.optional)()),x(2,(0,Nn.inject)(RR)),x(2,(0,Nn.optional)()),x(3,(0,Nn.inject)(Pt)),x(4,(0,Nn.inject)(Ke)),x(5,(0,Nn.inject)(Cm)),x(5,(0,Nn.optional)()),x(6,(0,Nn.inject)(oo)),x(6,(0,Nn.optional)()),x(7,(0,Nn.inject)(Ke)),x(8,(0,Nn.inject)(ao)),x(9,(0,Nn.inject)(qe)),x(10,(0,Nn.inject)(pn)),x(11,(0,Nn.inject)(Ao)),x(12,(0,Nn.inject)(v_))],gs);p();var ip=oe(he()),xm=require("vscode");p();function Gl(r){if(r.metadata.interactive!==void 0)return r.metadata}function Hee(r,e,t){let n=lt(r,{trim:!1,removeEmptyEntries:!1}),i=t.stripFirstMarkerNoConcat(n),o=fY(i),s=dI(o,`
`,e.magicCommandsAsComments?aO:void 0);return Qv(s.join(""))}p();var Eu=Symbol("IReplNotebookTrackerService");var D_e=W.runCurrentCellAndAddBelow,T_e=W.addCellBelowCommandTitle,k_e=W.debugCellCommandTitle,N_e=W.debugCellCommandTitle,R_e=W.debugStepOverCommandTitle,A_e=W.debugContinueCommandTitle,M_e=W.debugStopCommandTitle,O_e=W.runCellLensCommandTitle,L_e=W.runAllCellsLensCommandTitle,K_e=W.runAllCellsAboveLensCommandTitle,qee=W.runCellAndAllBelowLensCommandTitle,F_e=W.scrollToCellTitleFormatMessage,N_=class{constructor(e,t,n,i,o,s){this.configService=e;this.generatedCodeStorageFactory=n;this.replTracker=o;this.cellRangeCache=s;this.updateEvent=new xm.EventEmitter;this.notebookData=new Map;this.codeLensCache=new Map;this.totalCodeLensUpdateTimeInMs=0;this.codeLensUpdateCount=0;this.maxCellCount=0;xm.workspace.onDidCloseTextDocument(this.onClosedDocument,this,t),xm.workspace.onDidGrantWorkspaceTrust(()=>this.codeLensCache.clear(),this,t),this.configService.getSettings(void 0).onDidChange(this.onChangedSettings,this,t),Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,t),i.onDidDisposeKernel(a=>{this.notebookData.delete(a.notebook.uri.toString())},this,t)}getPerfMeasures(){return{totalCodeLensUpdateTimeInMs:this.totalCodeLensUpdateTimeInMs,codeLensUpdateCount:this.codeLensUpdateCount,maxCellCount:this.maxCellCount}}get updateRequired(){return this.updateEvent.event}createCodeLenses(e){let t=this.getCodeLensCacheData(e);return[...t.documentLenses,...t.gotoCellLens]}getCellRanges(e){return this.getCodeLensCacheData(e).cellRanges}getCodeLensCacheData(e){var l;let t=new yt,n=!1,i=e.uri.toString(),o=this.codeLensCache.get(i),s=!1;o||(o={cachedDocumentVersion:void 0,cachedExecutionCounts:new Set,documentLenses:[],cellRanges:[],gotoCellLens:[]},s=!0,this.codeLensCache.set(i,o)),o.cachedDocumentVersion!==e.version&&(o.cellRanges=this.cellRangeCache.getCellRanges(e),o.documentLenses=[],o.gotoCellLens=[],o.cachedDocumentVersion=e.version,s=!0);let a=this.getDocumentExecutionCounts(i);if((a.length!==o.cachedExecutionCounts.size||a.find(u=>!(o!=null&&o.cachedExecutionCounts.has(u))))&&(o.gotoCellLens=[],o.cachedExecutionCounts=new Set(a),s=!0),o.documentLenses.length===0&&s&&o.cellRanges.length){n=!0;let u=this.enumerateCommands(e.uri);C.debug(`CodeLensFactory: Generating new code lenses for version ${e.version} of document ${e.uri} for commands ${u.join(", ")}`);let c=!0;o.cellRanges.forEach(d=>{u.forEach(f=>{let m=this.createCodeLens(e,d,f,c);m&&o.documentLenses.push(m)}),c=!1})}else C.ci(`NOT Generating new code lenses for version ${e.version} of document ${e.uri} - needUpdate: ${s}, cellRanges.length: ${o.cellRanges.length}`);if(s&&o.gotoCellLens.length===0&&o.cellRanges.length&&this.configService.getSettings(e.uri).addGotoCodeLenses){let u=this.generatedCodeStorageFactory.get({fileUri:e.uri}),c=u?(l=u.all.find(d=>d.uri.toString()===e.uri.toString()))==null?void 0:l.generatedCodes:void 0;c&&c.length&&o.cellRanges.forEach(d=>{let f=this.createExecutionLens(e,d.range,c);f&&(o==null||o.gotoCellLens.push(f))})}return n&&(this.totalCodeLensUpdateTimeInMs+=t.elapsedTime,this.codeLensUpdateCount+=1,this.maxCellCount=Math.max(this.maxCellCount,o.cellRanges.length)),o}getDocumentExecutionCounts(e){return[...this.notebookData.values()].map(t=>t.documentExecutionCounts.get(e)).filter(t=>t!==void 0)}onDidChangeNotebookCellExecutionState(e){var i;if(this.replTracker.isForReplEditor(e.cell.notebook)||e.state!==1||!((i=e.cell.executionSummary)!=null&&i.executionOrder))return;let t=Gl(e.cell),n=this.notebookData.get(e.cell.notebook.uri.toString());n||(n={cellExecutionCounts:new Map,documentExecutionCounts:new Map},this.notebookData.set(e.cell.notebook.uri.toString(),n)),n!==void 0&&t!==void 0&&(n.cellExecutionCounts.set(t.id,e.cell.executionSummary.executionOrder),n.documentExecutionCounts.set(t.interactive.uristring,e.cell.executionSummary.executionOrder),this.updateEvent.fire())}onClosedDocument(e){this.codeLensCache.delete(e.uri.toString())}onChangedSettings(){this.codeLensCache.clear(),this.cellRangeCache.clear(),this.updateEvent.fire()}enumerateCommands(e){let t,n=this.configService.getSettings(e).codeLenses;n?t=n.split(",").map(s=>s.trim()):t=Mu.DefaultDesignLenses;let i=this.configService.getSettings(e).debugCodeLenses;i?t=t.concat(i.split(",").map(s=>s.trim())):t=t.concat(Mu.DefaultDebuggingLenses);let o=[];return xm.workspace.isTrusted||(o=[...Mu.DebuggerCommands,...Mu.DebuggerCommands,le.RunAllCells,le.RunAllCellsAbove,le.RunAllCellsAbovePalette,le.RunCellAndAllBelowPalette,le.RunCurrentCell,le.RunCurrentCellAdvance,le.RunCurrentCellAndAddBelow,le.RunFileInInteractiveWindows,le.InterruptKernel,le.RunToLine,le.RunCell,le.DebugCell,le.DebugContinue,le.DebugStepOver,le.DebugStop,le.RunCellAndAllBelowPalette]),o&&(t=t.filter(s=>!o.includes(s))),t}createCodeLens(e,t,n,i){let{range:o,cell_type:s}=t;switch(n){case le.RunCurrentCellAndAddBelow:return this.generateCodeLens(o,le.RunCurrentCellAndAddBelow,D_e);case le.AddCellBelow:return this.generateCodeLens(o,le.AddCellBelow,T_e,[e.uri,o.start.line]);case le.DebugCurrentCellPalette:return this.generateCodeLens(o,le.DebugCurrentCellPalette,k_e);case le.DebugCell:if(s!=="code")break;return this.generateCodeLens(o,le.DebugCell,N_e,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case le.DebugStepOver:if(s!=="code")break;return this.generateCodeLens(o,le.DebugStepOver,R_e,[e.uri]);case le.DebugContinue:if(s!=="code")break;return this.generateCodeLens(o,le.DebugContinue,A_e,[e.uri]);case le.DebugStop:if(s!=="code")break;return this.generateCodeLens(o,le.DebugStop,M_e,[e.uri]);case le.RunCurrentCell:case le.RunCell:return this.generateCodeLens(o,le.RunCell,O_e,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case le.RunAllCells:return this.generateCodeLens(o,le.RunAllCells,L_e,[e.uri,o.start.line,o.start.character]);case le.RunAllCellsAbovePalette:case le.RunAllCellsAbove:return i?this.generateCodeLens(o,le.RunCellAndAllBelow,qee,[e.uri,o.start.line,o.start.character]):this.generateCodeLens(o,le.RunAllCellsAbove,K_e,[e.uri,o.start.line,o.start.character]);case le.RunCellAndAllBelowPalette:case le.RunCellAndAllBelow:return this.generateCodeLens(o,le.RunCellAndAllBelow,qee,[e.uri,o.start.line,o.start.character]);default:C.warn(`Invalid command for code lens ${n}`);break}}findMatchingCellExecutionCount(e){let t=[...this.notebookData.values()].find(n=>n.cellExecutionCounts.get(e));return t==null?void 0:t.cellExecutionCounts.get(e)}createExecutionLens(e,t,n){if(n){let i=n.filter(o=>o.line-2===t.start.line).sort((o,s)=>o.timestamp-s.timestamp);if(i&&i.length){let o=i[i.length-1],s=this.findMatchingCellExecutionCount(o.id);if(s!==void 0)return this.generateCodeLens(t,le.ScrollToCell,F_e(s),[e.uri,o.id])}}}generateCodeLens(e,t,n,i){return new xm.CodeLens(e,U_e(t,n,i))}};N_=U([(0,ip.injectable)(),x(0,(0,ip.inject)(Ke)),x(1,(0,ip.inject)(ve)),x(2,(0,ip.inject)(Na)),x(3,(0,ip.inject)(qe)),x(4,(0,ip.inject)(Eu)),x(5,(0,ip.inject)(wm))],N_);function U_e(r,e,t){return{arguments:t,title:e,command:r}}p();var Cu=oe(he()),Yl=oe(require("vscode"));var R_=class{constructor(e,t,n,i,o){this.serviceContainer=e;this.debugLocationTracker=t;this.configuration=n;this.debugService=o;this.totalExecutionTimeInMs=0;this.totalGetCodeLensCalls=0;this.activeCodeWatchers=[];this.didChangeCodeLenses=new Yl.EventEmitter;i.push(this),i.push(Yl.workspace.onDidGrantWorkspaceTrust(()=>{this.activeCodeWatchers=Ce(this.activeCodeWatchers),this.didChangeCodeLenses.fire()})),i.push(this.debugService.onDidChangeActiveDebugSession(this.onChangeDebugSession.bind(this))),i.push(Yl.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument.bind(this))),this.debugLocationTracker&&i.push(this.debugLocationTracker.updated(this.onDebugLocationUpdated.bind(this)))}dispose(){this.totalGetCodeLensCalls>0&&ne("DS_INTERNAL.CODE_LENS_ACQ_TIME",{duration:this.totalExecutionTimeInMs/this.totalGetCodeLensCalls}),Ce(this.activeCodeWatchers)}get onDidChangeCodeLenses(){return this.didChangeCodeLenses.event}provideCodeLenses(e,t){return[ec,Bv].includes(e.uri.scheme)?[]:this.getCodeLensTimed(e)}getCodeWatcher(e){return this.matchWatcher(e.uri)}onDebugLocationUpdated(){this.didChangeCodeLenses.fire()}onChangeDebugSession(e){this.didChangeCodeLenses.fire()}onDidCloseTextDocument(e){let t=this.activeCodeWatchers.findIndex(n=>n.uri&&n.uri.toString()===e.uri.toString());t>=0&&this.activeCodeWatchers.splice(t,1)[0].dispose()}getCodeLensTimed(e){let t=new yt,n=this.getCodeLens(e);return this.totalExecutionTimeInMs+=t.elapsedTime,this.totalGetCodeLensCalls+=1,this.configuration.getSettings(e.uri).enableCellCodeLens?this.adjustDebuggingLenses(e,n):[]}adjustDebuggingLenses(e,t){let n=Mu.DebuggerCommands;if(this.debugLocationTracker&&this.debugService.activeDebugSession){let i=this.debugLocationTracker.getLocation(this.debugService.activeDebugSession),o;try{o=i?Yl.Uri.parse(i.fileName):void 0}catch(s){}if(i&&(Xs(Yl.Uri.file(i.fileName),e.uri,!0)||o&&Xs(o,e.uri,!0)))return t.filter(a=>{let l=new Yl.Position(i.lineNumber-1,i.column-1);return a.range.contains(l)}).filter(a=>a.command?n.includes(a.command.command):!1);C.ci(`Detected debugging context because activeDebugSession is name:"${this.debugService.activeDebugSession.name}", type: "${this.debugService.activeDebugSession.type}", but fell through with debugLocation: ${JSON.stringify(i)}, and document.uri: ${e.uri.toString()}`)}else return t.filter(i=>i.command?!n.includes(i.command.command):!1);return[]}getCodeLens(e){let t=this.matchWatcher(e.uri);return t?t.getCodeLenses():(C.debug(`Creating a new watcher for document ${e.uri}`),this.createNewCodeWatcher(e).getCodeLenses())}matchWatcher(e){let t=this.activeCodeWatchers.findIndex(i=>i.uri&&i.uri.toString()==e.toString());if(t>=0)return this.activeCodeWatchers[t];let n=Yl.workspace.textDocuments.filter(i=>i.uri.toString()===e.toString());if(n&&n.length>0)return C.debug(`creating new code watcher with matching document ${e}`),this.createNewCodeWatcher(n[0])}createNewCodeWatcher(e){let t=this.serviceContainer.get(eO);return t.setDocument(e),t.codeLensUpdated(this.onWatcherUpdated.bind(this)),this.activeCodeWatchers.push(t),t}onWatcherUpdated(){this.didChangeCodeLenses.fire()}};R_=U([(0,Cu.injectable)(),x(0,(0,Cu.inject)(Ar)),x(1,(0,Cu.inject)(MM)),x(1,(0,Cu.optional)()),x(2,(0,Cu.inject)(Ke)),x(3,(0,Cu.inject)(ve)),x(4,(0,Cu.inject)(oo))],R_);p();var op=oe(he()),ke=require("vscode");p();var cO=Symbol("ICodeExecutionHelper");p();var Ev=class extends Error{constructor(t){super("Cell failed to execute");this.cell=t}};function W_e(r,e){if(e<=0)throw new RangeError(`Length must be > 0 not ${e}`);return r<0&&(r+=e),r<0?0:r>=e?e-1:r}var tr=class{constructor(e,t,n,i,o,s){this.interactiveWindowProvider=e;this.configService=t;this.executionHelper=n;this.dataScienceErrorHandler=i;this.codeLensFactory=o;this.replTracker=s;this.version=-1;this.codeLenses=[];this.cells=[];this.codeLensUpdatedEvent=new ke.EventEmitter;this.disposables=[this.codeLensUpdatedEvent]}setDocument(e){this.document=e,this.version=e.version,this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.disposables.push(this.codeLensFactory.updateRequired(this.onCodeLensFactoryUpdated.bind(this))),this.disposables.push(ke.workspace.onDidCloseTextDocument(this.onDocumentClosed.bind(this))),this.disposables.push(ke.workspace.onDidCloseNotebookDocument(this.ondidCloseNotebook.bind(this)))}get codeLensUpdated(){return this.codeLensUpdatedEvent.event}get uri(){var e;return(e=this.document)==null?void 0:e.uri}getVersion(){return this.version}getCodeLenses(){let e=this.document;return e&&e.version!=this.version&&(this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.version=e.version),this.codeLenses}async debugCurrentCell(){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(ke.window.activeTextEditor.selection,!1,!0)}dispose(){let e=this.codeLensFactory.getPerfMeasures();e&&e.codeLensUpdateCount>0&&ne("DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",{codeLensUpdateTime:e.totalCodeLensUpdateTimeInMs/e.codeLensUpdateCount,maxCellCount:e.maxCellCount}),Ce(this.disposables)}async runAllCells(e){let t=await this.getActiveInteractiveWindow(),n=this.codeLenses.filter(s=>s.command&&s.command.command===le.RunCell&&s.command.arguments&&s.command.arguments.length>=5),i=n.length,o=Promise.resolve(!0);for(let s of n){let a=new ke.Range(s.command.arguments[1],s.command.arguments[2],s.command.arguments[3],s.command.arguments[4]);if(this.document){i===n.length&&(a=new ke.Range(new ke.Position(0,0),a.end));let l=this.document.getText(a);i-=1,o=this.addCode(t,l,this.document.uri,a.start.line,e)}}if(await o,n.length===0)return this.runFileAsOneCell(e!=null?e:!1)}async runFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells();if(this.document)return this.runFileAsOneCell(!1)}async debugFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells(!0);if(this.document)return this.runFileAsOneCell(!0)}async runAllCellsAbove(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===le.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t);o<0&&(o=i.length);let s=o,a=Promise.resolve(!0);for(let l of i)if(o>0&&this.document){let u=new ke.Range(l.range.start,l.range.end);o===s&&(u=new ke.Range(new ke.Position(0,0),u.end)),o-=1;let c=this.document.getText(u);a=this.addCode(n,c,this.document.uri,l.range.start.line)}else break;await a}async runCellAndAllBelow(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===le.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t),s=o>0?i.length-o:i.length,a=Promise.resolve(!0);for(let l=o;l>=0&&l<i.length;l+=1)if(s>0&&this.document){let u=i[l];s-=1;let c=this.document.getText(u.range);a=this.addCode(n,c,this.document.uri,u.range.start.line)}await a}async runSelectionOrLine(e,t){if(this.document&&e&&Xs(e.document.uri,this.document.uri)){let n=await this.getActiveInteractiveWindow(),i;if(t===void 0||ui(t)?i=this.executionHelper.getSelectedTextToExecute(e):i=t,!i)return;await this.addCode(n,i,this.document.uri,e.selection.start.line)}}async runToLine(e){if(this.document&&e>0){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(e-1),i=this.document.getText(new ke.Range(0,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,0)}}async runFromLine(e){if(this.document&&e<this.document.lineCount){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(this.document.lineCount-1),i=this.document.getText(new ke.Range(e,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,e)}}async runCell(e){if(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document)return;let t=e.contains(ke.window.activeTextEditor.selection.start)&&this.configService.getSettings(ke.window.activeTextEditor.document.uri).enableAutoMoveToNextCell;return this.runMatchingCell(e,t)}async debugCell(e){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(e,!1,!0)}async runCurrentCell(){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(ke.window.activeTextEditor.selection,!1)}async runCurrentCellAndAdvance(){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(ke.window.activeTextEditor.selection,!0)}async addEmptyCellToBottom(){let e=ke.window.activeTextEditor;e&&this.insertCell(e,e.document.lineCount+1)}async runCurrentCellAndAddBelow(){if(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document)return;let e=ke.window.activeTextEditor,t=new hs(this.configService.getSettings(e.document.uri)),n=0,i=this.getDefaultCellMarker(e.document.uri);e&&e.edit(s=>{let a=!0;for(let l=e.selection.end.line+1;l<e.document.lineCount;l+=1)if(t.isCell(e.document.lineAt(l).text)){a=!1,n=l,s.insert(new ke.Position(l,0),`${i}

`);break}a&&(n=e.document.lineCount,s.insert(new ke.Position(e.document.lineCount,0),`
${i}
`))}).then(E,E);let o=new ke.Position(n+1,0);return this.runMatchingCell(e.selection,!1).then(()=>this.advanceToRange(new ke.Range(o,o)))}insertCellBelowPosition(){let e=ke.window.activeTextEditor;e&&e.selection&&this.insertCell(e,e.selection.end.line+1)}insertCellBelow(){let e=ke.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.end);t?this.insertCell(e,t.range.end.line+1):this.insertCell(e,e.selection.end.line+1)}}insertCellAbove(){let e=ke.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.start);t?this.insertCell(e,t.range.start.line):this.insertCell(e,e.selection.start.line)}}deleteCells(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCells(e.selection);if(!t)return;let n=t[0],i=t[1],o=0,s=0,a=i.range.end.line+1,l=0;n.range.start.line>0&&(o=n.range.start.line-1,s=e.document.lineAt(o).range.end.character,a=i.range.end.line,l=i.range.end.character);let u=new ke.Range(new ke.Position(o,s),new ke.Position(a,l));e.edit(c=>{c.replace(u,""),this.codeLensUpdatedEvent.fire()}).then(E,E)}selectCell(){let e=ke.window.activeTextEditor;if(e&&e.selection){let t=this.getStartEndCells(e.selection);if(t){let n=t[0],i=t[1];e.selection.anchor.isBeforeOrEqual(e.selection.active)?e.selection=new ke.Selection(n.range.start,i.range.end):e.selection=new ke.Selection(i.range.end,n.range.start)}}}selectCellContents(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCellIndex(e.selection);if(!t)return;let n=t[0],i=t[1],o=e.selection.anchor.isBeforeOrEqual(e.selection.active),s=this.cells,a=[];for(let l=n;l<=i;l+=1){let u=s[l],c=u.range.start.line+1,d=0,f=u.range.end.line,m=u.range.end.character;u.range.start.line===u.range.end.line&&(c=u.range.start.line,d=e.document.lineAt(c).range.end.character,f=c,m=d),o?a.push(new ke.Selection(c,d,f,m)):a.push(new ke.Selection(f,m,c,d))}e.selections=a}extendSelectionByCellAbove(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBefore(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],u=o[a];if(!l.range.start.isEqual(t.start)||!u.range.end.isEqual(t.end)){let c;i?s<a?c=new ke.Selection(l.range.start,o[a-1].range.end):c=new ke.Selection(l.range.end,l.range.start):c=new ke.Selection(u.range.end,l.range.start),e.selection=c}else{let c;i&&s<a?(c=o[a-1],e.selection=new ke.Selection(l.range.start,c.range.end)):s>0&&(c=o[s-1],e.selection=new ke.Selection(u.range.end,c.range.start)),c&&e.revealRange(c.range,ke.TextEditorRevealType.Default)}}extendSelectionByCellBelow(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBeforeOrEqual(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],u=o[a];if(!l.range.start.isEqual(t.start)||!u.range.end.isEqual(t.end)){let c;i?c=new ke.Selection(l.range.start,u.range.end):s<a?c=new ke.Selection(o[s+1].range.start,u.range.end):c=new ke.Selection(u.range.start,u.range.end),e.selection=c}else{let c;i||s===a?a<o.length-1&&(c=o[a+1],e.selection=new ke.Selection(l.range.start,c.range.end)):s<a&&(c=o[s+1],e.selection=new ke.Selection(u.range.end,c.range.start)),c&&e.revealRange(c.range,ke.TextEditorRevealType.Default)}}async moveCellsUp(){await this.moveCellsDirection(!0)}async moveCellsDown(){await this.moveCellsDirection(!1)}changeCellToMarkdown(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"markdown"))}changeCellToCode(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"code"))}gotoNextCell(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getNextCellLens(t.start);n&&i&&this.advanceToRange(i.range)}gotoPreviousCell(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getPreviousCellLens(t.start);n&&i&&this.advanceToRange(i.range)}applyToCells(e){let t=ke.window.activeTextEditor,n=this.getStartEndCellIndex(t==null?void 0:t.selection);if(!t||!n)return;let i=this.cells,o=n[0],s=n[1];for(let a=o;a<=s;a+=1)e(t,i[a],a)}changeCellTo(e,t,n){if(n==="raw")throw Error("Cell Type raw not implemented");if(t.cell_type===n)return;let i=new hs(this.configService.getSettings(e.document.uri)),o=e.document.lineAt(t.range.start.line),s=e.document.getText(o.range),a=this.getDefaultCellMarker(e.document.uri),l=n==="markdown"?i.codeExecRegEx.exec(s):i.markdownExecRegEx.exec(s);if(!l)return;let u=l[l.length-1],c=n==="markdown"?`${a} [markdown]${u}`:`${a}${u}`;e.edit(async d=>{d.replace(o.range,c),t.cell_type=n,t.range.start.line<t.range.end.line&&(e.selection=new ke.Selection(t.range.start.line+1,0,t.range.end.line,t.range.end.character),ke.commands.executeCommand("editor.action.removeCommentLine").then(E,E),n==="markdown"&&ke.commands.executeCommand("editor.action.addCommentLine").then(E,E))}).then(E,E)}async moveCellsDirection(e){let t=ke.window.activeTextEditor;if(!t||!t.selection)return!1;let n=this.getStartEndCellIndex(t.selection);if(!n)return!1;let i=n[0],o=n[1],s=this.cells,a=s[i],l=s[o];if(!a||!l)return!1;let u=new ke.Range(a.range.start,l.range.end),c=new ke.Range(t.selection.start.line-u.start.line,t.selection.start.character,t.selection.end.line-u.start.line,t.selection.end.character),d=t.selection.active.isBefore(t.selection.anchor),f;if(e){if(i===0)return!1;{let m=s[i-1];f=this.exchangeTextLines(t,m.range,u).then(b=>(b&&(t.selection=new ke.Selection(m.range.start.line+c.start.line,c.start.character,m.range.start.line+c.end.line,c.end.character)),b))}}else{if(o===s.length-1)return!1;{let m=s[o+1],g=this.exchangeTextLines(t,u,m.range),b=m.range.end.line-m.range.start.line,v=u.end.line-u.start.line,k=b-v;f=g.then(R=>(R&&(t.selection=new ke.Selection(m.range.start.line+k+c.start.line,c.start.character,m.range.start.line+k+c.end.line,c.end.character)),R))}}return f.then(m=>(m&&d&&(t.selection=new ke.Selection(t.selection.active,t.selection.anchor)),!0))}exchangeTextLines(e,t,n){let i=t.start.line,o=t.end.line,s=n.start.line,a=n.end.line;if(o>=s)throw RangeError(`Above lines must be fully above not ${o} <= ${s}`);let l=new ke.Range(i,0,o,e.document.lineAt(o).range.end.character),u=e.document.getText(l),c=new ke.Range(s,0,a,e.document.lineAt(a).range.end.character),d=e.document.getText(c),f="";if(o+1<s){let b=o+1,v=s-1,k=new ke.Range(b,0,v,e.document.lineAt(v).range.end.character);f=`${e.document.getText(k)}
`}let m=`${d}
${f}${u}`,g=new ke.Range(l.start,c.end);return e.edit(b=>{b.replace(g,m),this.codeLensUpdatedEvent.fire()})}getStartEndCells(e){let t=this.getStartEndCellIndex(e);if(t){let n=this.getCellFromIndex(t[0]),i=this.getCellFromIndex(t[1]);return[n,i]}}getStartEndCellIndex(e){if(!e)return;let t=this.getCellIndex(e.start),n=t;if(e.start.line!==e.end.line&&(n=this.getCellIndex(e.end)),t===-1){if(n===-1)return;{t=0;let i=this.getCellFromIndex(0);if(e.start.line>i.range.start.line)throw RangeError(`Should not be able to pick a range with an end in a cell and start after a cell. ${e.start.line} > ${i.range.end.line}`)}}if(t>=0&&n>=0)return[t,n]}insertCell(e,t){let n=this.getDefaultCellMarker(e.document.uri),i=t>=e.document.lineCount?`
${n}
`:`${n}

`,o=new ke.Position(t,0),s=new ke.Position(t+1,0);e.edit(a=>{a.insert(o,i),this.codeLensUpdatedEvent.fire()}).then(E,E),e.selection=new ke.Selection(s,s)}getDefaultCellMarker(e){return this.configService.getSettings(e).defaultCellMarker||nt.DefaultCodeCellMarker}onCodeLensFactoryUpdated(){this.document&&(this.codeLenses=this.codeLensFactory.createCodeLenses(this.document),this.cells=this.codeLensFactory.getCellRanges(this.document)),this.codeLensUpdatedEvent.fire()}onDocumentClosed(e){this.document&&Xs(e.uri,this.document.uri)&&Ce(this.disposables)}ondidCloseNotebook(e){var t;this.replTracker.isForReplEditor(e)&&this.configService.getSettings((t=this.document)==null?void 0:t.uri).addGotoCodeLenses&&this.onCodeLensFactoryUpdated()}getActiveInteractiveWindow(){var e;return this.interactiveWindowProvider.getOrCreate((e=this.document)==null?void 0:e.uri)}async addCode(e,t,n,i,o){let s=!1;try{o?s=await e.debugCode(t,n,i):s=await e.addCode(t,n,i)}catch(a){a instanceof Ev||await this.dataScienceErrorHandler.handleError(a)}return s}async runMatchingCell(e,t,n){let i=this.getCurrentCellLens(e.start),o=this.getNextCellLens(e.start);if(i&&this.document){let s=Qv(this.document.getText(i.range));if(t){let l=ke.window.activeTextEditor,{newCellOnRunLast:u}=this.configService.getSettings(this.document.uri),c=new hs(this.configService.getSettings(this.document.uri));o?this.advanceToRange(o.range):u&&l&&!c.isEmptyCell(s)&&this.insertCell(l,i.range.end.line+1)}let a=await this.getActiveInteractiveWindow();await this.addCode(a,s,this.document.uri,i.range.start.line,n)}}getCellIndex(e){return this.cells.findIndex(t=>e&&t.range.contains(e))}getCellFromIndex(e){let t=this.cells,n=W_e(e,t.length);return t[n]}getCellFromPosition(e){if(!e){let t=ke.window.activeTextEditor;t&&t.selection&&(e=t.selection.active)}if(e){let t=this.getCellIndex(e);if(t>=0)return this.cells[t]}}getCurrentCellLens(e){return this.codeLenses.find(t=>t.range.contains(e)&&t.command!==void 0&&t.command.command===le.RunCell)}getNextCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===le.RunCell);if(t>=0)return this.codeLenses.find((n,i)=>n.command!==void 0&&n.command.command===le.RunCell&&i>t)}getPreviousCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===le.RunCell);if(t>=1)return this.codeLenses.find((n,i)=>n.command!==void 0&&i<t&&i+1===t)}async runFileAsOneCell(e){if(this.document){let t=await this.getActiveInteractiveWindow(),n=this.document.getText();await this.addCode(t,n,this.document.uri,0,e)}}advanceToRange(e){let t=ke.window.activeTextEditor,n=new ke.Selection(e.start,e.start);t&&(t.selection=n,t.revealRange(e,ke.TextEditorRevealType.Default))}};U([Tn("DATASCIENCE.DEBUG_CURRENT_CELL")],tr.prototype,"debugCurrentCell",1),U([Tn("DATASCIENCE.RUN_ALL_CELLS")],tr.prototype,"runAllCells",1),U([Tn("DATASCIENCE.RUN_FILE_INTERACTIVE")],tr.prototype,"runFileInteractive",1),U([Tn("DATASCIENCE.DEBUG_FILE_INTERACTIVE")],tr.prototype,"debugFileInteractive",1),U([Tn("DATASCIENCE.RUN_ALL_CELLS_ABOVE")],tr.prototype,"runAllCellsAbove",1),U([Tn("DATASCIENCE.RUN_CELL_AND_ALL_BELOW")],tr.prototype,"runCellAndAllBelow",1),U([Tn("DATASCIENCE.RUN_SELECTION_OR_LINE")],tr.prototype,"runSelectionOrLine",1),U([Tn("DATASCIENCE.RUN_TO_LINE")],tr.prototype,"runToLine",1),U([Tn("DATASCIENCE.RUN_FROM_LINE")],tr.prototype,"runFromLine",1),U([G7("CodeWatcher::runCell",4)],tr.prototype,"runCell",1),U([Tn("DATASCIENCE.DEBUG_CURRENT_CELL")],tr.prototype,"debugCell",1),U([Tn("DATASCIENCE.RUN_CURRENT_CELL")],tr.prototype,"runCurrentCell",1),U([Tn("DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE")],tr.prototype,"runCurrentCellAndAdvance",1),U([Nr("DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW")],tr.prototype,"runCurrentCellAndAddBelow",1),U([Nr("DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION")],tr.prototype,"insertCellBelowPosition",1),U([Nr("DATASCIENCE.RUN_INSERT_CELL_BELOW")],tr.prototype,"insertCellBelow",1),U([Nr("DATASCIENCE.RUN_INSERT_CELL_ABOVE")],tr.prototype,"insertCellAbove",1),U([Nr("DATASCIENCE.RUN_DELETE_CELLS")],tr.prototype,"deleteCells",1),U([Nr("DATASCIENCE.RUN_SELECT_CELL")],tr.prototype,"selectCell",1),U([Nr("DATASCIENCE.RUN_SELECT_CELL_CONTENTS")],tr.prototype,"selectCellContents",1),U([Nr("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE")],tr.prototype,"extendSelectionByCellAbove",1),U([Nr("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW")],tr.prototype,"extendSelectionByCellBelow",1),U([Nr("DATASCIENCE.RUN_MOVE_CELLS_UP")],tr.prototype,"moveCellsUp",1),U([Nr("DATASCIENCE.RUN_MOVE_CELLS_DOWN")],tr.prototype,"moveCellsDown",1),U([Nr("DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN")],tr.prototype,"changeCellToMarkdown",1),U([Nr("DATASCIENCE.RUN_CHANGE_CELL_TO_CODE")],tr.prototype,"changeCellToCode",1),U([Nr("DATASCIENCE.GOTO_NEXT_CELL_IN_FILE")],tr.prototype,"gotoNextCell",1),U([Nr("DATASCIENCE.GOTO_PREV_CELL_IN_FILE")],tr.prototype,"gotoPreviousCell",1),tr=U([(0,op.injectable)(),x(0,(0,op.inject)(ao)),x(1,(0,op.inject)(Ke)),x(2,(0,op.inject)(cO)),x(3,(0,op.inject)(pn)),x(4,(0,op.inject)(tO)),x(5,(0,op.inject)(Eu))],tr);p();var Cv=oe(he()),Ei=oe(require("vscode"));var Pm=require("vscode");var A_=class{constructor(e,t,n,i){this.configuration=t;this.extensionChecker=n;this.cellRangeCache=i;this.computeDecorations(),e.push(this),e.push(this.configuration.getSettings(void 0).onDidChange(this.settingsChanged,this)),e.push(Ei.window.onDidChangeActiveTextEditor(this.changedEditor,this)),e.push(Ei.window.onDidChangeTextEditorSelection(this.changedSelection,this)),e.push(Ei.workspace.onDidChangeTextDocument(this.changedDocument,this)),this.settingsChanged()}activate(){}dispose(){this.timer&&clearTimeout(this.timer)}settingsChanged(){Ei.window.activeTextEditor&&this.triggerUpdate(Ei.window.activeTextEditor)}changedEditor(){this.triggerUpdate(void 0)}changedDocument(e){Ei.window.activeTextEditor&&e.document===Ei.window.activeTextEditor.document&&this.triggerUpdate(Pm.window.activeTextEditor)}changedSelection(e){e.textEditor&&e.textEditor.selection.anchor&&this.triggerUpdate(e.textEditor)}triggerUpdate(e){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>this.update(e),100)}computeDecorations(){this.currentCellTopUnfocused=Pm.window.createTextEditorDecorationType({borderColor:new Ei.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottomUnfocused=Pm.window.createTextEditorDecorationType({borderColor:new Ei.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellTop=Pm.window.createTextEditorDecorationType({borderColor:new Ei.ThemeColor("interactive.activeCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottom=Pm.window.createTextEditorDecorationType({borderColor:new Ei.ThemeColor("interactive.activeCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0})}cellDecorationEnabled(e){return e.decorateCells===!1?!1:e.decorateCells==="currentCell"||e.decorateCells==="allCells"}update(e){let t=e===void 0?Pm.window.visibleTextEditors:[e];for(let n of t)if(n&&n.document&&n.document.languageId===Ye&&!cI(n.document)&&this.currentCellTop&&this.currentCellBottom&&this.currentCellTopUnfocused&&this.currentCellBottomUnfocused&&this.extensionChecker.isPythonExtensionInstalled){let i=this.configuration.getSettings(n.document.uri);if(this.cellDecorationEnabled(i)){let o=this.cellRangeCache.getCellRanges(n.document),s=o.map(c=>c.range).filter(c=>c.contains(n.selection.anchor)),a=s.length>0?[new Ei.Range(s[0].start,s[0].start)]:[],l=i.decorateCells!=="allCells"&&s.length>0?[new Ei.Range(s[0].end,s[0].end)]:[],u=[];i.decorateCells==="allCells"&&o.forEach(c=>{let d=c.range.start;d!==s[0].start&&u.push(new Ei.Range(d,d))}),Pm.window.activeTextEditor===n?(n.setDecorations(this.currentCellTop,a),n.setDecorations(this.currentCellBottom,l),n.setDecorations(this.currentCellTopUnfocused,u),n.setDecorations(this.currentCellBottomUnfocused,[])):(n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[...u,...a]),n.setDecorations(this.currentCellBottomUnfocused,l))}else n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[]),n.setDecorations(this.currentCellBottomUnfocused,[])}}};A_=U([(0,Cv.injectable)(),x(0,(0,Cv.inject)(ve)),x(1,(0,Cv.inject)(Ke)),x(2,(0,Cv.inject)(vo)),x(3,(0,Cv.inject)(wm))],A_);p();var lo=oe(he()),Zt=require("vscode");p();var ht=require("vscode");var Jee=oe(Zg());var sp=class{constructor(e,t,n,i,o){this.serviceContainer=e;this._owner=t;this.controllerFactory=n;this.inputUri=o;this._onDidChangeViewState=new ht.EventEmitter;this.closedEvent=new ht.EventEmitter;this._submitters=[];this.internalDisposables=[];var s;this.fs=this.serviceContainer.get(Pt),this.configuration=this.serviceContainer.get(Ke),this.jupyterExporter=this.serviceContainer.get(MI),this.interactiveWindowDebugger=this.serviceContainer.tryGet(Fee),this.errorHandler=this.serviceContainer.get(pn),this.codeGeneratorFactory=this.serviceContainer.get(k_),this.storageFactory=this.serviceContainer.get(Na),this.kernelProvider=this.serviceContainer.get(qe),this.debuggingManager=this.serviceContainer.get(nO),this.notebookUri=i instanceof ht.TabInputInteractiveWindow||i instanceof ht.TabInputNotebook?i.uri:i.notebook.uri,this._owner&&this._submitters.push(this._owner),ht.window.onDidChangeActiveNotebookEditor(a=>{(a==null?void 0:a.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire()},this.internalDisposables),ht.workspace.onDidCloseNotebookDocument(a=>{a.uri.toString()===this.notebookUri.toString()&&this.closedEvent.fire()},this.internalDisposables),((s=ht.window.activeNotebookEditor)==null?void 0:s.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire(),this.cellMatcher=new hs(this.configuration.getSettings(this.owningResource)),this.notebookDocument&&this.codeGeneratorFactory.getOrCreate(this.notebookDocument)}get onDidChangeViewState(){return this._onDidChangeViewState.event}get closed(){return this.closedEvent.event}get owner(){return this._owner}get submitters(){return this._submitters}get notebookDocument(){return this._notebookDocument||(this._notebookDocument=ht.workspace.notebookDocuments.find(e=>e.uri.toString()===this.notebookUri.toString())),this._notebookDocument}get kernelConnectionMetadata(){var e;return(e=this.controller)==null?void 0:e.metadata}async notifyConnectionReset(){if(this.notebookDocument)this.controller||(this.controller=this.initController()),this.controller.setInfoMessageCell(W.noKernelConnected);else{let e=ht.workspace.onDidOpenNotebookDocument(async t=>{t.uri.toString()===this.notebookUri.toString()&&(this._notebookDocument=t,this.controller=this.initController(),this.internalDisposables.push(this.controller.listenForControllerSelection()),this.controller.setInfoMessageCell(W.noKernelConnected),e.dispose())})}}initController(){let e=this.controllerFactory.create(this,this.errorHandler,this.kernelProvider,this._owner);return this.internalDisposables.push(e.listenForControllerSelection()),e}async ensureInitialized(){if(!this.notebookDocument&&(C.debug("Showing Interactive editor to initialize codeGenerator from notebook document"),await this.showInteractiveEditor(),!this.notebookDocument))throw new Error("Could not open notebook document for Interactive Window");this.codeGeneratorFactory.get(this.notebookDocument)||this.codeGeneratorFactory.getOrCreate(this.notebookDocument),this.controller||(this.controller=this.initController()),this.controller.controller?(this.controller.startKernel().catch(E),await this.controller.resolveSysInfoCell()):(C.info("No controller selected for Interactive Window initialization"),this.controller.setInfoMessageCell(W.selectKernelForEditor))}async showInteractiveEditor(){let e;ht.window.tabGroups.all.find(i=>{i.tabs.find(o=>{(o.input instanceof ht.TabInputNotebook||o.input instanceof ht.TabInputInteractiveWindow)&&o.input.uri.toString()==this.notebookUri.toString()&&(e=o.group.viewColumn)})});let t=this.notebookDocument||await this.openNotebookDocument();return await ht.window.showNotebookDocument(t,{preserveFocus:!0,viewColumn:e,asRepl:!0})}async openNotebookDocument(){return C.debug(`Opening notebook document ${this.notebookUri}`),await ht.workspace.openNotebookDocument(this.notebookUri)}dispose(){var e;this.internalDisposables.forEach(t=>t.dispose()),(e=this.controller)==null||e.disconnect()}async showErrorForCell(e,t){var o,s,a;let n=(o=this.controller)==null?void 0:o.controller,i=Iy(e);if(n&&i&&t){let l=no.getOrCreate(t,new mv(n));try{await l.appendOutput(i)}catch(u){C.warn(`Could not append error message "${i}" to cell: ${u}`)}finally{l.end(!1,(a=(s=t.executionSummary)==null?void 0:s.timing)==null?void 0:a.endTime)}}else C.info(`Could not append error message to cell "${i}"`)}changeMode(e){var t;(t=this.controller)==null||t.updateMode(e)}async addCode(e,t,n){return this.submitCode(e,t,n,!1)}useNewDebugMode(){var t;return!!(this.configuration.getSettings(this.owner).forceIPyKernelDebugger||(t=this.controller)!=null&&t.metadata&&!Qt(this.controller.metadata))}async debugCode(e,t,n){let i=!0,o=ht.workspace.textDocuments.find(a=>this.fs.arePathsSame(a.uri,t));if(!this.useNewDebugMode()&&o&&o.isUntitled){let a=[...ht.workspace.textDocuments];if(i=await o.save(),i){let l=ht.workspace.textDocuments.filter(u=>a.indexOf(u)===-1);l&&l.length>0&&(t=(l.find(c=>c.languageId==="python")||l.find(c=>!c.fileName.endsWith(".interactive"))||l[0]).uri,await ht.workspace.openTextDocument(t))}}let s=!0;return i?this.submitCode(e,t,n,!0):s}async submitCode(e,t,n,i){var c;if(this.cellMatcher.isEmptyCell(e)||!((c=this.controller)!=null&&c.controller))return!0;this.updateOwners(t);let o=lt(e,{trim:!1}),s=new hs(this.configuration.getSettings(t)),a=-1;s.isMarkdown(o[0])&&Og(o,(d,f)=>void 0,(d,f)=>{d&&d.length>0&&a===-1&&(a=f)});let u=(a>0?[o.slice(0,a).join(`
`),o.slice(a).join(`
`)]:[e]).map(d=>{let f=Re();this.controller.setPendingCellAdd(f.promise);let m=this.addNotebookCell(d,t,n),g=this.createExecutionPromise(m,i);return g.catch(b=>{b instanceof Ev?m.then(v=>{b.cell!==v&&this.showErrorForCell(W.cellStopOnErrorMessage,v).then(E,E)}).catch(E):m.then(v=>this.errorHandler.getErrorMessageForDisplayInCellOutput(b,"execution",this.owningResource).then(k=>this.showErrorForCell(k,v))).catch(E)}).finally(()=>{f==null||f.resolve()}),g});return u[u.length-1]}async createExecutionPromise(e,t){var a,l;if(!this.controller||!this.notebookDocument)return!1;C.ci("InteractiveWindow.ts.createExecutionPromise.start");let n=this.controller.startKernel(),i=await e,o=!0,s=async()=>void 0;try{let u=await n;await this.generateCodeAndAddMetadata(i,t,u),t&&this.useNewDebugMode()?await this.debuggingManager.start(this.notebookDocument,i):t&&Qt(u.kernelConnectionMetadata)&&this.interactiveWindowDebugger&&(s=async()=>{var f;return(f=this.interactiveWindowDebugger)==null?void 0:f.detach(u)},await this.interactiveWindowDebugger.attach(u),await this.interactiveWindowDebugger.updateSourceMaps(((a=this.storageFactory.get({notebook:i.notebook}))==null?void 0:a.all)||[]),this.interactiveWindowDebugger.enable(u)),C.ci("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell");let c=Gl(i);o=await this.kernelProvider.getKernelExecution(u).executeCell(i,(l=c==null?void 0:c.generatedCode)==null?void 0:l.code).then(()=>!0,()=>!1),C.ci("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell.finished")}finally{await s(),C.ci("InteractiveWindow.ts.createExecutionPromise.end")}if(!o)throw new Ev(i);return o}async expandAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{await ht.commands.executeCommand("notebook.cell.expandCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async collapseAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{e.kind===ht.NotebookCellKind.Code&&await ht.commands.executeCommand("notebook.cell.collapseCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async scrollToCell(e){let t=await this.showInteractiveEditor(),n=t.notebook.getCells().find(i=>{var o;return((o=Gl(i))==null?void 0:o.id)===e});if(n){let i=new ht.NotebookRange(n.index,n.index+1);t.revealRange(i,ht.NotebookEditorRevealType.Default),t.selection=i}}async hasCell(e){let t=this.notebookDocument;return!!t&&t.getCells().some(n=>{var i;return((i=Gl(n))==null?void 0:i.id)===e})}get owningResource(){if(this.owner)return this.owner;let e=lI();if(e)return e}updateOwners(e){var t;this._owner||(this._owner=e,(t=this.controller)==null||t.updateOwners(e)),this._submitters.find(n=>n.toString()==e.toString())||this._submitters.push(e)}async addNotebookCell(e,t,n){var g,b;let i=this.notebookDocument;if(!i)throw new Error("No notebook document");let o=this.configuration.getSettings(this.owningResource),s=this.cellMatcher.getCellType(e)===jE,a=s?QN(lt(e)).join(""):Hee(e,o,this.cellMatcher),l=this.cellMatcher.getFirstMarker(e),u=(b=(g=ht.workspace.textDocuments.find(v=>{var k;return v.uri.toString()===((k=this.owner)==null?void 0:k.toString())}))==null?void 0:g.languageId)!=null?b:Ye,c=new ht.NotebookCellData(s?ht.NotebookCellKind.Markup:ht.NotebookCellKind.Code,a,s?jE:u),d={uristring:t.toString(),lineIndex:n,originalSource:e},f={interactiveWindowCellMarker:l,interactive:d,id:(0,Jee.default)()};c.metadata=f;let m;return await _u(i,async v=>{m=await this.getAppendIndex();let k=ht.NotebookEdit.insertCells(m,[c]);v.set(i.uri,[k])}),i.cellAt(m)}async getAppendIndex(){if(!this.notebookDocument)throw new Error("No notebook document");return this.notebookDocument.cellCount}async generateCodeAndAddMetadata(e,t,n){let i=Gl(e);if(!i)return;let o=!Qt(n.kernelConnectionMetadata)||this.configuration.getSettings(void 0).forceIPyKernelDebugger,s=await this.codeGeneratorFactory.getOrCreate(this.notebookDocument).generateCode(i,e.index,t,o),a={...i,generatedCode:s},l=new ht.WorkspaceEdit,u=ht.NotebookEdit.updateCellMetadata(e.index,a);l.set(e.notebook.uri,[u]),await ht.workspace.applyEdit(l)}async export(){var n;if(!this.notebookDocument)throw new Error("no notebook to export.");let e=Bee(this.notebookDocument),t=await new rp().showDialog("ipynb",this.owningResource);t&&await((n=this.jupyterExporter)==null?void 0:n.exportToFile(e,ct(t)))}async exportAs(){var n;if(await this.ensureInitialized(),!this.controller)throw new Error("An active kernel is required to export the notebook.");let e=(n=this.controller.kernel)==null?void 0:n.value,t;if(this.submitters&&this.submitters.length){let i=this.submitters[this.submitters.length-1];t=Ht(i.path,Ep(i.path))}zr()?ht.commands.executeCommand(le.ExportAsPythonScript,this.notebookDocument,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(E,E):ht.commands.executeCommand(le.Export,this.notebookDocument,t,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(E,E)}};U([gL()],sp.prototype,"showErrorForCell",1),U([gL()],sp.prototype,"createExecutionPromise",1);p();function Gee(r){return W.interactiveWindowTitleFormat(Ht(r.path))}p();var L9=class{constructor(e,t,n,i,o,s,a){this.controllerService=e;this.mode=t;this.interactiveWindow=n;this.errorHandler=i;this.kernelProvider=o;this.owner=s;this.disposables=[];this.controller=a==null?void 0:a.controller,this.metadata=a==null?void 0:a.connection}updateMode(e){this.mode=e}updateOwners(e){this.owner=e}async startKernel(){var e;if((e=this.connectingListener)==null||e.dispose(),this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Interactive Window kernel not selected");this.setInfoMessage(this.metadata,0);try{let t=await this.createKernel(),n=async()=>{this.interactiveWindow.notebookDocument&&this.metadata&&(this.systemInfoCell=void 0,this.setInfoMessage(this.metadata,1))};return this.disposables.push(t.addHook("willRestart",n)),t.onRestarted(async()=>{C.debug("Restart event handled in IW"),this.fileInKernel=void 0;try{await this.setFileInKernel(t)}catch(i){C.error("Failed to run initialization after restarting")}finally{this.finishSysInfoMessage(t,1)}},this,this.disposables),this.fileInKernel=void 0,await this.setFileInKernel(t),this.finishSysInfoMessage(t,0),t}catch(t){throw this.owner?this.deleteSysInfoCell():await this.finishSysInfoWithFailureMessage(t),t}}async createKernel(){if(this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Controller not selected");let e=Re();e.promise.catch(E),this.kernel=e;try{let{kernel:t,actualController:n}=await this.controllerService.createKernel(this.metadata,this.controller,this.owner,this.interactiveWindow.notebookDocument,this.disposables);return this.metadata=t.kernelConnectionMetadata,this.controller=n,this.disposables.push(t),e.resolve(t),t}catch(t){throw e.reject(t),this.disconnect(),t}}async setFileInKernel(e){let t=this.owner;if(!t){C.ci("Unable to run initialization for IW");return}let n=ct(t),i=this.kernelProvider.getKernelExecution(e);this.mode==="perFile"&&!this.fileInKernel?(C.debug(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):(!this.fileInKernel||this.fileInKernel.toString()!==t.toString())&&this.mode!=="perFile"?(C.debug(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):C.debug(`Not Initializing __file__ in setFileInKernel with ${n} for mode ${this.mode} currently ${this.fileInKernel}`)}setPendingCellAdd(e){if(this.metadata&&this.interactiveWindow.notebookDocument){let t=this.controllerService.getRegisteredController(this.metadata);t==null||t.setPendingCellAddition(this.interactiveWindow.notebookDocument,e)}}listenForControllerSelection(){return this.controllerService.onControllerSelected(e=>{var t,n,i,o;if(!(!this.interactiveWindow.notebookDocument||e.notebook.uri.toString()!==((n=(t=this.interactiveWindow.notebookDocument)==null?void 0:t.uri)==null?void 0:n.toString()))&&e.controller.id!==((i=this.controller)==null?void 0:i.id)){let s=!!this.kernel;this.disconnect(),this.controller=e.controller.controller,this.metadata=e.controller.connection,s?this.startKernel().catch(E):((o=this.connectingListener)==null||o.dispose(),this.connectingListener=e.controller.onConnecting(()=>{this.startKernel().catch(E)}),this.disposables.push(this.connectingListener))}},this)}setInfoMessageCell(e){if(!this.interactiveWindow.notebookDocument){C.warn("Could not set info cell: no notebook document");return}this.systemInfoCell?this.systemInfoCell.updateMessage(e).catch(t=>C.warn(`could not update info cell with message: "${e}", error: ${t}`)):this.systemInfoCell=new sO(this.interactiveWindow,this.interactiveWindow.notebookDocument,e)}async resolveSysInfoCell(){var e;await((e=this.systemInfoCell)==null?void 0:e.resolveCell())}setInfoMessage(e,t){let n=Uee(e,t);this.setInfoMessageCell(n)}finishSysInfoMessage(e,t){var i;let n=Wee(e.kernelConnectionMetadata,t);(i=this.systemInfoCell)==null||i.updateMessage(n).catch(o=>C.warn(`System info message was not updated: "${n}" because of error: ${o}`)),this.systemInfoCell=void 0}async finishSysInfoWithFailureMessage(e){var n;let t=await this.errorHandler.getErrorMessageForDisplayInCell(e,"start",this.owner);t=t.split(`
`).join(`  
`),(n=this.systemInfoCell)==null||n.updateMessage(t).catch(i=>C.warn(`System info message was not updated: "${t}" because of error: ${i}`)),this.systemInfoCell=void 0}deleteSysInfoCell(){var e;(e=this.systemInfoCell)==null||e.deleteCell().then(E,E),this.systemInfoCell=void 0}disconnect(){this.disposables.forEach(e=>e.dispose()),this.disposables=[],this.kernel=void 0}},wv=class{constructor(e,t,n){this.controllerService=e;this.mode=t;this.initialController=n}create(e,t,n,i){if(!e.notebookDocument)throw Error("could not create controller: no notebook document");let o=this.initialController,s=this.controllerService.getSelectedController(e.notebookDocument);return s&&(o=s),new L9(this.controllerService,this.mode,e,t,n,i,o)}};p();var qP=class extends sp{async getAppendIndex(){var t,n;if((t=this.editor)!=null&&t.replOptions||(this.editor=await this.showInteractiveEditor()),!((n=this.editor)!=null&&n.replOptions))throw new Error("Interactive editor not found");return this.editor.replOptions.appendIndex}};var Yee="ds_asked_per_file_interactive",$ee="ds_interactive_window_cache",M_=class{constructor(e){this.serviceContainer=e}isForReplEditor(e){return this.interactiveWindowProvider||(this.interactiveWindowProvider=this.serviceContainer.get(ao)),this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e.uri)!==void 0}};M_=U([(0,lo.injectable)(),x(0,(0,lo.inject)(Ar))],M_);var O_=class{constructor(e,t,n,i,o,s,a,l){this.serviceContainer=e;this.disposables=t;this.fs=n;this.configService=i;this.globalMemento=o;this.workspaceMemento=s;this.notebookEditorProvider=a;this.controllerHelper=l;this._onDidChangeActiveInteractiveWindow=new Zt.EventEmitter;this._windows=[];this.notebookEditorProvider.registerEmbedNotebookProvider(this),this.restoreWindows()}get onDidChangeActiveInteractiveWindow(){return this._onDidChangeActiveInteractiveWindow.event}get activeWindow(){var t;let e=(t=Zt.window.activeNotebookEditor)==null?void 0:t.notebook.uri.toString();return e?this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e}):void 0}restoreWindows(){let e=new Map;Zt.window.tabGroups.all.forEach(t=>{t.tabs.forEach(n=>{let i=n.input;(i instanceof Zt.TabInputInteractiveWindow||i instanceof Zt.TabInputNotebook)&&e.set(i.uri.toString(),i)})}),this.workspaceMemento.get($ee,[]).forEach(t=>{if(!t.uriString||!e.get(t.uriString))return;let n=e.get(t.uriString);if(!n)return;let i=this.configService.getSettings(n.uri).interactiveWindowMode,o=n instanceof Zt.TabInputInteractiveWindow?new sp(this.serviceContainer,Zt.Uri.parse(t.owner),new wv(this.controllerHelper,i),n,Zt.Uri.parse(t.inputBoxUriString)):new qP(this.serviceContainer,Zt.Uri.parse(t.owner),new wv(this.controllerHelper,i),n,Zt.Uri.parse(t.inputBoxUriString));o.notifyConnectionReset().catch(E),this._windows.push(o),ne("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!1,hasOwner:!!t.owner,mode:i,restored:!0});let s=o.closed(this.onInteractiveWindowClosed.bind(this,o));this.disposables.push(o),this.disposables.push(s),this.disposables.push(o.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this)))}),this._updateWindowCache()}async getOrCreate(e,t){if(!Zt.workspace.isTrusted)throw new Error("Workspace not trusted");let n=await this.getInteractiveMode(e);this.pendingCreations&&await this.pendingCreations.catch(E);let i=this.getExisting(e,n,t);return i||(i=await this.create(e,n,t)),await i.ensureInitialized(),i}get(e){let t=this.configService.getSettings(e).interactiveWindowMode;return this.getExisting(e,t)}async create(e,t,n){let i=Re();this.pendingCreations=i.promise;try{let o=this.configService.getSettings(e).interactiveReplNotebook,s=o?St:vr,a=await this.controllerHelper.getInitialController(e,s,n);C.info(`Starting interactive window for resource '${Ee(e)}' with controller '${a==null?void 0:a.id}'`);let[l,u]=await this.createEditor(a,e,t,o);a&&a.controller.updateNotebookAffinity(u.notebook,Zt.NotebookControllerAffinity.Preferred),C.debug(`Interactive Window Editor Created: ${u.notebook.uri.toString()} with input box: ${l.toString()}`);let c=o?new qP(this.serviceContainer,e,new wv(this.controllerHelper,t,a),u,l):new sp(this.serviceContainer,e,new wv(this.controllerHelper,t,a),u,l);this._windows.push(c),ne("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!!a,hasOwner:!!e,mode:t,restored:!1}),this._updateWindowCache(),this.lastActiveInteractiveWindow=c;let d=c.closed(this.onInteractiveWindowClosed.bind(this,c));return this.disposables.push(c),this.disposables.push(d),this.disposables.push(c.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this))),c}finally{i.resolve()}}async createEditor(e,t,n,i){let o=t&&n==="perFile"?Gee(t):void 0,s=t!==void 0,a=this.getInteractiveViewColumn(t);if(i)return this.createNotebookBackedEditor(a,s,e==null?void 0:e.controller,o);let{inputUri:l,notebookEditor:u}=await Zt.commands.executeCommand("interactive.open",{viewColumn:a,preserveFocus:s},void 0,e?`${Je}/${e.id}`:void 0,o);if(!u)throw new Error("Failed to request creation of interactive window from VS Code.");return[l,u]}async createNotebookBackedEditor(e,t,n,i){i=i||"Interactive-1";let o=await Zt.workspace.openNotebookDocument(St),s=await Zt.window.showNotebookDocument(o,{preserveFocus:n?!1:t,viewColumn:e,asRepl:i});if(!s.replOptions)throw new Error("Wrong type of editor created");return n&&await Zt.commands.executeCommand("notebook.selectKernel",{editor:s,id:n.id,extension:Je}),[o.cellAt(s.replOptions.appendIndex).document.uri,s]}getInteractiveViewColumn(e){if(e)return Zt.ViewColumn.Beside;let t=this.configService.getSettings(e).interactiveWindowViewColumn;return t==="secondGroup"?Zt.ViewColumn.One:t==="active"?Zt.ViewColumn.Active:Zt.ViewColumn.Beside}async getInteractiveMode(e){let t=this.configService.getSettings(e).interactiveWindowMode;if(t==="multiple"&&e&&!this.globalMemento.get(Yee)&&this._windows.length===1&&(!this._windows[0].owner||!this.fs.arePathsSame(this._windows[0].owner,e))){this.globalMemento.update(Yee,!0).then(E,E);let n=[W.interactiveWindowModeBannerSwitchYes,W.interactiveWindowModeBannerSwitchNo];await Zt.window.showInformationMessage(W.interactiveWindowModeBannerTitle,...n)===n[0]&&(t="perFile",this._windows[0].changeMode(t),await this.configService.updateSetting("interactiveWindow.creationMode",t,e,Zt.ConfigurationTarget.Global))}return t}_updateWindowCache(){let e=this._windows.map(t=>{var n;return{owner:(n=t.owner)==null?void 0:n.toString(),uriString:t.notebookUri.toString(),inputBoxUriString:t.inputUri.toString()}});this.workspaceMemento.update($ee,e).then(E,E)}getExisting(e,t,n){return t==="single"?this._windows.length>0?this._windows[0]:void 0:t==="multiple"?e?this.activeWindow||this.lastActiveInteractiveWindow||this._windows[0]:void 0:this._windows.find(i=>{var o;return!e&&!i.owner&&!n?!0:e&&i.owner&&this.fs.arePathsSame(e,i.owner)?!n||((o=i.kernelConnectionMetadata)==null?void 0:o.id)===n.id:!1})}raiseOnDidChangeActiveInteractiveWindow(){this.lastActiveInteractiveWindow=this.activeWindow?this.activeWindow:this.lastActiveInteractiveWindow,this._onDidChangeActiveInteractiveWindow.fire(this.activeWindow)}onInteractiveWindowClosed(e){var t;C.debug(`Closing interactive window: ${(t=e.notebookUri)==null?void 0:t.toString()}`),e.dispose(),this._windows=this._windows.filter(n=>n!==e),this._updateWindowCache(),this.lastActiveInteractiveWindow===e&&(this.lastActiveInteractiveWindow=this._windows[0]),this.raiseOnDidChangeActiveInteractiveWindow()}getActiveOrAssociatedInteractiveWindow(){if(this.activeWindow)return this.activeWindow;if(Zt.window.activeTextEditor===void 0)return;let e=Zt.window.activeTextEditor.document.uri;if(e.scheme!==ec)return this.get(e)}findNotebookEditor(e){var n,i;let t;if(e&&e.path.endsWith(".interactive"))t=(n=this.get(e))==null?void 0:n.notebookDocument;else{let o=this.configService.getSettings(e).interactiveWindowMode;t=(i=this.getExisting(e,o))==null?void 0:i.notebookDocument}return t?Zt.window.visibleNotebookEditors.find(o=>o.notebook===t):void 0}findAssociatedNotebookDocument(e){let t=this._windows.find(i=>{var o;return((o=i.inputUri)==null?void 0:o.toString())===e.toString()});return t==null?void 0:t.notebookDocument}getInteractiveWindowWithNotebook(e){let t;return e!==void 0?t=this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e.toString()}):t=this.getActiveOrAssociatedInteractiveWindow(),t}getInteractiveWindowsWithSubmitter(e){return this._windows.filter(t=>t.submitters.find(n=>this.fs.arePathsSame(e,n)))}};O_=U([(0,lo.injectable)(),x(0,(0,lo.inject)(Ar)),x(1,(0,lo.inject)(ve)),x(2,(0,lo.inject)(Pt)),x(3,(0,lo.inject)(Ke)),x(4,(0,lo.inject)(Et)),x(4,(0,lo.named)(rr)),x(5,(0,lo.inject)(Et)),x(5,(0,lo.named)(_s)),x(6,(0,lo.inject)(Ao)),x(7,(0,lo.inject)(rO))],O_);p();var K_=oe(he());p();var wu=require("vscode");var uO=class{constructor(e,t,n,i){this.configService=e;this.storage=t;this.notebook=n;this.executionCount=0;this.cellIndexesCounted={};this.disposables=[];i.push(this),wu.workspace.onDidChangeTextDocument(this.onChangedDocument,this,this.disposables),Mr.onDidChangeNotebookCellExecutionState(this.onDidCellStateChange,this,this.disposables)}dispose(){this.disposed||(this.disposed=!0,this.storage.clear(),this.disposables.forEach(e=>e.dispose()))}reset(){this.storage.clear(),this.executionCount=0}async generateCode(e,t,n,i){let{executableLines:o}=this.extractExecutableLines(e);if(this.executionCount+=1,this.cellIndexesCounted[t]=!0,o.length>0&&o.find(s=>s.trim().length>0))return this.generateCodeImpl(e,this.executionCount,n,i)}extractExecutableLines(e){let t=e.interactive.originalSource,n=this.configService.getSettings(this.notebook.uri),i=new hs(n),o=uI(t);if(n.magicCommandsAsComments&&o.forEach((s,a)=>o[a]=aO(s)),e.interactiveWindowCellMarker&&o.length&&o[0].trim()===e.interactiveWindowCellMarker.trim()){let s=o.slice(1).filter(a=>a.trim().length>0);if(s.length>0&&s[0].trim().startsWith("%%")){let a=o.slice(o.indexOf(s[0]));return{lines:a,executableLines:a}}}return o.length>0&&(i.isCode(o[0])||i.isMarkdown(o[0]))?{lines:o,executableLines:o.slice(1)}:{lines:o,executableLines:o}}onDidCellStateChange(e){var t;e.state===1&&(e.state!==1||e.cell.notebook!==this.notebook||!((t=e.cell.executionSummary)!=null&&t.executionOrder)||this.cellIndexesCounted[e.cell.index]||(this.executionCount+=1,this.cellIndexesCounted[e.cell.index]=!0))}async generateCodeImpl(e,t,n,i){let{lineIndex:o,uristring:s}=e.interactive,a=wu.workspace.textDocuments.find(O=>O.uri.toString()===s);if(!a)return;let{stripped:l,trueStartLine:u}=this.extractStrippedLines(e),c=a.lineAt(u),d=a.lineAt(Math.min(u+l.length-1,a.lineCount-1)),f=0;for(;f<l.length&&l[f].trim().length===0;)f+=1;let m=f+u,g=a.offsetAt(new wu.Position(o,0)),b=a.offsetAt(d.rangeIncludingLineBreak.end),v=(e.interactiveWindowCellMarker||"").length>0,{runtimeLine:k,debuggerStartLine:R}=this.addHiddenLines(n,l,u,m,v,i),P=l.join(""),D=a.getText(new wu.Range(new wu.Position(o,0),d.rangeIncludingLineBreak.end)),K=(await Ba(P,"SHA-1")).substring(0,12),L=this.getRuntimeFile(K,t),B=n?-1:0,N={line:c?c.lineNumber+1:1,endLine:d?d.lineNumber+1:1,firstNonBlankLineIndex:m,debuggerStartLine:R,executionCount:t,startOffset:g,endOffset:b,deleted:!1,code:P,trimmedRightCode:l.map(O=>O.replace(/[ \t\r]+\n$/g,`
`)).join(""),realCode:D,runtimeLine:k,runtimeFile:L,id:e.id,timestamp:Date.now(),lineOffsetRelativeToIndexOfFirstLineInCell:B,hasCellMarker:v};return C.info(`Generated code for ${t} = ${L} with ${l.length} lines`),this.storage.store(wu.Uri.parse(e.interactive.uristring),N),N}getRuntimeFile(e,t){return`<ipython-input-${t}-${e}>`}onChangedDocument(e){let t=this.storage.getFileGeneratedCode(e.document.uri);if(t){let n=e.document.getText();e.contentChanges.forEach(i=>{this.handleContentChange(n,i,t)})}}extractStrippedLines(e){let t=uI(e.interactive.originalSource),{lines:n}=this.extractExecutableLines(e),i=e.interactive.lineIndex+1;if(!e.interactiveWindowCellMarker){i=e.interactive.lineIndex;for(let l=0;l<n.length;l+=1)if(n[l]!==t[l]){i+=l+1;break}}let o=0;for(;o<n.length&&n[o].trim().length===0;)o+=1;let s=n.length-1,a=n.length-2;for(;a>0;){let l=n[s],u=n[a];if((l.length===0||l===`
`)&&(u.length===0||u===`
`))n.splice(s,1),s-=1,a-=1;else break}!n[s].endsWith(`
`)&&n[s].length>0&&(n[s]=`${n[s]}
`);for(let l=0;l<n.length;l++)n[l]=n[l].replace(/\r\n/g,`
`);return{stripped:n,trueStartLine:i}}handleContentChange(e,t,n){let i=t.range.start.line-t.range.end.line+t.text.split(`
`).length-1,o=t.text.length-t.rangeLength,s=t.rangeLength<=0?t.rangeOffset:t.rangeOffset+t.rangeLength-1;n.forEach(a=>{a.endOffset<t.rangeOffset||(a.startOffset>s?(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.startOffset===s?a.deleted||t.rangeLength>0||i===0?a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode:(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode)})}addHiddenLines(e,t,n,i,o,s){let a=s||this.configService.getSettings(void 0).forceIPyKernelDebugger===!0;return e&&this.configService.getSettings(this.notebook.uri).stopOnFirstLineWhileDebugging?a?(t.splice(0,0,`breakpoint()
`),{runtimeLine:1,debuggerStartLine:n+1}):(t.splice(0,0,`breakpoint()
`),{runtimeLine:2,debuggerStartLine:n}):{runtimeLine:1,debuggerStartLine:o?i:i+1}}};var zee=require("vscode");var L_=class{constructor(e,t,n){this.configService=e;this.storageFactory=t;this.disposables=n;this.codeGenerators=new WeakMap}activate(){zee.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebook,this,this.disposables)}getOrCreate(e){let t=this.get(e);if(t)return t;let n=new uO(this.configService,this.storageFactory.getOrCreate(e),e,this.disposables);return this.codeGenerators.set(e,n),n}get(e){return this.codeGenerators.get(e)}onDidCloseNotebook(e){var t;(t=this.codeGenerators.get(e))==null||t.dispose(),this.codeGenerators.delete(e)}};L_=U([(0,K_.injectable)(),x(0,(0,K_.inject)(Ke)),x(1,(0,K_.inject)(Na)),x(2,(0,K_.inject)(ve))],L_);p();var Qee=oe(he()),Xee=require("vscode");p();var dO=class{constructor(){this.codeGeneratorsByFile=new yu}clear(){this.codeGeneratorsByFile.clear()}get all(){return[...this.codeGeneratorsByFile.entries()].map(e=>({uri:e[0],generatedCodes:e[1].filter(t=>!t.deleted)})).filter(e=>e.generatedCodes.length>0)}getFileGeneratedCode(e){return this.codeGeneratorsByFile.get(e)||[]}store(e,t){let n=this.codeGeneratorsByFile.get(e)||[],i=!1;for(let o=0;o<n.length&&!i;o+=1){let s=n[o];t.line>=s.line&&t.line<=s.endLine?(n.splice(o,1,t),i=!0):s.line>t.line&&(n.splice(o,0,t),i=!0)}i||n.push(t),this.codeGeneratorsByFile.set(e,n)}};var F_=class{constructor(){this.storages=new WeakMap}getOrCreate(e){return this.storages.has(e)||this.storages.set(e,new dO),this.storages.get(e)}get(e){if("notebook"in e)return this.storages.get(e.notebook);{let t=Xee.workspace.notebookDocuments.find(n=>{let i=this.storages.get(n);return i==null?void 0:i.all.find(o=>o.uri.toString()===e.fileUri.toString())});return t?this.storages.get(t):void 0}}};F_=U([(0,Qee.injectable)()],F_);p();var ap=oe(he());var U_=class{constructor(e,t,n,i,o,s){this.kernelProvider=e;this.codeGeneratorFactory=n;this.storageFactory=i;this.controllers=o;this.replTracker=s;this.disposables=[];t.push(this)}dispose(){Ce(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.controllers.onControllerSelected(this.onNotebookControllerSelected,this,this.disposables)}onNotebookControllerSelected({notebook:e}){var t,n;(t=this.storageFactory.get({notebook:e}))==null||t.clear(),(n=this.codeGeneratorFactory.get(e))==null||n.reset()}onDidCreateKernel(e){var n;let t=e.notebook;e.creator!=="jupyterExtension"||this.replTracker.isForReplEditor(t)||((n=this.storageFactory.get({notebook:t}))==null||n.clear(),e.onRestarted(()=>{var i;(i=this.storageFactory.get({notebook:t}))==null||i.clear(),this.codeGeneratorFactory.getOrCreate(t).reset()},this,this.disposables))}};U_=U([(0,ap.injectable)(),x(0,(0,ap.inject)(qe)),x(1,(0,ap.inject)(ve)),x(2,(0,ap.inject)(k_)),x(3,(0,ap.inject)(Na)),x(4,(0,ap.inject)(Nt)),x(5,(0,ap.inject)(Eu))],U_);p();var xv=oe(he()),Mte=require("vscode");var Ate=Rte(),fO=/(;32m[ ->]*?)(\d+)(.*)/g,W_=class{constructor(e,t,n,i){this.storageFactory=e;this.platformService=t;this.configurationService=n;this.replTracker=i}format(e,t){var a;if(!this.replTracker.isForReplEditor(e.notebook))return t;let n=this.storageFactory.get({notebook:e.notebook}),i=t.some(l=>/^[Input|Cell|File].*?\n.*/.test(l));if(!i&&!n)return t;let o=this.configurationService.getSettings(e.document.uri),s=(a=o==null?void 0:o.formatStackTraces)!=null?a:!1;return t.map(l=>i?this.modifyTracebackFrameIPython8(l,n==null?void 0:n.all,s):s?this.modifyTracebackFrameIPython7(l,n.all):l)}modifyTracebackFrameIPython8(e,t,n){var c,d,f,m,g;e=e.replace(/\u001b\[4\dm/g,""),e=e.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),e=e.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(b,v,k,R)=>(R=R.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${v}${k}${R}
`)),C.ci(`Trace frame to match: ${e}`);let i,o,s=/Cell\s+(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,l=/Input\s+?(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\].*line: (?<lineNumber>\d).*/.exec(e),u=s.exec(e);if(l&&((c=l.groups)!=null&&c.executionCount)&&((d=l.groups)!=null&&d.lineNumber)?(i=parseInt(l.groups.executionCount),o=(f=l.groups)==null?void 0:f.lineNumber):u&&((m=u.groups)!=null&&m.executionCount)&&((g=u.groups)!=null&&g.lineNumber)&&(i=parseInt(u.groups.executionCount),o=u.groups.lineNumber),t&&i){let b,v;for(let k of t)if(v=k.generatedCodes.find(R=>R.executionCount===i),v){b=k.uri;break}if(v&&b){let k=e;return n&&(k=k.replace(fO,(R,P,D,K)=>{let L=parseInt(D,10),O=(v.hasCellMarker?v.line-1:v.line)-1+v.lineOffsetRelativeToIndexOfFirstLineInCell+L;return`${P}<a href='${b==null?void 0:b.toString()}?line=${O-1}'>${O}</a>${K}`})),k.replace(/.*?\n/,`File \x1B[1;32m${ct(b)}:${o}\x1B[0m
`)}}if(n){let b=/^File.*?\[\d;32m(.*):\d+.*\u001b.*\n/.exec(e);if(b&&b.length>1){let v=kD(b[1],ct(this.platformService.homeDir)),k=Mte.Uri.file(v);return e.replace(fO,(R,P,D,K)=>{let L=parseInt(D,10);return`${P}<a href='${k==null?void 0:k.toString()}?line=${L-1}'>${L}</a>${K}`})}}return e}modifyTracebackFrameIPython7(e,t){return t.map(i=>i.uri).forEach(i=>{let o=ct(i),s=Ee(i),a=this.storageFactory.get({fileUri:i});if(a){if(e.includes(o)&&new RegExp(`\\[.*?;32m${Ate(o)}`).test(e)||e.includes(s)&&new RegExp(`\\[.*?;32m${Ate(s)}`).test(e)){let l="",u=/(;32m[ ->]*?)(\d+)(.*)/g;for(let d=u.exec(e);d&&d.length>3;d=u.exec(e)){let f=vu(d[3]).substr(1);l=`${l}${f}
`}let c=this.findCellOffset(a.getFileGeneratedCode(i),l);c!==void 0&&(e=e.replace(fO,(d,f,m,g)=>{let b=parseInt(m,10),v=c+b-1;return`${f}<a href='${i.toString()}?line=${v}'>${v+1}</a>${g}`}))}if(e.includes(o)){let l=this.findCellOffset(a.getFileGeneratedCode(i),e);if(l)return e.replace(fO,(u,c,d,f)=>{let m=parseInt(d,10),g=l+m-1;return`${c}<a href='${i.toString()}?line=${g}'>${g+1}</a>${f}`})}}}),e}findCellOffset(e,t){if(e){for(let n of e)if(n.trimmedRightCode.indexOf(t)>=0)return n.firstNonBlankLineIndex}}};W_=U([(0,xv.injectable)(),x(0,(0,xv.inject)(Na)),x(1,(0,xv.inject)(ds)),x(2,(0,xv.inject)(Ke)),x(3,(0,xv.inject)(Eu))],W_);p();var xu=oe(he()),Dm=require("vscode");p();function Ote(r){let e={source:{path:ct(r.uri)},pydevdSourceMaps:[]};return e.pydevdSourceMaps=r.generatedCodes.map(t=>({line:t.debuggerStartLine,endLine:t.endLine,runtimeSource:{path:t.runtimeFile},runtimeLine:t.runtimeLine})),e}p();var mO=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;this._ready=Re();this.ready=this._ready.promise;ne("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){C.debug(`[Debug-IW] ${e}: ${t}`)}async willSendEvent(e){return T9(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&LP(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){let t=Gl(this.debugCell);e.command==="setBreakpoints"&&t&&t.generatedCode&&!this.cellDumpInvoked&&(this.debugCellDumped||(this.debugCellDumped=yv(this.execution,this.debugAdapter)),await this.debugCellDumped),e.command==="configurationDone"&&t&&t.generatedCode&&(this.debugCellDumped||(this.debugCellDumped=yv(this.execution,this.debugAdapter)),await this.debugCellDumped,this._ready.resolve())}};p();var hO=class extends d_{constructor(){super(...arguments);this._ready=Re();this.ready=this._ready.promise}resolve(){this._ready.resolve()}};p();var K9=require("vscode");var gO=class extends f_{constructor(t,n,i,o,s,a,l){super(t,n,i,o,s,a);this.cellToDebugFileSortedInReverseOrderByLineNumber=[];l&&(this.debugLocationTracker=l.createDebugAdapterTracker(t),this.debugLocationTracker.onWillStartSession&&this.debugLocationTracker.onWillStartSession(),this.onDidSendMessage(u=>{var c;(c=this.debugLocationTracker)!=null&&c.onDidSendMessage&&this.debugLocationTracker.onDidSendMessage(u)},this,this.disposables),this.onDidEndSession(()=>{var u;(u=this.debugLocationTracker)!=null&&u.onWillStopSession&&this.debugLocationTracker.onWillStopSession()},this,this.disposables))}handleClientMessageAsync(t){var n,i;return C.ci(`KernelDebugAdapter::handleMessage ${JSON.stringify(t,void 0," ")}`),t.type==="request"&&((n=this.debugLocationTracker)!=null&&n.onWillReceiveMessage)&&this.debugLocationTracker.onWillReceiveMessage(t),t.type==="response"&&((i=this.debugLocationTracker)!=null&&i.onDidSendMessage)&&this.debugLocationTracker.onDidSendMessage(t),super.handleClientMessageAsync(t)}async dumpCell(t){var o,s;let n=this.notebookDocument.cellAt(t),i=Gl(n);if(!i)throw new Error("Not an interactive window cell");try{let a=(((o=i.generatedCode)==null?void 0:o.code)||n.document.getText()).replace(/\r\n/g,`
`),l=await this.session.customRequest("dumpCell",{code:a}),u=Is(l.sourcePath);this.fileToCell.set(u,K9.Uri.parse(i.interactive.uristring));let c=0;i.generatedCode&&!i.generatedCode.hasCellMarker&&(c=i.generatedCode.firstNonBlankLineIndex),this.cellToDebugFileSortedInReverseOrderByLineNumber.push({debugFilePath:u,interactiveWindow:K9.Uri.parse(i.interactive.uristring),metadata:i,lineOffset:c+i.interactive.lineIndex+(((s=i.generatedCode)==null?void 0:s.lineOffsetRelativeToIndexOfFirstLineInCell)||0)}),this.cellToDebugFileSortedInReverseOrderByLineNumber.sort((d,f)=>f.metadata.interactive.lineIndex-d.metadata.interactive.lineIndex)}catch(a){C.error(`Failed to dump cell for ${n.index} with code ${i.interactive.originalSource}`,a)}}translateDebuggerLocationToRealLocation(t,n){var o;if(n=(o=t==null?void 0:t.source)!=null?o:n,!n||!n.path)return;let i=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(s=>s.debugFilePath===n.path);i&&(n.name=Ht(i.interactiveWindow.path),n.path=i.interactiveWindow.toString(),typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine+(i.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line+(i.lineOffset||0)))}translateRealLocationToDebuggerLocation(t,n){var s;let i=t.line;if(n=(s=t==null?void 0:t.source)!=null?s:n,!n||!n.path||typeof i!="number")return;let o=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(a=>i>=a.metadata.interactive.lineIndex+1);!o||o.interactiveWindow.path!==n.path||(n.path=o.debugFilePath,typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine-(o.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line-(o.lineOffset||0)))}async sendRequestToJupyterSession(t){var n,i;if(t.command==="setBreakpoints"){let o=t.arguments;if(delete o.lines,o.source.path!==((n=this.cellToDebugFileSortedInReverseOrderByLineNumber[0])==null?void 0:n.interactiveWindow.path))return super.sendRequestToJupyterSession(t);let s,a=[],l=[],u=()=>{if(a.length){let f=JSON.parse(JSON.stringify(t));f.arguments.breakpoints=a,l.push(super.sendRequestToJupyterSession(f))}};for(let f of(i=t.arguments.breakpoints)!=null?i:[]){let m=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(g=>f.line>=g.metadata.generatedCode.line&&f.line<=g.metadata.generatedCode.endLine);if(m&&m.metadata.interactive.lineIndex!==s)u(),s=m.metadata.interactive.lineIndex,a=[f];else if(m)a.push(f);else{let g={...f,verified:!0};l.push(Promise.resolve({body:{breakpoints:[g]}}))}}u();let c=await Promise.all(l),d=JSON.parse(JSON.stringify(c[0]));return c.slice(1).forEach(f=>{var m;d.body.breakpoints=d.body.breakpoints.concat((m=f.body.breakpoints)!=null?m:[])}),d.command="setBreakpoints",d.type="response",d.success=!0,d.request_seq=t.seq,d}return super.sendRequestToJupyterSession(t)}getDumpFilesForDeletion(){return this.cellToDebugFileSortedInReverseOrderByLineNumber.map(t=>t.debugFilePath)}};p();var Lte=require("vscode");var vO=class{constructor(e){this.debugCell=e}trace(e,t){C.debug(`[Debug-IWRestart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Showing warning for unsupported restart request"),Lte.window.showWarningMessage(W.restartNotSupported,{modal:!0}).then(E,E),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};var V_=class extends p_{constructor(t,n,i,o,s,a,l){super(t,n,l);this.platform=i;this.debugLocationTrackerFactory=o;this.configService=s;this.debugService=a}activate(){super.activate(),this.disposables.push(Dm.debug.registerDebugAdapterDescriptorFactory(vK,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){return 2}async start(t,n){C.ci("Starting debugging IW"),await this.checkIpykernelAndPrompt(n)===1&&await this.startDebuggingCell(t,n)}async startDebuggingCell(t,n){let i=this.configService.getSettings(t.uri),o={type:vK,name:Ht(t.uri.toString()),request:"attach",justMyCode:i.debugJustMyCode,__notebookUri:t.uri.toString(),__mode:2,__cellIndex:n.index},s={suppressSaveBeforeStart:!0};await this.startDebuggingConfig(o,s);let a=this.notebookToDebugger.get(t);if(!a){C.error("Debugger not found, could not start debugging.");return}await a.ready}async createDebugAdapterDescriptor(t){let n=t.configuration;Pee(n);let i=Dm.workspace.notebookDocuments.find(s=>s.uri.toString()===n.__notebookUri);if(!i||typeof n.__cellIndex!="number"){C.error("Invalid debug session for debugging of IW using Jupyter Protocol");return}if(this.notebookInProgress.has(i)){C.info("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(i)){C.info("Cannot start debugging. Already debugging this notebook document. Toolbar should update");return}let o=new hO(i,n,t);this.notebookToDebugger.set(i,o);try{return this.notebookInProgress.add(i),await this.doCreateDebugAdapterDescriptor(n,t,i,o)}finally{this.notebookInProgress.delete(i)}}async doCreateDebugAdapterDescriptor(t,n,i,o){let s=await this.ensureKernelIsRunning(i);if(!(s!=null&&s.session)){Dm.window.showInformationMessage(W.kernelWasNotStarted).then(E,E);return}let a=new gO(n,i,s.session,s,this.platform,this.debugService,this.debugLocationTrackerFactory);this.disposables.push(a.onDidEndSession(this.endSession.bind(this)));let l=i.cellAt(t.__cellIndex),u=new mO(a,l,this.kernelProvider.getKernelExecution(s));return a.addDebuggingDelegates([u,new vO(l)]),u.ready.then(()=>o.resolve()).catch(c=>console.error("Failed waiting for controller to be ready",c)),this.trackDebugAdapter(i,a),new Dm.DebugAdapterInlineImplementation(a)}async updateSourceMaps(t,n){let i=this.getDebugSession(t.notebook);i&&(C.ci("Sending debug request for source map"),await Promise.all(n.map(async o=>{if(i)return i.customRequest("setPydevdSourceMap",Ote(o))})))}};V_=U([(0,xu.injectable)(),x(0,(0,xu.inject)(qe)),x(1,(0,xu.inject)(Nt)),x(2,(0,xu.inject)(ds)),x(3,(0,xu.inject)(AM)),x(4,(0,xu.inject)(Ke)),x(5,(0,xu.inject)(oo)),x(6,(0,xu.inject)(Ar))],V_);p();var Pv=oe(he()),Kte=require("vscode");var j_=class{constructor(e,t,n,i){this.configService=e;this.fs=t;this.context=n;this.registry=i;this.priority=5}activate(){this.registry.register(this,vr)}async getCode(e){if(!jt(e.kernelConnectionMetadata))return[];if(!zr()){if(this.configService.getSettings(void 0).forceIPyKernelDebugger===!0)return[];if(!Qt(e.kernelConnectionMetadata))return[]}if(!Qt(e.kernelConnectionMetadata))return[];this.addRunCellHookContents||(this.addRunCellHookContents=this.fs.readFile(Kte.Uri.joinPath(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","kernel","addRunCellHook.py")));let t=await this.addRunCellHookContents;return lt(t,{trim:!1})}};j_=U([(0,Pv.injectable)(),x(0,(0,Pv.inject)(Ke)),x(1,(0,Pv.inject)(Pt)),x(2,(0,Pv.inject)(st)),x(3,(0,Pv.inject)(Od))],j_);p();var H_=oe(he()),q_=require("vscode");var B_=class{constructor(e,t,n){this.dataScienceCodeLensProvider=e;this.extensionContext=t;this.configurationService=n}activate(){this.configurationService.getSettings().pythonCellFolding&&this.extensionContext.subscriptions.push(q_.languages.registerFoldingRangeProvider([dD],this))}provideFoldingRanges(e,t,n){if([ec,Bv].includes(e.uri.scheme))return;let i=this.dataScienceCodeLensProvider.getCodeWatcher(e);if(i){let o=i.getCodeLenses();return n.isCancellationRequested||o.length==0?void 0:o.map(s=>new q_.FoldingRange(s.range.start.line,s.range.end.line,q_.FoldingRangeKind.Region))}}};B_=U([(0,H_.injectable)(),x(0,(0,H_.inject)(Cm)),x(1,(0,H_.inject)(st)),x(2,(0,H_.inject)(Ke))],B_);p();var G_=oe(he());var Fte=require("vscode");var J_=class{constructor(e,t,n){this.dataScienceCodeLensProvider=e;this.extensionContext=t}activate(){this.extensionContext.subscriptions.push(Fte.languages.registerCodeLensProvider([dD],this.dataScienceCodeLensProvider))}};J_=U([(0,G_.injectable)(),x(0,(0,G_.inject)(Cm)),x(1,(0,G_.inject)(st)),x(2,(0,G_.inject)(wm))],J_);p();var Aa=oe(he());var F9="LastInteractiveKernelSelected",Y_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.interpreterService=t;this.disposables=n;this.workspaceMemento=i;this.serviceContainer=o;this.onControllerSelected=this.controllerRegistration.onControllerSelected}async getInitialController(e,t,n){if(n){let i=this.controllerRegistration.get(n,t);if(i)return i}if(this.workspaceMemento.get(F9)){let i=this.workspaceMemento.get(F9),o=i?this.controllerRegistration.get(i,t):void 0;if(o)return o}if(this.interpreterService)return await IEe(t,e,this.interpreterService,this.controllerRegistration)}getSelectedController(e){return this.controllerRegistration.getSelected(e)}getRegisteredController(e){return this.controllerRegistration.get(e,"interactive")}async createKernel(e,t,n,i,o){await Ll(n,e);let s=(c,d)=>{c!=="start"&&c!=="restart"||C.ci(`(onStart) Looking for controller ${d.controller.id} in ${this.controllerRegistration.all.map(f=>`${f.kind}:${f.id}`).join(", ")}`)},a=await Ta.connectToNotebookKernel(e,this.serviceContainer,{resource:n||i.uri,notebook:i,controller:t},new pr(!1),o,"jupyterExtension",s),l=this.controllerRegistration.registered.find(c=>c.id===a.controller.id);if(!l)throw Error(`Controller ${a.controller.id} not found or not yet created`);let u=l.controller;return this.interpreterService&&SEe(a.kernelConnectionMetadata,n,this.interpreterService).then(async c=>{await this.workspaceMemento.update(F9,c?void 0:a.kernelConnectionMetadata)}).catch(c=>{C.warn("Failed to store kernel connection metadata",c)}),{kernel:a,actualController:u}}};Y_=U([(0,Aa.injectable)(),x(0,(0,Aa.inject)(Nt)),x(1,(0,Aa.inject)(cm)),x(1,(0,Aa.optional)()),x(2,(0,Aa.inject)(ve)),x(3,(0,Aa.inject)(Et)),x(3,(0,Aa.named)(_s)),x(4,(0,Aa.inject)(Ar))],Y_);async function IEe(r,e,t,n){let i=await t.getActiveInterpreter(e);if(i){let o=await Zx(i),s=$x.create({kernelSpec:o,interpreter:i,id:SR(o,i)}),a=n.addOrUpdate(s,[r]),l=a[0];return n.trackActiveInterpreterControllers(a),C.ci(`Active Interpreter Controller ${l.connection.kind}:${l.id} created for View ${r} with resource ${Ee(e)}`),l}}async function SEe(r,e,t){var i;let n=await t.getActiveInterpreter(e);return(n==null?void 0:n.id)===((i=r.interpreter)==null?void 0:i.id)}p();var Dv=oe(require("vscode")),yO=oe(he());var $_=class{constructor(e){this.configService=e;this.cache=new Map;this.disposables=[];this.cachedOwnsSetting=this.configService.getSettings(void 0).sendSelectionToInteractiveWindow,Dv.workspace.onDidChangeConfiguration(this.onSettingChanged,this,this.disposables),Dv.window.onDidChangeActiveTextEditor(this.onChangedActiveTextEditor,this,this.disposables),this.onChangedActiveTextEditor(),Dv.workspace.onDidCloseTextDocument(this.onClosedDocument,this,this.disposables)}getCellRanges(e){let t=this.cache.get(e.uri);if(t&&t.version===e.version)return t.ranges;let n=this.configService.getSettings(e.uri),i=A9(e,n);return this.cache.set(e.uri,{version:e.version,ranges:i}),this.updateContextKeys(e),i}clear(){this.cache.clear()}onChangedActiveTextEditor(){let e=Dv.window.activeTextEditor;!e||e.document.languageId!=Ye||[ec,Bv].includes(e.document.uri.scheme)?(new fr(gr.HasCodeCells).set(!1).catch(n=>C.warn("Failed to set jupyter.HasCodeCells context",n)),this.updateContextKeys(!1)):this.updateContextKeys(e.document)}onSettingChanged(e){if(this.cache.clear(),e.affectsConfiguration("jupyter.interactiveWindow.textEditor.executeSelection")){let t=this.configService.getSettings(void 0);this.cachedOwnsSetting=t.sendSelectionToInteractiveWindow,this.updateContextKeys()}}updateContextKeys(e){var n;let t=!1;if(typeof e=="boolean")t=e;else{let i=e!=null?e:(n=Dv.window.activeTextEditor)==null?void 0:n.document;t=i?this.getCellRanges(i).length>0:!1}new fr(gr.OwnsSelection).set(this.cachedOwnsSetting||t).catch(E),new fr(gr.HasCodeCells).set(t).catch(E)}onClosedDocument(e){this.cache.delete(e.uri)}dispose(){this.disposables.forEach(e=>e.dispose())}};$_=U([(0,yO.injectable)(),x(0,(0,yO.inject)(Ke))],$_);function Ute(r){r.addSingleton(ao,O_),r.addSingleton(Eu,M_),r.addSingleton(rO,Y_),r.addSingleton(Ve,gs),r.addSingleton(wm,$_),r.add(eO,tr),r.addSingleton(tO,N_),r.addSingleton(Cm,R_),r.addSingleton(Ve,J_),r.addSingleton(Ve,B_),r.addSingleton(Ve,A_),r.addSingleton(Ve,U_),r.addSingleton(k_,L_,void 0,[Ve]),r.addSingleton(Na,F_),r.addSingleton(xI,W_),r.addSingleton(nO,V_,void 0,[Ve]),r.addSingleton(Ve,j_)}p();p();var co=require("vscode");var Wte=oe(he());var z_=class{async getFileToExecute(){let e=co.window.activeTextEditor;if(!e){co.window.showErrorMessage("No open file to run in terminal").then(E,E);return}if(e.document.isUntitled){co.window.showErrorMessage("The active file needs to be saved before it can be run").then(E,E);return}if(e.document.languageId!==Ye){co.window.showErrorMessage("The active file is not a Python source file").then(E,E);return}return e.document.isDirty&&await e.document.save(),e.document.uri}getSelectedTextToExecute(e){if(!e)return;let t=e.selection,n;return t.isEmpty?n=e.document.lineAt(t.start.line).text:t.isSingleLine?n=this.getSingleLineSelectionText(e):n=this.getMultiLineSelectionText(e),Qv(n.trimEnd())}async saveFileIfDirty(e){let t=co.workspace.textDocuments.filter(n=>n.uri.path===e.path);t.length===1&&t[0].isDirty&&await t[0].save()}getSingleLineSelectionText(e){let t=e.selection,n=new co.Range(t.start,t.end),i=e.document.getText(n),o=e.document.lineAt(t.start.line).text;return i.trim()===o.trim()?o:i}getMultiLineSelectionText(e){let t=e.selection,n=new co.Range(t.start,t.end),i=e.document.getText(n),o=new co.Range(new co.Position(t.start.line,0),new co.Position(t.end.line,e.document.lineAt(t.end.line).text.length)),s=e.document.getText(o);if(i.trim()===s.trim())return s;let a=e.document.lineAt(t.start.line).text,l=new co.Range(t.start,new co.Position(t.start.line,a.length)),u=e.document.getText(l);return u.trimStart()===a.trimStart()?a+i.substring(u.length):i}};z_=U([(0,Wte.injectable)()],z_);function Vte(r){r.addSingleton(cO,z_)}p();p();var Ma=oe(he());p();var qs=require("vscode");var bO=class{constructor(e,t,n,i,o,s){this.fileConverter=e;this.fs=t;this.interactiveProvider=n;this.controllerRegistration=i;this.preferredKernel=o;this.kernelFinder=s;this.disposables=[]}register(){this.registerCommand(le.ExportAsPythonScript,(e,t)=>this.export(e,"python",void 0,t)),this.registerCommand(le.ExportToHTML,(e,t,n)=>this.export(e,"html",t,n)),this.registerCommand(le.ExportToPDF,(e,t,n)=>this.export(e,"pdf",t,n)),this.registerCommand(le.Export,(e,t,n)=>this.export(e,void 0,t,n)),this.registerCommand(le.NativeNotebookExport,e=>this.nativeNotebookExport(e))}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommand(e,t){let n=qs.commands.registerCommand(e,t,this);this.disposables.push(n)}async nativeNotebookExport(e){var i,o,s;let t=ui(e)?e:(i=e==null?void 0:e.notebookEditor)==null?void 0:i.notebookUri,n=t?qs.workspace.notebookDocuments.find(a=>this.fs.arePathsSame(a.uri,t)):(o=qs.window.activeNotebookEditor)==null?void 0:o.notebook;if(n){let a,l=this.kernelFinder.registered.find(d=>d.kind==="localPythonEnvironment"),u=new qs.CancellationTokenSource;try{a=l?await this.preferredKernel.findPreferredLocalKernelSpecConnection(n,l,u.token).then(d=>d==null?void 0:d.interpreter):void 0}finally{u.dispose()}let c=((s=this.controllerRegistration.getSelected(n))==null?void 0:s.connection.interpreter)||a;return this.export(n,void 0,void 0,c)}else return this.export(void 0,void 0,void 0,void 0)}async export(e,t,n,i){var o,s,a,l;if(!e){if(e=((o=qs.window.activeNotebookEditor)==null?void 0:o.notebook)||((a=(s=this.interactiveProvider)==null?void 0:s.getActiveOrAssociatedInteractiveWindow())==null?void 0:a.notebookDocument),!e){C.info("Export called without a valid exportable document active");return}i=i||((l=this.controllerRegistration.getSelected(e))==null?void 0:l.connection.interpreter),t&&ne("DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",void 0,{format:t})}if(t)await this.fileConverter.export(t,e,n,i);else{let u=await this.showExportQuickPickMenu(e,n,i).then(c=>c);u!==void 0?u.handler():ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK")}}getExportQuickPickItems(e,t,n){let i=[];return(n||e.metadata&&bR(_a(e)))&&i.push({label:W.exportPythonQuickPickLabel,picked:!0,handler:()=>{ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"python"}),qs.commands.executeCommand(le.ExportAsPythonScript,e,n).then(E,E)}}),i.push({label:W.exportHTMLQuickPickLabel,picked:!1,handler:()=>{ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"html"}),qs.commands.executeCommand(le.ExportToHTML,e,t,n).then(E,E)}},{label:W.exportPDFQuickPickLabel,picked:!1,handler:()=>{ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"pdf"}),qs.commands.executeCommand(le.ExportToPDF,e,t,n).then(E,E)}}),i}async showExportQuickPickMenu(e,t,n){let i=this.getExportQuickPickItems(e,t,n),o={ignoreFocusOut:!1,matchOnDescription:!0,matchOnDetail:!0,placeHolder:W.exportAsQuickPickPlaceholder};return qs.window.showQuickPick(i,o)}};var IO=require("vscode");var Q_=class{constructor(e,t,n,i,o,s,a){this.disposables=e;this.fileConverter=t;this.fs=n;this.interactiveProvider=i;this.controllerSelection=o;this.kernelFinder=s;this.jupyterConnection=a;this.exportCommand=new bO(this.fileConverter,this.fs,this.interactiveProvider,o,new o_(a),s),IO.workspace.isTrusted||IO.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){var e;IO.workspace.isTrusted&&((e=this.exportCommand)==null||e.register())}};Q_=U([(0,Ma.injectable)(),x(0,(0,Ma.inject)(ve)),x(1,(0,Ma.inject)(v_)),x(2,(0,Ma.inject)(Pt)),x(3,(0,Ma.inject)(ao)),x(3,(0,Ma.optional)()),x(4,(0,Ma.inject)(Nt)),x(5,(0,Ma.inject)(ii)),x(6,(0,Ma.inject)(fn))],Q_);p();var Pu=oe(he()),Js=require("vscode");var X_=class{constructor(e,t,n,i,o){this.interactiveProvider=e;this.kernelProvider=n;this.controllers=i;this.jupyterUriProviderRegistration=o;this.disposables=[];this.isPythonFileActive=!1;this.ownedOpenNotebooks=new Set;t.push(this),this.nativeContext=new fr(gr.IsNativeActive),this.canRestartNotebookKernelContext=new fr(gr.CanRestartNotebookKernel),this.canInterruptNotebookKernelContext=new fr(gr.CanInterruptNotebookKernel),this.canRestartInteractiveWindowKernelContext=new fr(gr.CanRestartInteractiveWindowKernel),this.canInterruptInteractiveWindowKernelContext=new fr(gr.CanInterruptInteractiveWindowKernel),this.interactiveContext=new fr(gr.IsInteractiveActive),this.interactiveOrNativeContext=new fr(gr.IsInteractiveOrNativeActive),this.pythonOrNativeContext=new fr(gr.IsPythonOrNativeActive),this.pythonOrInteractiveContext=new fr(gr.IsPythonOrInteractiveActive),this.pythonOrInteractiveOrNativeContext=new fr(gr.IsPythonOrInteractiveOrNativeActive),this.hasNativeNotebookCells=new fr(gr.HaveNativeCells),this.isPythonNotebook=new fr(gr.IsPythonNotebook),this.isJupyterKernelSelected=new fr(gr.IsJupyterKernelSelected),this.hasNativeNotebookOrInteractiveWindowOpen=new fr(gr.HasNativeNotebookOrInteractiveWindowOpen),this.kernelSourceContext=new fr(gr.KernelSource)}dispose(){this.disposables.forEach(e=>e.dispose())}activate(){var e;Js.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,this.disposables),this.kernelProvider.onKernelStatusChanged(this.onDidKernelStatusChange,this,this.disposables),this.interactiveProvider&&(this.interactiveProvider.onDidChangeActiveInteractiveWindow(this.onDidChangeActiveInteractiveWindow,this,this.disposables),this.interactiveProvider.activeWindow&&this.onDidChangeActiveInteractiveWindow()),Js.window.activeNotebookEditor&&this.onDidChangeActiveNotebookEditor(Js.window.activeNotebookEditor),Js.window.onDidChangeActiveNotebookEditor(this.onDidChangeActiveNotebookEditor,this,this.disposables),((e=Js.window.activeTextEditor)==null?void 0:e.document.languageId)===Ye&&this.onDidChangeActiveTextEditor(Js.window.activeTextEditor),Js.workspace.onDidCloseNotebookDocument(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),this.controllers.onControllerSelectionChanged(()=>this.updateSelectedKernelContext(),this,this.disposables),this.updateSelectedKernelContext()}updateNativeNotebookCellContext(){var t;let e=(((t=Js.window.activeNotebookEditor)==null?void 0:t.notebook.cellCount)||0)>0;this.hasNativeNotebookCells.set(e).catch(E)}onDidChangeActiveInteractiveWindow(e){this.interactiveContext.set(!!e).catch(E),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}onDidChangeActiveNotebookEditor(e){let t=e?e.notebook.notebookType===St:!1;this.nativeContext.set(t).catch(E),this.isPythonNotebook.set(e&&t?bR(_a(e.notebook)):!1).catch(E),this.updateContextOfActiveNotebookKernel(e),this.updateContextOfActiveInteractiveWindowKernel(),this.updateNativeNotebookCellContext(),this.updateMergedContexts()}updateNativeNotebookInteractiveWindowOpenContext(e,t){t?this.ownedOpenNotebooks.add(e):this.ownedOpenNotebooks.delete(e),this.hasNativeNotebookOrInteractiveWindowOpen.set(this.ownedOpenNotebooks.size>0).catch(E)}updateContextOfActiveNotebookKernel(e){let t=e&&e.notebook.notebookType===St?this.kernelProvider.get(e.notebook):void 0;if(t){let n=this.kernelProvider.getKernelExecution(t),i=t.status!=="unknown"||n.executionCount>0||t.startedAtLeastOnce;this.canRestartNotebookKernelContext.set(!!i).catch(E);let o=t.status==="busy";this.canInterruptNotebookKernelContext.set(!!o).catch(E)}else this.canRestartNotebookKernelContext.set(!1).catch(E),this.canInterruptNotebookKernelContext.set(!1).catch(E);this.updateKernelSourceContext(t).catch(E),this.updateSelectedKernelContext()}async updateKernelSourceContext(e){if(!e||!Wt(e.kernelConnectionMetadata)){this.kernelSourceContext.set("").catch(E);return}let t=e.kernelConnectionMetadata,n=await this.jupyterUriProviderRegistration.jupyterCollections.find(i=>i.extensionId===t.serverProviderHandle.extensionId&&i.id===t.serverProviderHandle.id);if(!n){this.kernelSourceContext.set("").catch(E);return}this.kernelSourceContext.set(n.id).catch(E)}updateSelectedKernelContext(){var t,n,i;let e=((t=Js.window.activeNotebookEditor)==null?void 0:t.notebook)||((i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument);e&&hr(e)&&this.controllers.getSelected(e)?(this.isJupyterKernelSelected.set(!0).catch(E),this.updateNativeNotebookInteractiveWindowOpenContext(e,!0)):this.isJupyterKernelSelected.set(!1).catch(E)}updateContextOfActiveInteractiveWindowKernel(){var n,i;let e=(i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument,t=e?this.kernelProvider.get(e):void 0;if(t){let o=t.status!=="unknown";this.canRestartInteractiveWindowKernelContext.set(!!o).catch(E);let s=t.status==="busy";this.canInterruptInteractiveWindowKernelContext.set(!!s).catch(E)}else this.canRestartInteractiveWindowKernelContext.set(!1).catch(E),this.canInterruptInteractiveWindowKernelContext.set(!1).catch(E);this.updateSelectedKernelContext()}onDidKernelStatusChange({kernel:e}){var n;let t=e.notebook;t.notebookType===vr?this.updateContextOfActiveInteractiveWindowKernel():t.notebookType===St&&t===((n=Js.window.activeNotebookEditor)==null?void 0:n.notebook)&&this.updateContextOfActiveNotebookKernel(Js.window.activeNotebookEditor)}onDidChangeActiveTextEditor(e){this.isPythonFileActive=(e==null?void 0:e.document.languageId)===Ye&&!CB(e.document.uri),this.updateNativeNotebookCellContext(),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}updateMergedContexts(){this.interactiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0).catch(E),this.pythonOrNativeContext.set(this.nativeContext.value===!0||this.isPythonFileActive===!0).catch(E),this.pythonOrInteractiveContext.set(this.interactiveContext.value===!0||this.isPythonFileActive===!0).catch(E),this.pythonOrInteractiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0&&this.isPythonFileActive===!0).catch(E)}};X_=U([(0,Pu.injectable)(),x(0,(0,Pu.inject)(ao)),x(0,(0,Pu.optional)()),x(1,(0,Pu.inject)(ve)),x(2,(0,Pu.inject)(qe)),x(3,(0,Pu.inject)(Nt)),x(4,(0,Pu.inject)(sr))],X_);p();var lp=oe(he());var Z_=class{constructor(e,t,n){this.disposableRegistry=e;this.rawSupported=t;this.commandListeners=n;this.isDisposed=!1;this.startTime=Date.now()}get activationStartTime(){return this.startTime}activate(){this.disposableRegistry.push(this),this.computeZmqAvailable(),this.commandListeners&&this.commandListeners.forEach(e=>e.register())}async dispose(){this.changeHandler&&(this.changeHandler.dispose(),this.changeHandler=void 0)}computeZmqAvailable(){new fr(gr.ZmqAvailable).set(this.rawSupported?this.rawSupported.isSupported:!1).then(E,E)}};Z_=U([(0,lp.injectable)(),x(0,(0,lp.inject)(ve)),x(1,(0,lp.inject)(qd)),x(1,(0,lp.optional)()),x(2,(0,lp.multiInject)(fy))],Z_);p();var Tm=oe(he()),Du=require("vscode");var eE=class{constructor(e,t,n){this.jupyterServerHelper=e;this.fileSystem=t;this.errorHandler=n;this.extractPythonMainVersion=async()=>{if(!this.jupyterServerHelper)return 3;let e=await this.jupyterServerHelper.getUsableJupyterPython(),t=await kp(e);return e&&t&&t.major||3}}async exportToFile(e,t,n=!0){let i=await this.serialize(e);try{if(await this.fileSystem.writeFile(Du.Uri.file(t),i||""),!n)return;let o=W.exportOpenQuestion1;Du.window.showInformationMessage(W.exportDialogComplete(t),o).then(async s=>{try{s===o&&await oO(Du.Uri.file(t))}catch(a){await this.errorHandler.handleError(a)}},E)}catch(o){C.error("Error in exporting notebook file"),Du.window.showInformationMessage(W.exportDialogFailed(o)).then(E,E)}}async serialize(e,t){var a;let n=await this.extractPythonMainVersion(),i={language_info:{codemirror_mode:{name:"ipython",version:n},file_extension:".py",mimetype:"text/x-python",name:"python",nbconvert_exporter:"python",pygments_lexer:`ipython${n}`,version:n},kernelspec:t},o=(a=Du.extensions.getExtension("vscode.ipynb"))==null?void 0:a.exports;if(!o)throw new Error("vscode.ipynb extension not found");let s=new Du.NotebookData(e);return s.metadata={metadata:i,nbformat:mL.major,nbformat_minor:mL.minor},o.exportNotebook(s)}};eE=U([(0,Tm.injectable)(),x(0,(0,Tm.inject)(RR)),x(0,(0,Tm.optional)()),x(1,(0,Tm.inject)(Pt)),x(2,(0,Tm.inject)(pn))],eE);p();var Li=oe(he()),SO=require("vscode");p();var kv=oe(he()),Tv=require("vscode");var Bte=require("vscode");var U9="JUPYTER_API_ACCESS_INFORMATION",jte=new Set([Je.split(".")[0],"rchiodo","donjayamanne","SynapseVSCode"]),W9=new Set(["rchiodo","nuant"]),cp=class{constructor(e,t){this.globalState=e;this.context=t;this.extensionAccess=new Map;this.promiseChain=new Jv}async getAccessInformation(e){var s,a;let t=!e.extensionId||e.extensionId===hD?"":e.extensionId.split(".")[0]||"";if(this.context.extensionMode===Tv.ExtensionMode.Test||!t||Wd()==="insiders"){if(!jte.has(t)&&!W9.has(t)){C.warn(`Publisher ${t} is allowed to access the Kernel API with a message.`);let l=((a=(s=Bte.extensions.getExtension(e.extensionId))==null?void 0:s.packageJSON)==null?void 0:a.displayName)||"",u=l&&e.extensionId?`${l} (${e.extensionId})`:e.extensionId||t;Tv.window.showErrorMessage(W.thanksForUsingJupyterKernelApiPleaseRegisterWithUs(u)).then(E,E)}if(!W9.has(t)||!t||this.context.extensionMode===Tv.ExtensionMode.Test)return{extensionId:e.extensionId,accessAllowed:!0}}if(jte.has(t))return{extensionId:e.extensionId,accessAllowed:!0};if(!W9.has(t))return Tv.window.showErrorMessage(`Please contact the Jupyter Extension to get access to the Kernel API. Publisher ${t}`).then(E,E),C.error(`Publisher ${t} is not allowed to access the Kernel API.`),{extensionId:e.extensionId,accessAllowed:!1};let n=this.globalState.get(U9),i=n==null?void 0:n.find(l=>l.extensionId===e.extensionId);if(i)return ne("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:i.allowed}),{extensionId:e.extensionId,accessAllowed:i.allowed==="yes"};if(this.extensionAccess.get(e.extensionId))return this.extensionAccess.get(e.extensionId);let o=(async()=>{let l=W.allowExtensionToUseJupyterKernelApi(`${e.displayName} (${e.extensionId})`,Ue.bannerLabelYes),c=await Tv.window.showInformationMessage(l,{modal:!0},Ue.bannerLabelYes,Ue.bannerLabelNo)===Ue.bannerLabelYes;return this.promiseChain.chainFinally(async()=>{let d=[...this.globalState.get(U9,[])];return d=d.filter(f=>f.extensionId!==e.extensionId),d.push({allowed:c?"yes":"no",extensionId:e.extensionId}),this.globalState.update(U9,d)}).then(E,E),ne("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:c?"yes":"no"}),{extensionId:e.extensionId,accessAllowed:c}})();return this.extensionAccess.set(e.extensionId,o),o}};cp=U([(0,kv.injectable)(),x(0,(0,kv.inject)(Et)),x(0,(0,kv.named)(rr)),x(1,(0,kv.inject)(st))],cp);p();var Hte=new WeakMap;function V9(r){let e=Hte.get(r);return e||(e=_Ee(r),Hte.set(r,e)),e}function _Ee(r){return new Proxy(r,{get(e,t){return t==="kernel"?e.kernel?EEe(e.kernel):void 0:Reflect.get(e,t)}})}var qte=new WeakMap;function EEe(r){let e=qte.get(r);return e||(e=CEe(r),qte.set(r,e)),e}function CEe(r){return new Proxy(r,{get(e,t){return t==="registerCommTarget"?(n,i)=>(FZ(r,n),Reflect.get(e,t).apply(e,[n,i])):t==="removeCommTarget"?(n,i)=>(UZ(r,n),Reflect.get(e,t).apply(e,[n,i])):Reflect.get(e,t)}})}var tE=class{constructor(e,t,n,i,o,s,a,l){this.kernelProvider=e;this.kernelFinder=t;this.thirdPartyKernelProvider=n;this.disposables=i;this.controllerRegistration=o;this.apiAccess=s;this.extensions=a;this.serviceContainer=l;this.chainedApiAccess=new Jv;this.extensionApi=new Map}async getService(){let e=this.extensions.determineExtensionFromCallStack(),t=await this.chainedApiAccess.chainFinally(()=>this.apiAccess.getAccessInformation(e));if(!t.accessAllowed)return;if(this.extensionApi.get(t.extensionId))return this.extensionApi.get(t.extensionId);let n=new YP(t.extensionId,this.kernelProvider,this.kernelFinder,this.thirdPartyKernelProvider,this.disposables,this.controllerRegistration,this.serviceContainer);return this.extensionApi.set(t.extensionId,n),n}};tE=U([(0,Li.injectable)(),x(0,(0,Li.inject)(qe)),x(1,(0,Li.inject)(ii)),x(2,(0,Li.inject)(jg)),x(3,(0,Li.inject)(ve)),x(4,(0,Li.inject)(Nt)),x(5,(0,Li.inject)(cp)),x(6,(0,Li.inject)(Ha)),x(7,(0,Li.inject)(Ar))],tE);var YP=class{constructor(e,t,n,i,o,s,a){this.callingExtensionId=e;this.kernelProvider=t;this.kernelFinder=n;this.thirdPartyKernelProvider=i;this.disposables=o;this.controllerRegistration=s;this.serviceContainer=a;this._onDidChangeKernelSpecifications=new SO.EventEmitter;this._onDidChangeKernels=new SO.EventEmitter;this.translatedConnections=new WeakMap;this._onDidChangeStatus=new SO.EventEmitter;this._status=this.kernelFinder.status,this.kernelFinder.onDidChangeStatus(()=>{this._status=this.kernelFinder.status,this._onDidChangeStatus.fire()},this,o),this.kernelProvider.onDidDisposeKernel(l=>{var u;C.ci(`Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.kernelProvider.onDidStartKernel(l=>{var u;C.ci(`Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidDisposeKernel(l=>{var u;C.ci(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidStartKernel(l=>{var u;C.ci(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.controllerRegistration.onDidChange(()=>this._onDidChangeKernelSpecifications.fire(),this,o)}get onDidChangeKernelSpecifications(){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernelSpecifications"}),C.debug(`API called from ${this.callingExtensionId}`),this._onDidChangeKernelSpecifications.event}get onDidChangeKernels(){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernels"}),this._onDidChangeKernels.event}get status(){return this._status}get onDidChangeStatus(){return this._onDidChangeStatus.event}async getKernelSpecifications(){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernelSpecifications"}),this.kernelFinder.kernels.map(e=>this.translateKernelConnectionMetadataToExportedType(e))}getActiveKernels(){ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getActiveKernels"});let e=[],t=new Set;return this.kernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.kernelProvider.get(n.notebook);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.thirdPartyKernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.thirdPartyKernelProvider.get(n.uri);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.controllerRegistration.registered.forEach(n=>{n.controller.notebookType===St&&n.connection.kind==="connectToLiveRemoteKernel"&&(!n.connection.kernelModel.id||t.has(n.connection.kernelModel.id)||e.push({metadata:n.connection,uri:void 0,id:n.id}))}),e}getKernel(e){var n;ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernel"});let t=(n=this.thirdPartyKernelProvider.get(e))!=null?n:this.kernelProvider.get(e);if(t!=null&&t.session)return{metadata:this.translateKernelConnectionMetadataToExportedType(t.kernelConnectionMetadata),connection:V9(t.session)}}async startKernel(e,t){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"startKernel"}),this.startOrConnect(e,t)}async connect(e,t){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"connect"}),this.startOrConnect(e,t)}async startOrConnect(e,t){let n=this.kernelFinder.kernels.find(o=>o.id===e.id);if(!n)throw new Error("Not found");let i=await Ta.connectToKernel(n,this.serviceContainer,{resource:t},new pr(!1),this.disposables,"3rdPartyExtension");if(!(i!=null&&i.session))throw new Error("Not found");return V9(i.session)}translateKernelConnectionMetadataToExportedType(e){if(!this.translatedConnections.has(e)){let t=Object.freeze(Zc.fromJSON(e.toJSON()));this.translatedConnections.set(e,t)}return this.translatedConnections.get(e)}};YP=U([x(1,(0,Li.inject)(qe)),x(2,(0,Li.inject)(ii)),x(3,(0,Li.inject)(jg)),x(4,(0,Li.inject)(ve)),x(5,(0,Li.inject)(Nt)),x(6,(0,Li.inject)(Ar))],YP);p();var nE=oe(he());var rE=class{constructor(e){this.syncActivationServices=e}activate(){this.syncActivationServices.map(e=>{try{e.activate()}catch(t){C.error(`Error in activating extension, failed in ${e.constructor.name}`,t)}})}};rE=U([(0,nE.injectable)(),x(0,(0,nE.optional)()),x(0,(0,nE.multiInject)(Ve))],rE);p();p();var zl=require("vscode");p();var $l=require("vscode");var Gte="version";function Jte(r){return`${Gte}-${r.extension.packageJSON.version||"version"}`}async function Yte(r,e){if(ic())return $l.Uri.joinPath(r.globalStorageUri,Jte(r));{let t=$l.Uri.joinPath($l.Uri.file(r.globalStorageUri.fsPath),Jte(r));if(e)try{await e.createDirectory(t)}catch(n){C.warn(`Failed to create temp directory (${t.fsPath}), falling back to extension dir`,n),t=$l.Uri.joinPath(r.extensionUri,"temp"),await e.createDirectory(t)}return t}}async function $te(r){try{let e=await $l.workspace.fs.readDirectory(r.globalStorageUri);await Promise.all(e.filter(([t,n])=>t.startsWith(Gte)&&n===$l.FileType.Directory).map(([t])=>$l.workspace.fs.delete($l.Uri.joinPath(r.globalStorageUri,t),{recursive:!0}))).catch(E)}catch(e){}}function zte(r,e){e&&zl.commands.registerCommand("dataScience.ClearCache",async()=>{let t=[];for(let n of r.globalState.keys())t.push(r.globalState.update(n,void 0).then(E,E));for(let n of r.workspaceState.keys())t.push(r.workspaceState.update(n,void 0).then(E,E));t.push(zl.commands.executeCommand(le.ClearSavedJupyterUris).then(E,E)),await Promise.all(t).catch(E),await Promise.all([zl.workspace.fs.delete(zl.Uri.joinPath(r.globalStorageUri,"lastExecutedRemoteCell.json")).then(E,E),zl.workspace.fs.delete(zl.Uri.joinPath(r.globalStorageUri,"remoteServersMRUList.json")).then(E,E),zl.workspace.fs.delete(zl.Uri.joinPath(r.globalStorageUri,PS)).then(E,E),$te(r).then(E,E)]),C.info("Cache cleared")})}function Qte(r,e){zte(r,e)}p();p();var CO=oe(he()),Gt=require("vscode");var _O=W.percentPipCondaInstallInsteadOfBang("pip"),j9=W.percentPipCondaInstallInsteadOfBang("conda"),Xte=W.matplotlibWidgetInsteadOfOther,EO="Jupyter",iE=class{constructor(e){this.disposables=[];this.notebooksProcessed=new WeakMap;this.cellsToProcess=new Set;this.problems=Gt.languages.createDiagnosticCollection(EO),this.disposables.push(this.problems),e.push(this)}dispose(){Ce(this.disposables),this.problems.dispose()}activate(){this.disposables.push(Gt.languages.registerCodeActionsProvider(Ye,this)),this.disposables.push(Gt.languages.registerHoverProvider(Ye,this)),Gt.workspace.onDidChangeTextDocument(t=>{let n=cI(t.document);if(!n)return;let i=n.getCells().find(o=>o.document===t.document);i&&this.analyzeNotebookCell(i)},this,this.disposables),Gt.workspace.onDidCloseNotebookDocument(t=>{this.problems.delete(t.uri);let n=this.notebooksProcessed.get(t);this.notebooksProcessed.delete(t),n&&n.forEach((i,o)=>this.problems.delete(Gt.Uri.parse(o)))},this,this.disposables),Gt.workspace.onDidOpenNotebookDocument(t=>this.analyzeNotebook(t),this,this.disposables);let e=new rc(300);this.disposables.push(e),Gt.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>{let n=this.notebooksProcessed.get(t.notebook);t.contentChanges.forEach(i=>{i.removedCells.forEach(o=>{n==null||n.delete(o.document.uri.toString())}),i.addedCells.forEach(o=>this.queueCellForProcessing(o))}),t.cellChanges.forEach(i=>this.queueCellForProcessing(i.cell))})},this,this.disposables),Gt.workspace.notebookDocuments.map(t=>this.analyzeNotebook(t))}provideHover(e,t,n){let i=cI(e);if((i==null?void 0:i.notebookType)!==St)return;let o=this.problems.get(e.uri);if(!o)return;let s=o.find(l=>l.message===_O||l.message===j9);if(!s||!s.range.contains(t))return;let a=s.message===_O?"pip":"conda";return new Gt.Hover(W.pipCondaInstallHoverWarning(a,"https://aka.ms/jupyterCellMagicBangInstall"),s.range)}provideCodeActions(e,t,n,i){if(!cI(e))return[];let o=[];return n.diagnostics.forEach(s=>{switch(s.message){case _O:o.push(this.createReplaceCodeAction(e,"pip",s));break;case j9:o.push(this.createReplaceCodeAction(e,"conda",s));break;case Xte:o.push(this.createGotoWikiAction(e,Gt.Uri.parse("https://aka.ms/vscodejupytermatplotlibwidget"),s));break;default:break}}),o}createReplaceCodeAction(e,t,n){let i=new Gt.CodeAction(W.replacePipCondaInstallCodeAction(t),Gt.CodeActionKind.QuickFix);i.isPreferred=!0,i.diagnostics=[n];let o=new Gt.WorkspaceEdit;return o.replace(e.uri,new Gt.Range(n.range.start,new Gt.Position(n.range.start.line,n.range.start.character+1)),"%"),i.edit=o,i}createGotoWikiAction(e,t,n){let i=new Gt.CodeAction(W.matplotlibWidgetCodeActionTitle,Gt.CodeActionKind.QuickFix);return i.isPreferred=!0,i.diagnostics=[n],i.command={title:W.matplotlibWidgetCodeActionTitle,command:"vscode.open",arguments:[t]},i}analyzeNotebook(e){e.notebookType===St&&e.getCells().forEach((t,n)=>n<100?this.queueCellForProcessing(t):void 0)}queueCellForProcessing(e){this.cellsToProcess.add(e),this.analyzeNotebookCells()}analyzeNotebookCells(){if(this.cellsToProcess.size===0)return;let e=this.cellsToProcess.values().next().value;e&&(this.cellsToProcess.delete(e),this.analyzeNotebookCell(e)),setTimeout(()=>this.analyzeNotebookCells(),0)}analyzeNotebookCell(e){var n;if(e.kind!==Gt.NotebookCellKind.Code||e.document.languageId!==Ye||e.notebook.isClosed||e.document.isClosed||((n=this.notebooksProcessed.get(e.notebook))==null?void 0:n.get(e.document.uri.toString()))===e.document.version)return;this.problems.delete(e.document.uri);let t=this.notebooksProcessed.get(e.notebook)||new Map;t.set(e.document.uri.toString(),e.document.version),this.notebooksProcessed.set(e.notebook,t);for(let i=0;i<Math.min(e.document.lineCount,50);i++){let o=e.document.lineAt(i),s=o.text;if(s.trim().startsWith("!pip install")){let a=s.indexOf("!"),l=s.indexOf("l"),u=new Gt.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:_O,range:u,severity:Gt.DiagnosticSeverity.Error,source:EO}])}else if(s.trim().startsWith("!conda install")){let a=s.indexOf("!"),l=s.indexOf("l"),u=new Gt.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:j9,range:u,severity:Gt.DiagnosticSeverity.Error,source:EO}])}else if(s.trim().startsWith("%matplotlib")&&!s.trim().endsWith("widget")&&!s.trim().endsWith("inline")){let a=s.indexOf("%"),l=s.length,u=new Gt.Range(o.lineNumber,a,o.lineNumber,l);this.problems.set(e.document.uri,[{message:Xte,range:u,severity:Gt.DiagnosticSeverity.Warning,source:EO}])}}}};iE=U([(0,CO.injectable)(),x(0,(0,CO.inject)(ve))],iE);p();var TO=oe(he()),Ir=require("vscode");p();var Zte=new Map([["method",0],["function",1],["constructor",2],["field",3],["variable",4],["class",5],["struct",6],["interface",7],["module",8],["property",9],["event",10],["operator",11],["unit",12],["value",13],["constant",14],["enum",15],["enumMember",16],["keyword",17],["text",18],["color",19],["file",20],["reference",21],["customcolor",22],["folder",23],["typeParameter",24],["snippet",25],["<unknown>",3]]);p();function wO(r){if(r>=300)return"ZZZZZZZ";if(r<=25)return`A${String.fromCharCode(65+r)}`;let e=String.fromCharCode(65+Math.ceil(r/25)),t=String.fromCharCode(65+r%25);return`${e}${t}`}p();var sre=require("vscode");p();var Nv=require("vscode");var wEe=new Map([["julia",TEe],["python",PEe],["r",kEe]]);function ere(r,e){let t=wEe.get(e.toLowerCase());return t?t(r):r}var xEe=["Docstring:","Options:","Parameters","Returns","See Also","Notes","Examples","Usage:","Subclasses:"];function PEe(r){let e=lt(r,{trim:!1,removeEmptyEntries:!1}),t=-1,n=!1,i=!1,o=[],s=new Set,a=!1,l="",u=!1,c=!1;if(e.map((f,m)=>{if(m===0){let b=["Signature:","Init signature:"].find(v=>f.toLowerCase().startsWith(v.toLowerCase()));if(b){n=!0,f=f.substring(b.length).trim(),o.push("```python"),f.trim().length&&(o.push(f),u=!0);return}}if(f.startsWith("File:")&&m===e.length-1||f.startsWith("Type:")&&m===0)return;if(!a&&f.toLowerCase().startsWith("String form:".toLowerCase())){i=!0;return}let g=xEe.find(b=>f.trim().toLowerCase().startsWith(b.toLowerCase()));if(g&&!s.has(g)){l=g.toLowerCase(),s.add(g),a=!0,t=m,i=!1,n&&o.push("```","----------"),n=!1,c=!1,l!=="docstring:"&&o.push(`## ${g}`);let b=f.includes(":")?f.split(":")[1].replace("<no docstring>","").trim():"";b.length&&(o.push(b),u=!0);return}if(!i){if(t+1===m&&f.replace(/-/g,"").replace(/:/g,"").replace("<no docstring>","").trim().length===0){t=m,i=!1,n=!1,c=!1;return}if(l==="parameters"||l==="see also"){f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),u=u||f.trim().length>0;return}if(l==="options:"){f.startsWith("-")&&f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),u=u||f.trim().length>0;return}if(l==="returns"){f.trim().length&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),u=u||f.trim().length>0;return}if(l==="examples"&&!n&&(t+1===m||t+2===m))return i=!1,n=!0,u=u||f.trim().length>0,o.push("```python",f);if(!n&&f.startsWith("class ")&&f.trim().endsWith("):")){n=!0,c=!0,o.push("```python",f),u=u||f.trim().length>0;return}if(n&&c&&f.trim().length>0&&f.substring(0,1)!==" "&&f.substring(0,1)!=="	")return n=!1,c=!1,o.push(f,"```");u=u||f.trim().length>0,o.push(f)}}),!u)return"";let d=o.join(`  
`);return n?new Nv.MarkdownString(d+"  \n```"):new Nv.MarkdownString(d)}var DEe=[{section:"Examples:",header:"Examples",nextLine:/≡/g},{section:"Usage note",header:"Usage note",nextLine:/≡/g},{section:"Note:",header:"\u2502 Note",nextLine:"\u2502"},{section:"Note:",header:"\u2502 Note",nextLine:String.fromCharCode(9474)}];function TEe(r){let e=lt(r,{trim:!1,removeEmptyEntries:!1}),t=!1,n=[],i=new Set,o="",s=!1,a=!1;e.every(u=>u.trim().length===0||u.startsWith("  "))&&e.forEach((u,c)=>e[c]=u.trim().length?u.substring(2):u),e.map((u,c)=>{if(u.trim()==="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500")return a=!1,n.push(u);if(!a)return o="signature",t=!0,a=!0,u.trim().length?(s=!0,n.push("```julia",u)):n.push("```julia");o==="signature"&&u.trim()===""&&(o="",t=!1,s=!1,n.push("```"));let d=DEe.find(f=>u.trim().toLowerCase().startsWith(f.header.toLowerCase()));if(d&&(typeof d.nextLine=="string"?e[c+1].trim()===d.nextLine.trim():e[c+1].trim().replace(d.nextLine,"").length===0)){e[c+1]="",o=d.section.toLowerCase(),i.add(d.header),t&&n.push("```"),t=!1,n.push(`## ${d.section}`),o==="note:"&&!e.slice(c+1).every(f=>f.trim().length===0||f.trim().startsWith("|")||f.trim().startsWith(String.fromCharCode(9474)))&&(o="");return}if(o==="examples:"&&!t)return t=!0,u.trim().length?(s=!0,n.push("```julia",u)):n.push("```julia");if(o==="note:"){n.push(u.trim()?u.trim().substring(1):"");return}t&&!s&&u.trim().length===0||n.push(u)});let l=n.join(`  
`);return t?new Nv.MarkdownString(l+"  \n```"):new Nv.MarkdownString(l)}function kEe(r){let e=lt(r,{trim:!1,removeEmptyEntries:!1}),t=[];e.forEach((a,l)=>e[l]=a.indexOf("     ")===0?a.substring(5):a);let n="",i=!1,o=!1;e.map(a=>{let l=a.replace(/_/g,"").trim();if(a.startsWith("_")&&a.includes(String.fromCharCode(8))&&a.split("_").length===a.split(String.fromCharCode(8)).length&&l){i&&t.push("```"),i=!1,n=l.trim().toLowerCase(),t.push(`## ${l}`);return}if((n==="examples"||n==="examples:"||n==="usage"||n==="usage:")&&!i)return i=!0,a.trim().length?(o=!0,t.push("```r",a)):t.push("```r");if(n==="note:"){t.push(a.trim()?a.trim().substring(1):"");return}i&&!o&&a.trim().length===0||t.push(a)});let s=t.join(`  
`);return i?new Nv.MarkdownString(s+"  \n```"):new Nv.MarkdownString(s)}p();var tre=new WeakMap;async function Rv(r,e,t){var f;let n=tre.get(r)||0;tre.set(r,n+1);let{api:i}=kR(Je,r),o=`application/vnd.vscode.bg.execution.${n}`,s=`application/vnd.vscode.bg.execution.${n}.result`,a=`application/vnd.vscode.bg.execution.${n}.error`,l="",u=`
def __jupyter_exec_background__():
    from IPython.display import display
    from threading import Thread
    from traceback import format_exc

    # First send a dummy response to get the display id.
    # Later we'll send the real response with the actual data.
    # And that can happen much later even after the execution completes,
    # as that response will be sent from a bg thread.
    output = display({"${o}": ""}, raw=True, display_id=True)

    def do_implementation():
        ${e.map((m,g)=>g===0?m:`        ${m}`).join(`
`)}

    def bg_main():
        try:
            output.update({"${s}": do_implementation()}, raw=True)
        except Exception as e:
            output.update({"${a}": format_exc()}, raw=True)


    Thread(target=bg_main, daemon=True).start()


__jupyter_exec_background__()
del __jupyter_exec_background__
`.trim(),c=new En;c.add(t.onCancellationRequested(()=>c.dispose()));let d=Ls(t,new Promise((m,g)=>{c.add(i.onDidReceiveDisplayUpdate(async b=>{var R;if(t.isCancellationRequested)return m(void 0);let v=Bg(b);if(!l||((R=v==null?void 0:v.transient)==null?void 0:R.display_id)!==l)return;let k=b.items.find(P=>P.mime===s);if(k)try{return m(JSON.parse(new TextDecoder().decode(k.data)))}catch(P){return g(new Error("Failed to parse the result",P))}}))})).finally(()=>{r.session&&hQ(r.session,l),c.dispose()});for await(let m of i.executeCode(u,t)){if(t.isCancellationRequested)return;let g=Bg(m);if(!((f=g==null?void 0:g.transient)!=null&&f.display_id))continue;if(m.items.find(v=>v.mime===o)){l=g.transient.display_id;continue}if(l===g.transient.display_id){let v=m.items.find(k=>k.mime===s||k.mime===a);if((v==null?void 0:v.mime)===s)return JSON.parse(new TextDecoder().decode(v.data));if((v==null?void 0:v.mime)===a){C.warn(`Error in background execution:
`,new TextDecoder().decode(v.data));return}}}if(!t.isCancellationRequested){if(!l){C.warn("Failed to get display id for completions");return}return d}}var NEe=1,km=li.IntellisenseResolveTimeout,rre=5,B9=new WeakSet,xO=class extends Error{constructor(){super("Request timed out")}};async function are(r,e,t,n,i,o,s,a){var d;if(!r.range||!((d=n.session)!=null&&d.kernel)||B9.has(n)||!jt(n.kernelConnectionMetadata)&&n.status!=="idle")return r;let l=VEe(e||r,s,a),u=WEe(l,n,t),c=AQ(t);try{let f=await Gv(km,new xO,Ls(c.token,u));if(!t.isCancellationRequested&&(f==null?void 0:f.status)==="ok"&&(f!=null&&f.found)){let m=REe(f);r.documentation=ere(m,o)}}catch(f){if(f instanceof sre.CancellationError)return r;f instanceof xO&&(c.cancel(),AEe(n,o,i))}finally{c.dispose()}return r}function REe(r){return!r||r.status!=="ok"||!r.found?";":!r.data||typeof r.data!="object"?"":"text/plain"in r.data?vu(r.data["text/plain"]):""}var nre=new WeakSet;function AEe(r,e,t){jt(r.kernelConnectionMetadata)||B9.has(r)||(B9.add(r),C.warn(`Failed to inspect code in kernel ${ut(r.kernelConnectionMetadata)}`),nre.has(r)||(nre.add(r),ne("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",void 0,{kernelId:t,kernelConnectionType:r.kernelConnectionMetadata.kind,kernelLanguage:e})))}var H9=new WeakMap,q9=new WeakMap;async function MEe(r,e,t){let n=`return get_ipython().kernel.do_inspect("${eP(e.code)}", ${e.cursor_pos}, ${e.detail_level})`;return{content:await Rv(r,[n],t)}}var ire={data:{},found:!1,status:"ok",metadata:{}};function OEe(r,e){var i;if(!((i=r.session)!=null&&i.kernel))return;let t=JSON.stringify(e),n=H9.get(r.session.kernel);return n==null?void 0:n.get(t)}function LEe(r,e,t){var o;if(!((o=r.session)!=null&&o.kernel)||t.status!=="ok"||!t.found)return;let n=JSON.stringify(e),i=H9.get(r.session.kernel)||new Map;H9.set(r.session.kernel,i),i.size>100&&i.clear(),i.set(n,t)}function KEe(r){var t;if(!((t=r.session)!=null&&t.kernel))return!1;let e=q9.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};return!jt(r.kernelConnectionMetadata)&&e.maxTime>km?(C.warn(`Not sending inspect request as previous requests took over ${km}s.`),!1):e.numberOfTimesMaxedOut>rre?(C.warn(`Not sending inspect request as there have been at least ${rre} requests that took over ${km}s.`),!1):e.maxTime>km&&Date.now()-e.lastRequestTime<3e4?(C.warn(`Not sending inspect request as previous requests took over ${km}s.`),!1):!0}async function FEe(r,e){var i;if(!((i=r.session)!=null&&i.kernel)||!ore(r))return;C.info(`Too many pending requests ${lre(r)} for kernel ${r.id}, waiting for it to be ready.`);let t=r.session.kernel,n=new En;await Ls(e,new Promise(o=>{let s=()=>{if(e.isCancellationRequested)return;if(!ore(r)){o(),Ce(n);return}let a=setTimeout(s,100);n.add({dispose:()=>clearTimeout(a)})};n.add(Ag(e.onCancellationRequested)(()=>{o(),t.statusChanged.disconnect(s)})),t.statusChanged.connect(s),n.add({dispose:()=>{t.statusChanged.disconnect(s)}})})).finally(()=>Ce(n))}function UEe(r,e){var n;if(!((n=r.session)!=null&&n.kernel))return;let t=q9.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};t.maxTime=Math.max(t.maxTime,e),t.lastRequestTime=Date.now(),e>km&&(t.numberOfTimesMaxedOut+=1),q9.set(r.session.kernel,t)}async function WEe(r,e,t){var l;if(!((l=e.session)!=null&&l.kernel))return;let n=OEe(e,r);if(n)return n;if(!KEe(e)||(await FEe(e,t),t.isCancellationRequested))return ire;let i=jEe(e),o=new yt,s=lt(r.code).reverse()[0].slice(-50);C.trace(`Inspecting code ${s}`);let a=jt(e.kernelConnectionMetadata)?MEe(e,r,t):e.session.kernel.requestInspect(r);return a.finally(()=>i.dispose()),a.then(({content:u})=>{var d;if(!((d=e.session)!=null&&d.kernel))return;LEe(e,r,u),UEe(e,o.elapsedTime);let c=o.elapsedTime>km?C.warn:C.debug;return t.isCancellationRequested?c(`Inspected code ${s} in ${o.elapsedTime}ms (but cancelled)`):c(`Inspected code ${s} in ${o.elapsedTime}ms`),u})}function VEe(r,e,t){var l;let n=e.getText(),i=(typeof r.insertText=="string"?r.insertText:(l=r.insertText)==null?void 0:l.value)||(typeof r.label=="string"?r.label:r.label.label)||"",o=n.substring(0,t.character)+i,s=t.character+i.length;return{code:o,cursor_pos:s,detail_level:0}}var $P=new WeakMap;function ore(r){var e;return(e=r.session)!=null&&e.kernel?lre(r)>=NEe:!1}function lre(r){var e,t,n,i,o;return(e=r.session)!=null&&e.kernel?($P.has((t=r.session)==null?void 0:t.kernel)||$P.set((n=r.session)==null?void 0:n.kernel,{count:0}),((o=$P.get((i=r.session)==null?void 0:i.kernel))==null?void 0:o.count)||0):0}function jEe(r){var t,n,i;if(!((t=r.session)!=null&&t.kernel))return{dispose:E};let e=$P.get((n=r.session)==null?void 0:n.kernel)||{count:0};return $P.set((i=r.session)==null?void 0:i.kernel,e),e.count+=1,{dispose:()=>{e.count-=1}}}var DO=class extends Error{constructor(){super("Request timed out")}},J9=class{constructor(e,t,n){this.kernelId=e;this.kernel=t;this.monacoLanguage=n;this.pendingCompletionRequest=new WeakMap;this.previousCompletionItems=new WeakMap}async provideCompletionItems(e,t,n,i){var a;if(!((a=this.kernel.session)!=null&&a.kernel))return[];let o=e.version;if(this.pendingCompletionRequest.has(e))return[];this.pendingCompletionRequest.set(e,{position:t,version:o});let s=new Ir.Disposable(()=>{var l,u;(l=this.pendingCompletionRequest.get(e))!=null&&l.position.isEqual(t)&&((u=this.pendingCompletionRequest.get(e))==null?void 0:u.version)===o&&this.pendingCompletionRequest.delete(e)});try{let l=La(Ls(n,Promise.resolve(Ir.commands.executeCommand("vscode.executeCompletionItemProvider",e.uri,t)).then(m=>(m==null?void 0:m.items)||[]))),u=new yt;if(await nc(50),n.isCancellationRequested)return[];let c=await Gv(li.IntellisenseTimeout,new DO,this.provideCompletionItemsFromKernel(e,t,n,i));if(n.isCancellationRequested||!c||!c.length)return[];let d=await po(0,l.promise);jt(this.kernel.kernelConnectionMetadata)&&!l.completed&&u.elapsedTime<li.IntellisenseTimeout+50&&(d=await po(li.IntellisenseTimeout-u.elapsedTime,l.promise));let f=new Set((d||[]).map(m=>{let g=typeof m.label=="string"?m.label:m.label.label,b=m.insertText,v=[g,`.${g}`];return typeof b=="string"&&v.push(b),v}).flat());return c.filter(m=>{let g=typeof m.label=="string"?m.label:m.label.label;return!f.has(g)&&!f.has(`* ${g}`)})}catch(l){if(l instanceof DO)return[];throw l instanceof Ir.CancellationError||C.debug("Completions failed",l),l}finally{s.dispose()}}async provideCompletionItemsFromKernel(e,t,n,i){var v,k,R,P,D;if(n.isCancellationRequested||!((v=this.kernel.session)!=null&&v.kernel))return[];let o=new yt,s={duration:0,timesExceededTimeout:0,requestDuration:0,completionItems:0},a={kernelId:this.kernelId,kernelConnectionType:this.kernel.kernelConnectionMetadata.kind,kernelLanguage:NO(this.kernel),monacoLanguage:this.monacoLanguage,cancelled:!1,kernelStatusBeforeRequest:this.kernel.status,completed:!1,requestSent:!1};if(!jt(this.kernel.kernelConnectionMetadata)&&this.kernel.status!=="idle")return[];let l=e.getText(),u=e.offsetAt(t);a.requestSent=!0;let c=await Ls(n,this.getKernelCompletion(l,u,n));if(C.debug(`Jupyter completion time: ${o.elapsedTime}`),a.cancelled=n.isCancellationRequested,a.completed=!n.isCancellationRequested,a.kernelStatusAfterRequest=this.kernel.status,s.requestDuration=n.isCancellationRequested?0:o.elapsedTime,n.isCancellationRequested)return[];if(((k=c==null?void 0:c.content)==null?void 0:k.status)!=="ok"||((D=(P=(R=c==null?void 0:c.content)==null?void 0:R.matches)==null?void 0:P.length)!=null?D:0)===0)return ure(this.kernel,s,a),[];let d={matches:c.content.matches,cursor:{start:c.content.cursor_start,end:c.content.cursor_end},metadata:c.content.metadata},f=d.metadata?d.metadata._jupyter_types_experimental:[];s.completionItems=d.matches.length,ure(this.kernel,s,a);let m={code:l,cursor:d.cursor,documentRef:new WeakRef(e),position:e.positionAt(d.cursor.start)},g=new Ir.Range(e.positionAt(d.cursor.start),e.positionAt(d.cursor.end)),b=[];return Array.isArray(f)&&f.length>=d.matches.length&&f.every(K=>K&&typeof K.text=="string")?b=c.content.matches.map((K,L)=>{let B=f[L],N=B.type?Zte.get(B.type):Ir.CompletionItemKind.Field,O=new Ir.CompletionItem(K,N);return typeof B.start=="number"&&typeof B.end=="number"?O.range=new Ir.Range(e.positionAt(B.start),e.positionAt(B.end)):O.range=g,O.insertText=B.text,O.sortText=wO(L),jt(this.kernel.kernelConnectionMetadata)&&(K.startsWith("%")||K.startsWith("!"))&&(O.sortText=`ZZZ${O.sortText}`),this.previousCompletionItems.set(O,{...m,originalCompletionItem:JSON.parse(JSON.stringify(O))}),O}):b=d.matches.map((K,L)=>{let B=new Ir.CompletionItem(K);return B.range=g,B.sortText=wO(L),jt(this.kernel.kernelConnectionMetadata)&&(K.startsWith("%")||K.startsWith("!"))&&(B.sortText=`ZZZ${B.sortText}`),this.previousCompletionItems.set(B,{...m,originalCompletionItem:B}),B}),jt(this.kernel.kernelConnectionMetadata)?JEe(i.triggerCharacter,this.allowStringFilterForPython,b,e,t):b}async resolveCompletionItem(e,t){var l;if(!e.range||!((l=this.kernel.session)!=null&&l.kernel))return e;let n=this.previousCompletionItems.get(e);if(!n)return e;let{documentRef:i,position:o,originalCompletionItem:s}=n,a=i.deref();return a?are(e,s,t,this.kernel,this.kernelId,this.monacoLanguage,a,o):e}async getKernelCompletion(e,t,n){var i;if((i=this.kernel.session)!=null&&i.kernel)return jt(this.kernel.kernelConnectionMetadata)?this.getPythonKernelCompletion(e,t,n):Ls(n,this.kernel.session.kernel.requestComplete({code:e,cursor_pos:t}))}async getPythonKernelCompletion(e,t,n){let i=`return get_ipython().kernel.do_complete("${eP(e)}", ${t})`;return{content:await Rv(this.kernel,[i],n)}}},cre=new WeakMap,PO=new WeakMap;function ure(r,e,t){var o;let n=cre.get(r),i=((o=PO.get(r))==null?void 0:o.count)||0;e.duration>=li.IntellisenseTimeout&&PO.set(r,{count:i+1,measures:e,properties:t}),e.timesExceededTimeout=i,n?n.elapsedTime>6e4&&(ne("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n.reset(),PO.delete(r)):(ne("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n=new yt,cre.set(r,new yt),PO.delete(r))}var G9=class extends Pr{constructor(t,n){super();this.kernel=t;this.notebookEditorProvider=n;this.cellCompletionProviders=new WeakMap;this.completionItemsSent=new WeakMap;this.monacoLanguage=kO(this.kernel);this.registerCompletionProvider(),this._register(Ir.workspace.onDidChangeConfiguration(i=>{var o;if(i.affectsConfiguration("jupyter.enableKernelCompletions"))if(dre(this.kernel.notebook.uri))this.completionProvider||this.registerCompletionProvider();else{(o=this.completionProvider)==null||o.dispose(),this.completionProvider=void 0;return}!i.affectsConfiguration("jupyter.completionTriggerCharacters")&&!i.affectsConfiguration("jupyter.pythonCompletionTriggerCharacters")||this.registerCompletionProvider()}))}registerCompletionProvider(){var n;if(!dre(this.kernel.notebook.uri))return;let t=BEe(this.kernel);if(t.length===0){HEe(this.kernel);return}C.trace(`Registering Kernel Completion Provider from kernel ${ut(this.kernel.kernelConnectionMetadata)} for language ${this.monacoLanguage}`),this.allowStringFilterForPython=t.includes("'")||t.includes('"'),(n=this.completionProvider)==null||n.dispose(),this.completionProvider=void 0,this.completionProvider=Ir.languages.registerCompletionItemProvider(this.monacoLanguage,this,...t)}dispose(){var t;super.dispose(),(t=this.completionProvider)==null||t.dispose()}async provideCompletionItems(t,n,i,o){if(this.notebookEditorProvider.findAssociatedNotebookDocument(t.uri)!==this.kernel.notebook)return[];let s=this.cellCompletionProviders.get(t);if(!s){let a=await Rt(this.kernel.kernelConnectionMetadata.id);s=new J9(a,this.kernel,this.monacoLanguage),this.cellCompletionProviders.set(t,s)}return s.allowStringFilterForPython=this.allowStringFilterForPython,s.provideCompletionItems(t,n,i,o).then(a=>(a.forEach(l=>this.completionItemsSent.set(l,s)),a))}async resolveCompletionItem(t,n){let i=this.completionItemsSent.get(t);return i?i.resolveCompletionItem(t,n):t}},Nm=class extends Pr{constructor(t){super();this.kernelCompletionProviders=new WeakMap;t.push(this)}activate(){let t=tt.instance.get(qe);this._register(t.onDidStartKernel(async n=>{var a;if((a=n.session)!=null&&a.kernel&&jt(n.kernelConnectionMetadata)&&n.session.kernel.requestComplete({code:"__file__.",cursor_pos:9}),!kO(n)||this.kernelCompletionProviders.has(n))return;let o=tt.instance.get(Ao),s=this._register(new G9(n,o));this.kernelCompletionProviders.set(n,s)})),this._register(t.onDidDisposeKernel(n=>{var i;(i=this.kernelCompletionProviders.get(n))==null||i.dispose()}))}};Nm=U([(0,TO.injectable)(),x(0,(0,TO.inject)(ve))],Nm);function kO(r){return Uc(NO(r))}function NO(r){let e="";switch(r.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":e=r.kernelConnectionMetadata.kernelModel.language;break;case"startUsingRemoteKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;case"startUsingLocalKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;default:e=r.kernelConnectionMetadata.kernelSpec.language;break}return(e||"").toLowerCase()}function dre(r){return Ir.workspace.getConfiguration("jupyter",r).get("enableKernelCompletions",!1)}function BEe(r){let e=Ir.workspace.getConfiguration("jupyter",r.notebook.uri).get("completionTriggerCharacters");if(!e||typeof e!="object")return[];let t=NO(r),n=kO(r);return t in e?Array.isArray(e[t])?e[t]:[]:n in e?Array.isArray(e[n])?e[n]:[]:[]}function HEe(r){let e=NO(r),t=kO(r);e.toLowerCase()===t.toLowerCase()?C.warn(Ir.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,ut(r.kernelConnectionMetadata),`{${e}`)):C.warn(Ir.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
 or the following: 
jupyter.completionTriggerCharacters = {2}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,ut(r.kernelConnectionMetadata),`{${e}`,`{${t}`))}function qEe(r,e){let t=r.indexOf('"'),n=r.indexOf("'"),i=r.lastIndexOf('"'),o=r.lastIndexOf("'"),s=t>=0?t:n,a=i>=0?i:o;return s>=0&&e.character>s&&e.character<=a}function JEe(r,e,t,n,i){let o=i.character===0?void 0:new Ir.Range(i.line,i.character-1,i.line,i.character),a=(o?n.getText(o):void 0)===".",l=n.getWordRangeAtPosition(a||r==="."?new Ir.Position(i.line,i.character-1):i),u=l&&o?l.union(o):void 0,c=n.lineAt(i.line).text,d=u?n.getText(u):c,f=d.endsWith(".")||a,m=e&&(r=="'"||r=='"'||qEe(c,i));C.ci(`Jupyter completions filtering applied: ${m} on ${c}`);let g=t.map((b,v)=>{let k=typeof b.label=="string"?b.label:b.label.label,R=typeof b.label=="string"?b.label:b.label.label;if(R.startsWith("%")||R.startsWith("!"))return{...b,sortText:`ZZZ${b.sortText}`};if(m)return b;let P=d?R.indexOf(d):-1,D,K,L;if(d&&f&&R.includes(d)){D=R.substring(R.indexOf(d)+(f?d.length:0)),K=R.substring(R.indexOf(d)+d.length);let B=(typeof b.label=="string"?b.label.length:b.label.label.length)-K.length;L=b.range&&"start"in b.range?new Ir.Range(new Ir.Position(b.range.start.line,b.range.start.character+B),b.range.end):b.range}if(!K&&P>0){D=R.substring(R.indexOf(d)+(f?d.length:0)),K=R.substring(R.indexOf(d)+d.length);let B=(typeof b.label=="string"?b.label.length:b.label.label.length)-K.length;L=b.range&&"start"in b.range?new Ir.Range(new Ir.Position(b.range.start.line,b.range.start.character+B),b.range.end):b.range}return D&&K&&L&&(b.label=D,k=K,b.insertText=K,b.filterText=f?`.${K}`:K,b.range=L,b.sortText=wO(v)),k.endsWith("/")?{...b,command:{command:"editor.action.triggerSuggest",title:""}}:(k.includes(" ")&&(k=k.replace(/\\ /g," "),typeof b.label=="string"?b.label=b.label.replace(/\\ /g," "):b.label.label=b.label.label.replace(/\\ /g," ")),m||!k.includes(".")&&!k.endsWith("/")||k.startsWith(".")&&!k.endsWith("/")?b:void 0)}).filter(b=>b!==void 0);return C.ci(`Jupyter completions for ${d} at pos ${i.line}:${i.character} with trigger: ${r}
   ${t.map(b=>b.label).join(",")}`),C.ci(`Jupyter results for ${d} at pos ${i.line}:${i.character} with trigger: ${r}
   ${g.map(b=>b.label).join(",")}`),g}function pre(r,e){r.addSingleton(Ve,iE),r.addSingleton(Nm,Nm),r.addBinding(Nm,Ve)}p();var sE=oe(he());var fre=require("vscode");var oE=class{constructor(e,t,n){this.extensionChecker=e;this.disposables=t;this.kernelProvider=n}activate(){this.extensionChecker.onPythonExtensionInstallationStatusChanged(this.onPythonExtensionInstallationStatusChanged,this,this.disposables)}async onPythonExtensionInstallationStatusChanged(e){e==="installed"&&this.anyKernelsAreActive()&&fre.window.showInformationMessage(W.pythonExtensionInstalled,Ue.ok).then(E,E)}anyKernelsAreActive(){return this.kernelProvider.kernels.length>0}};oE=U([(0,sE.injectable)(),x(0,(0,sE.inject)(vo)),x(1,(0,sE.inject)(ve)),x(2,(0,sE.inject)(qe))],oE);p();var RO=oe(he()),Tu=require("vscode");var GEe=/^\s*(from (?<fromImport>\w+)(?:\.\w+)* import \w+(?:, \w+)*(?: as \w+)?|import (?<importImport>\w+(?:, \w+)*)(?: as \w+)?)$/,YEe=1e3,$Ee=hn(),aE=class{constructor(e,t=1e3){this.pendingChecks=new yu;this.disposables=new En;this.sentMatches=new Set;this.processedNotebookCells=new WeakMap;e.push(this.disposables),this.disposables.add(new Tu.Disposable(()=>Ce(this.pendingChecks.values()))),this.isTelemetryDisabled=MN(),this.disposables.add(Tu.workspace.onDidOpenNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(Tu.workspace.onDidCloseNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(Tu.workspace.onDidSaveNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave")));let n=this.disposables.add(new rc(t));this.disposables.add(Mr.onDidChangeNotebookCellExecutionState(i=>{n.trigger(()=>{i.state==2&&!this.isTelemetryDisabled&&this.checkNotebookCell(i.cell,"onExecution").catch(E)})},this)),this.disposables.add(ON(i=>this.isTelemetryDisabled=i))}activate(){Tu.workspace.notebookDocuments.forEach(e=>this.checkNotebookDocument(e,"onOpenCloseOrSave"))}getDocumentLines(e){let t=[];for(let n=0;n<Math.min(YEe,e.lineCount);n++){let i=e.lineAt(n);i.isEmptyOrWhitespace||t.push(i.text.trim())}return t}onOpenedOrClosedNotebookDocument(e,t){!hr(e)||this.isTelemetryDisabled||this.scheduleCheck(e.uri,this.checkNotebookDocument.bind(this,e,t))}scheduleCheck(e,t){let n=this.pendingChecks.get(e);if(n&&(n.dispose(),this.pendingChecks.delete(e)),$Ee)t();else{let i=setTimeout(t,5e3);this.pendingChecks.set(e,new Tu.Disposable(()=>clearTimeout(i)))}}async checkNotebookDocument(e,t){!hr(e)||this.isTelemetryDisabled||await Promise.all(e.getCells().map(async n=>this.checkNotebookCell(n,t)))}async checkNotebookCell(e,t){if(!(!hr(e.notebook)||e.kind!==Tu.NotebookCellKind.Code||e.document.languageId!==Ye||this.processedNotebookCells.get(e)===e.document.version))try{this.processedNotebookCells.set(e,e.document.version);let n=e.notebook.notebookType===St?"notebook":"interactive";await this.sendTelemetryForImports(this.getDocumentLines(e.document),n,t)}catch(n){if(!ci)throw n}}lookForImports(e){let t=[];try{for(let n of e){if(!n.includes("import")&&!n.includes("from"))continue;let i=n?GEe.exec(n):null;i!==null&&i.groups!==void 0&&(i.groups.fromImport!==void 0?t.push(i.groups.fromImport):i.groups.importImport!==void 0&&t.push(...i.groups.importImport.split(",").map(o=>o.trim())))}}catch(n){}return t}async sendTelemetryForImports(e,t,n){await Promise.all(this.lookForImports(e).map(async i=>{let o=`${i}_${t||""}_${n}`;if(this.sentMatches.has(o))return;this.sentMatches.add(o);let s=await Rt(i);ne("HASHED_PACKAGE_NAME",void 0,{hashedNamev2:s,resourceType:t,when:n})}))}};aE=U([(0,RO.injectable)(),x(0,(0,RO.inject)(ve))],aE);p();var on=oe(he()),hre=oe(Zg()),gt=require("vscode");p();var ku=require("vscode");var AO=class{constructor(e,t,n,i,o){this.configService=e;this.agentCreator=t;this.requestCreator=n;this.serverUriStorage=i;this.disposables=o;this.savedConnectInfo=new Map;this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}getPasswordConnectionInfo(e){if(!e.url||e.url.length<1)throw new Error("Invalid URL");let t=lE(e.url),n=e.disposables||[],i=!Array.isArray(e.disposables),o=this.savedConnectInfo.get(e.handle);return o||(o=this.getJupyterConnectionInfo({url:t,isTokenEmpty:e.isTokenEmpty,disposables:n,validationErrorMessage:e.validationErrorMessage}).then(s=>((!s||s.requiresPassword&&Object.keys(s).length===1)&&(C.warn(`Password for ${t} was invalid.`),this.savedConnectInfo.delete(e.handle)),s)),o.catch(()=>this.savedConnectInfo.delete(e.handle)),o.finally(()=>{i&&Ce(n)}).catch(E),this.savedConnectInfo.set(e.handle,o)),o}async getJupyterConnectionInfo(e){let t,n,i,o,s=await this.needPassword(e.url);if(s||e.isTokenEmpty){if(s&&e.isTokenEmpty){let a=ku.window.createInputBox();e.disposables.push(a),a.title=W.jupyterSelectPasswordTitle,a.placeholder=W.jupyterSelectPasswordPrompt,a.ignoreFocusOut=!0,a.password=!0,a.validationMessage=e.validationErrorMessage||"",a.show(),a.buttons=[ku.QuickInputButtons.Back],o=await new Promise((l,u)=>{a.onDidTriggerButton(c=>{c===ku.QuickInputButtons.Back&&u(ze.back)},this,e.disposables),a.onDidChangeValue(()=>a.validationMessage="",this,e.disposables),a.onDidAccept(()=>l(a.value),this,e.disposables),a.onDidHide(()=>u(ze.cancel),this,e.disposables)})}if(typeof o===void 0&&!o&&e.isTokenEmpty)throw new ku.CancellationError;if(o||e.isTokenEmpty)if(t=await this.getXSRFToken(e.url,""),t){let a=await this.getSessionCookie(e.url,t,o||"");n=a.sessionCookieName,i=a.sessionCookieValue}else n="authservice_session",i=o,t=await this.getXSRFToken(e.url,`${n}=${i}`);else return{requiresPassword:s}}else return{requiresPassword:s};return t&&n&&(i||e.isTokenEmpty)?(ne("DS_INTERNAL.GET_PASSWORD_SUCCESS"),{requestHeaders:{Cookie:`_xsrf=${t}; ${n}=${i||""}`,"X-XSRFToken":t},requiresPassword:s}):(ne("DS_INTERNAL.GET_PASSWORD_FAILURE"),{requiresPassword:s})}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async getXSRFToken(e,t){var a;let n,i,o=new URL("login?",lE(e)).toString();t!=""?(o=new URL("tree",lE(e)).toString(),i={Connection:"keep-alive",Cookie:t}):i={Connection:"keep-alive"};let s=await this.makeRequest(o,{method:"get",redirect:"manual",headers:i});if(s!==void 0&&s.ok){let l=this.getCookies(s);l.has("_xsrf")&&(n=(a=l.get("_xsrf"))==null?void 0:a.split(";")[0])}return n}async needPassword(e){let t=await this.makeRequest(lE(e),{method:"get",redirect:"follow",headers:{Connection:"keep-alive"}});if(t.status===200&&t.redirected){if(t.url.toLowerCase().includes("/login?"))return!0;if(t.url.toLowerCase().includes("/lab?"))return!1}let n=new URL("tree?",lE(e)).toString();return t=await this.makeRequest(n,{method:"get",redirect:"manual",headers:{Connection:"keep-alive"}}),t.status===404?(C.error(`Jupyter Server not found at ${e}, got 404 for ${n}`),!1):t.status!==200}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(i.message.indexOf("reason: self signed certificate")>=0){let o=W.jupyterSelfCertEnable,s=W.jupyterSelfCertClose,a=await ku.window.showErrorMessage(W.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,ku.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}async getSessionCookie(e,t,n){let i,o,s=new URLSearchParams;s.append("_xsrf",t),s.append("password",n);let a=await this.makeRequest(new URL("login?",lE(e)).toString(),{method:"post",headers:{Cookie:`_xsrf=${t}`,Connection:"keep-alive","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},body:s.toString(),redirect:"manual"});if(a.status===302){let l=this.getCookies(a);if(l.size>0){let u=l.entries().next().value;u&&(i=u[0],o=u[1])}}return{sessionCookieName:i,sessionCookieValue:o}}getCookies(e){let t=new Map,i=(e.headers.raw?e.headers.raw():e.headers)["set-cookie"];return i&&i.forEach(o=>{let s=o.substring(0,o.indexOf("=")),a=o.substring(o.indexOf("=")+1);t.set(s,a)}),t}onDidRemoveServers(e){e.forEach(t=>{t.id.startsWith("_builtin")&&this.savedConnectInfo.delete(t.handle)})}};function lE(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}p();var OO=require("vscode");var MO=class{constructor(e,t,n){this.configService=e;this.agentCreator=t;this.requestCreator=n}async isJupyterHub(e){try{if(e.toLowerCase().includes("/user/")&&e.includes("token="))return!1;if(e.toLowerCase().includes("/user/")&&!e.includes("token="))return!0;let t=await this.makeRequest(new URL("hub/api",zEe(e)).toString(),{method:"get"});if(t.status!==200)return!1;try{let n=await t.json();return C.trace(`JupyterHub version is ${n&&n.version} for url ${e}`),n&&n.version}catch(n){}return!1}catch(t){return C.debug(`Error in detecting whether url is isJupyterHub: ${t}`),!1}}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(i.message.indexOf("reason: self signed certificate")>=0){let o=W.jupyterSelfCertEnable,s=W.jupyterSelfCertClose,a=await OO.window.showErrorMessage(W.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,OO.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}};function zEe(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}var LO="user-jupyter-server-uri-list-version2";var QEe="DataScienceAllowInsecureConnections",cE=class extends Pr{constructor(t,n,i,o,s,a,l,u,c,d,f,m=UE){super();this.jupyterConnection=n;this.context=c;this.fs=d;this.jupyterServerProviderRegistry=f;this.id=m;this.extensionId=Je;this.documentation=gt.Uri.parse("https://aka.ms/vscodeJuptyerExtKernelPickerExistingServer");this.displayName=W.UserJupyterServerUrlProviderDisplayName;this.detail=W.UserJupyterServerUrlProviderDetail;this._onDidChangeHandles=this._register(new gt.EventEmitter);this.onDidChangeHandles=this._onDidChangeHandles.event;this._onDidChangeServers=this._register(new gt.EventEmitter);this.onDidChangeServers=this._onDidChangeServers.event;a.push(this),this.newStorage=new XP(i),this.secureConnectionValidator=new QP(s),this.jupyterServerUriInput=new zP(u),this.jupyterServerUriDisplayName=new Y9,this.jupyterPasswordConnect=new AO(t,l,u,o,a),this.jupyterHubPasswordConnect=new MO(t,l,u)}activate(){let t=this._register(this.jupyterServerProviderRegistry.createJupyterServerCollection(Je,this.id,this.displayName,this));t.commandProvider=this,t.documentation=this.documentation,this._register(this.onDidChangeHandles(()=>this._onDidChangeServers.fire(),this)),this._register(gt.commands.registerCommand("dataScience.ClearUserProviderJupyterServerCache",async()=>{await Promise.all([this.newStorage.clear().catch(E),this.fs.delete(gt.Uri.joinPath(this.context.globalStorageUri,PS)).catch(E)]),this._onDidChangeHandles.fire()})),this.initializeServers().catch(E)}async resolveJupyterServer(t,n){let i=await this.getServerUri(t.id);return{...t,connectionInformation:{id:t.id,label:t.label,baseUrl:gt.Uri.parse(i.baseUrl),token:i.token,headers:i.authorizationHeader,mappedRemoteNotebookDir:i.mappedRemoteNotebookDir?gt.Uri.file(i.mappedRemoteNotebookDir):void 0}}}async handleCommand(t,n){let i=new gt.CancellationTokenSource;this._register(new gt.Disposable(()=>{i.cancel(),i.dispose()}));try{let o="url"in t?t.url:void 0,s=await this.captureRemoteJupyterUrl(i.token,o);if(!s||s===ze.cancel)throw new gt.CancellationError;if(s&&s instanceof ze)return;let l=(await this.provideJupyterServers(i.token)).find(u=>u.id===s);if(!l)throw new Error(`Server ${s} not found`);return l}catch(o){if(o instanceof gt.CancellationError)throw o;C.error("Failed to select a Jupyter Server",o);return}finally{i.cancel(),i.dispose()}}async provideCommands(t,n){let i="";try{t=(t||"").trim(),["http:","https:"].includes(new URL(t.trim()).protocol.toLowerCase())&&(i=t)}catch(o){}return i?[{label:W.connectToToTheJupyterServer(i),url:i}]:[{label:W.jupyterSelectUriCommandLabel,canBeAutoSelected:!0}]}async provideJupyterServers(t){return await this.initializeServers(),(await this.newStorage.getServers(!1)).map(i=>({id:i.handle,label:i.serverInfo.displayName}))}async removeJupyterServer(t){await this.initializeServers(),await this.newStorage.remove(t.id),this._onDidChangeHandles.fire()}initializeServers(){if(this._cachedServerInfoInitialized)return this._cachedServerInfoInitialized;let t=Re();return this._cachedServerInfoInitialized=t.promise,(async()=>{this.newStorage.getServers(!1).catch(E),t.resolve()})().then(()=>t.resolve(),n=>t.reject(n)).catch(E),this._cachedServerInfoInitialized}recommendInstallingJupyterHubExtension(){throw gt.extensions.getExtension(Hv)?gt.window.showInformationMessage(W.useJupyterHubExtension,{modal:!0,detail:W.useJupyterHubExtensionDetail}).then(()=>{gt.commands.executeCommand("notebook.selectKernel",{notebookEditor:gt.window.activeNotebookEditor}).then(E,E)},E):gt.window.showInformationMessage(W.installJupyterHub,{modal:!0,detail:W.installJupyterHubDetail},Ue.install,Ue.moreInfo).then(t=>{t===Ue.install?gt.commands.executeCommand("workbench.extensions.installExtension",Hv,{context:{skipWalkthrough:!0}}).then(E,E):t===Ue.moreInfo&&gt.env.openExternal(gt.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter-hub")).then(E,E)},E),new gt.CancellationError}async captureRemoteJupyterUrl(t,n=""){await this.initializeServers();let i=[],o={baseUrl:"",displayName:"",token:""},s="",a=!1,l=!1,u,c="Get Url",d="Get Url",f=n,m=!1;if(n){let g=await this.jupyterServerUriInput.parseUserUriAndGetValidationError(n);typeof g.validationError=="string"?(s=g.validationError,c="Get Url"):(m=!0,o=g.jupyterServerUri,c="Check Passwords")}try{let g=!1;for(;;)try{if(u=(0,hre.default)(),c==="Get Url"){m=!1,c="Check Passwords",d=void 0;let v=s;s="";let k=await this.jupyterServerUriInput.getUrlFromUser(f||n,v,i);o=k.jupyterServerUri,f=k.url}if(t.isCancellationRequested)return ze.cancel;let b=[];if(c==="Check Passwords"){c="Check Insecure Connections",d=m&&n?void 0:"Get Url";try{let v=s;if(s="",!o.token&&await this.jupyterHubPasswordConnect.isJupyterHub(o.baseUrl))return this.recommendInstallingJupyterHubExtension(),ze.cancel;let k=await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:u,validationErrorMessage:v,disposables:b});a=k.requiresPassword,o.authorizationHeader=k.requestHeaders,g=!1}catch(v){if(g=!1,v instanceof gt.CancellationError||v==ze.back||v==ze.cancel)throw v;if(!Os.isSelfCertsError(v)){if(!tu.isSelfCertsExpiredError(v)){Av(u,o.baseUrl,!1,"ConnectionFailure");let k=/(https?:\/\/[^\s]+)/g,R=(v.message||v.toString()).replace(k,P=>`[${P}](${P})`);if(s=(zr()?W.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:W.remoteJupyterConnectionFailedWithoutServerWithError)(R),o.token.length>0&&(v.message||"").toLowerCase()==="Failed to fetch".toLowerCase())g=!0;else{c="Get Url";continue}}}}finally{b.forEach(v=>this._register(v))}}if(t.isCancellationRequested)return ze.cancel;if(c==="Check Insecure Connections"&&(c="Verify Connection",d=a&&o.token.length===0?"Check Passwords":"Get Url",d==="Get Url"&&(d=m&&n?void 0:"Get Url"),!a&&o.token.length===0&&new URL(o.baseUrl).protocol.toLowerCase()==="http:"&&(l=!0,Ce(b),!await this.secureConnectionValidator.promptToUseInsecureConnections())))return Av(u,o.baseUrl,!1,"InsecureHTTP"),ze.cancel;if(t.isCancellationRequested)return ze.cancel;if(c==="Verify Connection")try{c="Get Display Name",await this.jupyterConnection.validateRemoteUri({id:this.id,handle:u,extensionId:Je},o,!0)}catch(v){if(C.warn("Uri verification error",v),g&&s){c="Get Url";continue}if(v instanceof gt.CancellationError||v==ze.back||v==ze.cancel)throw v;if(Os.isSelfCertsError(v)){s=W.jupyterSelfCertFailErrorMessageOnly,c="Get Url",Av(u,o.baseUrl,!1,"SelfCert");continue}else if(tu.isSelfCertsExpiredError(v)){s=W.jupyterSelfCertExpiredErrorMessageOnly,c="Get Url",Av(u,o.baseUrl,!1,"ExpiredCert");continue}else if(a&&o.token.length===0){s=W.passwordFailure,c="Check Passwords",Av(u,o.baseUrl,!1,"AuthFailure");continue}else{Av(u,o.baseUrl,!1,"ConnectionFailure");let k=/(https?:\/\/[^\s]+)/g,R=(v.message||v.toString()).replace(k,P=>`[${P}](${P})`);s=(zr()?W.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:W.remoteJupyterConnectionFailedWithoutServerWithError)(R),c="Get Url";continue}}finally{Ce(b)}if(t.isCancellationRequested)return ze.cancel;if(c==="Get Display Name"){Ce(b),d=l?"Check Insecure Connections":a&&o.token.length===0?"Check Passwords":"Get Url",d==="Get Url"&&(d=m&&n?void 0:"Get Url"),o.displayName=await this.jupyterServerUriDisplayName.getDisplayName(u,o.displayName||new URL(o.baseUrl).hostname);break}}catch(b){if(b instanceof gt.CancellationError||b===ze.cancel)return ze.cancel;if(b===ze.back){if(!d)return ze.back;c=d;continue}throw b}return t.isCancellationRequested?ze.cancel:(await this.addNewServer({handle:u,uri:f,serverInfo:o}),xA({extensionId:this.extensionId,id:this.id,handle:u},o.displayName),Av(u,o.baseUrl,!1),u)}catch(g){if(g instanceof gt.CancellationError)return ze.cancel;throw g}finally{Ce(i)}}async addNewServer(t){await this.newStorage.add(t),this._onDidChangeHandles.fire()}async getServerUri(t){let i=(await this.newStorage.getServers(!1)).find(l=>l.handle===t);if(!i)throw new Error("Server not found");let o=i.serverInfo,s=this.jupyterServerUriDisplayName.displayNamesOfHandles.get(t);s&&(o.displayName=s);let a=Object.assign({},o);try{let l=await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:t});a=Object.assign({},o,{authorizationHeader:l.requestHeaders||o.authorizationHeader})}catch(l){C.error("Failed to validate Password info",l)}return a}};cE=U([(0,on.injectable)(),x(0,(0,on.inject)(Ke)),x(1,(0,on.inject)(fn)),x(2,(0,on.inject)(oP)),x(3,(0,on.inject)(dr)),x(4,(0,on.inject)(Et)),x(4,(0,on.named)(rr)),x(5,(0,on.inject)(ve)),x(6,(0,on.inject)(OR)),x(6,(0,on.optional)()),x(7,(0,on.inject)(Jg)),x(8,(0,on.inject)(st)),x(9,(0,on.inject)(Pt)),x(10,(0,on.inject)(sr)),x(11,(0,on.optional)()),x(11,(0,on.inject)(Date.now().toString()))],cE);var zP=class{constructor(e){this.requestCreator=e}async getUrlFromUser(e,t="",n){if(!e&&!CD)try{let s=await gt.env.clipboard.readText(),a=s.trim().startsWith("https://github.com/")?void 0:gt.Uri.parse(s.trim(),!0);e=s&&a&&a.scheme.toLowerCase().startsWith("http")?s:""}catch(s){e=""}let i=gt.window.createInputBox();n.push(i),i.title=W.jupyterSelectUriInputTitle,i.placeholder=W.jupyterSelectUriInputPlaceholder,i.value=e,i.validationMessage=t,i.buttons=[gt.QuickInputButtons.Back],i.ignoreFocusOut=!0,i.show();let o=Re();return i.onDidChangeValue(()=>i.validationMessage="",this,n),i.onDidHide(()=>o.reject(ze.cancel),this,n),i.onDidTriggerButton(s=>{s===gt.QuickInputButtons.Back&&o.reject(ze.back)},this,n),i.onDidAccept(async()=>{let s=await this.parseUserUriAndGetValidationError(i.value);if(typeof s.validationError=="string"){i.validationMessage=s.validationError;return}o.resolve(s)}),o.promise}async parseUserUriAndGetValidationError(e){let t=e.trim().replace(/\/(lab|tree)(\??)$/,""),n=$9(t,"");return n?(n.baseUrl=await XEe(t,this.requestCreator)||n.baseUrl,!t.toLowerCase().startsWith("http:")&&!t.toLowerCase().startsWith("https:")?{validationError:W.jupyterSelectURIMustBeHttpOrHttps}:{jupyterServerUri:n,url:t,validationError:void 0}):{validationError:W.jupyterSelectURIInvalidURI}}};zP=U([x(0,(0,on.inject)(Jg))],zP);async function XEe(r,e){var t;try{if(r=((t=$9(r,""))==null?void 0:t.baseUrl)||r,new URL(r).pathname==="/")return r;let n=r.indexOf("token=")>0?r.substring(0,r.indexOf("token=")):r,s=(await e.getFetchMethod()(n,{method:"GET",redirect:"manual"})).headers.get("location");if(s&&s.includes("login?"))return s.substring(0,s.indexOf("login?"))}catch(n){C.debug("Unable to identify the baseUrl of the Jupyter Server",n)}}function Av(r,e,t,n){e=e.trim().toLowerCase();let i=Vt({handle:r,extensionId:Je,id:UE});Promise.all([Rt(e.toLowerCase()),Rt(i.toLowerCase())]).then(([o,s])=>{ne("DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",void 0,{serverIdHash:s,failed:!!n,baseUrlHash:o,isJupyterHub:t,isLocalHost:["localhost","127.0.0.1","::1"].includes(new URL(e).hostname),reason:n})}).catch(o=>C.error(`Failed to hash remote url ${e}`,o))}var Y9=class{constructor(){this.displayNamesOfHandles=new Map}async getDisplayName(e,t){let n=[];try{let i=gt.window.createInputBox();n.push(i),i.ignoreFocusOut=!0,i.title=W.jupyterRenameServer,i.value=t,i.placeholder=W.jupyterServerUriDisplayNameInputPlaceholder,i.buttons=[gt.QuickInputButtons.Back],i.show();let o=Re();return n.push(i.onDidHide(()=>o.reject(ze.cancel))),i.onDidTriggerButton(s=>{s===gt.QuickInputButtons.Back&&o.reject(ze.back)},this,n),i.onDidAccept(()=>{let s=i.value.trim()||t;this.displayNamesOfHandles.set(e,s),o.resolve(s)},this,n),await o.promise}finally{Ce(n)}}},QP=class{constructor(e){this.globalMemento=e}async promptToUseInsecureConnections(){if(this.globalMemento.get(QEe,!1))return!0;let e=[],t=Re();try{let n=gt.window.createQuickPick();return e.push(n),n.canSelectMany=!1,n.ignoreFocusOut=!0,n.title=W.insecureSessionMessage,n.buttons=[gt.QuickInputButtons.Back],n.items=[{label:Ue.bannerLabelYes},{label:Ue.bannerLabelNo}],n.show(),e.push(n.onDidHide(()=>t.reject(ze.cancel))),n.onDidTriggerButton(i=>{i===gt.QuickInputButtons.Back&&t.reject(ze.back)},this,e),n.onDidAccept(()=>t.resolve(n.selectedItems.some(i=>i.label===Ue.bannerLabelYes)),this,e),await t.promise}finally{Ce(e)}}};QP=U([x(0,(0,on.inject)(Et)),x(0,(0,on.named)(rr))],QP);function $9(r,e){if(!r.startsWith(nt.REMOTE_URI))try{let t=new URL(r);return{baseUrl:`${t.protocol}//${t.host}${t.pathname==="/lab"||t.pathname==="/tree"?"":t.pathname}`,token:t.searchParams.get("token")||"",displayName:e||t.hostname}}catch(t){C.error(`Failed to parse URI ${r}`,t);return}}function mre(r){return r.map(e=>({handle:e.handle,uri:e.uri,displayName:e.serverInfo.displayName}))}function ZEe(r){let e=[];return r.forEach(t=>{let n=$9(t.uri,t.displayName);n&&e.push({handle:t.handle,uri:t.uri,serverInfo:n})}),e}var XP=class{constructor(e){this.encryptedStorage=e;this.updatePromise=Promise.resolve()}async getServers(e){if(this.servers&&!e)return this.servers;let t=await this.encryptedStorage.retrieve(li.JupyterServerRemoteLaunchService,LO);if(!t||t==="[]")return[];try{return this.servers=ZEe(JSON.parse(t))}catch(n){return[]}}async add(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e.handle).concat(e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).concat(e);this.servers=t,await this.encryptedStorage.store(li.JupyterServerRemoteLaunchService,LO,JSON.stringify(mre(t)))}).catch(E))}async remove(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).filter(n=>n.handle!==e);return this.servers=t,this.encryptedStorage.store(li.JupyterServerRemoteLaunchService,LO,JSON.stringify(mre(t)))}).catch(E))}async clear(){this.servers=[],await(this.updatePromise=this.updatePromise.then(async()=>{this.servers=[],await this.encryptedStorage.store(li.JupyterServerRemoteLaunchService,LO,void 0)}).catch(E))}};XP=U([x(0,(0,on.inject)(oP))],XP);p();var ZP=oe(he()),dE=require("vscode");var uE=class extends Pr{constructor(t,n){super();this.uriProviderRegistration=t;this.serverUriStorage=n;this.handleMappings=new Map;this._onDidChangeHandles=this._register(new dE.EventEmitter);this.extensionId=Je;this.id=cD;this.displayName="Jupyter Server for Testing";this.onDidChangeServers=this._onDidChangeHandles.event}async provideJupyterServers(t){return Array.from(this.handleMappings.values()).map(n=>n.server)}async resolveJupyterServer(t,n){return t}activate(){this._register(this.uriProviderRegistration.createJupyterServerCollection(Je,this.id,this.displayName,this)),this._register(dE.commands.registerCommand("jupyter.selectjupyteruri",this.selectJupyterUri,this))}async selectJupyterUri(t){var u;C.info(`Setting Jupyter Server URI to remote: ${t}`);let n=t.toString(!0),i=new URL(n),o=dE.Uri.parse(`${i.protocol}//${i.host}${i.pathname==="/lab"?"":i.pathname}`),s=(u=i.searchParams.get("token"))!=null?u:"",a=await Ba(t.toString(!0),"SHA-1"),l={label:this.displayName,id:a,connectionInformation:{baseUrl:o,token:s}};this.handleMappings.set(a,{uri:t,server:l}),await this.serverUriStorage.add({id:this.id,handle:a,extensionId:Je}),this._onDidChangeHandles.fire()}};uE=U([(0,ZP.injectable)(),x(0,(0,ZP.inject)(sr)),x(1,(0,ZP.inject)(dr))],uE);p();var KO=oe(he());var eD=require("vscode");var pE=class{constructor(e){this.disposables=e}activate(){this.registerCommandsIfTrusted()}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){eD.workspace.isTrusted&&this.registerCommand(le.ContinueEditSessionInCodespace,this.continueEditSessionInCodespace)}registerCommand(e,t){let n=eD.commands.registerCommand(e,t,this);this.disposables.push(n)}async continueEditSessionInCodespace(){await eD.commands.executeCommand("_workbench.editSessions.actions.continueEditSession.github.codespaces.continueEditSessionInCodespaceWithJupyterServer")}};pE=U([(0,KO.injectable)(),x(0,(0,KO.inject)(ve))],pE);p();var gre=oe(he());var vre=require("vscode");var fE=class{activate(){this.eagerlyActivateOtherExtensions().catch(E)}async eagerlyActivateOtherExtensions(){await Promise.all(vre.extensions.all.filter(e=>{var t,n;return(n=(t=e.packageJSON)==null?void 0:t.contributes)==null?void 0:n.pythonRemoteServerProvider}).map(e=>e.isActive?Promise.resolve():e.activate().then(E,E)))}};fE=U([(0,gre.injectable)()],fE);p();var FO=oe(he()),yre=require("vscode");var mE=class{constructor(e){this.uriStorage=e}activate(){yre.commands.registerCommand("jupyter.getUsedAzMLServerHandles",()=>{let e=[];return this.uriStorage.all.forEach(n=>{n.provider.extensionId.toLowerCase()==="ms-toolsai.vscode-ai".toLowerCase()&&e.push(n.provider)}),e})}};mE=U([(0,FO.injectable)(),x(0,(0,FO.inject)(dr))],mE);p();var up=require("vscode");var bre=oe(he());var hE=class{activate(){let e=tt.instance.get(ve),t=new En;e.push(t),e.push(up.commands.registerCommand("jupyter.manageAccessToKernels",()=>eCe(t)))}};hE=U([(0,bre.injectable)()],hE);async function eCe(r){let e=await bQ(),t=[];Array.from(e.entries()).forEach(([s])=>{var l,u;let a=(u=(l=up.extensions.getExtension(s))==null?void 0:l.packageJSON)==null?void 0:u.displayName;a&&t.push({label:a,description:s,extensionId:s})});let n=[];r.add({dispose:()=>{n=Ce(n)}});let i=up.window.createQuickPick();i.title=up.l10n.t("Manage Access To Jupyter Kernels"),i.placeholder=up.l10n.t("Choose which extensions can access Jupyter Kernels"),i.items=t,i.selectedItems=t.filter(s=>e.get(s.extensionId)===!0),i.canSelectMany=!0,i.ignoreFocusOut=!1;let o=!1;n.push(i),i.show(),await Promise.race([_x(i.onDidAccept,void 0,n).then(()=>o=!0),_x(i.onDidHide,void 0,n)]),o&&(await IQ(i.selectedItems.map(s=>s.extensionId)),n=Ce(n))}p();var _re=require("vscode");p();var UO=class{constructor(){this.cache=new Map;this.executionCount=0}getResults(e,t){return this.executionCount!==e&&(this.cache.clear(),this.executionCount=e),this.cache.get(t)}setResults(e,t,n){if(this.executionCount<e)this.cache.clear(),this.executionCount=e;else if(this.executionCount>e)return;this.cache.set(t,n)}},Ire=UO,Sre=UO;var Mv=oe(he());var gE=class{constructor(e,t){this.variables=e;this.kernelProvider=t;this.variableResultCache=new Ire;this.variableSummaryCache=new Sre;this.runningKernels=new Set;this._onDidChangeVariables=new _re.EventEmitter;this.onDidChangeVariables=this._onDidChangeVariables.event;this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this)}onKernelStatusChanged({kernel:e}){if("variableProvider"in e.controller&&e.controller.variableProvider!==this)return;let t=e.notebook.uri.toString(),n=this.runningKernels.has(t);e.status==="idle"&&!n?this.runningKernels.add(t):e.status!=="busy"&&e.status!=="idle"&&n&&(this.runningKernels.delete(t),this._onDidChangeVariables.fire(e.notebook))}_getVariableResultCacheKey(e,t,n){let i="",o=t;return o&&(i=`${o.name}.${o.propertyChain.join(".")}[[${n}`),`${e}:${i}`}async*provideVariables(e,t,n,i,o){if(o.isCancellationRequested)return;let s=this.kernelProvider.get(e);if(!s||s.status==="dead"||s.status==="terminating")return;let a=this.kernelProvider.getKernelExecution(s).executionCount,l=this._getVariableResultCacheKey(e.uri.toString(),t,i),u=this.variableResultCache.getResults(a,l);if(t){let c=t;if(!u&&c.getChildren)u=(await c.getChildren(i,o)).map(f=>this.createVariableResult(f,s)),this.variableResultCache.setResults(a,l,u);else if(!u)return;for(let d of u)yield d;if(n===2&&c.count&&u.length>0&&c.count>i+u.length)for await(let d of this.provideVariables(e,t,n,i+u.length,o))yield d}else{u||(u=(await this.variables.getAllVariableDiscriptions(s,void 0,i,o)).map(d=>this.createVariableResult(d,s)),this.variableResultCache.setResults(a,l,u));for(let c of u)yield c}}_getVariableSummaryCacheKey(e,t){return`${e}:${t.name}`}async*provideVariablesWithSummarization(e,t,n,i,o){var l;let s=this.kernelProvider.get(e),a=this.provideVariables(e,t,n,i,o);for await(let u of a)if(s&&s.status!=="dead"&&s.status!=="terminating"){let c=this._getVariableSummaryCacheKey(e.uri.toString(),u.variable),d=this.kernelProvider.getKernelExecution(s).executionCount,f=this.variableSummaryCache.getResults(d,c);f==null&&u.variable.type==="pandas.core.frame.DataFrame"&&(f=await this.variables.getVariableValueSummary({name:u.variable.name,value:u.variable.value,supportsDataExplorer:!1,type:(l=u.variable.type)!=null?l:"",size:0,count:0,shape:"",truncated:!0},s,o),this.variableSummaryCache.setResults(d,c,f!=null?f:null)),yield{hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount,variable:{name:u.variable.name,value:u.variable.value,expression:u.variable.expression,type:u.variable.type,language:u.variable.language,summary:f!=null?f:""}}}}createVariableResult(e,t){var s;let n=(s=e.count)!=null?s:0,i=!!e.hasNamedChildren,o={getChildren:(a,l)=>this.getChildren(o,a,t,l),expression:tCe(e.root,e.propertyChain),...e};return{variable:o,hasNamedChildren:i,indexedChildrenCount:n}}async getChildren(e,t,n,i){let o=e;return await this.variables.getAllVariableDiscriptions(n,o,t,i)}};gE=U([(0,Mv.injectable)(),x(0,(0,Mv.inject)(Oi)),x(0,(0,Mv.named)(nt.KERNEL_VARIABLES)),x(1,(0,Mv.inject)(qe))],gE);function tCe(r,e){let t=r;for(let n of e)typeof n=="string"?t+=`.${n}`:t+=`[${n}]`;return t}p();var dp=oe(he()),WO=require("vscode");var rCe=/Type:\s*(\w+)/,nCe=/Value:\s*(.*)/,iCe=/String form:\s*([\s\S]+?)\n/,oCe=/Docstring:\s*(.*)/,sCe=/Length:\s+(.*)/,aCe=/^\s+\[(\d+) rows x (\d+) columns\]/m,lCe=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]),vE=class{constructor(e,t,n,i){this.configService=e;this.disposables=n;this.kernelProvider=i;this.variableRequesters=new Map;this.cachedVariables=new Map;this.refreshEventEmitter=new WO.EventEmitter;this.variableRequesters.set(Ye,t)}get refreshRequired(){return this.refreshEventEmitter.event}async getAllVariableDiscriptions(e,t,n,i){let o=eu(e.kernelConnectionMetadata)||Ye,s=this.variableRequesters.get(o);return s?s.getAllVariableDiscriptions(e,t,n,i):[]}async getVariables(e,t){return this.getVariablesBasedOnKernel(t,e)}async getMatchingVariable(e,t,n){let i=this.cachedVariables.get(t.uri.toString());if(i){let o=i.variables.find(s=>s.name===e);return o&&!o.value&&(o=await this.getVariableValueFromKernel(o,t,n)),o}else{let o=await this.getVariableNamesAndTypesFromKernel(t,n);if(o){let s=o.find(a=>a.name===e);if(s)return this.getVariableValueFromKernel({name:e,value:void 0,supportsDataExplorer:!1,type:s.type,fullType:s.fullType,size:0,count:0,shape:"",truncated:!0},t,n)}}}async getVariableValueSummary(e,t,n){if(!t)return;let i=eu(t==null?void 0:t.kernelConnectionMetadata)||Ye,o=this.variableRequesters.get(i);if(o)return o.getVariableValueSummary(e,t,n)}async getDataFrameInfo(e,t,n,i){if(!t)return e;let o=eu(t==null?void 0:t.kernelConnectionMetadata)||Ye,s=this.variableRequesters.get(o);if(s){i&&(e=await this.getFullVariable(e,t));let a=e.name;return n&&(a=`${e.name}${n}`),s.getDataFrameInfo(e,t,a)}return e}async getDataFrameRows(e,t,n,i,o){let s=eu(i==null?void 0:i.kernelConnectionMetadata)||Ye,a=this.variableRequesters.get(s);if(a){let l=e.name;return o&&(l=`${e.name}${o}`),a.getDataFrameRows(t,n,i,l)}return{data:[]}}async getFullVariable(e,t,n){let i=eu(t==null?void 0:t.kernelConnectionMetadata)||Ye,o=this.variableRequesters.get(i);return o?o.getFullVariable(e,t,n):e}async getVariablesBasedOnKernel(e,t){var l;let n=this.cachedVariables.get(e.uri.toString()),i=this.kernelProvider.getKernelExecution(e).pendingCells.length>0,o=this.kernelProvider.getKernelExecution(e);(!n||!i&&(n.currentExecutionCount!==t.executionCount||n.currentExecutionCount!==o.executionCount))&&(n={currentExecutionCount:o.executionCount,variables:(await this.getVariableNamesAndTypesFromKernel(e)).map(u=>({name:u.name,value:void 0,supportsDataExplorer:!1,type:u.type,fullType:u.fullType,size:0,shape:"",count:0,truncated:!0,fileName:e.notebook.uri}))});let s=this.configService.getSettings(e.resourceUri).variableExplorerExclude?(l=this.configService.getSettings().variableExplorerExclude)==null?void 0:l.split(";"):[],a={executionCount:o.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(n){let u=t.sortColumn,c=(m,g)=>{let b=m[u]?m[u]:"",v=g[u]?g[u]:"";return t.sortAscending?b.localeCompare(v,void 0,{sensitivity:"base"}):v.localeCompare(b,void 0,{sensitivity:"base"})};n.variables.sort(c);let d=t.startIndex?t.startIndex:0,f=t.pageSize?t.pageSize:100;a.pageStartIndex=d;for(let m=d;m<d+f&&m<n.variables.length;){if(s&&s.indexOf(n.variables[m].type)>=0){n.variables.splice(m,1);continue}let g=typeof n.variables[m].value=="string"?n.variables[m]:await this.getVariableValueFromKernel(n.variables[m],e);n.variables[m]=g,a.pageResponse.push(g),m+=1}this.cachedVariables.set(e.uri.toString(),n),a.totalCount=n.variables.length}return a}async getVariableProperties(e,t,n){let i=await this.getMatchingVariable(e,t,n),o=eu(t.kernelConnectionMetadata)||Ye,s=this.variableRequesters.get(o);return s?s.getVariableProperties(e,n,i):{}}async getVariableNamesAndTypesFromKernel(e,t){let n=eu(e.kernelConnectionMetadata)||Ye,i=this.variableRequesters.get(n);return i?i.getVariableNamesAndTypesFromKernel(e,t):[]}inspect(e,t,n=0,i){let o=Re();try{e.requestInspect({code:t,cursor_pos:n,detail_level:0}).then(s=>{s&&s.content.status==="ok"?o.resolve(s.content.data):o.resolve(void 0)}).catch(s=>{o.reject(s)})}catch(s){o.reject(s)}return i&&this.disposables.push(i.onCancellationRequested(()=>o.reject(new WO.CancellationError))),o.promise}async getVariableValueFromKernel(e,t,n){var o;let i={...e};if(!t.disposed&&((o=t.session)!=null&&o.kernel)){let s=await this.inspect(t.session.kernel,e.name,0,n);if(s&&s.hasOwnProperty("text/plain")){let a=vu(s["text/plain"].toString()),l=rCe.exec(a),u=sCe.exec(a),c=aCe.exec(a);l&&(i.type=l[1]),i.value=[nCe,iCe,oCe].reduce((d,f)=>{var m;return d||((m=f.exec(a))==null?void 0:m[1])||""},""),u&&(i.count=parseInt(u[1],10)),c&&(i.shape=`(${c[1]}, ${c[2]})`)}s&&s.type&&(i.type=s.type.toString()),s&&s.value&&(i.value=s.value.toString()),lCe.has(i.type)&&(i.supportsDataExplorer=!0)}return i.type&&i.count&&!i.shape&&jt(t.kernelConnectionMetadata)&&i.supportsDataExplorer&&i.type!=="list"&&(i=await this.getFullVariable(i,t)),i}};vE=U([(0,dp.injectable)(),x(0,(0,dp.inject)(Ke)),x(1,(0,dp.inject)(iM)),x(1,(0,dp.named)(nt.PYTHON_VARIABLES_REQUESTER)),x(2,(0,dp.inject)(ve)),x(3,(0,dp.inject)(qe))],vE);p();var tD=oe(he());p();var yE=class extends ot{constructor(){super("unknown",W.jupyterDataRateExceeded)}};async function VO(r,{code:e,initializeCode:t,cleanupCode:n},i){var o;if(r.disposed||r.disposing||!((o=r.session)!=null&&o.kernel)||!r.session.kernel||r.session.isDisposed)return[];try{return t&&await Ai(r.session.kernel,t,i),await Ai(r.session.kernel,e,i)}catch(s){if(s instanceof Qr)return[];throw s}finally{n&&await Ai(r.session.kernel,n,i)}}var bE=class{constructor(e,t){this.varScriptGenerator=e;this.dfScriptGenerator=t}async getDataFrameInfo(e,t,n){var u;let{code:i,cleanupCode:o,initializeCode:s}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!1,variableName:n}),a=await VO(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameInfo",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"}),l=((u=t.notebook)==null?void 0:u.uri)||t.resourceUri||t.uri;return{...e,...this.deserializeJupyterResult(a),fileName:l}}async getDataFrameRows(e,t,n,i){let{code:o,cleanupCode:s,initializeCode:a}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!1,variableName:i,startIndex:e,endIndex:t}),l=await VO(n,{code:o,cleanupCode:s,initializeCode:a},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameRows",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return l.length===0?{data:[]}:KM(this.deserializeJupyterResult(l))}async getVariableProperties(e,t,n){let i={};return n&&n.value&&(i[`${e}`]=n.value),i}async getVariableValueSummary(e,t,n){let i=await this.varScriptGenerator.generateCodeToGetVariableValueSummary(e.name);try{let o=await Rv(t,i.split(/\r?\n/),n);return o==null?void 0:o.summary}catch(o){C.warn(`Exception when getting variable summary for variable "${e.name}": ${o.message}`);return}}async getAllVariableDiscriptions(e,t,n,i){if(!e.session)return[];let o=t?{root:t.root,propertyChain:t.propertyChain,startIndex:n}:void 0,s=await this.varScriptGenerator.generateCodeToGetAllVariableDescriptions(o),a=await Rv(e,s.split(/\r?\n/),i);if(e.disposed||e.disposing||i!=null&&i.isCancellationRequested||!a)return[];try{return a}catch(l){return C.error(l),[]}}async getVariableNamesAndTypesFromKernel(e,t){if(e.session){let{code:n,cleanupCode:i,initializeCode:o}=await this.varScriptGenerator.generateCodeToGetVariableTypes({isDebugging:!1}),s=await VO(e,{code:n,cleanupCode:i,initializeCode:o},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getVariableNamesAndTypesFromKernel",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});if(e.disposed||e.disposing)return[];let a=this.deserializeJupyterResult(s),l=[];for(let u of a){let c={...u,value:void 0,supportsDataExplorer:!1,size:0,shape:"",count:0,truncated:!0};l.push(c)}return l}return[]}async getFullVariable(e,t,n){let{code:i,cleanupCode:o,initializeCode:s}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!1,variableName:e.name}),a=await VO(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getFullVariable",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return{...e,...this.deserializeJupyterResult(a)}}extractJupyterResultText(e){if(e.length>0){let t=e[0];if(t&&t.output_type==="stream"&&t.name==="stderr"&&t.hasOwnProperty("text")){let n=t.text;if(n.includes("iopub_data_rate_limit"))throw new yE;{let i=W.jupyterGetVariablesExecutionError(n);throw C.error(i),new Error(i)}}if(t&&t.output_type==="execute_result"){let n=t.data;if(n&&n.hasOwnProperty("text/plain"))return n["text/plain"]}if(t&&t.output_type==="stream"&&t.hasOwnProperty("text"))return t.text;if(t&&t.output_type==="error"&&t.hasOwnProperty("traceback")){let i=t.traceback.map(vu).join(`\r
`),o=W.jupyterGetVariablesExecutionError(i);throw C.error(o),new Error(o)}}throw new Error(W.jupyterGetVariablesBadResults)}deserializeJupyterResult(e){let t=this.extractJupyterResultText(e);return JSON.parse(t)}};bE=U([(0,tD.injectable)(),x(0,(0,tD.inject)(my)),x(1,(0,tD.inject)(hy))],bE);function Ere(r,e,t){e.addSingleton(Ve,Z_),e.addSingleton(Ve,X_),e.addSingleton(Ve,Q_),e.addSingleton(Ve,aE),e.addSingleton(Ve,fE),e.addSingleton(Ve,uE),e.add(pA,rE),e.add(MI,eE),e.addSingleton(FR,tE),e.addSingleton(cp,cp),e.addSingleton(Ve,oE),pre(e,t),Qte(r,t),e.addSingleton(Ve,cE),e.addSingleton(Ve,pE),e.addSingleton(Ve,mE),e.addSingleton(Ve,hE),e.addSingleton(oM,gE),e.addSingleton(Oi,vE,nt.KERNEL_VARIABLES),e.addSingleton(iM,bE,nt.PYTHON_VARIABLES_REQUESTER)}p();p();var rD=oe(he()),wre=require("vscode");p();var Cre=class{};"force_variable_refresh","settings_updated","activate","show_data_explorer","get_variables_request","get_variables_response","variable_explorer_toggle","set_variable_explorer_height","variable_explorer_height_response","open_link","variables_complete","update_settings","loc_init","update_variable_view_execution_count","get_html_by_id_request","get_html_by_id_response","restart_kernel";var jO=Symbol("INotebookWatcher"),BO=Symbol("IVariableViewProvider");var IE=class{constructor(e,t){this.extensionContext=e;this.variableViewProvider=t}activate(){this.extensionContext.subscriptions.push(wre.window.registerWebviewViewProvider(this.variableViewProvider.viewType,this.variableViewProvider,{webviewOptions:{retainContextWhenHidden:!1}}))}};IE=U([(0,rD.injectable)(),x(0,(0,rD.inject)(st)),x(1,(0,rD.inject)(BO))],IE);p();var Oa=oe(he());p();var JO=require("vscode");p();var HO=class{constructor(e,t){this.disposedCallback=t,this.callback=e}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}};p();p();var fp=require("vscode");var pp=class{constructor(e,t,n){this.configService=e;this.rootPath=t;this.scripts=n;this.disposed=!1;this.themeIsDarkPromise=Re();this.webviewInit=Re();this._disposables=[];this.onMessageListeners=[];this._onDidDisposeWebviewPanel=new fp.EventEmitter;this.onDataScienceSettingsChanged=async()=>{let e=JSON.stringify(await this.generateDataScienceExtraSettings());this.postMessageInternal("update_settings",e).catch(E)};this.onWebViewLoadFailed=async()=>{this.dispose()};this.onPossibleSettingsChange=async e=>{if(e.affectsConfiguration("workbench.colorTheme")||e.affectsConfiguration("editor.fontSize")||e.affectsConfiguration("editor.fontFamily")||e.affectsConfiguration("editor.cursorStyle")||e.affectsConfiguration("editor.cursorBlinking")||e.affectsConfiguration("editor.autoClosingBrackets")||e.affectsConfiguration("editor.autoClosingQuotes")||e.affectsConfiguration("editor.autoSurround")||e.affectsConfiguration("editor.autoIndent")||e.affectsConfiguration("editor.scrollBeyondLastLine")||e.affectsConfiguration("editor.fontLigatures")||e.affectsConfiguration("editor.scrollbar.verticalScrollbarSize")||e.affectsConfiguration("editor.scrollbar.horizontalScrollbarSize")||e.affectsConfiguration("files.autoSave")||e.affectsConfiguration("files.autoSaveDelay")||e.affectsConfiguration("jupyter.widgetScriptSources")){let t=await this.generateDataScienceExtraSettings();if(t){let n=JSON.stringify(t);this.postMessageInternal("update_settings",n).catch(E)}}};this._disposables.push(fp.workspace.onDidChangeConfiguration(this.onPossibleSettingsChange,this)),this._disposables.push(this.configService.getSettings(void 0).onDidChange(this.onDataScienceSettingsChanged.bind(this)))}get onDidDispose(){return this._onDidDisposeWebviewPanel.event}dispose(){this.disposed||(this.disposed=!0,this._disposables.forEach(e=>e.dispose())),this.webviewInit=void 0,this._onDidDisposeWebviewPanel.fire()}getHTMLById(e){if(!this.activeHTMLRequest)this.activeHTMLRequest=Re(),this.postMessageInternal("get_html_by_id_request",e).catch(E);else throw new Error("getHTMLById request already in progress");return this.activeHTMLRequest.promise}addMessageListener(e){this.onMessageListeners.push(e)}removeMessageListener(e){let t=this.onMessageListeners.indexOf(e);t>=0&&this.onMessageListeners.splice(t,1)}asWebviewUri(e){var t;if(!this.webview)throw new Error("asWebViewUri called too early");return(t=this.webview)==null?void 0:t.asWebviewUri(e)}postMessage(e,t){return this.postMessageInternal(e.toString(),t)}onMessage(e,t){switch(e){case"started":this.webViewRendered();break;case"get_html_by_id_response":this.activeHTMLRequest&&(this.activeHTMLRequest.resolve(t),this.activeHTMLRequest=void 0);break;default:break}this.onMessageListeners.forEach(n=>{n(e,t)})}async loadWebview(e,t){var n;if(this.disposed=!1,this.webviewInit=this.webviewInit||Re(),this.webview===void 0){let i=await this.generateDataScienceExtraSettings(),o=(n=fp.workspace.getWorkspaceFolder(e))==null?void 0:n.uri;this.webview=await this.provideWebview(e,i,o,t),this._disposables.push(this.webview.loadFailed(this.onWebViewLoadFailed,this))}this.onDataScienceSettingsChanged().catch(E),this.sendLocStrings().catch(E)}async generateDataScienceExtraSettings(){let e=this.owningResource,t=fp.workspace.getConfiguration("editor"),n=fp.workspace.getConfiguration("workbench"),i=n?n.get("colorTheme",fL):fL,o=fp.extensions.getExtension($s);return{...JSON.parse(JSON.stringify(this.configService.getSettings(e))),extraSettings:{editor:{cursor:this.getValue(t,"cursorStyle","line"),cursorBlink:this.getValue(t,"cursorBlinking","blink"),autoClosingBrackets:this.getValue(t,"autoClosingBrackets","languageDefined"),autoClosingQuotes:this.getValue(t,"autoClosingQuotes","languageDefined"),autoSurround:this.getValue(t,"autoSurround","languageDefined"),autoIndent:this.getValue(t,"autoIndent",!1),fontLigatures:this.getValue(t,"fontLigatures",!1),scrollBeyondLastLine:this.getValue(t,"scrollBeyondLastLine",!0),verticalScrollbarSize:this.getValue(t,"scrollbar.verticalScrollbarSize",14),horizontalScrollbarSize:this.getValue(t,"scrollbar.horizontalScrollbarSize",10),fontSize:this.getValue(t,"fontSize",14),fontFamily:this.getValue(t,"fontFamily","Consolas, 'Courier New', monospace")},theme:i,hasPythonExtension:o!==void 0,isWeb:xi()==="Unknown"}}}async sendLocStrings(){let e={collapseSingle:Ft.collapseSingle,expandSingle:Ft.expandSingle,openExportFileYes:W.openExportFileYes,openExportFileNo:W.openExportFileNo,noRowsInDataViewer:Ft.noRowsInDataViewer,sliceIndexError:Ft.sliceIndexError,sliceMismatchedAxesError:Ft.sliceMismatchedAxesError,filterRowsTooltip:Ft.sliceMismatchedAxesError,fetchingDataViewer:Ft.fetchingDataViewer,dataViewerHideFilters:Ft.dataViewerHideFilters,dataViewerShowFilters:Ft.dataViewerShowFilters,refreshDataViewer:Ft.refreshDataViewer,clearFilters:Ft.refreshDataViewer,sliceSummaryTitle:Ft.sliceSummaryTitle,sliceData:Ft.sliceData,sliceSubmitButton:Ft.sliceSubmitButton,sliceDropdownAxisLabel:Ft.sliceDropdownAxisLabel,sliceDropdownIndexLabel:Ft.sliceDropdownIndexLabel,variableExplorerNameColumn:Ft.variableExplorerNameColumn,variableExplorerTypeColumn:Ft.variableExplorerTypeColumn,variableExplorerCountColumn:Ft.variableExplorerCountColumn,variableExplorerValueColumn:Ft.variableExplorerValueColumn,collapseVariableExplorerLabel:Ft.collapseVariableExplorerLabel,variableLoadingValue:Ft.variableLoadingValue,showDataExplorerTooltip:Ft.showDataExplorerTooltip,noRowsInVariableExplorer:Ft.noRowsInVariableExplorer,loadingRowsInVariableExplorer:Ft.loadingRowsInVariableExplorer,previousPlot:Ft.previousPlot,nextPlot:Ft.nextPlot,panPlot:Ft.panPlot,zoomInPlot:Ft.zoomInPlot,zoomOutPlot:Ft.zoomOutPlot,exportPlot:Ft.exportPlot,deletePlot:Ft.deletePlot,selectedImageListLabel:Ft.selectedImageListLabel,selectedImageLabel:Ft.selectedImageLabel,dvDeprecationWarning:Ft.dvDeprecationWarning};this.postMessageInternal("loc_init",JSON.stringify(e)).catch(E)}async postMessageInternal(e,t){var n;this.webviewInit&&(await this.webviewInit.promise,(n=this.webview)==null||n.postMessage({type:e.toString(),payload:t}))}webViewRendered(){this.webviewInit&&!this.webviewInit.resolved&&this.webviewInit.resolve(),this.sendLocStrings().catch(E),this.onDataScienceSettingsChanged().catch(E)}getValue(e,t,n){return e?e.get(t,n):n}};U([$v()],pp.prototype,"getHTMLById",1),U([$v()],pp.prototype,"addMessageListener",1),U([$v()],pp.prototype,"removeMessageListener",1);var qO=class extends pp{constructor(t,n,i,o,s){super(t,o,s);this.configService=t;this.provider=i;this.messageListener=n(this.onMessage.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webviewView(){return this.webview&&this.webview}async provideWebview(t,n,i,o){if(!o)throw new Error("WebviewViews must be passed an initial VS Code Webview");return this.provider.create({additionalPaths:i?[i]:[],rootPath:this.rootPath,cwd:t,listener:this.messageListener,scripts:this.scripts,settings:n,webviewHost:o})}};var Ov=class extends qO{constructor(t,n,i,o,s,a,l){let u=Fi(i.extensionUri,"dist","webviews","webview-side","viewers");super(t,(c,d)=>new HO(c,d),n,u,[Fi(u,"variableView.js")]);this.variables=o;this.disposables=s;this.notebookWatcher=a;this.dataViewerDelegator=l;this.notebookWatcher.onDidFinishExecutingActiveNotebook(this.activeNotebookExecuted,this,this.disposables),this.notebookWatcher.onDidChangeActiveNotebook(this.activeNotebookChanged,this,this.disposables),this.notebookWatcher.onDidRestartActiveNotebook(this.activeNotebookRestarted,this,this.disposables),this.variables.refreshRequired(this.sendRefreshMessage,this,this.disposables),JO.window.onDidChangeActiveTextEditor(this.activeTextEditorChanged,this,this.disposables)}get owningResource(){}async load(t){await super.loadWebview(JO.Uri.file(process.cwd()),t).catch(C.error),this.webviewView&&this.disposables.push(this.webviewView.onDidChangeVisibility(()=>{this.handleVisibilityChanged()})),this.handleVisibilityChanged()}get title(){return"variableView"}onMessage(t,n){switch(t){case"get_variables_request":this.handleMessage(t,n,this.requestVariables);break;case"show_data_explorer":this.handleMessage(t,n,this.showDataViewer);break;default:break}super.onMessage(t,n)}handleMessage(t,n,i){let o=n;i.bind(this)(o)}handleVisibilityChanged(){let t=new fr("jupyter.variableViewVisible"),n=!1;this.webviewView&&(n=this.webviewView.visible),t.set(n).catch(E),n&&(ne("DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE"),this.notebookWatcher.activeNotebookExecutionCount!==void 0?this.postMessage("update_variable_view_execution_count",{executionCount:this.notebookWatcher.activeNotebookExecutionCount}).catch(E):this.postMessage("force_variable_refresh").catch(E))}async showDataViewer(t){var n,i;return t.variable.fileName=(i=t.variable.fileName)!=null?i:(n=this.notebookWatcher.activeKernel)==null?void 0:n.notebook.uri,this.dataViewerDelegator.showContributedDataViewer(t.variable,!0)}postProcessSupportsDataExplorer(t){let n=this.dataViewerDelegator.getVariableViewers();return t.pageResponse.forEach(i=>{i.supportsDataExplorer=n.some(o=>o.jupyterVariableViewers.dataTypes.includes(i.type))}),t}async requestVariables(t){let n=this.notebookWatcher.activeKernel;if(n){let i=await this.variables.getVariables(t,n);this.postMessage("get_variables_response",this.postProcessSupportsDataExplorer(i)).catch(E),ne("DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",{variableCount:i.totalCount})}else{let i={executionCount:t.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};this.postMessage("get_variables_response",i).catch(E)}}async activeNotebookExecuted(t){this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(E)}async activeNotebookChanged(t){t.executionCount?this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(E):this.postMessage("update_variable_view_execution_count",{executionCount:0}).catch(E),this.postMessage("force_variable_refresh").catch(E)}activeTextEditorChanged(){this.postMessage("force_variable_refresh").catch(E)}async activeNotebookRestarted(){this.postMessage("restart_kernel").catch(E)}async sendRefreshMessage(){this.postMessage("force_variable_refresh").catch(E)}};U([Nr("DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED")],Ov.prototype,"load",1),U([gn()],Ov.prototype,"showDataViewer",1),U([gn()],Ov.prototype,"requestVariables",1);p();var Ql=require("vscode");var xre=oe(he());var Xl=class{async showContributedDataViewer(e,t){try{let n=this.getMatchingExternalVariableViewers(e);if(n.length===0)return Ql.window.showInformationMessage(W.dataViewerExtensionRequired,{modal:!0},Ue.bannerLabelYes).then(i=>{i===Ue.bannerLabelYes&&Ql.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(E,E)});if(n.length===1){let i=n[0].jupyterVariableViewers.command;return C.info(`Showing data viewer with command ${i} for variable ${JSON.stringify({...e,value:"..."})}`),Ql.commands.executeCommand(i,e)}else{let i=n.filter(s=>s.extension.id!==Je);if(i.length===1){let s=i[0].jupyterVariableViewers.command;return C.info(`Showing data viewer viewer with command ${s} for variable ${JSON.stringify({...e,value:"..."})}`),Ql.commands.executeCommand(s,e)}let o=Ql.window.createQuickPick();o.title=W.selectExternalDataViewer,o.items=n.map(s=>{var a,l;return{label:s.jupyterVariableViewers.title,detail:(l=(a=s.extension.packageJSON)==null?void 0:a.displayName)!=null?l:s.extension.id,command:s.jupyterVariableViewers.command}}),o.onDidAccept(async()=>{let s=o.selectedItems[0];if(s)return o.hide(),C.info(`Showing data viewer viewer with command ${s.command} for variable ${JSON.stringify({...e,value:"..."})}`),Ql.commands.executeCommand(s.command,e)}),o.show()}}catch(n){C.error(n),ne("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",void 0,{reason:"exception",fromVariableView:t}),Ql.window.showErrorMessage(W.showDataViewerFail).then(E,E)}}getMatchingExternalVariableViewers(e){return this.getVariableViewers().filter(n=>!e.type||n.jupyterVariableViewers.dataTypes.includes(e.type)).filter(n=>n.extension.id!==Je)}getVariableViewers(){return Ql.extensions.all.filter(t=>{var n,i,o,s;return((i=(n=t.packageJSON)==null?void 0:n.contributes)==null?void 0:i.jupyterVariableViewers)&&((s=(o=t.packageJSON)==null?void 0:o.contributes)==null?void 0:s.jupyterVariableViewers.length)}).map(t=>{var i;let n=(i=t.packageJSON)==null?void 0:i.contributes;return n!=null&&n.jupyterVariableViewers?n.jupyterVariableViewers.map(o=>({extension:t,jupyterVariableViewers:o})):[]}).flat()}};Xl=U([(0,xre.injectable)()],Xl);var SE=class{constructor(e,t,n,i,o,s,a){this.configuration=e;this.webviewViewProvider=t;this.context=n;this.variables=i;this.disposables=o;this.notebookWatcher=s;this.dataViewerDelegator=a;this.viewType="jupyterViewVariables"}get activeVariableView(){if(!hn())throw new Error("activeVariableView only for test code");return this.variableView?Promise.resolve(this.variableView):(this.activeVariableViewPromise=Re(),this.activeVariableViewPromise.promise)}async resolveWebviewView(e,t,n){e.webview.options={enableScripts:!0},this.variableView=new Ov(this.configuration,this.webviewViewProvider,this.context,this.variables,this.disposables,this.notebookWatcher,this.dataViewerDelegator),this.activeVariableViewPromise&&this.activeVariableViewPromise.resolve(this.variableView),await this.variableView.load(e)}};SE=U([(0,Oa.injectable)(),x(0,(0,Oa.inject)(Ke)),x(1,(0,Oa.inject)(VR)),x(2,(0,Oa.inject)(st)),x(3,(0,Oa.inject)(Oi)),x(3,(0,Oa.named)(nt.ALL_VARIABLES)),x(4,(0,Oa.inject)(ve)),x(5,(0,Oa.inject)(jO)),x(6,(0,Oa.inject)(Xl))],SE);p();var hp=oe(he());p();var Dre=1e3,Pre;(t=>(t.Fetching="fetching",t.Skipped="skipped"))(Pre||(Pre={}));var vs;(f=>(f.Started="started",f.UpdateSettings="update_settings",f.InitializeData="init",f.GetAllRowsRequest="get_all_rows_request",f.GetAllRowsResponse="get_all_rows_response",f.GetRowsRequest="get_rows_request",f.GetRowsResponse="get_rows_response",f.CompletedData="complete",f.GetSliceRequest="get_slice_request",f.RefreshDataViewer="refresh_data_viewer",f.SliceEnablementStateChanged="slice_enablement_state_changed",f.DeprecationWarningClicked="deprecation_warning_clicked"))(vs||(vs={}));var _E=Symbol("IDataViewerFactory"),GO=Symbol("IDataViewer"),YO=Symbol("IJupyterVariableDataProvider"),$O=Symbol("IJupyterVariableDataProviderFactory"),EE=Symbol("IDataViewerDependencyService");var mp=class{constructor(e,t){this.variableManager=e;this.dependencyService=t;this.initialized=!1}get kernel(){return this._kernel}static getNormalizedColumns(e){return e.map(t=>{let n;switch(t.type){case"bool":n="bool";break;case"integer":case"int32":case"int64":case"float":case"float32":case"float64":case"number":n="number";break;default:n="string"}return{key:t.key,type:n}})}static parseShape(e){try{if(e.startsWith("(")&&e.endsWith(")"))return e.substring(1,e.length-1).split(",").map(t=>parseInt(t))}catch(t){C.error(`Could not parse IJupyterVariable with malformed shape: ${e}`)}}dispose(){}setDependencies(e,t){this._kernel=t,this.variable=e}async getDataFrameInfo(e,t){let n={};await this.ensureInitialized();let i=this.variable;return i&&((e||t)&&(i=await this.variableManager.getDataFrameInfo(i,this._kernel,e,t)),n={columns:i.columns?mp.getNormalizedColumns(i.columns):i.columns,indexColumn:i.indexColumn,rowCount:i.rowCount,dataDimensionality:i.dataDimensionality,shape:mp.parseShape(i.shape),sliceExpression:e,type:i.type,maximumRowChunkSize:i.maximumRowChunkSize,name:i.name,fileName:ct(i.fileName)}),t&&(this.variable=i),n}async getAllRows(e){let t=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(t=(await this.variableManager.getDataFrameRows(this.variable,0,this.variable.rowCount,this._kernel,e)).data),t}async getRows(e,t,n){let i=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(i=(await this.variableManager.getDataFrameRows(this.variable,e,t,this._kernel,n)).data),i}async ensureInitialized(){var e,t;!this.initialized&&this.variable&&(this.initialized=!0,(e=this._kernel)!=null&&e.kernelConnectionMetadata&&this.dependencyService&&await this.dependencyService.checkAndInstallMissingDependencies(ic()?this._kernel:((t=this._kernel)==null?void 0:t.kernelConnectionMetadata.interpreter)||this._kernel),this.variable=await this.variableManager.getDataFrameInfo(this.variable,this._kernel))}};mp=U([(0,hp.injectable)(),x(0,(0,hp.inject)(Oi)),x(0,(0,hp.named)(nt.ALL_VARIABLES)),x(1,(0,hp.inject)(EE)),x(1,(0,hp.optional)())],mp);p();var zO=oe(he());var CE=class{constructor(e){this.serviceContainer=e}async create(e,t){let n=this.serviceContainer.get(YO);return n.setDependencies(e,t),n}};CE=U([(0,zO.injectable)(),x(0,(0,zO.inject)(Ar))],CE);p();var Kr=oe(he()),ys=require("vscode");p();var XO=require("vscode");var QO=class{constructor(e){this.configuration=e}async isRequestedColumnSizeAllowed(e,t){if(e>Dre&&await this.shouldAskForLargeData(t)){let n=W.tooManyColumnsMessage,i=W.tooManyColumnsYes,o=W.tooManyColumnsNo,s=W.tooManyColumnsDontAskAgain,a=await XO.window.showWarningMessage(n,i,o,s);return a===s&&await this.disableAskForLargeData(),a===i}return!0}async shouldAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();return t&&t.askForLargeDataFrames===!0}async disableAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();t&&(t.askForLargeDataFrames=!1,this.configuration.updateSetting("askForLargeDataFrames",!1,void 0,XO.ConfigurationTarget.Global).catch(E))}};var Tre="ds_prompt_about_deprecation",wE=class{constructor(e,t,n,i,o,s,a,l,u,c,d,f,m,g,b){this.disposables=e;this.debugService=t;this.jupyterVariableDataProviderFactory=i;this.dataViewerFactory=o;this.variableProvider=s;this.errorHandler=a;this.dataViewerDependencyService=l;this.interpreterService=u;this.platformService=c;this.kernelProvider=d;this.interactiveWindowProvider=f;this.experimentService=m;this.globalMemento=g;this.dataViewerDelegator=b;this.dataViewerChecker=new QO(n),ys.workspace.isTrusted||ys.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){ys.workspace.isTrusted&&(this.registerCommand(le.ShowDataViewer,this.delegateDataViewer),this.registerCommand(le.ShowJupyterDataViewer,this.delegateDataViewer))}registerCommand(e,t){let n=ys.commands.registerCommand(e,t,this);this.disposables.push(n)}async delegateDataViewer(e){let t="variable"in e?await this.getVariableFromRequest(e):e;if(!t){C.error("Variable info could not be retreived"),ne("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",void 0,{reason:"no variable info",fromVariableView:!1});return}return this.dataViewerDelegator.showContributedDataViewer(t,!1)}async getVariableFromRequest(e){if(this.variableProvider){let t=LM(e.variable);try{return await this.variableProvider.getFullVariable(t)}catch(n){return C.warn("Full variable info could not be retreived, will attempt with partial info.",n),t}}}async showJupyterVariableView(e){var n,i;ne("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX");let t=this.experimentService.inExperiment("DataViewerDeprecation");if(!this.globalMemento.get(Tre)&&t&&(this.globalMemento.update(Tre,!0).then(E,E),ys.window.showInformationMessage(W.dataViewerDeprecationMessage,W.dataViewerDeprecationRecommendationActionMessage).then(o=>{o===W.dataViewerDeprecationRecommendationActionMessage&&ys.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(E,E)},E)),(n=this.debugService)!=null&&n.activeDebugSession&&this.variableProvider&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory)try{if(this.debugService.activeDebugSession.configuration&&this.dataViewerDependencyService&&this.interpreterService){let l=await this.getDebugAdapterPython(this.debugService.activeDebugSession.configuration);l&&await this.dataViewerDependencyService.checkAndInstallMissingDependencies(l)}let o=await this.jupyterVariableDataProviderFactory.create(e),s=await o.getDataFrameInfo(),a=(i=s==null?void 0:s.columns)==null?void 0:i.length;if(a&&await this.dataViewerChecker.isRequestedColumnSizeAllowed(a)){let l=`${W.dataExplorerTitle} - ${e.name}`,u=await this.dataViewerFactory.create(o,l);return ne("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX"),u}}catch(o){ne("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",void 0,void 0,o),C.error(o),this.errorHandler.handleError(o).then(E,E)}else try{let o=this.getActiveKernel();if(o&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory){let s=await this.jupyterVariableDataProviderFactory.create(e,o),a=`${W.dataExplorerTitle} - ${e.name}`;return await this.dataViewerFactory.create(s,a)}}catch(o){C.error(o),ne("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER"),ys.window.showErrorMessage(W.showDataViewerFail).then(E,E)}}getActiveKernel(){var s,a;let e=(s=ys.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==St?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=(a=this.dataViewerFactory)==null?void 0:a.activeViewer;return o?this.kernelProvider.kernels.find(l=>l===o.kernel):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return ys.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}async getDebugAdapterPython(e){if(!this.interpreterService){C.info("Interpreter Service missing when trying getDebugAdapterPython");return}let t="";if(e.debugAdapterPython!==void 0?(C.info("Found debugAdapterPython on Debug Configuration to use"),t=e.debugAdapterPython):e.pythonPath&&(C.info("Found pythonPath on Debug Configuration to use"),t=e.pythonPath),t){let n=t;return n.startsWith("~")&&this.platformService.homeDir&&(n=kD(n,this.platformService.homeDir.path)),this.interpreterService.getInterpreterDetails(ys.Uri.file(n))}else return this.interpreterService.getActiveInterpreter()}};wE=U([(0,Kr.injectable)(),x(0,(0,Kr.inject)(ve)),x(1,(0,Kr.inject)(oo)),x(1,(0,Kr.optional)()),x(2,(0,Kr.inject)(Ke)),x(3,(0,Kr.inject)($O)),x(3,(0,Kr.optional)()),x(4,(0,Kr.inject)(_E)),x(4,(0,Kr.optional)()),x(5,(0,Kr.inject)(Oi)),x(5,(0,Kr.named)(nt.DEBUGGER_VARIABLES)),x(6,(0,Kr.inject)(pn)),x(7,(0,Kr.inject)(EE)),x(7,(0,Kr.optional)()),x(8,(0,Kr.inject)(cm)),x(8,(0,Kr.optional)()),x(9,(0,Kr.inject)(ds)),x(10,(0,Kr.inject)(qe)),x(11,(0,Kr.inject)(ao)),x(12,(0,Kr.inject)(py)),x(13,(0,Kr.inject)(Et)),x(13,(0,Kr.named)(rr)),x(14,(0,Kr.inject)(Xl))],wE);p();var Lv=oe(he()),Nu=require("vscode");var xE=class{constructor(e,t,n,i){this.interactiveWindowProvider=e;this.kernelProvider=t;this.dataViewerFactory=n;this.disposables=i;this._onDidFinisheExecutingActiveNotebook=new Nu.EventEmitter;this._onDidChangeActiveNotebook=new Nu.EventEmitter;this._onDidRestartActiveNotebook=new Nu.EventEmitter;this._executionCountTracker=new WeakMap;Nu.window.onDidChangeActiveNotebookEditor(this.activeEditorChanged,this,this.disposables),Nu.workspace.onDidCloseNotebookDocument(this.notebookEditorClosed,this,this.disposables),this.kernelProvider.onDidRestartKernel(o=>{this.handleRestart({state:1,notebook:o.notebook})},this,this.disposables),Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables)}get onDidChangeActiveNotebook(){return this._onDidChangeActiveNotebook.event}get onDidFinishExecutingActiveNotebook(){return this._onDidFinisheExecutingActiveNotebook.event}get onDidRestartActiveNotebook(){return this._onDidRestartActiveNotebook.event}get activeKernel(){var s;let e=(s=Nu.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==St?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=this.dataViewerFactory.activeViewer;return o?this.kernelProvider.kernels.find(a=>a===o.kernel):void 0}get activeNotebookExecutionCount(){var t;let e=(t=this.activeKernel)==null?void 0:t.notebook;return e?this._executionCountTracker.get(e):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return Nu.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}onDidChangeNotebookCellExecutionState(e){hr(e.cell.notebook)&&e.state===1&&this.handleExecute({notebook:e.cell.notebook,state:0,cell:e.cell})}handleExecute(e){var t,n,i,o,s,a;this.isNonSilentExecution(e)&&(((n=(t=e.cell)==null?void 0:t.executionSummary)==null?void 0:n.executionOrder)!==void 0&&this._executionCountTracker.set(e.notebook,(i=e.cell.executionSummary)==null?void 0:i.executionOrder),this.isActiveNotebookEvent(e)&&((s=(o=e.cell)==null?void 0:o.executionSummary)==null?void 0:s.executionOrder)!==void 0&&this.activeKernel&&this.kernelProvider.getKernelExecution(this.activeKernel).pendingCells.length===0&&this._onDidFinisheExecutingActiveNotebook.fire({executionCount:(a=e.cell.executionSummary)==null?void 0:a.executionOrder}))}handleRestart(e){this._executionCountTracker.delete(e.notebook),this.isActiveNotebookEvent(e)&&this._onDidRestartActiveNotebook.fire()}notebookEditorClosed(e){this._executionCountTracker.delete(e)}activeEditorChanged(e){let t={};if(e&&hr(e.notebook)){let n=this._executionCountTracker.get(e.notebook);n&&(t.executionCount=n)}this._onDidChangeActiveNotebook.fire(t)}isNonSilentExecution(e){var t;return!!(e.state===0&&e.cell&&((t=e.cell.executionSummary)!=null&&t.executionOrder))}isActiveNotebookEvent(e){var t;return((t=this.activeKernel)==null?void 0:t.notebook)===e.notebook}};xE=U([(0,Lv.injectable)(),x(0,(0,Lv.inject)(ao)),x(1,(0,Lv.inject)(qe)),x(2,(0,Lv.inject)(_E)),x(3,(0,Lv.inject)(ve))],xE);p();var nD=oe(he());var kre=require("vscode");var Rm=class{constructor(e,t){this.serviceContainer=e;this.disposables=t;this.knownViewers=new Set;t.push(this),this.viewContext=new fr(gr.IsDataViewerActive),this.disposables.push(kre.commands.registerCommand(le.RefreshDataViewer,this.refreshDataViewer,this))}dispose(){for(let e of this.knownViewers)e.dispose()}async create(e,t){let n,i=this.serviceContainer.get(GO);try{this.knownViewers.add(i),i.onDidDisposeDataViewer(this.updateOpenDataViewers,this,this.disposables),i.onDidChangeDataViewerViewState(this.updateViewStateContext,this,this.disposables),await i.showData(e,t),n=i}finally{n||i.dispose()}return n}get activeViewer(){return[...this.knownViewers.values()].find(e=>e.active)}updateOpenDataViewers(e){this.knownViewers.delete(e)}async updateViewStateContext(){let e=!1;this.knownViewers.forEach(t=>{t.active&&(e=!0)}),await this.viewContext.set(e)}refreshDataViewer(){for(let e of this.knownViewers)e.active&&e.refreshData().then(E,E)}};U([Nr("DATASCIENCE.START_SHOW_DATA_EXPLORER")],Rm.prototype,"create",1),U([jR(1e3)],Rm.prototype,"refreshDataViewer",1),Rm=U([(0,nD.injectable)(),x(0,(0,nD.inject)(Ar)),x(1,(0,nD.inject)(ve))],Rm);p();var Ru=oe(he()),bs=require("vscode");p();var ZO=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged(e)}};p();p();var Q9;function X9(r,e){return Q9&&Q9.hasOwnProperty(r)?Q9[r]:e}function Z9(r,...e){return r.replace(/{(\d+)}/g,(t,n)=>e[n]===void 0?t:e[n])}var cCe=/^\s*((?<StartRange>-?\d+:)|(?<StopRange>-?:\d+)|(?:(?<Start>-?\d+)(?::(?<Stop>-?\d+))?(?::(?<Step>-?\d+))?))\s*$/;function eB(r){let e=r.length-2;return"["+r.map(()=>e>0?(e-=1,"0"):":").join(", ")+"]"}function uCe(r,e){if(r.startsWith("[")&&r.endsWith("]")){let t,n=r.substring(1,r.length-1).split(",").map((i,o)=>{var a;let s=cCe.exec(i);if((a=s==null?void 0:s.groups)!=null&&a.Start&&!s.groups.Stop){let l=parseInt(s.groups.Start),u=e[o];return(l>=0&&l>=u||l<0&&l<-u)&&(t={shapeIndex:o,value:l}),l}});if(t){let{shapeIndex:i,value:o}=t,s=X9("sliceIndexError","Index {0} out of range for axis {1} with {2} elements");return Z9(s,o.toString(),i.toString(),e[i].toString())}else if(n&&n.length!==e.length){let i=X9("sliceMismatchedAxesError","Expected {0} axes, got {1} in slice expression");return Z9(i,e.length.toString(),n.length.toString())}}return""}function Nre(r,e){return uCe(r,e)===""}p();var PE=class extends pp{constructor(t,n,i,o,s,a,l){super(t,o,s);this.configService=t;this.provider=n;this._title=a;this.viewColumn=l;this.viewState={visible:!1,active:!1};this.webPanelViewStateChanged=t=>{let n=t.isVisible(),i=t.isActive(),o={visible:n,active:i},s={visible:this.viewState.visible,active:this.viewState.active};this.viewState.visible=n,this.viewState.active=i,this.onViewStateChanged({current:o,previous:s})};this.messageListener=i(this.onMessage.bind(this),this.webPanelViewStateChanged.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webPanel(){if(this.webview)return this.webview}async show(t){this.isDisposed||this.webPanel&&await this.webPanel.show(t)}dispose(){this.isDisposed||this.webPanel&&this.webPanel.close(),super.dispose()}get title(){return this._title}setTitle(t){this._title=t,!this.isDisposed&&this.webPanel&&this.webPanel.setTitle(t)}onViewStateChanged(t){}async provideWebview(t,n,i,o){return this.provider.create({viewColumn:this.viewColumn,listener:this.messageListener,title:this.title,rootPath:this.rootPath,scripts:this.scripts,settings:n,cwd:t,webviewHost:o,additionalPaths:i?[i]:[]})}};var Rre="JupyterDataViewerPreferredViewColumn",Kv=class extends PE{constructor(t,n,i,o,s){var l;let a=Fi(s.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(u,c,d)=>new ZO(u,c,d),a,[Fi(a,"dataExplorer.js")],W.dataExplorerTitle,(l=i.get(Rre))!=null?l:bs.ViewColumn.One);this.globalMemento=i;this.errorHandler=o;this.context=s;this.pendingRowsCount=0;this.sentDataViewerSliceDimensionalityTelemetry=!1;this._onDidDisposeDataViewer=new bs.EventEmitter;this._onDidChangeDataViewerViewState=new bs.EventEmitter;this.onDidDispose(this.dataViewerDisposed,this)}get active(){var t;return!!((t=this.webPanel)!=null&&t.isActive())}get refreshPending(){return this.pendingRowsCount>0}get onDidDisposeDataViewer(){return this._onDidDisposeDataViewer.event}get onDidChangeDataViewerViewState(){return this._onDidChangeDataViewerViewState.event}async showData(t,n){if(!this.isDisposed){this.dataProvider=t,await super.loadWebview(bs.Uri.file(process.cwd())).catch(C.error),super.setTitle(n),await super.show(!0);let i=await this.prepDataFrameInfo();if(i.shape&&i.shape.length>2){this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length);let o=eB(i.shape);i=await this.getDataFrameInfo(o)}this.postMessage(vs.InitializeData,i).catch(E)}}get kernel(){if(this.dataProvider&&"kernel"in this.dataProvider)return this.dataProvider.kernel}dataViewerDisposed(){this._onDidDisposeDataViewer.fire(this)}async refreshData(){let t=this.currentSliceExpression;this.dataFrameInfoPromise=void 0;let n=await this.getDataFrameInfo(void 0,!0);if(t!==void 0&&n.shape!==void 0)if(Nre(t,n.shape))n=await this.getDataFrameInfo(t);else{let i=eB(n.shape);n=await this.getDataFrameInfo(i)}C.info(`Refreshing data viewer for variable ${n.name}`),this.postMessage(vs.InitializeData,n).catch(E)}dispose(){super.dispose(),this.dataProvider&&(this.dataProvider.dispose(),this.dataProvider=void 0)}async onViewStateChanged(t){var n;t.current.active&&t.current.visible&&t.previous.active&&t.current.visible&&await this.globalMemento.update(Rre,(n=this.webPanel)==null?void 0:n.viewColumn),this._onDidChangeDataViewerViewState.fire()}get owningResource(){}onMessage(t,n){switch(t){case vs.GetAllRowsRequest:this.getAllRows(n).catch(E);break;case vs.GetRowsRequest:this.getRowChunk(n).catch(E);break;case vs.GetSliceRequest:this.getSlice(n).catch(E);break;case vs.RefreshDataViewer:this.refreshData().catch(E),ne("DATASCIENCE.REFRESH_DATA_VIEWER");break;case vs.SliceEnablementStateChanged:ne("DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",void 0,{newState:n.newState?"checked":"unchecked"});break;case vs.DeprecationWarningClicked:bs.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(E,E);break;default:break}super.onMessage(t,n)}getDataFrameInfo(t,n){return(!this.dataFrameInfoPromise||t!==this.currentSliceExpression)&&(this.dataFrameInfoPromise=this.dataProvider?this.dataProvider.getDataFrameInfo(t,n):Promise.resolve({}),this.currentSliceExpression=t),this.dataFrameInfoPromise}async prepDataFrameInfo(){this.rowsTimer=new yt;let t=await this.getDataFrameInfo();try{ne("DATASCIENCE.SHOW_DATA_EXPLORER",void 0,{rows:t.rowCount?t.rowCount:0,columns:t.columns?t.columns.length:0}),this.pendingRowsCount=t.rowCount?t.rowCount:0}catch(n){}return t}async getAllRows(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.dataProvider.getAllRows(t);return this.pendingRowsCount=0,this.postMessage(vs.GetAllRowsResponse,n)}})}getSlice(t){return this.wrapRequest(async()=>{var n;if(this.dataProvider){let i=await this.getDataFrameInfo(t.slice);return(n=i.shape)!=null&&n.length&&this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length),ne("DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",void 0,{source:t.source}),this.postMessage(vs.InitializeData,i)}})}getRowChunk(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.getDataFrameInfo(t.sliceExpression),i=await this.dataProvider.getRows(t.start,Math.min(t.end,n.rowCount?n.rowCount:0),t.sliceExpression);return this.pendingRowsCount=Math.max(0,this.pendingRowsCount-i.length),this.postMessage(vs.GetRowsResponse,{rows:i,start:t.start,end:t.end})}})}async wrapRequest(t){try{return await t()}catch(n){if(n instanceof yE){C.error(n.message);let i=W.pythonInteractiveHelpLink;bs.window.showErrorMessage(W.jupyterDataRateExceeded,i).then(o=>{o===i&&bs.env.openExternal(bs.Uri.parse(uD.JupyterDataRateHelpLink))},E),this.dispose()}C.error(n),this.errorHandler.handleError(n).then(E,E)}finally{this.sendElapsedTimeTelemetry()}}sendElapsedTimeTelemetry(){this.rowsTimer&&this.pendingRowsCount===0&&ne("DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",void 0,{rowsTimer:this.rowsTimer.elapsedTime})}maybeSendSliceDataDimensionalityTelemetry(t){this.sentDataViewerSliceDimensionalityTelemetry||(ne("DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",{numberOfDimensions:t}),this.sentDataViewerSliceDimensionalityTelemetry=!0)}};U([Nr("DATAVIEWER.WEBVIEW_LOADED")],Kv.prototype,"showData",1),Kv=U([(0,Ru.injectable)(),x(0,(0,Ru.inject)(FI)),x(1,(0,Ru.inject)(Ke)),x(2,(0,Ru.inject)(Et)),x(2,(0,Ru.named)(rr)),x(3,(0,Ru.inject)(pn)),x(4,(0,Ru.inject)(st))],Kv);p();var Are=oe(he());p();p();p();var eL="0.20.0";var tL=require("vscode");var iD=class{async getVersion(e,t){try{let n=await this._getVersion(e,t);return typeof n=="string"?mY(n):n}catch(n){C.warn(W.failedToGetVersionOfPandas,n.message);return}}async promptInstall(e,t,n){let i=n?W.pandasTooOldForViewingFormat(n,eL):W.pandasRequiredForViewing(eL);if((pB()?Ue.install:await tL.window.showErrorMessage(i,{modal:!0},Ue.install))===Ue.install)await this._doInstall(e,t);else throw ne("DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS"),new Error(i)}async checkOrInstall(e){let t=new tL.CancellationTokenSource;try{let n=await this.getVersion(e,t.token);if(t.token.isCancellationRequested){ne("DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED");return}if(n){if(n.compare(eL)>0){ne("DS_INTERNAL.SHOW_DATA_PANDAS_OK");return}ne("DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD");let i=`${n.major}.${n.minor}.${n.build}`;await this.promptInstall(e,t,i)}ne("DS_INTERNAL.SHOW_DATA_NO_PANDAS"),await this.promptInstall(e,t)}finally{t.dispose()}}};U([Nr("DS_INTERNAL.PYTHON_MODULE_INSTALL",{action:"displayed",moduleName:_i.get(23)})],iD.prototype,"promptInstall",1);var tB="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",dCe=`import pandas as _VSCODE_pandas;print(_VSCODE_pandas.__version__);print("${tB}"); del _VSCODE_pandas`;function pCe(r){return(r.kernelConnectionMetadata.interpreter&&_r(r.kernelConnectionMetadata.interpreter))==="Conda"?"%conda":"%pip"}var rL=class extends iD{async execute(e,t){var o;if(!((o=t.session)!=null&&o.kernel))throw new Qr;let n=await Ai(t.session.kernel,e),i=n.find(s=>s.output_type==="error");return i&&C.warn(W.failedToGetVersionOfPandas,i.message),n.map(s=>{var a;return(a=s.text)==null?void 0:a.toString()})}async _getVersion(e){let n=(await this.execute(dCe,e)).map(s=>s?s.toString():void 0).find(s=>s);if(!(n!=null&&n.includes(tB)))return C.warn(W.failedToGetVersionOfPandas,`Output is ${n}`),"";let i=lt(n.trim()),o=i.indexOf(tB);return o>=0?i[o-1]:""}async _doInstall(e){let t=`${pCe(e)} install pandas`;try{await this.execute(t,e),ne("DATASCIENCE.USER_INSTALLED_PANDAS")}catch(n){throw ne("DATASCIENCE.USER_INSTALLED_PANDAS",void 0,void 0,n),new Error(W.failedToInstallPandas)}}async checkAndInstallMissingDependencies(e){var t;if(ne("DATAVIEWER.USING_KERNEL"),!((t=e.session)!=null&&t.kernel))throw ne("DATASCIENCE.NO_ACTIVE_KERNEL_SESSION"),new Error("No no active kernel session.");await this.checkOrInstall(e)}};var DE=class{constructor(){this.withKernel=new rL}async checkAndInstallMissingDependencies(e){return this.withKernel.checkAndInstallMissingDependencies(e)}};DE=U([(0,Are.injectable)()],DE);p();var Gs;(s=>(s.Started="started",s.UpdateSettings="update_settings",s.SendPlot="send_plot",s.CopyPlot="copy_plot",s.ExportPlot="export_plot",s.RemovePlot="remove_plot"))(Gs||(Gs={}));var Mre=class{};Gs.Started,Gs.UpdateSettings,Gs.SendPlot,Gs.CopyPlot,Gs.ExportPlot,Gs.RemovePlot;var nL=Symbol("IPlotViewerProvider"),iL=Symbol("IPlotViewer");p();var Fv=oe(he());var Au=require("vscode");p();var oL=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged&&this.viewChanged(e)}};var TE=class extends PE{constructor(t,n,i,o){let s=new yt,a=Fi(o.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(l,u,c)=>new oL(l,u,c),a,[Fi(a,"plotViewer.js")],W.plotViewerTitle,Au.ViewColumn.One);this.fs=i;this.context=o;this.closedEvent=new Au.EventEmitter;this.removedEvent=new Au.EventEmitter;this.addPlot=async t=>{this.isDisposed||(await super.show(!1),this.postMessage(Gs.SendPlot,t).catch(E))};super.loadWebview(Au.Uri.file(process.cwd())).catch(C.error).finally(()=>{ne("PLOTVIEWER.WEBVIEW_LOADED",{duration:s.elapsedTime})})}get closed(){return this.closedEvent.event}get removed(){return this.removedEvent.event}async show(){if(!this.isDisposed)return super.show(!0)}dispose(){super.dispose(),this.removedEvent.dispose(),this.closedEvent&&this.closedEvent.fire(this)}get owningResource(){}onMessage(t,n){switch(t){case Gs.CopyPlot:this.copyPlot(n.toString()).catch(E);break;case Gs.ExportPlot:this.exportPlot(n).catch(E);break;case Gs.RemovePlot:this.removePlot(n);break;default:break}super.onMessage(t,n)}removePlot(t){this.removedEvent.fire(t)}copyPlot(t){return Promise.resolve()}async exportPlot(t){C.info("exporting plot...");let n={};n[W.pngFilter]=["png"],n[W.svgFilter]=["svg"];let i=await Au.window.showSaveDialog({saveLabel:W.exportPlotTitle,filters:n});try{if(i)switch(Ep(i.path).toLowerCase()){case".png":let s=hR(t.png.replace("data:image/png;base64",""));await this.fs.writeFile(i,s);break;default:case".svg":await this.fs.writeFile(i,t.svg);break}}catch(o){C.error(o),Au.window.showErrorMessage(W.exportImageFailed(o.toString())).then(E,E)}}};TE=U([(0,Fv.injectable)(),x(0,(0,Fv.inject)(FI)),x(1,(0,Fv.inject)(Ke)),x(2,(0,Fv.inject)(Pt)),x(3,(0,Fv.inject)(st))],TE);p();var oD=oe(he());var kE=class{constructor(e,t){this.serviceContainer=e;this.imageList=[];this.closedViewer=()=>{this.currentViewer&&(this.currentViewer=void 0),this.currentViewerClosed&&(this.currentViewerClosed.dispose(),this.currentViewerClosed=void 0)};this.removedPlot=e=>{this.imageList.splice(e,1)};t.push(this)}dispose(){this.currentViewer&&this.currentViewer.dispose()}async showPlot(e){this.imageList.push(e);let t=this.currentViewer?[e]:this.imageList,n=await this.getOrCreate();await Promise.all(t.map(n.addPlot))}async getOrCreate(){return this.currentViewer||(this.currentViewer=this.serviceContainer.get(iL),this.currentViewerClosed=this.currentViewer.closed(this.closedViewer),this.currentViewer.removed(this.removedPlot),ne("DATASCIENCE.OPEN_PLOT_VIEWER"),await this.currentViewer.show()),this.currentViewer}};kE=U([(0,oD.injectable)(),x(0,(0,oD.inject)(Ar)),x(1,(0,oD.inject)(ve))],kE);p();var aL=oe(he()),Am=require("vscode");var Ore="image/svg+xml",sL={"image/png":"png","image/jpeg":"jpeg","image/gif":"gif",[Ore]:"svg"},NE=class{constructor(e){this.fs=e}async savePlot(e,t,n){if(e.isClosed)return;let i=fCe(e,t,n);if(!i)return C.error(`No plot to save ${Ee(e.uri)}, id: ${t} for ${n}`);if(!(n.toLowerCase()in sL))return C.error(`Unsupported MimeType ${Ee(e.uri)}, id: ${t} for ${n}`);let o=await this.getSaveTarget(i,n);o&&(o.path.toLowerCase().endsWith("pdf")?await this.saveAsPdf(i,o):await this.saveAsImage(i,o))}getSaveTarget(e,t){var l;let n=sL[t.toLowerCase()],i={};e.items.find(u=>u.mime.toLowerCase()===Ore)&&(i[W.pdfFilter]=["pdf"],i[W.svgFilter]=["svg"]),n==="png"&&(i[W.pngFilter]=["png"]),Object.keys(i).length===0&&(i.Images=[n]);let o=(((l=Am.workspace.workspaceFolders)==null?void 0:l.length)||0)>0?Am.workspace.workspaceFolders[0].uri:void 0,s="output",a=o?Am.Uri.joinPath(o,s):Am.Uri.file(s);return Am.window.showSaveDialog({defaultUri:a,saveLabel:W.exportPlotTitle,filters:i})}async saveAsImage(e,t){let n=Ep(t.path).substring(1),i=Object.keys(sL).find(s=>sL[s]===n),o=e.items.find(s=>s.mime===i);if(!o)throw new Error(`Unsupported MimeType ${t.toString()}, available mime Types: ${e.items.map(s=>s.mime).join(", ")}`);await this.fs.writeFile(t,o.data)}async saveAsPdf(e,t){return C.error("Save as PDF is not yet supported on the web.")}};NE=U([(0,aL.injectable)(),x(0,(0,aL.inject)(Pt))],NE);function fCe(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e&&i.items.find(o=>o.mime===t))return i}p();var lL=oe(he());var mCe="image/svg+xml",hCe="image/png",gp=class{constructor(e){this.plotViewProvider=e}async openPlot(e,t){if(e.isClosed)return;let n=Lre(e,t,mCe),i;if(n)i=new TextDecoder().decode(n.data);else{let o=Lre(e,t,hCe);if(!o)return C.error(`No SVG or PNG Plot to open ${Ee(e.uri)}, id: ${t}`);i=gCe(o)}i&&await this.plotViewProvider.showPlot(i)}};gp=U([(0,lL.injectable)(),x(0,(0,lL.inject)(nL))],gp);function Lre(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e)return i.items.find(o=>o.mime===t)}function gCe(r){let e=r.data,t=gR(e),n=vCe(e);return`<?xml version="1.0" encoding="utf-8" standalone="no"?>
<svg height="${n.height}" width="${n.width}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g>
        <image xmlns="http://www.w3.org/2000/svg" x="0" y="0" height="100%" width="100%" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="data:image/png;base64,${t}"/>
    </g>
</svg>`}function vCe(r){if(!yCe(r))throw new Error("The buffer is not a valid png");let e=new DataView(new Uint8Array(r).buffer);return{width:e.getUint32(16,!1),height:e.getUint32(20,!1)}}function yCe(r){return r[0]===137&&r[1]===80&&r[2]===78&&r[3]===71&&r[4]===13&&r[5]===10&&r[6]===26&&r[7]===10&&r.length>8+21}p();var sD=oe(he()),aD=require("vscode");p();var cL=Symbol("IPlotSaveHandler");var RE=class{constructor(e,t){this.plotSaveHandler=e;this.plotViewHandler=t;this.disposables=[]}dispose(){Ce(this.disposables)}activate(){this.activateImpl().catch(E)}async activateImpl(){let e=aD.extensions.getExtension(vp);if(!e)return;e.isActive||await e.activate(),e.exports.onDidReceiveMessage(async({editor:n,message:i})=>{var s;let o=n.notebook||((s=aD.window.activeNotebookEditor)==null?void 0:s.notebook);if(o)try{i.type==="saveImageAs"?await this.plotSaveHandler.savePlot(o,i.outputId,i.mimeType):i.type==="openImageInPlotViewer"&&await this.plotViewHandler.openPlot(o,i.outputId)}catch(a){C.error(a),aD.window.showErrorMessage(W.exportImageFailed(a.message)).then(E,E)}},this,this.disposables)}};RE=U([(0,sD.injectable)(),x(0,(0,sD.inject)(cL)),x(1,(0,sD.inject)(gp))],RE);p();var ME=oe(he()),uL=require("vscode");var AE=class{constructor(e,t,n){this.kernelProvider=e;this.controllers=t;this.ipywidgetMessageDispatcher=n;this.disposables=[];this.widgetOutputsPerNotebook=new WeakMap}dispose(){Ce(this.disposables)}activate(){let e=uL.notebooks.createRendererMessaging("jupyter-ipywidget-renderer");e.onDidReceiveMessage(this.onDidReceiveMessage.bind(this,e),this,this.disposables),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables)}onDidStartKernel(e){this.hookupKernel(e),e.onStarted(()=>this.hookupKernel(e),this,this.disposables),e.onRestarted(()=>this.hookupKernel(e),this,this.disposables)}hookupKernel(e){var a,l,u;this.widgetOutputsPerNotebook.delete(e.notebook);let t=(a=e.session)==null?void 0:a.kernel,n=(u=(l=e.session)==null?void 0:l.kernel)==null?void 0:u.iopubMessage;if(!n)return;let i=this.ipywidgetMessageDispatcher.create(e.notebook);this.disposables.push(i.onDisplayMessage(c=>{this.trackModelId(e.notebook,c)}));let o=Jn(),s=(c,d)=>{c===t&&(o.KernelMessage.isDisplayDataMsg(d)||o.KernelMessage.isUpdateDisplayDataMsg(d)||o.KernelMessage.isExecuteReplyMsg(d)||o.KernelMessage.isExecuteResultMsg(d))&&this.trackModelId(e.notebook,d)};n.connect(s),this.disposables.push(new uL.Disposable(()=>n.disconnect(s)))}trackModelId(e,t){let n=t.content;if(n.data&&typeof n.data=="object"&&uo in n.data){let i=n.data[uo];if(i&&"model_id"in i){let o=this.widgetOutputsPerNotebook.get(e)||new Set;o.add(i.model_id),this.widgetOutputsPerNotebook.set(e,o)}}}onDidReceiveMessage(e,{editor:t,message:n}){n&&typeof n=="object"&&n.command==="query-widget-state"&&this.queryWidgetState(e,t,n),n&&typeof n=="object"&&n.command==="ipywidget-renderer-loaded"&&this.sendWidgetVersionAndState(e,t)}queryWidgetState(e,t,n){let i=this.widgetOutputsPerNotebook.get(t.notebook),o=!!this.controllers.getSelected(t.notebook),s=!!(i!=null&&i.has(n.model_id));e.postMessage({command:"query-widget-state",model_id:n.model_id,hasWidgetState:s,kernelSelected:o},t).then(E,E)}sendWidgetVersionAndState(e,t){let n=this.kernelProvider.get(t.notebook),i=n==null?void 0:n.ipywidgetsVersion;n!=null&&n.ipywidgetsVersion&&C.trace(`IPyWidget version in Kernel is ${n==null?void 0:n.ipywidgetsVersion}.`);let o=!!this.controllers.getSelected(t.notebook);e.postMessage({command:"ipywidget-renderer-init",version:i,widgetState:void 0,kernelSelected:o},t).then(E,E)}};AE=U([(0,ME.injectable)(),x(0,(0,ME.inject)(qe)),x(1,(0,ME.inject)(Nt)),x(2,(0,ME.inject)(Vl))],AE);function Kre(r){r.addSingleton(Ve,RE),r.addSingleton(Ve,wE),r.add(GO,Kv),r.addSingleton(_E,Rm),r.addSingleton(EE,DE),r.addSingleton(Xl,Xl),r.add(iL,TE),r.addSingleton(nL,kE),r.addSingleton(cL,NE),r.addSingleton(gp,gp),r.addSingleton(jO,xE),r.addSingleton(Ve,IE),r.addSingleton(Ve,AE),r.addSingleton(BO,SE),r.add(YO,mp),r.addSingleton($O,CE)}p();var Hre=oe(nK());p();var Fre=oe(he());var Uv=class{constructor(e){this.container=e}getContainer(){return this.container}add(e,t,n,i){n?this.container.bind(e).to(t).whenTargetNamed(n):this.container.bind(e).to(t),i&&i.forEach(o=>{this.addBinding(e,o)})}addFactory(e,t){this.container.bind(e).toFactory(t)}addBinding(e,t){this.container.bind(t).toService(e)}addSingleton(e,t,n,i){n?this.container.bind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.bind(e).to(t).inSingletonScope(),i&&i.forEach(o=>{this.addBinding(e,o)})}addSingletonInstance(e,t,n){n?this.container.bind(e).toConstantValue(t).whenTargetNamed(n):this.container.bind(e).toConstantValue(t)}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}rebind(e,t,n){n?this.container.rebind(e).to(t).whenTargetNamed(n):this.container.rebind(e).to(t)}rebindSingleton(e,t,n){n?this.container.rebind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.rebind(e).to(t).inSingletonScope()}rebindInstance(e,t,n){n?this.container.rebind(e).toConstantValue(t).whenTargetNamed(n):this.container.rebind(e).toConstantValue(t)}dispose(){this.container.unbindAll(),this.container.unload()}};U([$v()],Uv.prototype,"getContainer",1),Uv=U([(0,Fre.injectable)()],Uv);var _n=require("vscode");p();var Wre=require("vscode");function Vre(r){let e=Wre.window.createOutputChannel(W.jupyterServerConsoleOutputChannel,"log");r.push(e);let t={get(n,i){let o=n[i];if(typeof o=="function"){if(i==="append")return(...s)=>{e.append(...s),Ure(...s)};if(i==="appendLine")return(...s)=>{e.appendLine(...s),Ure(...s)}}return o}};return new Proxy(e,t)}function Ure(...r){r.length===1?C.debug(lt(r[0]).map((e,t)=>t===0?e:`    ${e}`).join(`
`)):C.debug(...r)}p();var jre=require("vscode");function Bre(){let r=jre.workspace.getConfiguration("python"),e=r==null?void 0:r.get("languageServer");return!(e!=="Pylance"&&e!=="Default")}async function qre(r,e){let t=H7(e);t.appendLine(`${_n.env.appName} (${_n.version}, ${_n.env.remoteName}, ${_n.env.appHost})`),t.appendLine(`Jupyter Extension Version: ${r.extension.packageJSON.version}.`);let n=_n.extensions.getExtension($s);n?t.appendLine(`Python Extension Version: ${n.packageJSON.version}.`):t.appendLine("Python Extension not installed.");let i=_n.extensions.getExtension(vB);return i?t.appendLine(`Pylance Extension Version${Bre()?"":" (Not Used) "}: ${i.packageJSON.version}.`):t.appendLine("Pylance Extension not installed."),e!=null&&e.platform&&t.appendLine(`Platform: ${e.platform} (${e.arch}).`),t.appendLine(`Home = ${e==null?void 0:e.homePath}`),t.appendLine(`Temp Storage folder ${Ee(await Yte(r))}`),!_n.workspace.workspaceFolders||_n.workspace.workspaceFolders.length===0?t.appendLine("No workspace folder opened."):_n.workspace.workspaceFolders.length===1?t.appendLine(`Workspace folder ${Ee(_n.workspace.workspaceFolders[0].uri)}`):t.appendLine(`Multiple Workspace folders opened ${_n.workspace.workspaceFolders.map(o=>Ee(o.uri)).join(", ")}`),t}function Jre(r,e){let t=new Hre.Container({skipBaseClassChecks:!0}),n=new Uv(t),i=new tt(t);return n.addSingletonInstance(Ar,i),n.addSingletonInstance(OZ,n),n.addSingletonInstance(ve,r.subscriptions),n.addSingletonInstance(Et,r.globalState,rr),n.addSingletonInstance(Et,r.workspaceState,_s),n.addSingletonInstance(st,r),n.addSingletonInstance(jm,e,qv),n.addSingletonInstance(jm,Vre(r.subscriptions),gB),[n,i]}function Gre(){let r=Re(),e={location:_n.ProgressLocation.Window,title:Ue.loadingExtension};return _n.window.withProgress(e,()=>r.promise).then(E,E),{dispose:()=>r.resolve()}}function Yre(r,e,t){bCe(Ue.handleExtensionActivationError),console.error("extension activation failed",r),C.error("extension activation failed",r),qQ(r,e,t)}function bCe(r){try{_n.window.showErrorMessage(r).then(E,E)}catch(e){C.error("failed to notify user",e)}}async function $re(r,e){let t=e.get(py),n=new yt;await t.activate();let i=n.elapsedTime;ne("DS_INTERNAL.EXPERIMENT_LOAD",{duration:i}),_n.commands.executeCommand("setContext","jupyter.vscode.channel",Wd()).then(E,E),e.get(pA).activate();let o=e.get(ST);o.initialize(),r.subscriptions.push(o)}var rB=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}},OE=new rB,lD={totalActivateTime:0,codeLoadingTime:0,startActivateTime:0,endActivateTime:0,workspaceFolderCount:0};typeof requestAnimationFrame=="undefined"&&typeof setImmediate=="undefined"&&(self.setImmediate=r=>setTimeout(r),self.clearImmediate=r=>clearTimeout(r));lD.codeLoadingTime=OE.elapsedTime;var nB;async function ICe(r){lD.startActivateTime=OE.elapsedTime;let e=await qre(r,{addConsoleLogger:hn()});bY(OE),QB(r.subscriptions),dB(Zl.env.uiKind==Zl.UIKind.Web),mB(!0),r.subscriptions.push({dispose:()=>FE.isExiting=!0});try{let[t,n]=_Ce(r,e);return await n,HQ(lD,OE),t}catch(t){return lD.endActivateTime=OE.elapsedTime,Yre(t,lD,OE),C.error("Failed to active the Jupyter Extension",t),{ready:Promise.resolve(),registerPythonApi:E,registerRemoteServerProvider:()=>({dispose:E}),getKernelService:()=>Promise.resolve(void 0),addRemoteJupyterServer:()=>Promise.resolve(void 0),openNotebook:()=>Promise.reject(),createJupyterServerCollection:()=>{throw new Error("Not Implemented")},kernels:{getKernel:()=>Promise.resolve(void 0),onDidStart:()=>({dispose:E})},onDidChangePythonEnvironment:void 0,getPythonEnvironment:()=>{}}}}function SCe(){if(FE.isExiting=!0,nB){let r=nB.get(Vu);if(r)return r.dispose()}return Promise.resolve()}function _Ce(r,e){let t=Gre();try{let[n,i]=Jre(r,e);nB=i,hY(()=>Promise.resolve(new Map));let o=ECe(r,n,i);return[VQ(o,n,i,r),o,i]}finally{t.dispose()}}async function ECe(r,e,t){let n=r.extensionMode===Zl.ExtensionMode.Development||Zl.workspace.getConfiguration("jupyter").get("development",!1);e.addSingletonInstance($7,n),n&&Zl.commands.executeCommand("setContext","jupyter.development",!0).then(E,E),Zl.commands.executeCommand("setContext","jupyter.webExtension",!0).then(E,E),BX(e),Kee(e,n),MZ(e,n),Ute(e),Vte(e),Ere(r,e,n),Kre(e),await $re(r,t)}
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

@microsoft/dynamicproto-js/lib/dist/esm/dynamicproto-js.js:
  (*!
   * Microsoft Dynamic Proto Utility, 1.1.8
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)

strip-comments/index.js:
  (*!
   * strip-comments <https://github.com/jonschlinkert/strip-comments>
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Released under the MIT License.
   *)
*/
